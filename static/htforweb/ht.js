!function(B,x,_){"use strict";function s(I,G){if("function"!=typeof G&&null!==G)throw new TypeError("Super expression must either be null or a function");I.prototype=x.create(G&&G.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),G&&al(I,G)}function K(r){var z=x.prototype.toString.call(r);return"Array]"===z.substring(z.length-6)}function p(V,N,L,H,r,b){N=N||[],L=L||[],H=H||[];try{N.push(V);var e=Function.apply(0,N);return L[L.length]="return "+e,Function.apply(0,L).apply(0,H)}catch(K){return b&&b(K),r}}function m(B){var d={};return{get:function(o){if(d[o]!==_)return d[o];var n;switch(o){case"WEBGL_depth_texture":n=B.getExtension("WEBGL_depth_texture")||B.getExtension("MOZ_WEBGL_depth_texture")||B.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=B.getExtension("EXT_texture_filter_anisotropic")||B.getExtension("MOZ_EXT_texture_filter_anisotropic")||B.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=B.getExtension("WEBGL_compressed_texture_s3tc")||B.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||B.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=B.getExtension("WEBGL_compressed_texture_pvrtc")||B.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=B.getExtension("WEBGL_compressed_texture_etc1");break;default:n=B.getExtension(o)}return d[o]=n,n}}}function I(h,w,W){function m(){if(u!==_)return u;var p=w.get("EXT_texture_filter_anisotropic");return u=null!==p?h.getParameter(p.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function e(D){if("highp"===D){if(h.getShaderPrecisionFormat(h.VERTEX_SHADER,h.HIGH_FLOAT).precision>0&&h.getShaderPrecisionFormat(h.FRAGMENT_SHADER,h.HIGH_FLOAT).precision>0)return"highp";D="mediump"}return"mediump"===D&&h.getShaderPrecisionFormat(h.VERTEX_SHADER,h.MEDIUM_FLOAT).precision>0&&h.getShaderPrecisionFormat(h.FRAGMENT_SHADER,h.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var u;W=W||{};var L="undefined"!=typeof WebGL2RenderingContext&&h instanceof WebGL2RenderingContext,Y=W.precision!==_?W.precision:"highp",z=e(Y);z!==Y&&(console.warn("WebGL:",Y,"not supported, using",z,"instead."),Y=z);var Z=W.logarithmicDepthBuffer===!0,i=h.getParameter(h.MAX_TEXTURE_IMAGE_UNITS),P=h.getParameter(h.MAX_VERTEX_TEXTURE_IMAGE_UNITS),U=h.getParameter(h.MAX_TEXTURE_SIZE),$=h.getParameter(h.MAX_CUBE_MAP_TEXTURE_SIZE),S=h.getParameter(h.MAX_VERTEX_ATTRIBS),v=h.getParameter(h.MAX_VERTEX_UNIFORM_VECTORS),B=h.getParameter(h.MAX_VARYING_VECTORS),I=h.getParameter(h.MAX_FRAGMENT_UNIFORM_VECTORS),C=P>0,D=L||!!w.get("OES_texture_float"),g=(L||!!w.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,K=C&&D,l=L?h.getParameter(h.MAX_SAMPLES):0;return{getMaxAnisotropy:m,getMaxPrecision:e,precision:Y,logarithmicDepthBuffer:Z,maxTextures:i,maxVertexTextures:P,maxTextureSize:U,maxCubemapSize:$,maxAttributes:S,maxVertexUniforms:v,maxVaryings:B,maxFragmentUniforms:I,vertexTextures:C,floatFragmentTextures:D,elementTypeUint:g,floatVertexTextures:K,maxSamples:l}}function V($,z){return $.z!==z.z?z.z-$.z:$.id-z.id}var v="ht";if(!B[v]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),B.performance&&B.performance.now||function(){var e=Date.now();B.performance||(B.performance={}),B.performance.now=function(){return Date.now()-e}}();for(var h=Date.now(),l=16,z=["ms","moz","webkit","o"],t=0;t<z.length&&!B.requestAnimationFrame;++t)B.requestAnimationFrame=B[z[t]+"RequestAnimationFrame"],B.cancelAnimationFrame=B[z[t]+"CancelAnimationFrame"]||B[z[t]+"CancelRequestAnimationFrame"];B.requestAnimationFrame||(B.requestAnimationFrame=function(f){var t=Date.now(),N=l+h-t;return 0>N&&(N=0),h=t,B.setTimeout(function(){h=Date.now(),f(performance.now())},N)}),B.cancelAnimationFrame||(B.cancelAnimationFrame=function(H){return B.clearTimeout(H)}),x.assign===_&&(x.assign=function(h){if(h===_||null===h)throw new TypeError("Cannot convert undefined or null to object");for(var e=x(h),u=1;u<arguments.length;u++){var c=arguments[u];if(c!==_&&null!==c)for(var $ in c)x.prototype.hasOwnProperty.call(c,$)&&(e[$]=c[$])}return e}),B.btoa===_&&(B.btoa=function(F){for(var X,P,G=String(F),e=0,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",j="";G.charAt(0|e)||(S="=",e%1);j+=S.charAt(63&X>>8-8*(e%1))){if(P=G.charCodeAt(e+=.75),P>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");X=X<<8|P}return j})}();var l,c,$,T,i=B.location,L=i&&B.document,Q=null,k=_,b=B[v]={},M=B[v+"config"],C=b.Default=M&&M.Default||{},X=b.Style=M&&M.Style||{},H=b.Attr=M&&M.Attr||{},r=function(){return!0},d=function(){return!1},a=function(u){return u},Y=function(y){return!y},g=b.Color=M&&M.Color||{},P=b.IsGetter=M&&M.IsGetter||{};!function(){var A=!1;try{var q=x.defineProperty({},"passive",{get:function(){return A=!0,_}});i&&($=l=i)&&B.addEventListener("test",q,q),i&&(T=c=i)&&B.removeEventListener("test",q,q)}catch(Z){A=!1}C.passiveSupported=A}();var w,G,n,O,U=C.passiveSupported,y=C.eventListenerOptionsFalse=U?{passive:!1,capture:!1}:!1,N=C.eventListenerOptionsTrue=U?{passive:!1,capture:!0}:!0,W=function(L,t,i,l){L.addEventListener(t,i,l?N:y)},R=function(K,r,L,q){K.removeEventListener(r,L,q?N:y)},q=Math,u=q.round,E=q.floor,J=q.ceil,z=q.sqrt,f=q.max,F=q.min,D=q.abs,j=q.cos,S=q.acos,h=q.sin,t=q.pow,A=q.asin,o=q.exp,e=q.PI,Z=2*e,Ej=e/2,is=q.tan,mf=q.atan2,Ch=q.random,Pn=q.log,Wo=function(f,I,J){return Math.max(I,Math.min(J,f))},ce=t(2,1),gd=!1,pm=B.parseInt||global.parseInt,pi="2021-12-15",cb=i&&(B.navigator?B.navigator.platform.indexOf("Win")>-1:!1),aj=function(N){return N*N},Eg=i&&B.setTimeout,qs=i&&B.clearTimeout,Jg=i&&(B.navigator?B.navigator.userAgent.toLowerCase():""),sb=function(w){return w.test(Jg)},eb=sb(/msie/),nm=sb(/msie/)||sb(/trident/),Ah=sb(/msie 10/),Kb=sb(/edge/),sd=sb(/firefox/),bd=sb(/mac/),yb=sb(/mscAndroid/),Ap=C.isTouchable===_?cb?!1:L?"ontouchend"in L:!1:C.isTouchable,Dh="default",jg="single",fe="multiple",fb="front",ge="back",Mh="left",Xi="right",Ui="top",nl="bottom",Nc="center",fr="eye",gi="middle",yj="east",vr="west",jp="north",Vl="none",jf="px",sq="absolute",hd="border",$g="triangle",Lm="rect",To="circle",ui="cylinder",qo="shape",wk="items",bn="normal",vi="remove",gg="clear",Od="width",pe="height",Oj="ingroup",Uf="check",ls="uncheck",Yr="radio",tb="radioOn",zb="radioOff",Hl="points",wl="values",dm="series",gb="body",lf="label",$n="label2",Hd="note",el="note2",xj="icons",Gg="labelFont",us="labelColor",qk="labelSelectColor",lj="note.expanded",bg="note2.expanded",hr="edge.expanded",Dj="edge.points",jo="edge.type",js="rotation",qr="hidden",qj="visible",kj="tuv",Te="no",ul="draw",zd="select",Mb="currentSubGraph",fo="selectBackground",yc="autoMakeVisible",hh="autoHideScrollBar",Kh="scrollBarColor",jr="scrollBarSize",er="indent",Rk="rowHeight",Ke="columnLineColor",Rm="rowLineColor",Ef="columnLineVisible",so="rowLineVisible",Re="visibleFunc",Gd="expandIcon",Cs="collapseIcon",Io="checkMode",me="sortFunc",Wk="editable",qm="batchEditable",he="tristate",Al="asc",ff="desc",_g="position",mc="__",tp="elevation",Jl="children",Kn="translateX",Dr="translateY",Ei="dataModel",Qe="maxSize",ei="enc",Jk="state",Rn=ei+"o"+"de",Sl="shape3d",jh="shape3d.resolution",Cm="shape3d.visible",Xo="shape3d.from.visible",vl="shape3d.to.visible",$c="shape3d.top.visible",Tg="shape3d.bottom.visible",jb="repeat.uv.length",as="serializeValue",Bk="deserializeValue",vh="centerUniform",Ek="uniform",eo="rgba(255,255,255,0)",ij="style",Jm="attr",yl="field",Nh="string",Xp="boolean",se="color",Gr="int",_o="number",cr="ew-resize",Wm="ns-resize",Yi="pointer",Jq="auto",Rl="mousedown",rl="mousemove",Tk="mouseup",wp="mouseout",mh="touchstart",He="touchmove",Rr="touchend",Qh="keydown",io="keyup",Vd=["DOMMouseScroll","mousewheel"],_e=sd?Vd[0]:Vd[1],Cc=mc+v+mc+Rn,Ze=[mh,He,Rr],xb=[Rl,rl,Tk,wp,_e,"wheel","mouseenter","mouseleave","mouseover"],fi=[Qh,io,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],hb=Ap?Ze.concat(fi):xb.concat(fi),mm=Q,kp=Q,Sj=Q,jd=Q,Yo=!0,Vk=Tk.length,Zq=function(){Sj&&(qs(Sj.timeout),Sj=Q)},Ai=function(){Sj&&Hi(Sj.e,Sj.info)};B.addEventListener&&(k=i)&&(Ap||(W(B,wp,function(){Zq()}),W(B,_e,function(){zn()})),W(B,io,function(N){91===N.keyCode?Fr={}:delete Fr[N.keyCode]},!0),W(B,Qh,function(c){Fr[c.keyCode]=!0},!0),W(B,"blur",function(){Fr={}}));var ji,Vo,Wf,Zg=0,rb=Q,gr=function(N,h){var k=Eg(function(){delete rb[k],vo(rb)&&(rb=Q),N()},h);return k},Le=Q,Tq=Q,Uh={},Nf={},Tn={},Ko={},ak={},Fr={},lp={},zi={},zp={},Gb={},up=/.json$/,Gk=/\.(json|bin)$/,ej=/^data:image\/svg\+xml/,Ye={},Fj=[],Ep={},gn=Q,Ql=Q,ss=function(){},Cf=function(){throw"Oops!"},Em=[0,0,0],Tm={x:0,y:0,width:0,height:0},Gc=Q,Ol=Q,zm=Q,Cq=function(E,s){Nf[E]=s,s&&s.comps&&!s.uuid&&(s.uuid=b.Math.generateUUID()),Lh[E]&&(s.cacheRule=Lh[E],delete Lh[E])},we=function(z){Ol&&!z._72O&&(zm||(zm={}),zm[z._72O=Tb()]=z),ji!=Q?jn()<.05&&O&&!Vo&&(Wi=Zq):Wi=wb},ve=function(p,c,Z,K){Ol||(Ol={});var l=Ol[p];if(l){if(l.url===c)return;l.image?(l.image.onload=ss,l.image.onerror=ss):l.request&&(l.request.onload=ss,l.request.onerror=ss)}if(up.test(c)){var A=new rn;if(Ol[p]={request:A,url:c},c=C.beforeLoadURL(c,p),c.data){var e=C.parse(c.data);Fg(p,e),C.handleImageLoaded(p,e)}else{A.onload=function(){if(200===this.status||0===this.status){var L=C.parse(A.getResponseText());Fg(p,L),C.handleImageLoaded(p,L)}else Fg(p,C.handleUnfoundImage(p,c)||Q)},A.onerror=function(){Fg(p,C.handleUnfoundImage(p,c)||Q)};var N={};N.url=encodeURI(c),N.sync=!1,A.send(N)}}else{var e=new Image;Ol[p]={image:e,url:c},/^data:image/.test(c)||(c=C.beforeLoadURL(c,p),c=C.appendTimeStamp(c),c=encodeURI(c),e.crossOrigin=C.crossOrigin),C.convertImageSrc(c,function(M){nm&&(c.toLowerCase().indexOf(".svg")>0||ej.test(c))?(L.body.appendChild(e),e.style.visibility="hidden",e.onload=function(){Eg(function(){if(Z&&(e.width=Z),K&&(e.height=K),!e.width||!e.height){var n=e.width||e.clientWidth,o=e.height||e.clientHeight;e.width=n,e.height=o}C.handleImageLoaded(p,e),Fg(p,e),L.body.removeChild(e),e.style.visibility=""},180)},e.onerror=function(){Fg(p,C.handleUnfoundImage(p,c)||Q),L.body.removeChild(e),e.style.visibility=""}):(e.onload=function(){Z&&(e.width=Z),K&&(e.height=K),C.handleImageLoaded(p,e),Fg(p,e)},e.onerror=function(){Fg(p,C.handleUnfoundImage(p,c)||Q)}),e.src=M})}},Fg=function(C,Y){if(Cq(C,Y),delete Ol[C],vo(Ol)&&(Ol=Q,zm)){for(var S in zm){var o=zm[S];o._2O&&o._2O[C]&&(o.deleteTexture(C),delete o._2O[C]),o.invalidateAll&&o.invalidateAll(_,"imageLoaded",C),o.redraw&&o.redraw(),o.iv(),Y&&Y.layoutAttach&&np(o.dm)&&o.dm().updateLayoutAttach(C),delete o._72O}zm=Q}if(Y&&zm)for(var S in zm){var o=zm[S];o.invalidateAll&&o.invalidateAll(_,"imageLoading",C),o.redraw&&o.redraw(),o.iv(),Y.layoutAttach&&np(o.dm)&&o.dm().updateLayoutAttach(C)}},wq=function(){return Pn=q&&Date,function(){return B.performance&&B.performance.now?B.performance.now():Date.now()}}(),oo=function(Q,$,f){return{width:Q,height:$,comps:oi(f)?f:[f]}},gp=function(Y,D){return{type:To,rect:[Y,D,1.6,1.6],borderWidth:1,borderColor:yo,gradient:ns,gradientColor:xo,background:yo}},df=function(Q,Z){return oo(16,16,{type:$g,rect:[4,4,10,8],background:Q,rotation:Z?1.57:3.14})},dn=function(U,g){return oo(16,16,{type:$g,rect:[4,4,8,7],background:U,rotation:g?3.14:0})},Zh=function(c){var r=c._orientation;return"horizontal"===r||"h"===r},$k=function(K,W){var U=Q||4,i=Q||1,u=Q||1;0>U?U=0:U>.25&&(U=.25);var n,L,y,m,N,X,F,c=.5,S=[],I=[],r=[],x=Z/u,D=Z/i,b=c-U;for(L=0;i>=L;L++)for(m=-e+L*D,X=j(m),N=h(m),n=0;u>=n;n++)y=n*x,F=b+U*X,S.push(j(y)*F,N*U,-h(y)*F),(G=[K,W])&&I.push(n/u,1-L/i);for(L=0;i>L;L++){var o=L*(u+1),q=(L+1)*(u+1);for(n=0;u>n;n++)r.push(o+n,q+n+1,q+n,o+n,o+n+1,q+n+1),cg.z=Kc.z=[K,W]}},_k=function(h){var N=2,F=0;for(var Q in h)Q.length===N&&pm(Q,32)===Or&&(gn=Ql=h[Q]),F++;return F},Hq=function(a,h,A,g){return A||(A=Ap?5:3,A/=g||1),{x:a-A,y:h-A,width:2*A,height:2*A}},Nm=function(s,D,l,g){var M=this;D||(D=Ap?5:3,l=20,g=20);var p={x:s,y:D,width:l,height:g};if(l)for(var K=0;l>K;K++)if(3===l)g=20;else for(var u=0;g>u;u++)M=B?B:l;var w={x:e,y:2*e};if(Om(p,w)){var r=pe[0]+Ui[0]+gg[1]+Al.length,q=qr[0]+he[0]+gg[1]+gb.length;Yq[fr]=[M[r],M[q]],M[r]=mg[fr],M[q]=mg[Sl]}},$h=function(Z){return(/ble$/.test(Z)||/ed$/.test(Z)||P[Z]?"is":"get")+Z.charAt(0).toUpperCase()+Z.slice(1)},mg=function(V){return"set"+V.charAt(0).toUpperCase()+V.slice(1)},am=function(H){return typeof H===Nh||H instanceof String},Ho=function(m){return typeof m===_o},wb=function(e){return typeof e===Xp},vp=function(l){return l&&"object"==typeof l},np=function(x){return"function"==typeof x},oi=function(y){return y instanceof Array},Wh=function(V){return V instanceof Qd},Yh=function(L){return oi(L)?new Qd(L):L},Je=function(M){return M instanceof ud},hn=function(v){return v instanceof fl},Pm=function(U){return U instanceof kc},md=function(X,H){if(!(X instanceof b.Group))return!1;if(!H)return X.isExpanded();var F=H.getDataUI(X);return F&&F._88I?!0:!1},Zj=function(H){return H instanceof Ri},gf=function(u){return u&&"IFRAME"===u.tagName},Rb=function(X){return X==Q||C.numberDigits==Q?X:parseFloat(X.toFixed(C.numberDigits))},ir=function(H,U,T){var R,n=U.length;if(T)for(var g=0;T>g;g++)if(3===n)H.push(U[0]),H.push(U[1]),H.push(U[2]);else for(R=0;n>R;R++)H.push(U[R]);else if(3===n)H.push(U[0]),H.push(U[1]),H.push(U[2]);else for(R=0;n>R;R++)H.push(U[R])},Fl=function(Q){return Q?vp(Q)?Q:{}:!1},nd=function(Z,d,w){var e,D=vp(Z)?Z:Z.prototype;for(e in d)w&&e in D?D[e]===_&&console.warn("class",D,"has own undefined property",e,", keep exist!"):D[e]=d[e];return Z},Nd=function(z,m){if(!("wheelDelta"in m)){var Y=m.deltaMode;m.wheelDelta=Y===m.DOM_DELTA_PIXEL?-m.deltaY:Y===m.DOM_DELTA_LINE?40*-m.deltaY:120*-m.deltaY}z.handle_mousewheel(m)},Ig=function(X){return String.fromCharCode(X)},mk=function(h){for(var A,p=0,L="";p<h.length;p++)A=h[h.length-1-p],"%"===A?A="'":"a"===A?A='"':"]"===A&&(A="\\"),L+=Ig(A.charCodeAt(0)-1);return L},rd=function(s,G,Q){s.superClass.constructor.apply(G,Q)},vo=function(G){for(var p in G)return!1;return!0},Hg=function($){return $?0===$.length:!0},dl=function(){var m="";return[ls[0],Rm[0],lf[0]].forEach(function(o){m+=mg(o).slice(3)}),Ek=L&&L[m]||vh,function(V,K){return V===K?!0:V.x===K.x&&V.y===K.y&&V.width===K.width&&V.height===K.height}}(),cd=function(S,t,W){return t>S?t:S>W?W:S},Qg=function(L){return 0>L?-1:L>0?1:0},jn=function(){var U=1e4*h(Vk++);return U-E(U)},Bn=function(c,m,A){return mq(c.x,c.y,m.x,m.y,A.x,A.y,A.x+A.width,A.y,!0)||mq(c.x,c.y,m.x,m.y,A.x+A.width,A.y,A.x+A.width,A.y+A.height,!0)||mq(c.x,c.y,m.x,m.y,A.x+A.width,A.y+A.height,A.x,A.y+A.height,!0)||mq(c.x,c.y,m.x,m.y,A.x,A.y+A.height,A.x,A.y,!0)},mq=function(u,G,s,B,e,c,z,d,n){var N=(z-e)*(G-c)-(d-c)*(u-e),_=(d-c)*(s-u)-(z-e)*(B-G);if(0!==_){var L=N/_,C=u+L*(s-u),l=G+L*(B-G);return n&&(C+tk<F(u,s)||C-tk>f(u,s)||C+tk<F(e,z)||C-tk>f(e,z)||l+tk<F(G,B)||l-tk>f(G,B)||l+tk<F(c,d)||l-tk>f(c,d))?Q:[C,l]}return Q},rs=function(l,w,b){if(l&&b)if(w){if(w===ij)return l.getStyle(b);if(w===Jm)return l.getAttr(b);if(w===yl)return l[b]}else if(b=$h(b),l[b])return l[b]();return _},ad=function(U,c,m,t){if(U&&m)if(c){if(c===ij)U.s(m,t);else if(c===Jm)U.a(m,t);else if(c===yl){var T=U[m];U[m]=t,U.fp("f:"+m,T,t)}}else m=mg(m),U[m]&&U[m](t)},es=function(u,V){var D,Z,n,J=!1;return(rs(u,ij,"shadow")||V&&"shadow"===rs(u,ij,"select.type"))&&(D=rs(u,ij,"shadow.offset.x")||0,Z=rs(u,ij,"shadow.offset.y")||0,n=rs(u,ij,"shadow.blur")||0,J=!0),!J&&rs(u,ij,"shadow2")&&(D=rs(u,ij,"shadow2.offset.x")||0,Z=rs(u,ij,"shadow2.offset.y")||0,n=rs(u,ij,"shadow2.blur")||0,J=!0),J?1.5*n+Math.max(D,Z):0},jm=function(l,Y,C,m){return m=0===C?0:m||0,Y&&"top"!==Y?"bottom"===Y?{x:l.x-m,y:l.y-m,width:l.width+2*m,height:l.height*C+m}:"right"===Y?{x:l.x-m,y:l.y-m,width:l.width*C+m,height:l.height+2*m}:"left"===Y?{x:l.x+l.width*(1-C),y:l.y-m,width:l.width*C+m,height:l.height+2*m}:void 0:{x:l.x-m,y:l.y+l.height*(1-C),width:l.width+2*m,height:l.height*C+m}},ef=function(X,C,v,c,p){C&&uj(X,v,c,1,p,C)},Vi=function(x,p,l,v){var s=1-x;return s*s*p+2*x*s*l+x*x*v},cg=function(m,c,O,E,Y){var p=1-m;return p*p*p*c+3*p*p*m*O+3*p*m*m*E+m*m*m*Y},xh=function(Q){var e,t,L,q,Z=0;return Q.forEach(function(l){if(e=l.length,e>0)for(t=l[0],q=1;e>q;q++)L=l[q],Z+=Ki(t,L),t=L}),Z},eh=function(y,M,o){var u="__"+y,B=function(w){("mousedown"===y||"mouseup"===y||"touchstart"===y||"touchend"===y)&&Mq(w),o.disabled||o["handle_"+y](w)};o[u]||(o[u]=B,W(M,y,B))},Lk=function(Q,O,_){var d="__"+Q,U=_[d];U&&(R(O,Q,U),delete _[d])},Lf=function(E,S){var O="_"+S;E[$h(S)]=function(){return this[O]},E[mg(S)]=function(j){var k=this[O];this[O]=j,this.fp(S,k,j)}},ed=function(Z){return x.create(Z)},bi=function(L){if(!L.element){var r,W;(r=L.textField)?W=Df(tt.TextField,r):(r=L.textArea)?W=Df(tt.TextArea,r):(r=L.button)?W=Df(tt.Button,r):(r=L.comboBox)?W=Df(tt.ComboBox,r):(r=L.checkBox)?W=Df(tt.CheckBox,r):(r=L.radioButton)?W=Df(tt.RadioButton,r):(r=L.slider)?W=Df(tt.Slider,r):(r=L.colorPicker)?W=Df(tt.ColorPicker,r):(r=L.image)&&(W=Df(tt.Image,r)),W&&(L.element=W)}},Si=function(m,v){var c=jc(m);return c._ht=v,c},Ce=B.top===B?B.top:B||B.document,jc=function(R,b){var I=L.createElement("div"),w=I.style;return I.tabIndex=-1,I.onkeydown=zq,w.msTouchAction=Vl,Rh(I,Q,0),Ap&&w.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",Q),R&&(w.overflow=qr),b&&zk(b,I),I},Yp=function(M,D){var K=L.createElement("canvas"),W=K.style;return W.msTouchAction=Vl,D||(W.pointerEvents=Vl),Rh(K,Q,0),M&&zk(M,K),K},Rh=function(h,W,j){var P=h.style;P.border=W?W+" solid 1px":0,P.outline=0,P.padding=j?"0 "+j+jf:0,Pd(h)},Pd=function(y){var I=y.style;I.position=sq,I.margin=0,I.setProperty("box-sizing","border-box",Q),I.setProperty("-moz-box-sizing","border-box",Q)},$f=function(j,K,M,g){g||(g=rh),K!=Q&&(j.width=K*g,j.style.width=K+jf),M!=Q&&(j.height=M*g,j.style.height=M+jf)},zk=function(a,h,z){a.appendChild(h),z&&(h.style.position=sq)},Yd=function(X,B){B.split||(B+="");for(var K,Z=B.split("\n"),J=0,s=Z.length,E=0;s>E;E++){var W=lr(X.font,Z[E]);W.width>J&&(J=W.width),K||(K=W.height)}return X.ss=Z,{width:J,height:K*s}},Vq=function(A,M,Y,J,F,w,$,_){A.font=Y;var V=A.measureText(M);A.beginPath(),A.strokeStyle=J,A.lineWidth=1,"underline"===_?(A.moveTo(F-$/2,w+V.actualBoundingBoxDescent+1),A.lineTo(F+$/2,w+V.actualBoundingBoxDescent+1)):"strikethrough"===_?(A.moveTo(F-$/2,w),A.lineTo(F+$/2,w)):"overline"===_&&(A.moveTo(F-$/2,w-V.fontBoundingBoxAscent),A.lineTo(F+$/2,w-V.fontBoundingBoxAscent)),A.stroke()},Dm=function(P,N,S,e,K,A,r){var i=N.length;if(1===i){var d=N[0];if(vk(P,d,S,e,K),r){var I=lr(e,d);Vq(P,d,e,K,S.x+S.width/2,S.y+S.height/2,I.width,r)}}else for(var m=S.height/i,g={x:S.x,y:S.y,width:S.width,height:m},p=0;p<N.length;p++){if(A)Br(P,N[p],e,K,g.x,g.y,g.width,g.height,A,null,r);else if(vk(P,N[p],g,e,K),r){var I=lr(e,N[p]);Vq(P,N[p],e,K,g.x+g.width/2,g.y+g.height/2,I.width,r)}g.y+=m}},vk=function(P,t,x,F,p){P.font=F?F:rr,P.fillStyle=p?p:tj,P.textAlign=Nc,P.textBaseline=gi;var E,N;x?x.width===_?(E=x.x,N=x.y):(E=x.x+x.width/2,N=x.y+x.height/2):(E=0,N=0),P.fillText(t,u(E),u(N))},Kg=function(B){B.getView&&(B=B.getView());var R=B.offsetWidth||B.scrollWidth;return!R&&B.style.width&&(R=pm(B.style.width)),R},Ro=function(u){u.getView&&(u=u.getView());var $=u.offsetHeight||u.scrollHeight;return!$&&u.style.height&&($=pm(u.style.height)),$},Tp=function(s,K,b){var C=K[0].toUpperCase()+K.substring(1,K.length);s["webkit"+C]=b,s["moz"+C]=b,s["ms"+C]=b,s["o"+C]=b,s[K]=b},en=function(){var m=function(c){zq(c),c.stopPropagation()},g=function(o){zq(o)},d=[mh,Qh,Rl];return function(F,v){var n=jc(),G=n.style;return G.backgroundColor=C.disabledBackground,F&&(G.backgroundImage="url("+F+")",G.backgroundPosition="50% 50%",G.backgroundRepeat="no-repeat no-repeat"),v===!1?d.forEach(function(E){W(n,E,g)}):d.forEach(function(S){W(n,S,m)}),n}}(),ob=function(D){var a=D.getContext("2d");return a.save(),a.lineCap=Bh,a.lineJoin=vn,a},Wi=function(i,H,q,A){Hk(i,H*rh,q*rh),A*=rh,1!==A&&i.scale(A,A)},Hk=function(b,H,F){b.translate(H,F)},wm=function(m,F){F&&m.rotate(F)},Xc=function(P,N,b){N===_&&(N=1),b===_&&(b=1),(1!==N||1!==b)&&P.scale(N,b)},hc=!1,o=Ce[Uf[1]+Kn[0]],hp=function(b){var f=L.activeElement;if(L.activeElement!==b){f&&f.forceOnblur&&f.forceOnblur();for(var i=[],E=b.parentNode;E;)i.push([E,E.scrollLeft,E.scrollTop]),E=E.parentNode;if(!hc){var D=[],r=[];try{for(var g=B.parent,p=B;g!==p;)D.push([g,g.scrollX,g.scrollY]),p=g,g=B.parent;var H=B.frameElement;if(H)for(var G=H.parentNode;G;)r.push([G,G.scrollLeft,G.scrollTop]),G=G.parentNode}catch(u){hc=!0}}if(Ap)b.focus();else{var w=Yn(),e=w.target;b.focus(),e.scrollLeft=w.left,e.scrollTop=w.top}i.forEach(function(Q){Q[0].scrollLeft=Q[1],Q[0].scrollTop=Q[2]}),hc||(D.forEach(function(W){W[0].scrollTo(W[1],W[2])}),r.forEach(function(H){H[0].scrollLeft=H[1],H[0].scrollTop=H[2]}))}},nb=function(A){return A&&A.getView?A.getView():A},xg=function(H,m,N,U,k){if(2===arguments.length&&(N=m.y,U=m.width,k=m.height,m=m.x),H.isSelfViewEvent)H.setX(m),H.setY(N),H.setWidth(U),H.setHeight(k);else{var u=nb(H),t=u.style;if((L.fullscreenElement||L.mozFullScreenElement||L.webkitFullscreenElement||L.msFullscreenElement)!==u)m!==_&&(t.left=m+jf),N!==_&&(t.top=N+jf),U!==_&&(t.width=U+jf),k!==_&&(t.height=k+jf);else{var y=C.getWindowInfo();t.left=(m=y.left)+jf,t.top=(N=y.top)+jf,t.width=(U=y.width)+jf,t.height=(k=y.height)+jf}H.endEditing&&!Ap&&H.endEditing(),H.redraw&&H.redraw(),H.invalidate&&H.invalidate(),H.onLayouted&&H.onLayouted(m,N,U,k),H.fireViewEvent&&H.fireViewEvent("layout")}},nr=function(f){if(!f.touches)return f;var K=f.touches[0];return K?K:f.changedTouches[0]},Vc=function(C){return rq(C)?nr(C).target:C.target},rq=function(X){return X&&"object"==typeof X&&"touches"in X},$j=function(Q){C.popup&&C.popup.close(),C.popup=Q},xf=Q,Cg=function(q){xf.handleWindowTouchMove(q)},ic=function(m){xf.handleWindowTouchEnd(m),R(B,He,Cg),R(B,Rr,ic),R(B,"blur",ic),xf=Q},vq=function(g){xf.handleWindowMouseMove(g)},pf=function(M){xf.handleWindowMouseUp(M),R(B,rl,vq),R(B,Tk,pf),R(B,"blur",pf),xf=Q},tc=function(U){return 1===xm(U)},ch=function(x,V){return V?V.keyCode===x:Fr[x]},ue=function(h){return Kp(h)&&ch(65,h)},Qi=function(R){return ch(46,R)||ch(8,R)},Kr=function(z){return function(L){return L?L.keyCode===z:Fr[z]}},Or=573,Oo=[65,83,68,87,37,38,39,40,32,13,27],Xk=Kr(Oo[0]),En=Kr(Oo[1]),tm=Kr(Oo[2]),bm=Kr(Oo[3]),re=Kr(Oo[4]),zc=Kr(Oo[5]),ze=Kr(Oo[6]),uh=Kr(Oo[7]),Uq=Kr(Oo[8]),Ud=Kr(Oo[9]),ol=Kr(Oo[10]),Ar={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Ge=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,593],Qk=Q,hs=Q,gl=function(H,s){Qk||(Qk=Yp()),$f(Qk,H,s,1);var E=ob(Qk);return E.clearRect(0,0,H,s),E},ac=function(H,O,x){if(O&&H){if("override"===x)return O;if("override_rgb"===x){var L=bc(O);return H=uq(H),"rgba("+u(255*L[0])+","+u(255*L[1])+","+u(255*L[2])+","+H[3]/255+")"}if("override_a"===x){var L=bc(O);return H=uq(H),"rgba("+H[0]+","+H[1]+","+H[2]+","+L[3]+")"}if("multiply_destinationAtop"===x){var e=be(bc(H)),f=e[3],w=be(bc(O)),J=w[3],j=be(e),N=j[3],E=e.map(function(l,n){return l*w[n]}),Q=1-f,p=1-J,A=p*f+J;return e=e.map(function(P,G){return(J*Q*w[G]+J*f*E[G]+p*f*P)/A}),f=A,Q=1-f,e=e.map(function(D,X){return(N*j[X]*Q+f*D*N)/N}),f=N,"rgba("+u(255*e[0])+","+u(255*e[1])+","+u(255*e[2])+","+f+")"}var L=bc(O);return H=uq(H),"rgba("+u(H[0]*L[0])+","+u(H[1]*L[1])+","+u(H[2]*L[2])+","+H[3]/255*L[3]+")"}return H},uq=function(){var r,Y={};for(var z in B){var L=fe.length;if(z.length==L&&z[0]===fe[2]&&z[1]===Vl[1]&&z[4]===fe[3]&&z[5]===fe[4]&&z.substr(L-2)===Vl[1]+Vl[2]){var I=B[z];for(var U in I)U.length===L&&U.substr(0,3)===Xi[3]+vi[3]+zd[0]&&U.substr(L-2)===fe[0]+Hd[3]&&(Vd=I[U])}}return function(V){var Q,c=Y[V];return c||(r||(r=Yp(),$f(r,1,1,1)),Q=r.getContext("2d"),Q.clearRect(0,0,1,1),uj(Q,0,0,1,1,V),c=Q.getImageData(0,0,1,1).data,c=Y[V]=[c[0],c[1],c[2],c[3]]),c}}(),bc=function(q){if(!am(q))return q;var R=uq(q);return R.CA||(R.CA=[R[0]/255,R[1]/255,R[2]/255,R[3]/255]),R.CA},Wp=function(g,o,T,b,R){var M=Yp();M.width=T,M.height=b;var S=M.getContext("2d");S.drawImage(g,0,0,T,b);try{for(var a=S.getImageData(0,0,T,b),x=a.data,Y=0,K=x.length;K>Y;Y+=4){var $=x[Y+0],e=x[Y+1],n=x[Y+2],p=x[Y+3];"override_a"===R?x[Y+3]=255*o[3]:"override_rgb"===R?(x[Y+0]=255*o[0],x[Y+1]=255*o[1],x[Y+2]=255*o[2]):"override"===R?(x[Y+0]=255*o[0],x[Y+1]=255*o[1],x[Y+2]=255*o[2],x[Y+3]=255*o[3]):(x[Y+0]=o[0]*$,x[Y+1]=o[1]*e,x[Y+2]=o[2]*n,x[Y+3]=o[3]*p)}S.putImageData(a,0,0)}catch(t){return g}return M},Yq=function(o,x,J){return x&&(x="miter"===J?8*x+20:x+1,o&&ae(o,x)),x},Aj=function(p,c){if(c){var A=new td(c),G=p.width/2,F=p.height/2,b=Tl([A.tf(-G,-F),A.tf(G,-F),A.tf(G,F),A.tf(-G,F)]);return b.x+=p.x+G,b.y+=p.y+F,b}return p},Lr=function(K,X,o,e,h,c,q,w){e*=Math.PI/180;var Q={x:Math.cos(e)*(K.x-q.x)/2+Math.sin(e)*(K.y-q.y)/2,y:-Math.sin(e)*(K.x-q.x)/2+Math.cos(e)*(K.y-q.y)/2},T=Math.pow(Q.x,2)/Math.pow(X,2)+Math.pow(Q.y,2)/Math.pow(o,2);T>1&&(X*=Math.sqrt(T),o*=Math.sqrt(T));var Y=(h==c?-1:1)*Math.sqrt((Math.pow(X,2)*Math.pow(o,2)-Math.pow(X,2)*Math.pow(Q.y,2)-Math.pow(o,2)*Math.pow(Q.x,2))/(Math.pow(X,2)*Math.pow(Q.y,2)+Math.pow(o,2)*Math.pow(Q.x,2)));isNaN(Y)&&(Y=0);var I={x:Y*X*Q.y/o,y:Y*-o*Q.x/X},C={x:(K.x+q.x)/2+Math.cos(e)*I.x-Math.sin(e)*I.y,y:(K.y+q.y)/2+Math.sin(e)*I.x+Math.cos(e)*I.y},n=function(C){return Math.sqrt(Math.pow(C[0],2)+Math.pow(C[1],2))},u=function(g,M){return(g[0]*M[0]+g[1]*M[1])/(n(g)*n(M))},k=function(v,_){return(v[0]*_[1]<v[1]*_[0]?-1:1)*Math.acos(u(v,_))},V=k([1,0],[(Q.x-I.x)/X,(Q.y-I.y)/o]),R=[(Q.x-I.x)/X,(Q.y-I.y)/o],J=[(-Q.x-I.x)/X,(-Q.y-I.y)/o],L=k(R,J);u(R,J)<=-1&&(L=Math.PI),u(R,J)>=1&&(L=0);var u=X>o?X:o,d=X>o?1:X/o,E=X>o?o/X:1;if(null==w){var y={x:0,y:0,width:0,height:0};ae(y,u),y.x*=d,y.width*=d,y.y*=E,y.height*=E;var i=new td(e);return y=Tl([i.tf(y.x,y.y),i.tf(y.x+y.width,y.y),i.tf(y.x+y.width,y.y+y.height),i.tf(y.x,y.y+y.height)]),y.x+=C.x,y.y+=C.y,[{x:y.x,y:y.y},{x:y.x+y.width,y:y.y},{x:y.x+y.width,y:y.y+y.height},{x:y.x,y:y.y+y.height}]}w.translate(C.x,C.y),w.rotate(e),w.scale(d,E),w.arc(0,0,u,V,V+L,1-c),w.scale(1/d,1/E),w.rotate(-e),w.translate(-C.x,-C.y)},Hn=function(E,U){E&&E.beginPath();for(var T,p,o,D=[],x=function(r){for(var I,u=/(\-{0,1}[\d\.]+)/gi,o=[];I=u.exec(r);)o.push(parseFloat(I[0]));return o},j=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,F={x:0,y:0};T=j.exec(U);){var e=T[0],r=e.substr(0,1);if("M"===r||"m"===r){for(var Y=x(e),V=0;V<Y.length;V+=2){var l=Y[V],M=Y[V+1];"m"===r&&(l+=F.x,M+=F.y),E&&E.moveTo(l,M),D.push({x:l,y:M}),F.x=l,F.y=M}p=o=null}else if("H"===r||"h"===r){for(var Y=x(e),V=0;V<Y.length;V+=1){var l=Y[V];"h"===r&&(l+=F.x),E&&E.lineTo(l,F.y),D.push({x:l,y:F.y}),F.x=l}p=o=null}else if("C"===r||"c"===r){for(var Y=x(e),V=0;V<Y.length;V+=6){var d=Y[V],H=Y[V+1],N=Y[V+2],k=Y[V+3],l=Y[V+4],M=Y[V+5];"c"===r&&(d+=F.x,H+=F.y,N+=F.x,k+=F.y,l+=F.x,M+=F.y),E&&E.bezierCurveTo(d,H,N,k,l,M),D.push({x:d,y:H}),D.push({x:N,y:k}),D.push({x:l,y:M}),F.x=l,F.y=M}p=[d,H,N,k,l,M],o=null}else if("S"===r||"s"===r){for(var Y=x(e),V=0;V<Y.length;V+=4){var d,H;p?(d=2*p[4]-p[2],H=2*p[5]-p[3]):(d=F.x,H=F.y);var N=Y[V],k=Y[V+1],l=Y[V+2],M=Y[V+3];"s"===r&&(N+=F.x,k+=F.y,l+=F.x,M+=F.y),E&&E.bezierCurveTo(d,H,N,k,l,M),D.push({x:d,y:H}),D.push({x:N,y:k}),D.push({x:l,y:M}),F.x=l,F.y=M}p=[d,H,N,k,l,M],o=null}else if("Q"===r||"q"===r){for(var Y=x(e),V=0;V<Y.length;V+=4){var d=Y[V],H=Y[V+1],l=Y[V+2],M=Y[V+3];"q"===r&&(d+=F.x,H+=F.y,l+=F.x,M+=F.y),E&&E.quadraticCurveTo(d,H,l,M),D.push({x:d,y:H}),D.push({x:l,y:M}),F.x=l,F.y=M}p=null,o=[d,H,l,M]}else if("T"===r||"t"===r){for(var Y=x(e),V=0;V<Y.length;V+=2){var d,H;o?(d=2*o[2]-o[0],H=2*o[3]-o[1]):(d=F.x,H=F.y);var l=Y[V],M=Y[V+1];"t"===r&&(l+=F.x,M+=F.y),E&&E.quadraticCurveTo(d,H,l,M),D.push({x:d,y:H}),D.push({x:l,y:M}),F.x=l,F.y=M}p=null,o=[d,H,l,M]}else if("V"===r||"v"===r){for(var Y=x(e),V=0;V<Y.length;V+=1){var M=Y[V];"v"===r&&(M+=F.y),E&&E.lineTo(F.x,M),D.push({x:F.x,y:M}),F.y=M}p=o=null}else if("L"===r||"l"===r){for(var Y=x(e),V=0;V<Y.length;V+=2){var l=Y[V],M=Y[V+1];"l"===r&&(l+=F.x,M+=F.y),E&&E.lineTo(l,M),D.push({x:l,y:M}),F.x=l,F.y=M}p=o=null}else if("A"===r||"a"===r){for(var Y=x(e),V=0;V<Y.length;V+=7){var L=Y[V],w=Y[V+1],S=Y[V+2],P=Y[V+3],Q=Y[V+4],l=Y[V+5],M=Y[V+6];"a"===r&&(l+=F.x,M+=F.y);var z=Lr(F,L,w,S,P,Q,{x:l,y:M},E);z&&(D=D.concat(z)),F.x=l,F.y=M}p=o=null}var J=e.substr(e.length-1);("z"===J||"Z"===J)&&E&&E.closePath()}return D},Bo=function(u,k,D,X,S){var h,p=k[0];if(u.save(),oi(k))if(p&&1===p.length){var B,E="L"===k[0],P=k.length;E?(u.transform(k[5],k[6],k[7],k[8],k[9],k[10]),h=u.createLinearGradient(k[1],k[2],k[3],k[4]),B=11):(u.transform(k[7],k[8],k[9],k[10],k[11],k[12]),h=u.createRadialGradient(k[1],k[2],k[3],k[4],k[5],k[6]),B=13);for(var x=u.compGray;P>B;){var m=k[B+1];m=D(m),h.addColorStop(k[B],x?C.toGrayColor(m):m),B+=2}}else{var B,E="linear"===p,H=S.x,Q=S.y,c=S.width,n=S.height,P=k.length,x=u.compGray;if(E)h=u.createLinearGradient(H+c*k[1],Q+n*k[2],H+c*k[3],Q+n*k[4]),B=5;else{var o=Math.min(c,n),$=k[1]*c+H,Y=k[2]*n+Q,F=k[3]*o;h=u.createRadialGradient($,Y,0,$,Y,F),B=4}for(;P>B;){var m=k[B+1];m=D(m),h.addColorStop(k[B],x?C.toGrayColor(m):m),B+=2}}else h=k;return X?u.strokeStyle=h:u.fillStyle=h,h},Kc=function(){function K(y,$){var Y=y.length,J=y[0];if(am(y)||J&&1!==J.length)return y;for(var r=new Array(Y),R=0;Y>R;R++)r[R]=y[R];var l,k,_,G,I,s,p,E,U,V,d,m,T,M="L"===r[0];return l=M?5:7,k=r[l],_=r[l+1],G=r[l+2],I=r[l+3],s=r[l+4],p=r[l+5],E=$[0],U=$[1],V=$[2],d=$[3],m=$[4],T=$[5],r[l]=E*k+V*_,r[l+1]=U*k+d*_,r[l+2]=E*G+V*I,r[l+3]=U*G+d*I,r[l+4]=E*s+V*p+m,r[l+5]=U*s+d*p+T,r}return function(A,q){var Y;(Y=A.s("shape.gradient.pack"))&&A.s("shape.gradient.pack",K(Y,q)),(Y=A.s("shape.border.gradient.pack"))&&A.s("shape.border.gradient.pack",K(Y,q))}}(),Yc=function(I,v,Z,Q){var Y=!1;if(I.beginPath?I.beginPath():Y=!0,Wh(v)&&(v=v._as),Wh(Z)&&(Z=Z._as),Z&&Z.length){for(var V,n,O,s,q=0,P=0,K=Z.length;K>P;P++)V=Z[P],1===V?(n=v[q++],I.moveTo(n.x,Y?-n.y:n.y)):2===V?(n=v[q++],I.lineTo(n.x,Y?-n.y:n.y)):3===V?(n=v[q++],O=v[q++],I.quadraticCurveTo(n.x,Y?-n.y:n.y,O.x,Y?-O.y:O.y)):4===V?(n=v[q++],O=v[q++],s=v[q++],I.bezierCurveTo(n.x,Y?-n.y:n.y,O.x,Y?-O.y:O.y,s.x,Y?-s.y:s.y)):5===V&&I.closePath();Q&&5!==V&&I.closePath()}else{var i,l,m,f=v.length;if(f>0){for(i=v[0],I.moveTo(i.x,Y?-i.y:i.y),l=1;f>l;l++)m=v[l],I.lineTo(m.x,Y?-m.y:m.y);Q&&I.closePath()}}},Mr=function(B,i,D,w){if(Wh(B)&&(B=B._as),Wh(i)&&(i=i._as),i&&i.length){D=D||zh;for(var z,A,O,Y,e,y,d,M,t=[],$=Q,k=0,j=0,I=i.length;I>j;j++)if(z=i[j],1===z)t.push($=[]),$.push(B[k++]);else if(2===z)$.push(B[k++]);else if(3===z){for(A=$[$.length-1],O=B[k++],Y=B[k++],y=1;D>y;y++)d=Vi(y/D,A.x,O.x,Y.x),M=Vi(y/D,A.y,O.y,Y.y),$.push({x:d,y:M,b:!0});$.push(Y)}else if(4===z){for(A=$[$.length-1],O=B[k++],Y=B[k++],e=B[k++],y=1;D>y;y++)d=cg(y/D,A.x,O.x,Y.x,e.x),M=cg(y/D,A.y,O.y,Y.y,e.y),$.push({x:d,y:M,b:!0});$.push(e)}else 5===z&&$.push($[0]);return w&&5!==z&&$&&$.length>2&&$.push($[0]),t}return w&&B.length>2&&(B=B.slice(),B.push(B[0])),B?[B]:[]},oq=function(a,Y,B,y,I,A){var U,G,P,k=uq(Y),H=y,d=k[0],l=k[1],o=k[2];if(B){var $=uq(B);U=$[0]-d,G=$[1]-l,P=$[2]-o}else U=255-d,G=255-l,P=255-o;for(A||(A=y>10?1:.5,A=1>I?F(A/I,2):A),a.save(),a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0,a.shadowColor=0;(y-=A)>0;){var e=1-y/H,E=d+U*e,T=l+G*e,u=o+P*e;E=F(J(E),255),T=F(J(T),255),u=F(J(u),255),a.strokeStyle="rgb("+E+","+T+","+u+")",a.lineWidth=y,a.stroke()}a.restore()},Pj=function(){if(Yo&&k){var H=k+""||Al;yb=H.indexOf(qr.substr(0,2))>0&&H.indexOf(Ui+Ui.substr(1,1))>1?!0:!1}var Q={};return function(X,p){var R=X+"-"+p,q=Q[R];if(q)return q;var u,U,v,E=uq(X);return 0>p?(p=(100+p)/100,u=J(E[0]*p),U=J(E[1]*p),v=J(E[2]*p)):(p/=100,u=E[0],U=E[1],v=E[2],u+=(255-u)*p,U+=(255-U)*p,v+=(255-v)*p,u=F(J(u),255),U=F(J(U),255),v=F(J(v),255)),Q[R]="rgb("+u+","+U+","+v+")"}}(),uj=function(N,s,u,H,w,h){h&&(N.fillStyle=h),N.beginPath(),N.rect(s,u,H,w),N.fill()},Un=function(y,G,J,H,g,e,X){y.beginPath(),cn[G](y,J.x,J.y,J.width,J.height,H,g,e,X)
},qc=function(U,T,Q,b,y){var k=cn[Q];U.fillStyle=k?k(U,T,b?b:xo,y.x,y.y,y.width,y.height):T},Pp=function(l,B,D,r,w,s){l.fillStyle=Nk(l,B,D,r,w,s)},kg=function(h,m,Q,s,i,U){h.strokeStyle=Nk(h,m,Q,s,i,U)},Nk=function(r,U,_,Y,d,B){var G;try{if(!U.tagName&&U.comps){U._cacheImage_||(U._cacheImage_={});var X;X="override"===Y?"colors_override":"override_rgb"===Y?"colors_override_rgb":"override_a"===Y?"colors_override_a":"colors",U._cacheImage_[X]||(U._cacheImage_[X]={__count__:0});var s=U._cacheImage_[X][_];s||(U._cacheImage_[X].__count__>C.imageCacheThreshold&&(U._cacheImage_[X]={__count__:0}),s=b.Default.toCanvas(U,ld(U),Sr(U),null,d,B,_,null,Y),U._cacheImage_[X][_]=s,U._cacheImage_[X].__count__++),U=s}G=r.createPattern(U,"repeat")}catch(I){G="black"}return G},gj=function(Q){var u,j,F=[],S=0,l=Q.length;for(u=0;65>u;u++)F[u]=u;for(u=0;65>u;u++)S=(S+F[u]+Q.charCodeAt(u%l))%65,j=F[u],F[u]=F[S],F[S]=j;for(u=0;65>u;u++)F[u]=wr[F[u]];return F.join("")},bq=function(Q){for(var q=8+$m.randomInt(8),M=wr[8*$m.randomInt(8)+(q-8)],F="",S=0;q>S;S++)F+=wr[$m.randomInt(64)];var X=gj(F+v+mc+Rn);return M+F+Gi.encode(Q,X)},Kj=function(Y){var F=Y[0],x=wr.indexOf(F);if(0>x)return"";x=8+(7&x);var h=Y.slice(1,1+x),N=gj(h+v+mc+Rn);return Gi.decode(Y,N,1+x)},Dk=function(E,x,J,R,y,m,w){E.save(),E.translate(x,J),E.scale(1,w/m),E.arc(0,0,m,R,y),E.restore()},Xj=function(b,U,G,f,V,i,O,N){var Q,S,W,k,p,M,Y,I,y,d,c;if(D(V)>2*e&&(V=2*e),p=J(D(V)/(e/4)),Q=V/p,S=-Q,W=-f,p>0){M=U+j(f)*i,Y=G+h(-f)*O,N?b.lineTo(M,Y):b.moveTo(M,Y);for(var u=0;p>u;u++)W+=S,k=W-S/2,I=U+j(W)*i,y=G+h(W)*O,d=U+j(k)*(i/j(S/2)),c=G+h(k)*(O/j(S/2)),b.quadraticCurveTo(d,c,I,y)}},nn=function(g,q,k,K,V,O,W,S,F){6===arguments.length&&(W=O,S=O,F=O);var A=q+K,P=k+V,l=V>K?2*K:2*V;O=l>O?O:l,W=l>W?W:l,S=l>S?S:l,F=l>F?F:l;var h=.29*F,M=.58*F;g.moveTo(A,P-F),g.quadraticCurveTo(A,P-M,A-h,P-h),g.quadraticCurveTo(A-M,P,A-F,P),h=.29*S,M=.58*S,g.lineTo(q+S,P),g.quadraticCurveTo(q+M,P,q+h,P-h),g.quadraticCurveTo(q,P-M,q,P-S),h=.29*O,M=.58*O,g.lineTo(q,k+O),g.quadraticCurveTo(q,k+M,q+h,k+h),g.quadraticCurveTo(q+M,k,q+O,k),h=.29*W,M=.58*W,g.lineTo(A-W,k),g.quadraticCurveTo(A-M,k,A-h,k+h),g.quadraticCurveTo(A,k+M,A,k+W),g.lineTo(A,P-F)},Xn=function(K,P,L,e,d,D,G){P&&(L=u(L),e=u(e),G||(G=1),K.fillStyle=P,K.beginPath(),K.rect(L,e,G,D),K.rect(L,e,d,G),D-G>0&&K.rect(L,e+D-G,d,G),d-G>0&&K.rect(L+d-G,e,G,D),K.fill())},Hm=function(A,p,E,K){var I=K.x,$=K.y,o=K.width,s=K.height;if(!(!p||!E||0>=o||0>=s)){var d,j=Oi(p),m=mb(p),w=E>0;1===E||-1===E?(A.fillStyle=w?j:m,A.beginPath(),A.rect(I,$,1,s),A.rect(I,$,o,1),A.fill(),A.fillStyle=w?m:j,A.beginPath(),A.rect(I,$+s-1,o,1),A.rect(I+o-1,$,1,s),A.fill()):(E=F(D(E),F(o/2,s/2)),d=A.createLinearGradient(I,$,I+E,$),d.addColorStop(0,w?j:m),d.addColorStop(1,p),A.fillStyle=d,A.beginPath(),A.moveTo(I,$),A.lineTo(I+E,$+E),A.lineTo(I+E,$+s-E),A.lineTo(I,$+s),A.lineTo(I,$),A.fill(),d=A.createLinearGradient(I,$,I,$+E),d.addColorStop(0,w?j:m),d.addColorStop(1,p),A.fillStyle=d,A.beginPath(),A.moveTo(I,$),A.lineTo(I+E,$+E),A.lineTo(I+o-E,$+E),A.lineTo(I+o,$),A.lineTo(I,$),A.fill(),d=A.createLinearGradient(I,$+s,I,$+s-E),d.addColorStop(0,w?m:j),d.addColorStop(1,p),A.fillStyle=d,A.beginPath(),A.moveTo(I,$+s),A.lineTo(I+E,$+s-E),A.lineTo(I+o-E,$+s-E),A.lineTo(I+o,$+s),A.lineTo(I,$+s),A.fill(),d=A.createLinearGradient(I+o,$,I+o-E,$),d.addColorStop(0,w?m:j),d.addColorStop(1,p),A.fillStyle=d,A.beginPath(),A.moveTo(I+o,$),A.lineTo(I+o-E,$+E),A.lineTo(I+o-E,$+s-E),A.lineTo(I+o,$+s),A.lineTo(I+o,$),A.fill())}},bb=function(O,c,F,e,p,v,B){var t=O.createLinearGradient(e,p,v,B);return t.addColorStop(0,F),t.addColorStop(1,c),t},oj=function(P,N,l,X,R,k,d){var m=P.createLinearGradient(X,R,k,d);return m.addColorStop(0,N),m.addColorStop(.5,l),m.addColorStop(1,N),m},Xb=function(O,d,n,l,G,p,X){var F=O.createLinearGradient(l,G,p,X);return F.addColorStop(0,d),F.addColorStop(1/3,n),F.addColorStop(2/3,d),F.addColorStop(1,n),F},zf=function(J,y,p,P,m,B,W,n,t){var i=J.createRadialGradient(P+B*n,m+W*t,F(B,W)/24,P+B/2,m+W/2,f(B,W)/2);return i.addColorStop(0,p),i.addColorStop(1,y),i},vf=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],cn={polygon:function(i,N,_,D,E,x){(x==Q||3>x)&&(x=6);for(var u,p,g=F(D,E)/2,A=N+D/2,d=_+E/2,l=0,c=2*e/x,T=0;x>T;T++)u=A+j(l)*g,p=d+h(l)*g,0===T?i.moveTo(u,p):i.lineTo(u,p),l+=c;i.closePath()},arc:function(s,o,q,B,k,c,i,b,G){c==Q&&(c=e),i==Q&&(i=Z),b==Q&&(b=!0);var L=o+B/2,J=q+k/2;b&&s.moveTo(L,J),G?Dk(s,L,J,c,i,B/2,k/2):s.arc(L,J,F(B,k)/2,c,i),b&&s.closePath()},rect:function(Z,e,p,n,x){Z.rect(e,p,n,x)},circle:function(x,z,c,X,D){x.arc(z+X/2,c+D/2,F(X,D)/2,0,Z,!0)},oval:function(f,h,k,A,B){Dk(f,h+A/2,k+B/2,0,Z,A/2,B/2)},roundRect:function(D,N,H,z,A,i){i==Q&&(i=F(F(z,A)/4,8)),nn(D,N,H,z,A,i)},star:function(Y,C,M,j,B){var z=2*j,_=2*B,m=C+j/2,s=M+B/2;Y.moveTo(m-z/4,s-_/12),Y.lineTo(C+.306*j,M+.579*B),Y.lineTo(m-z/6,s+_/4),Y.lineTo(C+j/2,M+.733*B),Y.lineTo(m+z/6,s+_/4),Y.lineTo(C+.693*j,M+.579*B),Y.lineTo(m+z/4,s-_/12),Y.lineTo(C+.611*j,M+.332*B),Y.lineTo(m+0,s-_/4),Y.lineTo(C+.388*j,M+.332*B),Y.closePath()},pentagram:function(k,m,O,v,s){var g=.5*s,A=m+.5*v,z=O+g,f=.5257311121191336*v;f>g&&(f=g);var j=vf,p=0;for(k.moveTo(A+f*j[p++],z+f*j[p++]);20>p;)k.lineTo(A+f*j[p++],z+f*j[p++]);k.closePath()},triangle:function(K,i,P,o,n){K.moveTo(i+o/2,P),K.lineTo(i+o,P+n),K.lineTo(i,P+n),K.closePath()},hexagon:function(O,w,y,B,j){O.moveTo(w,y+j/2),O.lineTo(w+B/4,y+j),O.lineTo(w+3*B/4,+y+j),O.lineTo(w+B,y+j/2),O.lineTo(w+3*B/4,y),O.lineTo(w+B/4,y),O.closePath()},pentagon:function(b,q,H,N,E){var h=2*N,i=2*E,Y=q+N/2,l=H+E/2;b.moveTo(Y-h/4,l-i/12),b.lineTo(Y-h/6,l+i/4),b.lineTo(Y+h/6,l+i/4),b.lineTo(Y+h/4,l-i/12),b.lineTo(Y+0,l-i/4),b.closePath()},diamond:function(O,Y,Z,$,J){O.moveTo(Y+$/2,Z),O.lineTo(Y,Z+J/2),O.lineTo(Y+$/2,Z+J),O.lineTo(Y+$,Z+J/2),O.closePath()},rightTriangle:function(L,D,v,U,$){L.moveTo(D,v),L.lineTo(D+U,v+$),L.lineTo(D,v+$),L.closePath()},parallelogram:function(T,W,S,i,$){var h=i/4;T.moveTo(W+h,S),T.lineTo(W+i,S),T.lineTo(W+i-h,S+$),T.lineTo(W,S+$),T.closePath()},trapezoid:function(P,l,N,A,h){var E=A/4;P.moveTo(l+E,N),P.lineTo(l+A-E,N),P.lineTo(l+A,N+h),P.lineTo(l,N+h),P.closePath()},"linear.southwest":function(M,_,L,e,k,D,I){return bb(M,_,L,e,k+I,e+D,k)},"linear.southeast":function(V,x,C,Y,A,u,O){return bb(V,x,C,Y+u,A+O,Y,A)},"linear.northwest":function(i,V,K,E,p,g,v){return bb(i,V,K,E,p,E+g,p+v)},"linear.northeast":function(f,$,D,M,m,y,w){return bb(f,$,D,M+y,m,M,m+w)},"linear.north":function(M,W,m,a,s,Z,j){return bb(M,W,m,a,s,a,s+j)},"linear.south":function(K,M,c,H,S,t,y){return bb(K,M,c,H,S+y,H,S)},"linear.west":function(Y,x,E,W,c,L){return bb(Y,x,E,W,c,W+L,c)},"linear.east":function(_,k,G,u,w,m){return bb(_,k,G,u+m,w,u,w)},"radial.center":function(C,k,U,$,m,Y,J){return zf(C,k,U,$,m,Y,J,.5,.5)},"radial.southwest":function(x,X,O,C,N,E,V){return zf(x,X,O,C,N,E,V,.25,.75)},"radial.southeast":function(J,Z,m,C,s,$,I){return zf(J,Z,m,C,s,$,I,.75,.75)},"radial.northwest":function(U,$,_,t,s,v,k){return zf(U,$,_,t,s,v,k,.25,.25)},"radial.northeast":function(m,u,s,W,y,G,D){return zf(m,u,s,W,y,G,D,.75,.25)},"radial.north":function(V,l,C,U,I,x,Y){return zf(V,l,C,U,I,x,Y,.5,.25)},"radial.south":function(J,S,k,B,w,p,Y){return zf(J,S,k,B,w,p,Y,.5,.75)},"radial.west":function(x,N,w,D,A,I,M){return zf(x,N,w,D,A,I,M,.25,.5)},"radial.east":function(z,N,G,W,S,A,e){return zf(z,N,G,W,S,A,e,.75,.5)},"spread.horizontal":function(S,Q,o,f,N,l){return oj(S,Q,o,f,N,f+l,N)},"spread.vertical":function(I,p,j,o,s,i,K){return oj(I,p,j,o,s,o,s+K)},"spread.diagonal":function(v,P,$,I,y,e,V){return oj(v,P,$,I+e,y,I,y+V)},"spread.antidiagonal":function(b,S,K,c,P,j,Z){return oj(b,S,K,c,P,c+j,P+Z)},"spread.north":function(Y,o,H,x,q,p,n){return Xb(Y,o,H,x,q-n/4,x,q+n+n/4)},"spread.south":function(F,n,c,R,f,U,w){return Xb(F,c,n,R,f-w/4,R,f+w+w/4)},"spread.west":function(o,A,I,m,Z,x){return Xb(o,A,I,m-x/4,Z,m+x+x/4,Z)},"spread.east":function(A,G,w,V,B,T){return Xb(A,w,G,V-T/4,B,V+T+T/4,B)}},Nr=function(t,c,s){return new td(t).tf(c,s)},Ti=function(h){var c=h.touches[0],i=h.touches[1],g=c.clientX,e=c.clientY,v=i.clientX,Y=i.clientY;return z((g-v)*(g-v)+(e-Y)*(e-Y))},Bc=function(b){var k=b.touches[0],h=b.touches[1],H=k.clientX,Q=k.clientY,o=h.clientX,T=h.clientY;return{x:(H+o)/2,y:(Q+T)/2}},Dq=(function(){for(var C=0,H=ff.split(""),Z=0;Z<H.length;Z++)C=10*pm(H[Z])+C;return $k(B[Or.toString(8*Z)+lf.substr(Z)+3],B[Or.toString(8*Z)+lf.substr(Z)+4]),C}(),function(g,S,l){for(var n=0;n<l.size();n++){var m=l.get(n);g.co(m)&&S.add(m)}for(n=0;n<l.size();n++)m=l.get(n),Dq(g,S,m._children)}),ap=function(H,p,T){for(var i=0;i<T.size();i++){var x=T.get(T.size()-1-i);H.co(x)&&p.add(x)}for(i=0;i<T.size();i++)x=T.get(i),ap(H,p,x._children)},Lg=function(t,I,o){for(var D=!1,N=0;N<o.size();N++){var X=o.get(N);t.co(X)?D&&I.add(X):D=1}for(N=0;N<o.size();N++)X=o.get(N),Lg(t,I,X._children)},Ue=function(s,l,Q){for(var N=!1,H=0;H<Q.size();H++){var g=Q.get(Q.size()-1-H);s.co(g)?N&&l.add(g):N=!0}for(H=0;H<Q.size();H++)g=Q.get(H),Ue(s,l,g._children)},Jp=C.moveDatas=function(J,V,P,i){var t=i==Q;if(0!==V||0!==P||!t&&0!==i){var z=!0,x=[];if(J.forEach(function(H){z&&(H._69O||Pm(H)||Zj(H))&&(z=!1)}),z)x=J;else{var Y={},W={};J.forEach(function(u){Y[u._id]=!0});var u={},T=function(B){var o=B._id;return Y[o]?(x.push(B),u[o]=!0):u[o]=!1},X=function(e){var r=e._id;if(W[r])return T(e);var l=u[r];if(l!==_)return l;var C=e._parent;if(C&&(Zj(C)||Pm(C))&&X(C))return u[r]=!0;var y=e._host;return y&&(W[r]=r,l=X(y),W[r]=_,l)?u[r]=!0:T(e)};J.forEach(function(E){X(E)})}x.forEach(function(w){if(Je(w))t?w.translate(V,P):w.translate3d(V,P,i);else{var N=w.s(Dj);if(!N||N.isEmpty())return;var l=new Qd;N.each(function(y){y=be(y),t?(y.x+=V,y.y+=P):(y.x+=V,y.y+=i,y.e==Q?y.e=P:y.e+=P),l.add(y)}),w.s(Dj,l)}})}},vs=function(){function o(Y,P){return P===Y.substring(0,P.length)?!0:!1}function L(y){return parseFloat(y)||0}function P(c,w){if(w==_&&(w=new El),o(c,"matrix3d")){var m=c.substring(9,c.length-1).split(",");m=m.map(L),w.fromArray(m)}else if(o(c,"matrix")){var m=c.substring(7,c.length-1).split(",");m=m.map(L),w.el[0]=m[0],w.el[1]=m[1],w.el[2]=0,w.el[3]=0,w.el[4]=m[2],w.el[5]=m[3],w.el[6]=0,w.el[7]=0,w.el[8]=0,w.el[9]=0,w.el[10]=1,w.el[11]=0,w.el[12]=m[4],w.el[13]=m[5],w.el[14]=0,w.el[15]=1}return w}function H(Z,k){k==_&&(k=new id);var H=Z.split(/\s+/);return H=H.map(L),k.set(H[0]||0,H[1]||0,H[2]||0),k}var M,u,S,h,D,Q=function(z,o){M||(M=new El,u=new id,S=new El,h=new El,D=new El),o==_&&(o=new El);var p=getComputedStyle(z);p.transform&&"none"!==p.transform&&(P(p.transform,M),H(p.transformOrigin,u),h.setPosition(u),u.negate(),D.setPosition(u),(nm||"preserve-3d"!==p.transformStyle)&&(M.el[8]=0,M.el[9]=0,M.el[10]=1,M.el[11]=0),o.multiplyMatrices(D,o),o.multiplyMatrices(M,o),o.multiplyMatrices(h,o)),!nm&&p.perspective&&"none"!==p.perspective&&(S.el[11]=-1/L(p.perspective),H(p.perspectiveOrigin,u),h.setPosition(u),u.negate(),D.setPosition(u),o.multiplyMatrices(D,o),o.multiplyMatrices(S,o),o.multiplyMatrices(h,o));for(var N=z.offsetParent,e=z.offsetLeft,r=z.offsetTop,F=z.parentElement;F&&F!==N;){var b=getComputedStyle(F);if("none"!==b.transform||"none"!==b.perspective)break;F=F.parentElement}return F==_&&z!==z.ownerDocument.documentElement&&"fixed"!==p.position&&(F=z.ownerDocument.documentElement),N!=_&&N!==F&&(e-=F.offsetLeft,r-=F.offsetTop),u.set(e,r,0),h.setPosition(u),o.multiplyMatrices(h,o),F&&Q(F,o),o};return function(y,P){var M=y.parentElement;if(M){var z=M.updateAppendMatrix;if(z){delete M.updateAppendMatrix;var T=new El;Q(M,T);var L=new El;L.getInverse(T),M._matrixAppend=L,M._maxrixPreAppend=T}return P?M._matrixAppend:M._maxrixPreAppend}}}(),Il=function(C,X){for(;C&&!C.hasOwnProperty(X);)C=x.getPrototypeOf(C);return C&&x.getOwnPropertyDescriptor(C,X)},ep=x.getPrototypeOf?function(I,H,t){var s=Il(H,t);s&&x.defineProperty(I,t,s)}:function(X,m,s){X[s]=m[s]},Sf={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},$l=function(){var Z={1:function(L,O){return{x:L.x-O.width/2,y:L.y-O.height/2}},2:function(C,O){return{x:C.x+O.width/2,y:C.y-O.height/2}},3:function(K,T){return{x:K.x+K.width/2,y:K.y-T.height/2}},4:function(m,E){return{x:m.x+m.width-E.width/2,y:m.y-E.height/2}},5:function(H,O){return{x:H.x+H.width+O.width/2,y:H.y-O.height/2}},6:function(D){return{x:D.x,y:D.y}},7:function(j){return{x:j.x+j.width/2,y:j.y}},8:function(r){return{x:r.x+r.width,y:r.y}},9:function(k,B){return{x:k.x-B.width/2,y:k.y+B.height/2}},10:function(W,A){return{x:W.x+A.width/2,y:W.y+A.height/2}},11:function(H,R){return{x:H.x+H.width/2,y:H.y+R.height/2}},12:function(u,F){return{x:u.x-F.width/2+u.width,y:u.y+F.height/2}},13:function(A,S){return{x:A.x+A.width+S.width/2,y:A.y+S.height/2}},14:function(V,A){return{x:V.x-A.width/2,y:V.y+V.height/2}},15:function(C){return{x:C.x,y:C.y+C.height/2}},16:function(F,H){return{x:F.x+H.width/2,y:F.y+F.height/2}},17:function(X){return{x:X.x+X.width/2,y:X.y+X.height/2}},18:function(Z,F){return{x:Z.x+Z.width-F.width/2,y:Z.y+Z.height/2}},19:function(a){return{x:a.x+a.width,y:a.y+a.height/2}},20:function(F,k){return{x:F.x+F.width+k.width/2,y:F.y+F.height/2}},21:function(G,A){return{x:G.x-A.width/2,y:G.y+G.height-A.height/2}},22:function(J,O){return{x:J.x+O.width/2,y:J.y+J.height-O.height/2}},23:function(P,U){return{x:P.x+P.width/2,y:P.y+P.height-U.height/2}},24:function(x,e){return{x:x.x+x.width-e.width/2,y:x.y+x.height-e.height/2}},25:function(x,Z){return{x:x.x+x.width+Z.width/2,y:x.y+x.height-Z.height/2}},26:function(w){return{x:w.x,y:w.y+w.height}},27:function(L){return{x:L.x+L.width/2,y:L.y+L.height}},28:function(h){return{x:h.x+h.width,y:h.y+h.height}},29:function(I,t){return{x:I.x-t.width/2,y:I.y+I.height+t.height/2}},30:function(y,P){return{x:y.x+P.width/2,y:y.y+y.height+P.height/2}},31:function(D,c){return{x:D.x+D.width/2,y:D.y+D.height+c.height/2}},32:function(o,I){return{x:o.x+o.width-I.width/2,y:o.y+o.height+I.height/2}},33:function($,L){return{x:$.x+$.width+L.width/2,y:$.y+$.height+L.height/2}},34:function(Y,R){return{x:Y.x,y:Y.y-R.height/2}},35:function(P,p){return{x:P.x+P.width,y:P.y-p.height/2}},36:function(G,k){return{x:G.x,y:G.y+G.height+k.height/2}},37:function(p,B){return{x:p.x+p.width,y:p.y+p.height+B.height/2}},38:function(q,w){return{x:q.x+q.width/4,y:q.y-w.height/2}},39:function(l,s){return{x:l.x+3*l.width/4,y:l.y-s.height/2}},40:function(Z){return{x:Z.x+Z.width/4,y:Z.y}},41:function(M){return{x:M.x+3*M.width/4,y:M.y}},42:function(K,t){return{x:K.x+K.width/4,y:K.y+t.height/2}},43:function(Q,H){return{x:Q.x+3*Q.width/4,y:Q.y+H.height/2}},44:function(g,n){return{x:g.x+g.width/2,y:g.y+g.height/2-n.height/2}},45:function(b){return{x:b.x+b.width/4,y:b.y+b.height/2}},46:function(O,U){return{x:O.x+O.width/2-U.width/2,y:O.y+O.height/2}},47:function(Y,R){return{x:Y.x+Y.width/2+R.width/2,y:Y.y+Y.height/2}},48:function(a){return{x:a.x+3*a.width/4,y:a.y+a.height/2}},49:function(O,E){return{x:O.x+O.width/2,y:O.y+O.height/2+E.height/2}},50:function(W,w){return{x:W.x+W.width/4,y:W.y+W.height-w.height/2}},51:function(g,k){return{x:g.x+3*g.width/4,y:g.y+g.height-k.height/2}},52:function(W){return{x:W.x+W.width/4,y:W.y+W.height}},53:function(f){return{x:f.x+3*f.width/4,y:f.y+f.height}},54:function(k,u){return{x:k.x+k.width/4,y:k.y+k.height+u.height/2}},55:function(s,d){return{x:s.x+3*s.width/4,y:s.y+s.height+d.height/2}}};return _k(B)?function(d,L,u){return Z[d](L,u?u:Tm)}:void 0}();nd(g,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Ak=g.reverse,Dd=g.transparent,il=g.rectSelectBackground,xn=g.dash,rm=g.titleBackground,Sb=g.titleIconBackground,_b=g.headerBackground,dj=g.headerIconBackground,Uk=g.headerSeparator,jl=g.headerLine,ur=g.contentIconBackground,Bq=g.contentLine,po=(g.widgetIconHighlight,g.widgetIconBorder),yo=(g.widgetIconGradient,g.imageBackground),xo=g.imageGradient,Hc=g.highlight,ub=g.label,dk=g.labelSelect;if(pi&&!B.shutAlert1){var op=new Date,Kk=pi.split("-"),yn=new Date(op.getFullYear(),op.getMonth(),op.getDate()),pi=new Date(pm(Kk[0],10),pm(Kk[1],10)-1,pm(Kk[2],10)),Qf=yn.getTime(),yg=pi.getTime(),or=v+"_try",Sp=B.alert;try{var uf=B.localStorage;if(uf&&Sp)if(yg>Qf&&1728e6>yg-Qf){var lm=(yg-Qf)/864e5;uf&&uf[or]!=lm&&(uf[or]=lm,B.htWillExpire?Sp(B.htWillExpire.replace("{{day}}",lm)):Sp("HT for Web free trial license will expire in "+lm+" days, please apply for a new license!"))}else Qf>=yg&&(B.htExpired?Sp(B.htExpired):Sp("Your free trial of HT for Web has expired!")),uf&&delete uf[or]}catch(Og){}}Math.sign===_&&(Math.sign=function(d){return 0>d?-1:d>0?1:+d});var wr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Gi={encode:function(l,M){var j,N,f,i,O,F,Y,p="",g=0;for(l=unescape(encodeURIComponent(l));g<l.length;)j=l.charCodeAt(g++),N=l.charCodeAt(g++),f=l.charCodeAt(g++),i=j>>2,O=(3&j)<<4|N>>4,F=(15&N)<<2|f>>6,Y=63&f,isNaN(N)?F=Y=64:isNaN(f)&&(Y=64),p=p+M.charAt(i)+M.charAt(O)+M.charAt(F)+M.charAt(Y);return p},decode:function(k,P,Y){for(var z,M,O,w,c,n,s,y="",f=Y||0;f<k.length;)w=P.indexOf(k.charAt(f++)),c=P.indexOf(k.charAt(f++)),n=P.indexOf(k.charAt(f++)),s=P.indexOf(k.charAt(f++)),z=w<<2|c>>4,M=(15&c)<<4|n>>2,O=(3&n)<<6|s,y+=String.fromCharCode(z),64!=n&&(y+=String.fromCharCode(M)),64!=s&&(y+=String.fromCharCode(O));return y=decodeURIComponent(escape(y))},_utf8_encode:function(V){V=V.replace(/\r\n/g,"\n");for(var S="",B=0;B<V.length;B++){var x=V.charCodeAt(B);128>x?S+=String.fromCharCode(x):x>127&&2048>x?(S+=String.fromCharCode(192|x>>6),S+=String.fromCharCode(128|63&x)):(S+=String.fromCharCode(224|x>>12),S+=String.fromCharCode(128|63&x>>6),S+=String.fromCharCode(128|63&x))}return S},_utf8_decode:function(E){for(var P="",J=0,z=0,n=0,b=0;J<E.length;)z=E.charCodeAt(J),128>z?(P+=String.fromCharCode(z),J++):z>191&&224>z?(n=E.charCodeAt(J+1),P+=String.fromCharCode((31&z)<<6|63&n),J+=2):(n=E.charCodeAt(J+1),b=E.charCodeAt(J+2),P+=String.fromCharCode((15&z)<<12|(63&n)<<6|63&b),J+=3);return P}},No=[],Bm=[],$m=b.Math={generateUUID:function(){for(var Q=[],r=0;256>r;r++)Q[r]=(16>r?"0":"")+r.toString(16).toUpperCase();return function(){var i=0|4294967295*Math.random(),z=0|4294967295*Math.random(),F=0|4294967295*Math.random(),v=0|4294967295*Math.random();return Q[255&i]+Q[255&i>>8]+Q[255&i>>16]+Q[255&i>>24]+"-"+Q[255&z]+Q[255&z>>8]+"-"+Q[64|15&z>>16]+Q[255&z>>24]+"-"+Q[128|63&F]+Q[255&F>>8]+"-"+Q[255&F>>16]+Q[255&F>>24]+Q[255&v]+Q[255&v>>8]+Q[255&v>>16]+Q[255&v>>24]}}(),clamp:function(d,g,u){return Math.max(g,Math.min(u,d))},fequal:function(i,u,N){return null==N&&(N=1e-8),Math.abs(i-u)<N},generateIncreasingID:function(){var Q=0;return function(){return++Q}}(),encodeBase64:function(H,b){return Gi.encode(H,b||wr)},decodeBase64:function(j,w){return Gi.decode(j,w||wr)},randomArray:function(f,J){J=J||f.length;for(var v=J-1;v>0;v--){var V=Math.floor(Math.random()*(v+1)),B=f[v];f[v]=f[V],f[V]=B}return f},randomInt:function(w,j){return j===_&&(j=w,w=0),w+Math.floor(Math.random()*(j-w))},randomFloat:function(l,B){return B===_&&(B=l,l=0),l+Math.random()*(B-l)},isPOT:function(y){return y>0&&0===(y-1&y)},nearestPOT:function($){if(!$)return 1;var w=$;w--,w|=w>>1,w|=w>>2,w|=w>>4,w|=w>>8,w|=w>>16,w++;var n=w>>1;return $-n>w-$?w:n},requestMatrix4:function(){return No.length>0?No.pop():new $m.Matrix4},releaseMatrix4:function(D){No.push(D)},requestVector3:function(){return Bm.length>0?Bm.pop():new $m.Vector3},releaseVector3:function(Z){Bm.push(Z)}},je=b.Matrix=b.Math.Matrix2d=function(z,k,E,x,C){this.setFromTransform(z,k,E,x,C)},td=je;je.prototype={},je.prototype.constructor=je,je.prototype.set=function(L,o,C,E,t,j){return this.a=L,this.b=o,this.c=C,this.d=E,this.tx=t,this.ty=j,this},je.prototype.setFromTransform=function(y,$,g,X,S){var z=this;if(y===_)return z.a=1,z.b=0,z.c=0,z.d=1,z.tx=0,z.ty=0,void 0;var c,s;return y?(c=h(y),s=j(y)):(c=0,s=1),X=X||1,S=S||1,z.a=s*X,z.b=c*X,z.c=-c*S,z.d=s*S,z.tx=$||0,z.ty=g||0,z},je.prototype.apply=function(D,z){z=z||new jj;var V=D.x,B=D.y;return z.x=this.a*V+this.c*B+this.tx,z.y=this.b*V+this.d*B+this.ty,z},je.prototype.applyInverse=function(P,R){R=R||new jj;var B=1/(this.a*this.d+this.c*-this.b),m=P.x,H=P.y;return R.x=this.d*B*m+-this.c*B*H+(this.ty*this.c-this.tx*this.d)*B,R.y=this.a*B*H+-this.b*B*m+(-this.ty*this.a+this.tx*this.b)*B,R},je.prototype.translate=function(w,L){return this.tx+=w,this.ty+=L,this},je.prototype.scale=function(P,U){return this.a*=P,this.d*=U,this.c*=P,this.b*=U,this.tx*=P,this.ty*=U,this},je.prototype.rotate=function(A){var T=Math.cos(A),m=Math.sin(A),J=this.a,q=this.c,d=this.tx;return this.a=J*T-this.b*m,this.b=J*m+this.b*T,this.c=q*T-this.d*m,this.d=q*m+this.d*T,this.tx=d*T-this.ty*m,this.ty=d*m+this.ty*T,this},je.prototype.appendTranslate=function(u,l){return this.tx+=this.a*u+this.c*l,this.ty+=this.b*u+this.d*l,this},je.prototype.appendScale=function(G,y){return this.a*=G,this.d*=y,this.c*=y,this.b*=G,this},je.prototype.appendRotate=function(Z){if(!Z)return this;var U=Math.cos(Z),e=Math.sin(Z),J=this.a,i=this.b;return this.a=J*U+this.c*e,this.b=i*U+this.d*e,this.c=-J*e+this.c*U,this.d=-i*e+this.d*U,this},je.prototype.append=function(U){var R=this.a,T=this.b,f=this.c,S=this.d;return this.a=U.a*R+U.b*f,this.b=U.a*T+U.b*S,this.c=U.c*R+U.d*f,this.d=U.c*T+U.d*S,this.tx=U.tx*R+U.ty*f+this.tx,this.ty=U.tx*T+U.ty*S+this.ty,this},je.prototype.setTransform=function(W,g,O,h,J,r,P,B,m){var q,y,R,j,x,w,t,M,c,n;return x=Math.sin(P),w=Math.cos(P),t=Math.cos(m),M=Math.sin(m),c=-Math.sin(B),n=Math.cos(B),q=w*J,y=x*J,R=-x*r,j=w*r,this.a=t*q+M*R,this.b=t*y+M*j,this.c=c*q+n*R,this.d=c*y+n*j,this.tx=W+(O*q+h*R),this.ty=g+(O*y+h*j),this},je.prototype.prepend=function(U){var O=this.tx;if(1!==U.a||0!==U.b||0!==U.c||1!==U.d){var H=this.a,s=this.c;this.a=H*U.a+this.b*U.c,this.b=H*U.b+this.b*U.d,this.c=s*U.a+this.d*U.c,this.d=s*U.b+this.d*U.d}return this.tx=O*U.a+this.ty*U.c+U.tx,this.ty=O*U.b+this.ty*U.d+U.ty,this},je.prototype.transform=je.prototype.prepend,je.prototype.invert=function(){var J=this.a,m=this.b,x=this.c,Y=this.d,d=this.tx,E=J*Y-m*x;return this.a=Y/E,this.b=-m/E,this.c=-x/E,this.d=J/E,this.tx=(x*this.ty-Y*d)/E,this.ty=-(J*this.ty-m*d)/E,this},je.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},je.prototype.clone=function(){var r=new je;return r.a=this.a,r.b=this.b,r.c=this.c,r.d=this.d,r.tx=this.tx,r.ty=this.ty,r},je.prototype.copy=function(L){return L.a=this.a,L.b=this.b,L.c=this.c,L.d=this.d,L.tx=this.tx,L.ty=this.ty,L},je.prototype.tf=function(n,s){1===arguments.length&&(s=n.y,n=n.x);var F=this;return{x:F.a*n+F.c*s+F.tx,y:F.b*n+F.d*s+F.ty}},je.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},je.prototype.fromArray=function(e){return this.a=e[0],this.b=e[1],this.c=e[2],this.d=e[3],this.tx=e[4],this.ty=e[5],this},je.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},je.prototype.tfi=function(N,c){1===arguments.length&&(c=N.y,N=N.x);var U=this,h=1/(U.a*U.d+U.c*-U.b);return{x:U.d*h*N+-U.c*h*c+(U.ty*U.c-U.tx*U.d)*h,y:U.a*h*c+-U.b*h*N+(-U.ty*U.a+U.tx*U.b)*h}},je.IDENTITY=new je,je.TEMP_MATRIX=new je;var ql=b.Math.Quaternion=function(j,W,A,M){this.set(j,W,A,M)};x.assign(ql.prototype,{set:function(B,$,d,U){var f=this;return f._x=B||0,f._y=$||0,f._z=d||0,f._w=U!==_?U:1,f},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(B){var c=this;return c._x=B._x,c._y=B._y,c._z=B._z,c._w=B._w,c},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(b){return this._x*b._x+this._y*b._y+this._z*b._z+this._w*b._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this},fromArray:function(I,f){f===_&&(f=0);var H=this;return H._x=I[f],H._y=I[f+1],H._z=I[f+2],H._w=I[f+3],this},slerp:function(h,O){if(0===O)return this;if(1===O)return this.copy(h);var W=this._x,T=this._y,F=this._z,C=this._w,Z=C*h._w+W*h._x+T*h._y+F*h._z;if(0>Z?(this._w=-h._w,this._x=-h._x,this._y=-h._y,this._z=-h._z,Z=-Z):this.copy(h),Z>=1)return this._w=C,this._x=W,this._y=T,this._z=F,this;var v=Math.sqrt(1-Z*Z);if(Math.abs(v)<.001)return this._w=.5*(C+this._w),this._x=.5*(W+this._x),this._y=.5*(T+this._y),this._z=.5*(F+this._z),this;var o=Math.atan2(v,Z),S=Math.sin((1-O)*o)/v,R=Math.sin(O*o)/v;return this._w=C*S+this._w*R,this._x=W*S+this._x*R,this._y=T*S+this._y*R,this._z=F*S+this._z*R,this},setFromAxisAngle:function(O,T){var Y=T/2,I=Math.sin(Y);return this._x=O.x*I,this._y=O.y*I,this._z=O.z*I,this._w=Math.cos(Y),this},setFromEuler:function(m){var _=m._x,Z=m._y,d=m._z,L=m._order,j=Math.cos,C=Math.sin,z=j(_/2),X=j(Z/2),Q=j(d/2),w=C(_/2),g=C(Z/2),c=C(d/2);return"XYZ"===L?(this._x=w*X*Q+z*g*c,this._y=z*g*Q-w*X*c,this._z=z*X*c+w*g*Q,this._w=z*X*Q-w*g*c):"YXZ"===L?(this._x=w*X*Q+z*g*c,this._y=z*g*Q-w*X*c,this._z=z*X*c-w*g*Q,this._w=z*X*Q+w*g*c):"ZXY"===L?(this._x=w*X*Q-z*g*c,this._y=z*g*Q+w*X*c,this._z=z*X*c+w*g*Q,this._w=z*X*Q-w*g*c):"ZYX"===L?(this._x=w*X*Q-z*g*c,this._y=z*g*Q+w*X*c,this._z=z*X*c-w*g*Q,this._w=z*X*Q+w*g*c):"YZX"===L?(this._x=w*X*Q+z*g*c,this._y=z*g*Q+w*X*c,this._z=z*X*c-w*g*Q,this._w=z*X*Q-w*g*c):"XZY"===L&&(this._x=w*X*Q-z*g*c,this._y=z*g*Q-w*X*c,this._z=z*X*c+w*g*Q,this._w=z*X*Q+w*g*c),this},setFromRotationMatrix:function(m){var V,f=m.el,G=f[0],B=f[4],S=f[8],c=f[1],k=f[5],F=f[9],z=f[2],X=f[6],l=f[10],P=G+k+l;return P>0?(V=.5/Math.sqrt(P+1),this._w=.25/V,this._x=(X-F)*V,this._y=(S-z)*V,this._z=(c-B)*V):G>k&&G>l?(V=2*Math.sqrt(1+G-k-l),this._w=(X-F)/V,this._x=.25*V,this._y=(B+c)/V,this._z=(S+z)/V):k>l?(V=2*Math.sqrt(1+k-G-l),this._w=(S-z)/V,this._x=(B+c)/V,this._y=.25*V,this._z=(F+X)/V):(V=2*Math.sqrt(1+l-G-k),this._w=(c-B)/V,this._x=(S+z)/V,this._y=(F+X)/V,this._z=.25*V),this},setFromToVectors:function(){var j,O;return function(x,u){return j===_&&(j=new id),O=x.dot(u)+1,1e-7>O?(O=0,Math.abs(x.x)>Math.abs(x.z)?j.set(-x.y,x.x,0):j.set(0,-x.z,x.y)):j.crossVectors(x,u),this._x=j.x,this._y=j.y,this._z=j.z,this._w=O,this.normalize()}}(),setFromUnitVectors:function(){var q,d,x=1e-6;return function(b,H){return q===_&&(q=new id),d=b.dot(H)+1,x>d?(d=0,Math.abs(b.x)>Math.abs(b.z)?q.set(-b.y,b.x,0):q.set(0,-b.z,b.y)):q.crossVectors(b,H),this._x=q.x,this._y=q.y,this._z=q.z,this._w=d,this.normalize()}}(),multiply:function(N){return this.multiplyQuaternions(this,N)},premultiply:function(p){return this.multiplyQuaternions(p,this)},multiplyQuaternions:function(q,U){var $=q._x,E=q._y,x=q._z,o=q._w,J=U._x,G=U._y,H=U._z,r=U._w;return this._x=$*r+o*J+E*H-x*G,this._y=E*r+o*G+x*J-$*H,this._z=x*r+o*H+$*G-E*J,this._w=o*r-$*J-E*G-x*H,this},toArray:function(W,J){return W||(W=[]),J=J||0,W[J]=this._x,W[J+1]=this._y,W[J+2]=this._z,W[J+3]=this._w,W}});var Pc=b.Math.Vector4=function(D,z,L,k){this.x=D||0,this.y=z||0,this.z=L||0,this.w=k!==_?k:1};x.assign(Pc.prototype,{isVector4:!0,set:function(z,g,v,n){return this.x=z,this.y=g,this.z=v,this.w=n,this},setScalar:function(V){return this.x=V,this.y=V,this.z=V,this.w=V,this},setX:function(h){return this.x=h,this},setY:function(c){return this.y=c,this},setZ:function(g){return this.z=g,this},setW:function(L){return this.w=L,this},setComponent:function(w,R){switch(w){case 0:this.x=R;break;case 1:this.y=R;break;case 2:this.z=R;break;case 3:this.w=R;break;default:throw new Error("index is out of range: "+w)}return this},getComponent:function(W){switch(W){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+W)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(O){return this.x=O.x,this.y=O.y,this.z=O.z,this.w=O.w!==_?O.w:1,this},add:function(k,l){return l!==_?this.addVectors(k,l):(this.x+=k.x,this.y+=k.y,this.z+=k.z,this.w+=k.w,this)},addScalar:function(V){return this.x+=V,this.y+=V,this.z+=V,this.w+=V,this},addVectors:function(i,g){return this.x=i.x+g.x,this.y=i.y+g.y,this.z=i.z+g.z,this.w=i.w+g.w,this},addScaledVector:function(K,A){return this.x+=K.x*A,this.y+=K.y*A,this.z+=K.z*A,this.w+=K.w*A,this},sub:function(w,H){return H!==_?this.subVectors(w,H):(this.x-=w.x,this.y-=w.y,this.z-=w.z,this.w-=w.w,this)},subScalar:function(h){return this.x-=h,this.y-=h,this.z-=h,this.w-=h,this},subVectors:function(R,y){return this.x=R.x-y.x,this.y=R.y-y.y,this.z=R.z-y.z,this.w=R.w-y.w,this},multiplyScalar:function(v){return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this},applyMatrix4:function(X){var n=this.x,l=this.y,J=this.z,c=this.w,L=X.el;return this.x=L[0]*n+L[4]*l+L[8]*J+L[12]*c,this.y=L[1]*n+L[5]*l+L[9]*J+L[13]*c,this.z=L[2]*n+L[6]*l+L[10]*J+L[14]*c,this.w=L[3]*n+L[7]*l+L[11]*J+L[15]*c,this},divideScalar:function(X){return this.multiplyScalar(1/X)},setAxisAngleFromQuaternion:function($){this.w=2*Math.acos($.w);var H=Math.sqrt(1-$.w*$.w);return 1e-4>H?(this.x=1,this.y=0,this.z=0):(this.x=$.x/H,this.y=$.y/H,this.z=$.z/H),this},setAxisAngleFromRotationMatrix:function(P){var y,N,u,b,k=.01,K=.1,F=P.el,M=F[0],I=F[4],d=F[8],l=F[1],f=F[5],L=F[9],B=F[2],A=F[6],C=F[10];if(Math.abs(I-l)<k&&Math.abs(d-B)<k&&Math.abs(L-A)<k){if(Math.abs(I+l)<K&&Math.abs(d+B)<K&&Math.abs(L+A)<K&&Math.abs(M+f+C-3)<K)return this.set(1,0,0,0),this;y=Math.PI;var V=(M+1)/2,D=(f+1)/2,w=(C+1)/2,i=(I+l)/4,e=(d+B)/4,J=(L+A)/4;return V>D&&V>w?k>V?(N=0,u=.707106781,b=.707106781):(N=Math.sqrt(V),u=i/N,b=e/N):D>w?k>D?(N=.707106781,u=0,b=.707106781):(u=Math.sqrt(D),N=i/u,b=J/u):k>w?(N=.707106781,u=.707106781,b=0):(b=Math.sqrt(w),N=e/b,u=J/b),this.set(N,u,b,y),this}var h=Math.sqrt((A-L)*(A-L)+(d-B)*(d-B)+(l-I)*(l-I));return Math.abs(h)<.001&&(h=1),this.x=(A-L)/h,this.y=(d-B)/h,this.z=(l-I)/h,this.w=Math.acos((M+f+C-1)/2),this},min:function(k){return this.x=Math.min(this.x,k.x),this.y=Math.min(this.y,k.y),this.z=Math.min(this.z,k.z),this.w=Math.min(this.w,k.w),this},max:function(W){return this.x=Math.max(this.x,W.x),this.y=Math.max(this.y,W.y),this.z=Math.max(this.z,W.z),this.w=Math.max(this.w,W.w),this},clamp:function(n,K){return this.x=Math.max(n.x,Math.min(K.x,this.x)),this.y=Math.max(n.y,Math.min(K.y,this.y)),this.z=Math.max(n.z,Math.min(K.z,this.z)),this.w=Math.max(n.w,Math.min(K.w,this.w)),this},clampScalar:function(){var A,j;return function(Z,m){return A===_&&(A=new Pc,j=new Pc),A.set(Z,Z,Z,Z),j.set(m,m,m,m),this.clamp(A,j)}}(),clampLength:function(K,P){var A=this.length();return this.divideScalar(A||1).multiplyScalar(Math.max(K,Math.min(P,A)))
},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(y){return this.x*y.x+this.y*y.y+this.z*y.z+this.w*y.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(s){return this.normalize().multiplyScalar(s)},lerp:function(i,w){return this.x+=(i.x-this.x)*w,this.y+=(i.y-this.y)*w,this.z+=(i.z-this.z)*w,this.w+=(i.w-this.w)*w,this},lerpVectors:function(i,J,L){return this.subVectors(J,i).multiplyScalar(L).add(i)},equals:function(d){return d.x===this.x&&d.y===this.y&&d.z===this.z&&d.w===this.w},fromArray:function(N,t){return t===_&&(t=0),this.x=N[t],this.y=N[t+1],this.z=N[t+2],this.w=N[t+3],this},toArray:function(m,c){return m===_&&(m=[]),c===_&&(c=0),m[c]=this.x,m[c+1]=this.y,m[c+2]=this.z,m[c+3]=this.w,m},fromBufferAttribute:function(K,R){return this.x=K.getX(R),this.y=K.getY(R),this.z=K.getZ(R),this.w=K.getW(R),this}});var id=b.Math.Vector3=function(S,d,o){S===_?(this.x=0,this.y=0,this.z=0):"object"==typeof S?this.copy(S):this.set(S,d==_?S:d,o==_?S:o)},yp=b.Math.Vector3;x.assign(id.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(D,a,M){return this.x=D,this.y=a,this.z=M,this},equals:function(b){return b&&this.x===b.x&&this.y===b.y&&this.z===b.z},setScalar:function(i){return this.x=i,this.y=i,this.z=i,this},setX:function(Z){return this.x=Z,this},setY:function(Y){return this.y=Y,this},setZ:function(P){return this.z=P,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(C){return C.x===_?(this.x=C[0],this.y=C[1],this.z=C[2]):(this.x=C.x,this.y=C.y,this.z=C.z||0),this},add:function(J){return this.x+=J.x,this.y+=J.y,this.z+=J.z,this},addScalar:function(P){return this.x+=P,this.y+=P,this.z+=P,this},addVectors:function(Y,f){return this.x=Y.x+f.x,this.y=Y.y+f.y,this.z=Y.z+f.z,this},addScaledVector:function(k,y){return this.x+=k.x*y,this.y+=k.y*y,this.z+=k.z*y,this},sub:function(o){return this.x-=o.x,this.y-=o.y,this.z-=o.z,this},subScalar:function(w){return this.x-=w,this.y-=w,this.z-=w,this},subVectors:function(N,f){return this.x=N.x-f.x,this.y=N.y-f.y,this.z=N.z-f.z,this},divide:function(n){return this.x/=n.x,this.y/=n.y,this.z/=n.z,this},multiply:function(H){return this.x*=H.x,this.y*=H.y,this.z*=H.z,this},multiplyScalar:function(g){return this.x*=g,this.y*=g,this.z*=g,this},divideScalar:function(D){if(0!==D){var S=1/D;this.x*=S,this.y*=S,this.z*=S}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(U){return Math.sqrt(this.distanceToSquared(U))},distanceToSquared:function(V){var e=this.x-V.x,z=this.y-V.y,t=this.z-V.z;return e*e+z*z+t*t},distanceToSquared2:function(I){var y=this.x-I[0],U=this.y-I[1],q=this.z-I[2];return y*y+U*U+q*q},divideVectors:function(x,E){return this.x=x.x/E.x,this.y=x.y/E.y,this.z=x.z/E.z,this},multiplyVectors:function(B,f){return this.x=B.x*f.x,this.y=B.y*f.y,this.z=B.z*f.z,this},transformDirection:function(B){var R=this.x,w=this.y,r=this.z,f=B.el;return this.x=f[0]*R+f[4]*w+f[8]*r,this.y=f[1]*R+f[5]*w+f[9]*r,this.z=f[2]*R+f[6]*w+f[10]*r,this.normalize()},applyAxisAngle:function(){var I=new ql;return function(S,f){return this.applyQuaternion(I.setFromAxisAngle(S,f))}}(),applyEuler:function(){var V=new ql;return function(H){return this.applyQuaternion(V.setFromEuler(H))}}(),applyQuaternion:function(q){var a=this.x,L=this.y,$=this.z,r=q._x,T=q._y,I=q._z,o=q._w,S=o*a+T*$-I*L,u=o*L+I*a-r*$,x=o*$+r*L-T*a,D=-r*a-T*L-I*$;return this.x=S*o+D*-r+u*-I-x*-T,this.y=u*o+D*-T+x*-r-S*-I,this.z=x*o+D*-I+S*-T-u*-r,this},applyMatrix4:function(p){var y=this.x,m=this.y,J=this.z,U=p.el,v=1/(U[3]*y+U[7]*m+U[11]*J+U[15]);return this.x=(U[0]*y+U[4]*m+U[8]*J+U[12])*v,this.y=(U[1]*y+U[5]*m+U[9]*J+U[13])*v,this.z=(U[2]*y+U[6]*m+U[10]*J+U[14])*v,this},applyMatrix3:function($){var j=this.x,V=this.y,L=this.z,l=$.el;return this.x=l[0]*j+l[3]*V+l[6]*L,this.y=l[1]*j+l[4]*V+l[7]*L,this.z=l[2]*j+l[5]*V+l[8]*L,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var V=new id;return function(Y){return this.sub(V.copy(Y).multiplyScalar(2*this.dot(Y)))}}(),dot:function(H){return this.x*H.x+this.y*H.y+this.z*H.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var s=this.length();return s?this.multiplyScalar(1/s):this},setLength:function(Z){return this.normalize().multiplyScalar(Z)},fromArray:function(Y,N){return N===_&&(N=0),this.x=Y[N],this.y=Y[N+1],this.z=Y[N+2],this},toArray:function(Z,o){return Z===_&&(Z=[0,0,0]),o===_&&(o=0),Z[o]=this.x,Z[o+1]=this.y,Z[o+2]=this.z,Z},cross:function(h){return this.crossVectors(this,h)},angleTo:function(u){var H=this.dot(u)/Math.sqrt(this.lengthSq()*u.lengthSq());return H>1||-1>H?0:Math.acos(H)},lerp:function(u,Z){return this.x+=(u.x-this.x)*Z,this.y+=(u.y-this.y)*Z,this.z+=(u.z-this.z)*Z,this},lerpVectors:function(j,K,W){return this.subVectors(K,j).multiplyScalar(W).add(j)},crossVectors:function(z,s){var F=z.x,V=z.y,I=z.z,w=s.x,f=s.y,m=s.z;return this.x=V*m-I*f,this.y=I*w-F*m,this.z=F*f-V*w,this},min:function(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this},max:function(L){return this.x=Math.max(this.x,L.x),this.y=Math.max(this.y,L.y),this.z=Math.max(this.z,L.z),this},setFromMatrixPosition:function(A){return this.setFromMatrixColumn(A,3)},setFromMatrixScale:function(F){var k=this.setFromMatrixColumn(F,0).length(),u=this.setFromMatrixColumn(F,1).length(),q=this.setFromMatrixColumn(F,2).length();return this.x=k,this.y=u,this.z=q,this},setFromMatrixColumn:function(k,A){return this.fromArray(k.el,4*A)}}),id.UP=new id(0,1,0),id.AxisX=new id(1,0,0),id.AxisY=new id(0,1,0),id.AxisZ=new id(0,0,1);var jj=b.Math.Vector2=function(y,N,s){"object"==typeof y&&(y.x!=_?(N=y.y,s=y.e,y=y.x):(s=y[2],N=y[1],y=y[0])),this.set(y||0,N||0,s)};jj.prototype={},jj.prototype.constructor=jj;var mr=jj;x.defineProperties(jj.prototype,{width:{get:function(){return this.x},set:function(T){this.x=T}},height:{get:function(){return this.y},set:function(g){this.y=g}}}),jj.prototype.clone=function(){return new jj(this.x,this.y,this.e)},jj.prototype.copy=function(U){return this.set(U.x,U.y,U.e),this},jj.prototype.equals=function(o){return o.x===this.x&&o.y===this.y&&o.e===this.e},jj.prototype.set=function(X,r,w){return this.x=X||0,this.y=r||(0!==r?this.x:0),w!=_&&(this.e=w),this},jj.prototype.setScalar=function(W){return this.x=W,this.y=W,this.e=W,this},jj.prototype.setX=function(v){return this.x=v||0,this},jj.prototype.setY=function(n){return this.y=n||0,this},jj.prototype.setE=function(P){return this.e=P||0,this},jj.prototype.add=function(y){return this.x+=y.x,this.y+=y.y,this},jj.prototype.addVectors=function(Z,a){return this.x=Z.x+a.x,this.y=Z.y+a.y,this},jj.prototype.addScalar=function(m){return this.x+=m,this.y+=m,this},jj.prototype.addScaledVector=function(C,S){return this.x+=C.x*S,this.y+=C.y*S,this},jj.prototype.sub=function(z){return this.x-=z.x,this.y-=z.y,this},jj.prototype.subScalar=function(D){return this.x-=D,this.y-=D,this},jj.prototype.subVectors=function(Z,M){return this.x=Z.x-M.x,this.y=Z.y-M.y,this},jj.prototype.multiply=function(M){return this.x*=M.x,this.y*=M.y,this},jj.prototype.multiplyScalar=function(l){return this.x*=l,this.y*=l,this},jj.prototype.divide=function(v){return this.x/=v.x,this.y/=v.y,this},jj.prototype.divideScalar=function(K){return this.multiplyScalar(1/K)},jj.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},jj.prototype.max=function(H){return this.x=Math.max(this.x,H.x),this.y=Math.max(this.y,H.y),this},jj.prototype.fromArray=function(P,J){return J===_&&(J=0),this.x=P[J],this.y=P[J+1],this},jj.prototype.clamp=function(G,J){return this.x=Math.max(G.x,Math.min(J.x,this.x)),this.y=Math.max(G.y,Math.min(J.y,this.y)),this},jj.prototype.clampScalar=function(){var G,M;return function(h,H){return G===_&&(G=new jj,M=new jj),G.set(h,h),M.set(H,H),this.clamp(G,M)}}(),jj.prototype.clampLength=function(M,T){var B=this.length();return this.multiplyScalar(Math.max(M,Math.min(T,B))/B)},jj.prototype.dot=function(i){return this.x*i.x+this.y*i.y},jj.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},jj.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},jj.prototype.normalize=function(){return this.divideScalar(this.length())},jj.prototype.angle=function(){var H=Math.atan2(this.y,this.x);return 0>H&&(H+=2*Math.PI),H},jj.prototype.distanceTo=function(N){return Math.sqrt(this.distanceToSquared(N))},jj.prototype.distanceToSquared=function(n){var g=this.x-n.x,b=this.y-n.y;return g*g+b*b},jj.prototype.isNearEnough=function(i){return this.distanceToSquared(i)<1e-8},jj.prototype.setLength=function(i){var l=this.length();return l?this.multiplyScalar(i/l):this},jj.prototype.lerp=function(P,C){return this.x+=(P.x-this.x)*C,this.y+=(P.y-this.y)*C,"number"==typeof P.e&&"number"==typeof this.e&&(this.e+=(P.e-this.e)*C),this},jj.prototype.lerpVectors=function(B,V,x){return this.subVectors(V,B).multiplyScalar(x).add(B)},jj.prototype.rotateAround=function(s,C){var T=s?s.x:0,P=s?s.y:0,H=Math.cos(C),E=Math.sin(C),J=this.x-T,Z=this.y-P;return this.x=J*H-Z*E+T,this.y=J*E+Z*H+P,this};var Nn=b.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};x.assign(Nn.prototype,{isMatrix3:!0,set:function(Y,x,n,W,o,X,R,N,j){var $=this.el;return $[0]=Y,$[1]=W,$[2]=R,$[3]=x,$[4]=o,$[5]=N,$[6]=n,$[7]=X,$[8]=j,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(t){var P=this.el,O=t.el;return P[0]=O[0],P[1]=O[1],P[2]=O[2],P[3]=O[3],P[4]=O[4],P[5]=O[5],P[6]=O[6],P[7]=O[7],P[8]=O[8],this},setFromMatrix4:function(B){var h=B.el;return this.set(h[0],h[4],h[8],h[1],h[5],h[9],h[2],h[6],h[10]),this},applyToBufferAttribute:function(){var o=new id;return function(b){for(var f=0,n=b.count;n>f;f++)o.x=b.getX(f),o.y=b.getY(f),o.z=b.getZ(f),o.applyMatrix3(this),b.setXYZ(f,o.x,o.y,o.z);return b}}(),multiply:function(M){return this.multiplyMatrices(this,M)},premultiply:function(L){return this.multiplyMatrices(L,this)},multiplyMatrices:function(G,B){var A=G.el,I=B.el,b=this.el,s=A[0],q=A[3],X=A[6],j=A[1],Y=A[4],w=A[7],d=A[2],c=A[5],v=A[8],H=I[0],u=I[3],D=I[6],r=I[1],z=I[4],U=I[7],M=I[2],O=I[5],k=I[8];return b[0]=s*H+q*r+X*M,b[3]=s*u+q*z+X*O,b[6]=s*D+q*U+X*k,b[1]=j*H+Y*r+w*M,b[4]=j*u+Y*z+w*O,b[7]=j*D+Y*U+w*k,b[2]=d*H+c*r+v*M,b[5]=d*u+c*z+v*O,b[8]=d*D+c*U+v*k,this},multiplyScalar:function(i){var a=this.el;return a[0]*=i,a[3]*=i,a[6]*=i,a[1]*=i,a[4]*=i,a[7]*=i,a[2]*=i,a[5]*=i,a[8]*=i,this},determinant:function(){var i=this.el,l=i[0],X=i[1],k=i[2],f=i[3],x=i[4],O=i[5],C=i[6],j=i[7],b=i[8];return l*x*b-l*O*j-X*f*b+X*O*C+k*f*j-k*x*C},getInverse:function(s){var B=s.el,v=this.el,h=B[0],_=B[1],V=B[2],n=B[3],Z=B[4],F=B[5],W=B[6],D=B[7],b=B[8],r=b*Z-F*D,T=F*W-b*n,K=D*n-Z*W,I=h*r+_*T+V*K;if(0===I)return this.identity();var R=1/I;return v[0]=r*R,v[1]=(V*D-b*_)*R,v[2]=(F*_-V*Z)*R,v[3]=T*R,v[4]=(b*h-V*W)*R,v[5]=(V*n-F*h)*R,v[6]=K*R,v[7]=(_*W-D*h)*R,v[8]=(Z*h-_*n)*R,this},transpose:function(){var h,Z=this.el;return h=Z[1],Z[1]=Z[3],Z[3]=h,h=Z[2],Z[2]=Z[6],Z[6]=h,h=Z[5],Z[5]=Z[7],Z[7]=h,this},getNormalMatrix:function($){return this.setFromMatrix4($).getInverse(this).transpose()},transposeIntoArray:function(K){var U=this.el;return K[0]=U[0],K[1]=U[3],K[2]=U[6],K[3]=U[1],K[4]=U[4],K[5]=U[7],K[6]=U[2],K[7]=U[5],K[8]=U[8],this},setUvTransform:function(O,a,Q,I,e,G,X){var H=Math.cos(e),U=Math.sin(e);this.set(Q*H,Q*U,-Q*(H*G+U*X)+G+O,-I*U,I*H,-I*(-U*G+H*X)+X+a,0,0,1)},scale:function(c,N){var U=this.el;return U[0]*=c,U[3]*=c,U[6]*=c,U[1]*=N,U[4]*=N,U[7]*=N,this},rotate:function(B){var q=Math.cos(B),F=Math.sin(B),S=this.el,x=S[0],A=S[3],z=S[6],U=S[1],o=S[4],J=S[7];return S[0]=q*x+F*U,S[3]=q*A+F*o,S[6]=q*z+F*J,S[1]=-F*x+q*U,S[4]=-F*A+q*o,S[7]=-F*z+q*J,this},translate:function(y,v){var h=this.el;return h[0]+=y*h[2],h[3]+=y*h[5],h[6]+=y*h[8],h[1]+=v*h[2],h[4]+=v*h[5],h[7]+=v*h[8],this},equals:function(H){for(var T=this.el,t=H.el,U=0;9>U;U++)if(T[U]!==t[U])return!1;return!0},fromArray:function(z,x){x===_&&(x=0);for(var S=0;9>S;S++)this.el[S]=z[S+x];return this},toArray:function(S,M){S===_&&(S=[]),M===_&&(M=0);var m=this.el;return S[M]=m[0],S[M+1]=m[1],S[M+2]=m[2],S[M+3]=m[3],S[M+4]=m[4],S[M+5]=m[5],S[M+6]=m[6],S[M+7]=m[7],S[M+8]=m[8],S}});var qf=b.Math.Plane=function(O,V){this.normal=O!==_?O:new id(1,0,0),this.constant=V!==_?V:0};x.assign(qf.prototype,{set:function(u,E){return this.normal.copy(u),this.constant=E,this},setComponents:function(P,M,I,K){return this.normal.set(P,M,I),this.constant=K,this},setFromNormalAndCoplanarPoint:function(f,w){return this.normal.copy(f),this.constant=-w.dot(this.normal),this},setFromCoplanarPoints:function(){var Y=new id,p=new id;return function(N,s,R){var Z=Y.subVectors(R,s).cross(p.subVectors(N,s)).normalize();return this.setFromNormalAndCoplanarPoint(Z,N),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(m){return this.normal.copy(m.normal),this.constant=m.constant,this},normalize:function(){var U=1/this.normal.length();return this.normal.multiplyScalar(U),this.constant*=U,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(K){return this.normal.dot(K)+this.constant},distanceToSphere:function(d){return this.distanceToPoint(d.center)-d.radius},projectPoint:function(G,r){return r===_&&(r=new id),r.copy(this.normal).multiplyScalar(-this.distanceToPoint(G)).add(G)},intersectLine:function(){var y=new id;return function(K,f){f===_&&(f=new id);var T=K.delta(y),g=this.normal.dot(T);if(0===g)return 0===this.distanceToPoint(K.start)?f.copy(K.start):_;var e=-(K.start.dot(this.normal)+this.constant)/g;return 0>e||e>1?_:f.copy(T).multiplyScalar(e).add(K.start)}}(),intersectsLine:function(w){var h=this.distanceToPoint(w.start),U=this.distanceToPoint(w.end);return 0>h&&U>0||0>U&&h>0},intersectsBox:function(x){return x.intersectsPlane(this)},intersectsSphere:function(k){return k.intersectsPlane(this)},coplanarPoint:function(j){return j===_&&(j=new id),j.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var S=new id,$=new Nn;return function(X,k){var p=k||$.getNormalMatrix(X),M=this.coplanarPoint(S).applyMatrix4(X),o=this.normal.applyMatrix3(p).normalize();return this.constant=-M.dot(o),this}}(),translate:function(X){return this.constant-=X.dot(this.normal),this},equals:function($){return $.normal.equals(this.normal)&&$.constant===this.constant}});var _f=b.Math.Ray=function(Y,k){this.origin=Y!==_?Y.clone():new id,this.direction=k!==_?k.clone():new id};x.assign(_f.prototype,{set:function(L,G){return this.origin.copy(L),this.direction.copy(G),this},clone:function(){return(new this.constructor).copy(this)},copy:function(V){return this.origin.copy(V.origin),this.direction.copy(V.direction),this.maxHitLen=V.maxHitLen,this},at:function(a,e){var m=e||new id;return m.copy(this.direction).multiplyScalar(a).add(this.origin)},setMaxHitLength:function(p){this.maxHitLen=p},lookAt:function(k){return this.direction.copy(k).sub(this.origin).normalize(),this},applyMatrix4:function(G){var o=this.maxHitLen;if(o){var e=this.direction.clone().multiplyScalar(o).add(this.origin);e.applyMatrix4(G)}return this.origin.applyMatrix4(G),this.direction.transformDirection(G),o&&(this.maxHitLen=this.origin.distanceTo(e)),this},distanceToPlane:function(P){var u=P.normal.dot(this.direction);if(0===u)return 0===P.distanceToPoint(this.origin)?0:null;var p=-(this.origin.dot(P.normal)+P.constant)/u;return p>=0?p:null},intersectPlane:function(a,B){var c=this.distanceToPlane(a);return null===c?null:this.at(c,B)},intersectSphere:function(){var o=new id;return function(x,I){o.subVectors(x.center,this.origin);var j=o.dot(this.direction),r=o.dot(o)-j*j,f=x.radius*x.radius;if(r>f)return null;var O=Math.sqrt(f-r),X=j-O,q=j+O;return 0>X&&0>q?null:0>X?this.at(q,I):this.at(X,I)}}(),intersectEllipsoid:function(){var r=new id,b=new id;return function(B,R){r.subVectors(B.center,this.origin),r.divide(B.radius),b.divideVectors(this.direction,B.radius);var F=b.lengthSq(),g=r.dot(b),U=r.dot(r)*F-g*g;if(U>F)return null;var T=Math.sqrt(F-U),I=(g-T)/F,O=(g+T)/F;return 0>I&&0>O?null:0>I?this.at(O,R):this.at(I,R)}}(),intersectBox:function(W,t){var w,p,z,$,L,K,Z=1/this.direction.x,P=1/this.direction.y,n=1/this.direction.z,c=this.origin;if(Z>=0?(w=(W.min.x-c.x)*Z,p=(W.max.x-c.x)*Z):(w=(W.max.x-c.x)*Z,p=(W.min.x-c.x)*Z),P>=0?(z=(W.min.y-c.y)*P,$=(W.max.y-c.y)*P):(z=(W.max.y-c.y)*P,$=(W.min.y-c.y)*P),w>$||z>p)return null;if((z>w||w!==w)&&(w=z),(p>$||p!==p)&&(p=$),n>=0?(L=(W.min.z-c.z)*n,K=(W.max.z-c.z)*n):(L=(W.max.z-c.z)*n,K=(W.min.z-c.z)*n),w>K||L>p)return null;if((L>w||w!==w)&&(w=L),(p>K||p!==p)&&(p=K),0>p)return null;var q=w>=0?w:p,J=this.maxHitLen;return J&&q>J?null:this.at(q,t)},intersectTriangle:function(){var H=new id,A=new id,o=new id,N=new id;return function(p,q,d,m,n){A.subVectors(q,p),o.subVectors(d,p),N.crossVectors(A,o);var W,z=this.direction.dot(N);if(z>0){if(m)return null;W=1}else{if(!(0>z))return null;W=-1,z=-z}H.subVectors(this.origin,p);var s=W*this.direction.dot(o.crossVectors(H,o));if(0>s)return null;var U=W*this.direction.dot(A.cross(H));if(0>U||s+U>z)return null;var l=-W*H.dot(N);if(0>l)return null;var _=l/z,g=this.maxHitLen;return g&&_>g?null:this.at(_,n)}}()});var pk=b.Math.Box3=function(p,t){this.min=p!==_?p:new id(1/0,1/0,1/0),this.max=t!==_?t:new id(-1/0,-1/0,-1/0)};x.assign(pk.prototype,{set:function(J,P){return this.min.copy(J),this.max.copy(P),this},setFromArray:function(P){for(var r=1/0,W=1/0,e=1/0,j=-1/0,c=-1/0,k=-1/0,E=0,g=P.length;g>E;E+=3){var o=P[E],w=P[E+1],z=P[E+2];r>o&&(r=o),W>w&&(W=w),e>z&&(e=z),o>j&&(j=o),w>c&&(c=w),z>k&&(k=z)}return this.min.set(r,W,e),this.max.set(j,c,k),this},setFromPoints:function(V){this.makeEmpty();for(var S=0,F=V.length;F>S;S++)this.expandByPoint(V[S]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(i){return i.max.x<this.min.x||i.min.x>this.max.x||i.max.y<this.min.y||i.min.y>this.max.y||i.max.z<this.min.z||i.min.z>this.max.z?!1:!0},copy:function(V){return this.min.copy(V.min),this.max.copy(V.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(F){return this.min.min(F),this.max.max(F),this},expandByBox:function(D){return this.min.min(D.min),this.max.max(D.max),this},applyMatrix4:function(){var u=[new id,new id,new id,new id,new id,new id,new id,new id];return function(z){return this.isEmpty()?this:(u[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(z),u[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(z),u[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(z),u[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(z),u[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(z),u[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(z),u[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(z),u[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(z),this.setFromPoints(u),this)}}()});var oh=b.Math.Sphere=function(o,Z){this.center=o!==_?o:new id,this.radius=Z!==_?Z:0};x.assign(oh.prototype,{set:function(u,d){return this.center.copy(u),this.radius=d,this},setFromPoints:function(){var i=new pk;return function(Q,m){var Y=this.center;m!==_?Y.copy(m):i.setFromPoints(Q).getCenter(Y);for(var f=0,B=0,E=Q.length;E>B;B++)f=Math.max(f,Y.distanceToSquared(Q[B]));return this.radius=Math.sqrt(f),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(u){return this.center.copy(u.center),this.radius=u.radius,this},empty:function(){return this.radius<=0},containsPoint:function(H){return H.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(T){return T.distanceTo(this.center)-this.radius},intersectsSphere:function(y){var W=this.radius+y.radius;return y.center.distanceToSquared(this.center)<=W*W},intersectsBox:function(z){return z.intersectsSphere(this)},intersectsPlane:function(u){return Math.abs(u.distanceToPoint(this.center))<=this.radius},clampPoint:function(a,Z){var p=this.center.distanceToSquared(a);return Z===_&&(Z=new id),Z.copy(a),p>this.radius*this.radius&&(Z.sub(this.center).normalize(),Z.multiplyScalar(this.radius).add(this.center)),Z},getBoundingBox:function(R){return R===_&&(R=new pk),R.set(this.center,this.center),R.expandByScalar(this.radius),R},applyMatrix4:function(u){return this.center.applyMatrix4(u),this.radius=this.radius*u.getMaxScaleOnAxis(),this},translate:function(j){return this.center.add(j),this},equals:function(p){return p.center.equals(this.center)&&p.radius===this.radius}});var rk=b.Math.Frustum=function(k,U,p,r,X,u){this.planes=[k!==_?k:new qf,U!==_?U:new qf,p!==_?p:new qf,r!==_?r:new qf,X!==_?X:new qf,u!==_?u:new qf]};x.assign(rk.prototype,{set:function(x,D,n,Y,i,H){var e=this.planes;return e[0].copy(x),e[1].copy(D),e[2].copy(n),e[3].copy(Y),e[4].copy(i),e[5].copy(H),this},clone:function(){return(new this.constructor).copy(this)},copy:function(G){for(var z=this.planes,b=0;6>b;b++)z[b].copy(G.planes[b]);return this},setFromMatrix:function(y){var r=this.planes,X=y.el,O=X[0],N=X[1],v=X[2],h=X[3],k=X[4],t=X[5],m=X[6],L=X[7],T=X[8],A=X[9],n=X[10],Q=X[11],u=X[12],g=X[13],w=X[14],E=X[15];return r[0].setComponents(h-O,L-k,Q-T,E-u).normalize(),r[1].setComponents(h+O,L+k,Q+T,E+u).normalize(),r[2].setComponents(h+N,L+t,Q+A,E+g).normalize(),r[3].setComponents(h-N,L-t,Q-A,E-g).normalize(),r[4].setComponents(h-v,L-m,Q-n,E-w).normalize(),r[5].setComponents(h+v,L+m,Q+n,E+w).normalize(),this},intersectsObject:function(){var O=new oh;return function(I){var M=I.geometry;return null===M.boundingSphere&&M.computeBoundingSphere(),O.copy(M.boundingSphere).applyMatrix4(I.matrixWorld),this.intersectsSphere(O)}}(),intersectsSprite:function(){var F=new oh;return function(C){return F.center.set(0,0,0),F.radius=.7071067811865476,F.applyMatrix4(C.matrixWorld),this.intersectsSphere(F)}}(),intersectsSphere:function(C){for(var a=this.planes,n=C.center,O=-C.radius,W=0;6>W;W++){var q=a[W].distanceToPoint(n);if(O>q)return!1}return!0},intersectsBox:function(){var N=new id;return function(A){for(var V=this.planes,R=0;6>R;R++){var j=V[R];if(N.x=j.normal.x>0?A.max.x:A.min.x,N.y=j.normal.y>0?A.max.y:A.min.y,N.z=j.normal.z>0?A.max.z:A.min.z,j.distanceToPoint(N)<0)return!1}return!0}}(),containsPoint:function(Y){for(var m=this.planes,S=0;6>S;S++)if(m[S].distanceToPoint(Y)<0)return!1;return!0}});var El=b.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};x.assign(El.prototype,{set:function(p,t,r,D,m,R,N,w,i,S,C,q,e,P,W,d){var b=this.el;return b[0]=p,b[4]=t,b[8]=r,b[12]=D,b[1]=m,b[5]=R,b[9]=N,b[13]=w,b[2]=i,b[6]=S,b[10]=C,b[14]=q,b[3]=e,b[7]=P,b[11]=W,b[15]=d,this},clone:function(){return(new El).fromArray(this.el)},fromArray:function(T,d){d===_&&(d=0);for(var y=this.el,f=0;16>f;f++)y[f]=T[f+d];return this},getElements:function(){return this.el},scale:function(N){var D=this.el,O=N.x,W=N.y,P=N.z;return D[0]*=O,D[4]*=W,D[8]*=P,D[1]*=O,D[5]*=W,D[9]*=P,D[2]*=O,D[6]*=W,D[10]*=P,D[3]*=O,D[7]*=W,D[11]*=P,this},makeRotationFromEuler:function(J){var _=this.el,d=J._x,O=J._y,S=J._z,X=J._order,V=Math.cos(d),i=Math.sin(d),p=Math.cos(O),Q=Math.sin(O),L=Math.cos(S),K=Math.sin(S);if("XYZ"===X){var A=V*L,Y=V*K,M=i*L,o=i*K;_[0]=p*L,_[4]=-p*K,_[8]=Q,_[1]=Y+M*Q,_[5]=A-o*Q,_[9]=-i*p,_[2]=o-A*Q,_[6]=M+Y*Q,_[10]=V*p}else if("YXZ"===X){var r=p*L,a=p*K,I=Q*L,l=Q*K;_[0]=r+l*i,_[4]=I*i-a,_[8]=V*Q,_[1]=V*K,_[5]=V*L,_[9]=-i,_[2]=a*i-I,_[6]=l+r*i,_[10]=V*p}else if("ZXY"===X){var r=p*L,a=p*K,I=Q*L,l=Q*K;_[0]=r-l*i,_[4]=-V*K,_[8]=I+a*i,_[1]=a+I*i,_[5]=V*L,_[9]=l-r*i,_[2]=-V*Q,_[6]=i,_[10]=V*p}else if("ZYX"===X){var A=V*L,Y=V*K,M=i*L,o=i*K;_[0]=p*L,_[4]=M*Q-Y,_[8]=A*Q+o,_[1]=p*K,_[5]=o*Q+A,_[9]=Y*Q-M,_[2]=-Q,_[6]=i*p,_[10]=V*p}else if("YZX"===X){var k=V*p,R=V*Q,B=i*p,y=i*Q;_[0]=p*L,_[4]=y-k*K,_[8]=B*K+R,_[1]=K,_[5]=V*L,_[9]=-i*L,_[2]=-Q*L,_[6]=R*K+B,_[10]=k-y*K}else if("XZY"===X){var k=V*p,R=V*Q,B=i*p,y=i*Q;_[0]=p*L,_[4]=-K,_[8]=Q*L,_[1]=k*K+y,_[5]=V*L,_[9]=R*K-B,_[2]=B*K-R,_[6]=i*L,_[10]=y*K+k}return _[3]=0,_[7]=0,_[11]=0,_[12]=0,_[13]=0,_[14]=0,_[15]=1,this},makeRotationFromQuaternion:function(S){var M=this.el,P=S._x,D=S._y,a=S._z,W=S._w,Z=P+P,j=D+D,l=a+a,p=P*Z,x=P*j,J=P*l,A=D*j,L=D*l,f=a*l,r=W*Z,O=W*j,z=W*l;return M[0]=1-(A+f),M[4]=x-z,M[8]=J+O,M[1]=x+z,M[5]=1-(p+f),M[9]=L-r,M[2]=J-O,M[6]=L+r,M[10]=1-(p+A),M[3]=0,M[7]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(t){var V=this.el,A=t.el,m=A[0],k=A[1],g=A[2],s=A[3],x=A[4],Y=A[5],S=A[6],F=A[7],X=A[8],h=A[9],d=A[10],B=A[11],G=A[12],W=A[13],Z=A[14],C=A[15],f=h*Z*F-W*d*F+W*S*B-Y*Z*B-h*S*C+Y*d*C,c=G*d*F-X*Z*F-G*S*B+x*Z*B+X*S*C-x*d*C,o=X*W*F-G*h*F+G*Y*B-x*W*B-X*Y*C+x*h*C,L=G*h*S-X*W*S-G*Y*d+x*W*d+X*Y*Z-x*h*Z,R=m*f+k*c+g*o+s*L;if(0===R)return this.identity();var D=1/R;return V[0]=f*D,V[1]=(W*d*s-h*Z*s-W*g*B+k*Z*B+h*g*C-k*d*C)*D,V[2]=(Y*Z*s-W*S*s+W*g*F-k*Z*F-Y*g*C+k*S*C)*D,V[3]=(h*S*s-Y*d*s-h*g*F+k*d*F+Y*g*B-k*S*B)*D,V[4]=c*D,V[5]=(X*Z*s-G*d*s+G*g*B-m*Z*B-X*g*C+m*d*C)*D,V[6]=(G*S*s-x*Z*s-G*g*F+m*Z*F+x*g*C-m*S*C)*D,V[7]=(x*d*s-X*S*s+X*g*F-m*d*F-x*g*B+m*S*B)*D,V[8]=o*D,V[9]=(G*h*s-X*W*s-G*k*B+m*W*B+X*k*C-m*h*C)*D,V[10]=(x*W*s-G*Y*s+G*k*F-m*W*F-x*k*C+m*Y*C)*D,V[11]=(X*Y*s-x*h*s-X*k*F+m*h*F+x*k*B-m*Y*B)*D,V[12]=L*D,V[13]=(X*W*g-G*h*g+G*k*d-m*W*d-X*k*Z+m*h*Z)*D,V[14]=(G*Y*g-x*W*g-G*k*S+m*W*S+x*k*Z-m*Y*Z)*D,V[15]=(x*h*g-X*Y*g+X*k*S-m*h*S-x*k*d+m*Y*d)*D,this},makeRotationAxis:function(n,O){var Y=Math.cos(O),Q=Math.sin(O),S=1-Y,g=n.x,B=n.y,F=n.z,l=S*g,$=S*B;return this.set(l*g+Y,l*B-Q*F,l*F+Q*B,0,l*B+Q*F,$*B+Y,$*F-Q*g,0,l*F-Q*B,$*F+Q*g,S*F*F+Y,0,0,0,0,1),this},multiply:function(_){return this.multiplyMatrices(this,_)},premultiply:function(M){return this.multiplyMatrices(M,this)},multiplyMatrices:function(A,m){var $=A.el,B=m.el,l=this.el,h=$[0],Z=$[4],s=$[8],j=$[12],i=$[1],o=$[5],N=$[9],u=$[13],G=$[2],b=$[6],f=$[10],I=$[14],V=$[3],C=$[7],H=$[11],O=$[15],S=B[0],k=B[4],w=B[8],U=B[12],e=B[1],t=B[5],g=B[9],P=B[13],n=B[2],M=B[6],y=B[10],E=B[14],T=B[3],Q=B[7],r=B[11],c=B[15];return l[0]=h*S+Z*e+s*n+j*T,l[4]=h*k+Z*t+s*M+j*Q,l[8]=h*w+Z*g+s*y+j*r,l[12]=h*U+Z*P+s*E+j*c,l[1]=i*S+o*e+N*n+u*T,l[5]=i*k+o*t+N*M+u*Q,l[9]=i*w+o*g+N*y+u*r,l[13]=i*U+o*P+N*E+u*c,l[2]=G*S+b*e+f*n+I*T,l[6]=G*k+b*t+f*M+I*Q,l[10]=G*w+b*g+f*y+I*r,l[14]=G*U+b*P+f*E+I*c,l[3]=V*S+C*e+H*n+O*T,l[7]=V*k+C*t+H*M+O*Q,l[11]=V*w+C*g+H*y+O*r,l[15]=V*U+C*P+H*E+O*c,this},lookAt:function(){var f=new id;return function(G,L,c){return f.subVectors(G,L),this.lookAtDirection(f,c)}}(),lookAtDirection:function(){var s=new id,V=new id,e=new id;return function(d,o){o||(o=id.UP);var w=this.el;return e.copy(d),0===e.lengthSq()&&(e.z=1),e.normalize(),s.crossVectors(o,e),0===s.lengthSq()&&(1===Math.abs(o.z)?e.x+=1e-4:e.z+=1e-4,e.normalize(),s.crossVectors(o,e)),s.normalize(),V.crossVectors(e,s),w[0]=s.x,w[4]=V.x,w[8]=e.x,w[1]=s.y,w[5]=V.y,w[9]=e.y,w[2]=s.z,w[6]=V.z,w[10]=e.z,this}}(),extractScale:function(){var X;return function(Y){X===_&&(X=new id),Y===_&&(Y=new id);var k=X.setFromMatrixColumn(this,0).length(),c=X.setFromMatrixColumn(this,1).length(),Z=X.setFromMatrixColumn(this,2).length();return Y.set(k,c,Z),Y}}(),extractRotation:function(){var y;return function(Z){y===_&&(y=new id),Z===_&&(Z=new El);var X=this.el,q=Z.el,C=1/y.setFromMatrixColumn(Z,0).length(),m=1/y.setFromMatrixColumn(Z,1).length(),l=1/y.setFromMatrixColumn(Z,2).length();return X[0]=q[0]*C,X[1]=q[1]*C,X[2]=q[2]*C,X[4]=q[4]*m,X[5]=q[5]*m,X[6]=q[6]*m,X[8]=q[8]*l,X[9]=q[9]*l,X[10]=q[10]*l,this}}(),multiplyScalar:function(z){var b=this.el;return b[0]*=z,b[4]*=z,b[8]*=z,b[12]*=z,b[1]*=z,b[5]*=z,b[9]*=z,b[13]*=z,b[2]*=z,b[6]*=z,b[10]*=z,b[14]*=z,b[3]*=z,b[7]*=z,b[11]*=z,b[15]*=z,this},getPosition:function(e){return e===_&&(e=new id),e.setFromMatrixColumn(this,3)},setPosition:function($){var q=this.el;return q[12]=$.x,q[13]=$.y,q[14]=$.z,this},toArray:function(D,K){D===_&&(D=[]),K===_&&(K=0);var j=this.el;return D[K]=j[0],D[K+1]=j[1],D[K+2]=j[2],D[K+3]=j[3],D[K+4]=j[4],D[K+5]=j[5],D[K+6]=j[6],D[K+7]=j[7],D[K+8]=j[8],D[K+9]=j[9],D[K+10]=j[10],D[K+11]=j[11],D[K+12]=j[12],D[K+13]=j[13],D[K+14]=j[14],D[K+15]=j[15],D},determinant:function(){var n=this.el,Z=n[0],y=n[4],z=n[8],M=n[12],A=n[1],m=n[5],g=n[9],l=n[13],k=n[2],Y=n[6],x=n[10],q=n[14],R=n[3],b=n[7],j=n[11],G=n[15];return R*(+M*g*Y-z*l*Y-M*m*x+y*l*x+z*m*q-y*g*q)+b*(+Z*g*q-Z*l*x+M*A*x-z*A*q+z*l*k-M*g*k)+j*(+Z*l*Y-Z*m*q-M*A*Y+y*A*q+M*m*k-y*l*k)+G*(-z*m*k-Z*g*Y+Z*m*x+z*A*Y-y*A*x+y*g*k)},copy:function(z){var F=this.el,a=z.el;return F[0]=a[0],F[1]=a[1],F[2]=a[2],F[3]=a[3],F[4]=a[4],F[5]=a[5],F[6]=a[6],F[7]=a[7],F[8]=a[8],F[9]=a[9],F[10]=a[10],F[11]=a[11],F[12]=a[12],F[13]=a[13],F[14]=a[14],F[15]=a[15],this},compose:function(r,i,t){var E=this.el,o=i._x,I=i._y,w=i._z,L=i._w,T=o+o,j=I+I,C=w+w,Y=o*T,p=o*j,V=o*C,h=I*j,u=I*C,g=w*C,B=L*T,c=L*j,d=L*C,O=t.x,M=t.y,Q=t.z;return E[0]=(1-(h+g))*O,E[1]=(p+d)*O,E[2]=(V-c)*O,E[3]=0,E[4]=(p-d)*M,E[5]=(1-(Y+g))*M,E[6]=(u+B)*M,E[7]=0,E[8]=(V+c)*Q,E[9]=(u-B)*Q,E[10]=(1-(Y+h))*Q,E[11]=0,E[12]=r.x,E[13]=r.y,E[14]=r.z,E[15]=1,this},decompose:function(){var x=new id,W=new El;return function(f,a,l){var J=this.el,O=x.set(J[0],J[1],J[2]).length(),T=x.set(J[4],J[5],J[6]).length(),y=x.set(J[8],J[9],J[10]).length(),c=this.determinant();0>c&&(O=-O),f.x=J[12],f.y=J[13],f.z=J[14],W.copy(this);var N=1/O,k=1/T,H=1/y;return W.el[0]*=N,W.el[1]*=N,W.el[2]*=N,W.el[4]*=k,W.el[5]*=k,W.el[6]*=k,W.el[8]*=H,W.el[9]*=H,W.el[10]*=H,a.setFromRotationMatrix(W),l.x=O,l.y=T,l.z=y,this}}()});var Wr=b.Math.Triangle=function(T,d,m){this.a=T!==_?T:new id,this.b=d!==_?d:new id,this.c=m!==_?m:new id};x.assign(Wr,{barycoordFromPoint:function(){var Z=new id,M=new id,U=new id;return function(f,m,X,t,o){Z.subVectors(t,m),M.subVectors(X,m),U.subVectors(f,m);var g=Z.dot(Z),l=Z.dot(M),$=Z.dot(U),b=M.dot(M),B=M.dot(U),N=g*b-l*l,A=o||new id;if(0===N)return A.set(-2,-1,-1);var h=1/N,i=(b*$-l*B)*h,_=(g*B-l*$)*h;return A.set(1-i-_,_,i)}}(),uvIntersection:function(){var P=new id;return function(j,a,x,F,o,e,G){return Wr.barycoordFromPoint(j,a,x,F,P),o.multiplyScalar(P.x),e.multiplyScalar(P.y),G.multiplyScalar(P.z),o.add(e).add(G),o.clone()}}()});var Vp=b.Math.Euler=function(m,L,$,Z,b){this.set(m,L,$,Z,b)};Vp.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Vp.DefaultOrder="XYZ",Vp.ReverseOrder=function(){var A={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(w){return A[w]}}(),x.defineProperties(Vp.prototype,{x:{get:function(){return this._x},set:function(x){this._x=x,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(Z){this._y=Z,this.onChangeCallback()}},z:{get:function(){return this._z},set:function($){this._z=$,this.onChangeCallback()
}},order:{get:function(){return this._order},set:function(_){this._order=_,this.onChangeCallback()}}}),x.assign(Vp.prototype,{set:function(E,P,C,A,V){return oi(E)&&(V=C,A=P,C=E[2],P=E[1],E=E[0]),A?V&&(A=Vp.ReverseOrder(A)):A="ZYX",this._x=E||0,this._y=P||0,this._z=C||0,this._order=A||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(s){return this._x=s._x,this._y=s._y,this._z=s._z,this._order=s._order,this.onChangeCallback(),this},setFromRotationMatrix:function(A,Z,q){var a=b.Math.clamp,p=A.el||A,M=p[0],$=p[4],F=p[8],c=p[1],B=p[5],w=p[9],H=p[2],Q=p[6],z=p[10];return Z=Z||this._order,"XYZ"===Z?(this._y=Math.asin(a(F,-1,1)),Math.abs(F)<.99999?(this._x=Math.atan2(-w,z),this._z=Math.atan2(-$,M)):(this._x=Math.atan2(Q,B),this._z=0)):"YXZ"===Z?(this._x=Math.asin(-a(w,-1,1)),Math.abs(w)<.99999?(this._y=Math.atan2(F,z),this._z=Math.atan2(c,B)):(this._y=Math.atan2(-H,M),this._z=0)):"ZXY"===Z?(this._x=Math.asin(a(Q,-1,1)),Math.abs(Q)<.99999?(this._y=Math.atan2(-H,z),this._z=Math.atan2(-$,B)):(this._y=0,this._z=Math.atan2(c,M))):"ZYX"===Z?(this._y=Math.asin(-a(H,-1,1)),Math.abs(H)<.99999?(this._x=Math.atan2(Q,z),this._z=Math.atan2(c,M)):(this._x=0,this._z=Math.atan2(-$,B))):"YZX"===Z?(this._z=Math.asin(a(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-w,B),this._y=Math.atan2(-H,M)):(this._x=0,this._y=Math.atan2(F,z))):"XZY"===Z?(this._z=Math.asin(-a($,-1,1)),Math.abs($)<.99999?(this._x=Math.atan2(Q,B),this._y=Math.atan2(F,M)):(this._x=Math.atan2(-w,z),this._y=0)):console.warn("unsupported order: "+Z),this._order=Z,q!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var K=new El;return function(Z,E,U){return K.makeRotationFromQuaternion(Z),this.setFromRotationMatrix(K,E,U)}}(),setFromVector3:function(G,B){return this.set(G.x,G.y,G.z,B||this._order)},reorder:function(){var v=new ql;return function(B){return v.setFromEuler(this),this.setFromQuaternion(v,B)}}(),equals:function(Z){return Z._x===this._x&&Z._y===this._y&&Z._z===this._z&&Z._order===this._order},fromArray:function(F){return this._x=F[0],this._y=F[1],this._z=F[2],F[3]!==_&&(this._order=F[3]),this.onChangeCallback(),this},toArray:function(w,P){return w===_&&(w=[]),P===_&&(P=0),w[P]=this._x,w[P+1]=this._y,w[P+2]=this._z,w[P+3]=this._order,w},toVector3:function(m){return m?m.set(this._x,this._y,this._z):new id(this._x,this._y,this._z)},onChange:function(C){return this.onChangeCallback=C,this},onChangeCallback:function(){}});var Im={ms_ac:function(_,b){for(var Q=b.ms_ac,F=0;F<Q.length;F++)Lf(_,Q[F])},ms_listener:function(h){h.addListeners=function(){var W=this,M=hb;C.mockTouch&&(M=Ze.concat(xb).concat(fi)),W.__events__=M;for(var N=0,U=M.length;U>N;N++){var A=M[N];"wheel"===A&&!W.handle_wheel&&W.handle_mousewheel&&(W.handle_wheel=function(V){Nd(W,V)}),W["handle_"+A]&&eh(A,W.getView(),W)}},h.removeListeners=function(){var L=this,H=L.__events__;if(H){L.__events__=_;for(var p=0,$=H.length;$>p;p++)L["handle_"+H[p]]&&Lk(H[p],L.getView(),L)}}},ms_fire:function(f){f.mp=function(M,z,F){this.addPropertyChangeListener(M,z,F)},f.ump=function(j,l){this.removePropertyChangeListener(j,l)},f.fp=function(m,B,G,O,p){return this.firePropertyChange(m,B,G,O,p)},f.addPropertyChangeListener=function(S,J,l){var $=this;$._62I||($._62I=new $p),$._62I.add(S,J,l)},f.removePropertyChangeListener=function(V,p){this._62I&&this._62I.remove(V,p)},f.firePropertyChange=function(M,N,w,m,P){if(m){if(m(N,w))return!1}else if(N===w)return!1;var H=this,l=P||{};return l.property=M,l.oldValue=N,l.newValue=w,l.source=H,l.data=H,H._62I&&H._62I.fire(l),H.onPropertyChanged&&H.onPropertyChanged(l),!0}},ms_attr:function(y){y.a=function(k,t){var w=this;if(2===arguments.length)w.setAttr(k,t);else{if(!vp(k))return w.getAttr(k);for(var o in k)w.setAttr(o,k[o])}return w},y.getAttr=function(e,x){if(x===_&&(x=1),this._attrObject&&e in this._attrObject)return this._attrObject[e];if(this.getImage){var K=this.getImage();if(am(K)&&(K=Nf[K]),vp(K)&&"dataBindings"in K)for(var g=K.dataBindings,w=g.length-1;w>=0;w--){var s=g[w];if(s.attr===e){if("defaultValue"in s)return s.defaultValue;break}}}return x?H[e]:_},y.setAttr=function(p,G){var M=this;M._attrObject||(M._attrObject={});var y=M._attrObject[p];G===_?delete M._attrObject[p]:M._attrObject[p]=G,M.fp&&M.fp("a:"+p,y,G)&&M.onAttrChanged&&M.onAttrChanged(p,y,G)},y.getSerializableAttrs=function(){var t,E={};for(t in this._attrObject)E[t]=1;return E}},ms_bnb:function(b){b.getBodyColor=function(r){return r.s("body.color")},b.getBorderColor=function(x){return x.s("border.color")}},_51o:function(k){k.mi=function(n,E,u){this.addInteractorListener(n,E,u)},k.umi=function(T,q){this.removeInteractorListener(T,q)},k.fi=function(q){this.fireInteractorEvent(q)},k.addInteractorListener=function(T,e,w){var K=this;K._63I||(K._63I=new $p),K._63I.add(T,e,w)},k.removeInteractorListener=function(g,i){this._63I&&this._63I.remove(g,i)},k.fireInteractorEvent=function(c){this._63I&&this._63I.fire(c)},k.setInteractors=function(p){var V=this,e=V._interactors;e&&e.each(function(y){y.tearDown()}),oi(p)&&(p=new Qd(p)),V._interactors=p,p&&p.each(function(N){N.setUp()}),V.fp("interactors",e,p),V.invalidateSelection()},k.getInteractors=function(){return this._interactors}},_49o:function(w){w._44O=Q,w._45O=Q,w.getTopPainters=function(){return this._44O},w.getBottomPainters=function(){return this._45O},w.addTopPainter=function(Y){var b=this;b._44O||(b._44O=new Qd),b._44O.contains(Y)||(b._44O.add(Y),b.redraw&&b.redraw())},w.removeTopPainter=function(A){var K=this;K._44O&&(K._44O.remove(A),K.redraw&&K.redraw())},w.addBottomPainter=function(h){var b=this;b._45O||(b._45O=new Qd),b._45O.contains(h)||(b._45O.add(h),b.redraw&&b.redraw())},w.removeBottomPainter=function(b){var D=this;D._45O&&(D._45O.remove(b),D.redraw&&D.redraw())},w._93db=function(h,A){var J=this;J._45O&&J._45O.each(function(i){i.draw?i.draw(h,A):i.call(J,h,A)})},w._92db=function(I,p){var C=this;C._44O&&C._44O.each(function(E){E.draw?E.draw(I,p):E.call(C,I,p)})}},ms_sm:function(q){q.sm=function(){return this.getSelectionModel()},q.setSelectableFunc=function(K){this.sm().setFilterFunc(K)},q.getSelectableFunc=function(){return this.sm().getFilterFunc()},q.getSelectionModel=function(){var o=this;return o._selectionModel?o._selectionModel:o.dm().sm()},q.isSelectionModelShared=function(){return!this._selectionModel},q.setSelectionModelShared=function(k){var D=this,P=D.sm(),r=!D._selectionModel,Z=D.handleSelectionChange,f=D.dm();r!==k&&(D.invalidateSelection&&D.invalidateSelection(),k?(f.sm().ms(Z,D),D._selectionModel.ums(Z,D),D._selectionModel.dispose(),D._selectionModel=Q):(f.sm().ums(Z,D),D._selectionModel=new dp(f),D._selectionModel.ms(Z,D)),D.onSelectionModelSharedChanged(),D.fp("selectionModelShared",r,k),D.fireViewEvent({kind:"selectionModelSharedChange",oldValue:r,newValue:k,oldSelectionModel:P,newSelectionModel:D.sm()}))},q.onSelectionModelSharedChanged=function(){var x=this;x.redraw(),x.invalidateSelection&&x.invalidateSelection()},q.removeSelection=function(){var X=this.dm();X.beginTransaction(),this.sm().toSelection().each(X.remove,X),X.endTransaction()},q.selectAll=function(){var k=this;k.sm().ss(k.dm().toDatas(function(J){return k.isVisible(J)&&k.isSelectable(J)}))},q.isSelected=function(p){return this.sm().co(p)},q.isSelectedById=function(o){var j=this.dm().getDataById(o);return j?this.isSelected(j):!1},q.isSelectable=function(A){return this.sm().isSelectable(A)}},ms_tx:function(C){C._64I=0,C._65O=0,C.isScrollable=function(){return this.getWidth()<this._64I},C._40o=function(){return this.isScrollable()},C.getLogicalPoint=function(_){return ag(_,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},C.tx=function(D){return D===_?this.getTranslateX():(this.setTranslateX(D),void 0)},C.getTranslateX=function(){return this._65O},C.setTranslateX=function(d){var F=this,v=F.getWidth()-F._64I;v>d&&(d=v),d>0&&(d=0),d=u(d);var p=F._65O;F._65O=d,F.fp(Kn,p,d)}},ms_ty:function(x){x._23Q=0,x._66O=0,x._41o=function(){return this.getHeight()<this._23Q},x.getLogicalPoint=function(r){return ag(r,this._canvas||this._view,this.tx?this.tx():0,this.ty())},x.ty=function(l){return l===_?this.getTranslateY():(this.setTranslateY(l),void 0)},x.getTranslateY=function(){return this._66O},x.setTranslateY=function(D){var a=this,g=a.getHeight()-a._23Q;g>D&&(D=g),D>0&&(D=0),D=u(D);var H=a._66O;a._66O=D,a.fp(Dr,H,D)}},ms_txy:function(Z){Z._65O=0,Z._66O=0,Z.tx=function(l){return l===_?this.getTranslateX():(this.setTranslateX(l),void 0)},Z.ty=function(r){return r===_?this.getTranslateY():(this.setTranslateY(r),void 0)},Z.onTranslateEnded=function(){},Z.setTranslate=function(S,L,b){var z=this;if(b=Fl(b)){z._65I&&z._65I.stop(!0);var H=z.tx(),c=z.ty();b.action=function(T){z.setTranslate(H+(S-H)*T,c+(L-c)*T)},b._37o=function(){delete z._66I,delete z._65I,z.onTranslateEnded()},z._66I=1,z._65I=Po(b)}else z.tx(S),z.ty(L)},Z.getTranslateX=function(){return this._65O},Z.setTranslateX=function(O){var X=this;O=X.adjustTranslateX(O);var s=X._65O;X._65O=O,X.fp(Kn,s,O)},Z.getTranslateY=function(){return this._66O},Z.setTranslateY=function(B){var Y=this;B=Y.adjustTranslateY(B);var h=Y._66O;Y._66O=B,Y.fp(Dr,h,B)},Z.adjustTranslateX=function(M){return u(M)},Z.adjustTranslateY=function(o){return u(o)},Z.translate=function(o,I,i){this.setTranslate(this.tx()+o,this.ty()+I,i)},Z.getLogicalPoint=function(M){var c=this;return ag(M,this._canvas||c._view,c.tx(),c.ty())}},ms_dm:function(g){g.dm=function(g){return g?(this.setDataModel(g),void 0):this.getDataModel()},g.getDataModel=function(){return this._dataModel}},ms_lp:function(_){_.lp=function(h){return this.getLogicalPoint(h)}},ms_v:function(v){v._disabled=!1,v.setDisabled=function(S,q){var g=this,K=g._disabled;K!==S&&(K&&(hg(g._63O),delete g._63O),S&&(zk(g._view,g._63O=en(q)),g.iv()),g._disabled=S,g.fp("disabled",K,S))},v.isDisabled=function(){return this._disabled},v.getDisabledDiv=function(){return this._63O},v.getView=function(){return this._view},v.addToDOM=function(I){var d=this,h=d.getView(),p=h.style;I=I||L.body,I.appendChild(h),p.left="0",p.right="0",p.top="0",p.bottom="0",W(B,"resize",function(){d.iv()}),d.iv()},v.setCursor=function(S){"default"===S&&(S=this._defaultCursor||S);var m=this.getView().style;m.cursor=S,m.cursor="-webkit-"+S,m.cursor="-moz-"+S},v.getWidth=function(){return this._view.clientWidth},v.getHeight=function(){return this._view.clientHeight},v.setWidth=function(z){var s=this;s._view.style.width=z+jf,s.iv(),s.fp&&s.fp(Od,Q,z)},v.setHeight=function(b){var K=this;K._view.style.height=b+jf,K.iv(),K.fp&&K.fp(pe,Q,b)},v.setFocus=function(F){var i=this,L=i._currentEditor;return F&&L&&(L.getView&&(L=L.getView()),L.contains(F.target))?!1:(hp(i._view),i.endEditing&&i.endEditing(),i.fireViewEvent("focus"),!0)},v.iv=function(K){this.invalidate(K)},v.invalidate=function(Y){var I=this;I._68I||(I._68I=1,Pq(I.validate,I,Q,Y),I.onInvalidated&&I.onInvalidated(),I.fireViewEvent("invalidate"))},v.validate=function(){var P=this,B=P._view;if(P._68I&&(delete P._68I,B.parentNode))if(0===B.offsetWidth&&0===B.offsetHeight&&P._67I!==Q)P._67I===_&&(P._67I=C.reinvalidateCount),P._67I>0?P._67I--:P._67I=Q,P.iv();else{P.fireViewEvent("beginValidate"),P.validateImpl(),P.onValidated&&P.onValidated(),P.fireViewEvent("validate");var i=P._63O;i&&(B.lastChild!==i&&(hg(i),zk(B,i)),xg(i,0,0,P.getWidth(),P.getHeight())),we(P),Gf(P),$q(P)}},v.layout=function(x,H,b,z){1===arguments.length?xg(this,x):xg(this,x,H,b,z)},v.addViewListener=function(l,t,v){var c=this;c._67O||(c._67O=new $p),c._67O.add(l,t,v)},v.removeViewListener=function(k,y){this._67O.remove(k,y)},v.fireViewEvent=function(M){var T=this;T._67O&&(am(M)&&(M={kind:M}),T._67O.fire(M)),C.viewListener&&C.viewListener(T,M)}},ms_tip:function(p){p.setToolTipEnabled=function(R){var k=this;R?Ap||k._13o||(k.enableToolTip(),k.fp("toolTipEnabled",!1,!0)):k._13o&&(k.disableToolTip(),k.fp("toolTipEnabled",!0,!1))},p.isToolTipEnabled=function(){return!!this._13o},p.enableToolTip=function(){var A=this;if(!Ap&&!A._13o){A._13o=function(m){var a=A.getToolTip(m);a!=Q?(C.toolTipContinual&&C.isToolTipShowing()?Hi(m,a):(zn(),Sj={timeout:Eg(Ai,Zd),e:m,info:a}),jd={e:m,view:A}):zn()};var v=A.getView();W(v,rl,A._13o),W(v,"mouseleave",C.hideToolTip)}},p.disableToolTip=function(){var P=this;if(P._13o){var Z=P.getView();R(Z,rl,P._13o),R(Z,"mouseleave",C.hideToolTip),delete P._13o}},p.getToolTip=function(w){var k=this;if(k.getDataAt){var O=k.getDataAt(w);return O?O.getToolTip():Q}return k.getValue?k.getValue():void 0}},_52o:function(R){R._zoom=1,R._29I=Tm,R.zoomIn=function(z,i){this.setZoom(this._zoom*af,z,i)},R.zoomOut=function(S,n){this.setZoom(this._zoom/af,S,n)},R.zoomReset=function(V,C){this.setZoom(1,V,C)},R.scrollZoomIn=function(T){this.setZoom(this._zoom*Xg,Q,T)},R.scrollZoomOut=function(X){this.setZoom(this._zoom/Xg,Q,X)},R.pinchZoomIn=function(X){this.setZoom(this._zoom*Mn,Q,X)},R.pinchZoomOut=function(W){this.setZoom(this._zoom/Mn,Q,W)},R.adjustZoom=function(n){return Gq>n?Gq:n>rj?rj:n},R.getZoom=function(){return this._zoom},R.setZoom=function(I,$,e){var s=this;if($=Fl($)){s._14o&&s._14o.stop(!0);var L=s._zoom;$.action=function(n){s._96O(L+(I-L)*n,e)},$._37o=function(){delete s._zooming,delete s._14o,s.onZoomEnded()},s._zooming=1,s._14o=Po($)}else s._96O(I,e)},R._96O=function(C,h){var w=this;if(C=w.adjustZoom(C),C!==w._zoom){w.validate();var c=w._29I,u=w._zoom;0!==c.width&&0!==c.height&&(h=h?h:{x:c.x+c.width/2,y:c.y+c.height/2},w.tx((h.x-c.x)*u-h.x*C),w.ty((h.y-c.y)*u-h.y*C)),w._zoom=C,w.fp("zoom",u,C)}}},ms_edge:function(o){o._2I=function(v){var h=this;h._44I||(h._44I=new Qd),h._42I||(h._42I=new Qd),h._44I.add(v),h._42I.add(v),h._20I()},o._4I=function(e){var n=this;n._44I||(n._44I=new Qd),n._43I||(n._43I=new Qd),n._44I.add(e),n._43I.add(e),n._20I()},o._16I=function(g){var $=this;$._44I.remove(g),$._42I.remove(g),$._44I.isEmpty()&&delete $._44I,$._42I.isEmpty()&&delete $._42I,$._20I()},o._18I=function(Z){var h=this;h._44I.remove(Z),h._43I.remove(Z),h._44I.isEmpty()&&delete h._44I,h._43I.isEmpty()&&delete h._43I,h._20I()},o._20I=function(){var c=this;if(delete c._45I,!c._44I||c._44I.isEmpty())return delete c._70O,void 0;var x;c._44I.each(function(o){o.isLooped()&&(x||(x={}),x[o._id]||(c._45I||(c._45I=new Qd),c._45I.add(o),x[o._id]=o))}),x?(c._70O=new Qd,c._44I.each(function(H){x[H._id]?"A"===x[H._id]||(x[H._id]="A",c._70O.add(H)):c._70O.add(H)})):c._70O=c._44I},o.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},o.getSourceAgentEdges=function(){return this._46I},o.getTargetAgentEdges=function(){return this._47I},o._1I=function(W){var z=this;z._46I||(z._46I=new Qd),z._48I||(z._48I=new Qd),z._46I.add(W),z._48I.add(W),z._19I()},o._3I=function(s){var h=this;h._47I||(h._47I=new Qd),h._48I||(h._48I=new Qd),h._47I.add(s),h._48I.add(s),h._19I()},o._15I=function(u){var Y=this;Y._46I.remove(u),Y._48I.remove(u),Y._46I.isEmpty()&&delete Y._46I,Y._48I.isEmpty()&&delete Y._48I,Y._19I()},o._17I=function(P){var E=this;E._47I.remove(P),E._48I.remove(P),E._47I.isEmpty()&&delete E._47I,E._48I.isEmpty()&&delete E._48I,E._19I()},o._19I=function(){var E=this;delete E._49I;var h=E._48I;if(h&&!h.isEmpty()){var z={};h.each(function(j){z[j._id]?E._49I||(E._49I=new Qd):z[j._id]=j}),E._49I?h.each(function(n){z[n._id]&&(E._49I.add(n),delete z[n._id])}):E._49I=h}},o.getLoopedEdges=function(){return this._45I},o.getEdges=function(){return this._70O},o.getAgentEdges=function(){return this._49I},o.getSourceEdges=function(){return this._42I},o.getTargetEdges=function(){return this._43I},o._8I=function(){this._70O&&this._70O.each(function(m){m._7I()})}},ms_shadow:function(z){Ug.PARAMS.forEach(function(b){var X=b.replace(/(^|\.)[a-z]/g,function(g){return g[g.length-1].toUpperCase()}),P=X.charAt(0).toLowerCase()+X.substr(1);z["getShadow"+X]=function(){return this._getShadowParam(P)},z["setShadow"+X]=function(B){this._setShadowParam(P,B)}}),z.enableShadow=function(U){this.shadowMap.setShadow(!0,U)},z.disableShadow=function(){this.shadowMap.setShadow(!1)},z._getShadowParam=function(h){return this.shadowMap.getShadow()[h]},z._setShadowParam=function(F,Q){var t=this._getShadowParam(F),k={};k[F]=Q;var v=this.shadowMap;v.setShadow(v.enable,k),this.firePropertyChange("shadow"+F.charAt(0).toUpperCase()+F.substr(1),t,Q)}}};nd(C,{getVersion:function(){return"7.2.6-dev5"}},!0),nd(C,{numberDigits:5,crossOrigin:"",baseZIndex:_,isTouchable:Ap,mockTouch:!0,devicePixelRatio:B.devicePixelRatio?B.devicePixelRatio:B.screen?B.screen.deviceXDPI/B.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:g.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return xf},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(H){return H*H},labelColor:ub,labelSelectColor:dk,labelFont:"12px arial, sans-serif",widgetIndent:Ap?30:20,widgetRowHeight:Ap?30:20,widgetHeaderHeight:Ap?32:22,widgetTitleHeight:Ap?34:24,scrollBarColor:Dd,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Ap?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Bn,intersectionLineLine:mq,isEnter:Ud,isEsc:ol,isDelete:Qi,isSpace:Uq,isLeft:re,isUp:zc,isRight:ze,isDown:uh,isTouchEvent:rq,getTarget:Vc,isString:am,isNumber:Ho,isBoolean:wb,isArray:oi,isSelectAll:ue,isFunction:np,isObject:vp,getPropertyValue:rs,setPropertyValue:ad,addMethod:nd,createGradient:function(D,S,m,E,i,G,v,J){var s=cn[S];return s(D,m,E,i,G,v,J)},appendToScreen:function(z){z=z.getView?z.getView():z,(L.fullscreenElement||L.mozFullScreenElement||L.webkitFullscreenElement||L.msFullscreenElement||L.body).appendChild(z)},encodeString:function(m){return b.Math.encodeBase64(m,C.encodeStringKey)},decodeString:function(j){return b.Math.decodeBase64(j,C.encodeStringKey)},findView:function(I){var P=function(z,M){var v=M._ht;v&&z.push(v);var H=M.children,y=H.length;if(y)for(var p=0;y>p;p++)P(z,H[p])},s=[];P(s,L.body);var M=function(A,I){for(var $="2d"===I?sl.GraphView:cl.Graph3dView,D=0,d=A.length;d>D;D++)if(A[D]instanceof $)return s[D];return null};return"all"===I?s:"2d"===I?M(s,"2d"):"3d"===I?M(s,"3d"):M(s,"3d")||M(s,"2d")},toggleFullscreen:function(j){var a=j.getView();if(L.fullscreenElement||L.mozFullScreenElement||L.webkitFullscreenElement||L.msFullscreenElement)L.exitFullscreen?L.exitFullscreen():L.msExitFullscreen?L.msExitFullscreen():L.mozCancelFullScreen?L.mozCancelFullScreen():L.webkitExitFullscreen&&L.webkitExitFullscreen();else{var $=!0;if(j.isSelfViewEvent){var R=j.getX(),w=j.getY(),N=j.getWidth(),C=j.getHeight(),G=a.style.background,D=a.style.backgroundColor;G||D||(a.style.backgroundColor="white"),a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen();var Y=setInterval(function(){if(a!==(L.fullscreenElement||L.mozFullScreenElement||L.webkitFullscreenElement||L.msFullscreenElement))clearInterval(Y),j.setX(R),j.setY(w),j.setWidth(N),j.setHeight(C),j._fullscreen=!1,a.style.oldBackgroundColor=D,j.iv();else{var H=b.Default.getWindowInfo();($||H.width!==j.getWidth()||H.height!==j.getHeight())&&(j.setX(H.left),j.setY(H.top),j.setWidth(H.width),j.setHeight(H.height),j._fullscreen=!0,j.iv(),$=!1)}},500)}else{var T=a.style.left,E=a.style.top,N=a.style.width,C=a.style.height,G=a.style.background,D=a.style.backgroundColor;G||D||(a.style.backgroundColor="white"),a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen();var Y=setInterval(function(){if(a!==(L.fullscreenElement||L.mozFullScreenElement||L.webkitFullscreenElement||L.msFullscreenElement))clearInterval(Y),a.style.left=T,a.style.top=E,a.style.width=N,a.style.height=C,a.style.oldBackgroundColor=D,j.iv();else{var A=b.Default.getWindowInfo();($||A.width!==j.getWidth()||A.height!==j.getHeight())&&(xg(j),$=!1)}},500)}}},appendTimeStamp:function(D){return D},setCompType:function(t,Z){am(Z)&&Z.substr(0,12)==Cc&&(Z=C.parse(Z)),np(Z)||vp(Z)?lp[t]=Z:xr(t)},getCompType:function(D){var k=lp[D];return k===_&&up.test(D)&&xr(D),k},getCompTypeMap:function(){return lp},drawCompType:function(z,t,p,c,d,L){z(t,p,c,d,L)},numberListener:function(){var V={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(t){var z=t.keyCode;V[z]||65===z&&C.isCtrlDown(t)||86===z&&C.isCtrlDown(t)||67===z&&C.isCtrlDown(t)||88===z&&C.isCtrlDown(t)||z>=35&&40>=z||(t.shiftKey||48>z||z>57)&&(96>z||z>105)&&t.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(k){var N=k.target.tagName;("DIV"===N||"CANVAS"===N)&&!(C.ignoreKeyCodes.indexOf(k.keyCode)>=0)&&("keydown"!==k.type||re(k)||ze(k)||zc(k)||uh(k)||Qi(k)||65===k.keyCode&&(k.metaKey||k.ctrlKey))&&k.cancelable===!0&&(k.preventDefault(),k.preventManipulation&&k.preventManipulation())},getWindowInfo:function(){var f=L.documentElement,K=f&&(f.scrollLeft||f.scrollTop)?f:L.body;return{target:K,left:K.scrollLeft,top:K.scrollTop,width:B.innerWidth||K.clientWidth,height:B.innerHeight||K.clientHeight}},isDragging:function(){return!!xf},isLeftButton:function(Y){return rq(Y)?!0:0===Y.button},isMiddleButton:function(Q){return rq(Q)?!1:Q&&(1===Q.button||4&(Q.buttons||0))},isRightButton:function(k){return rq(k)?!1:k&&(2===k.button||2&(k.buttons||0))},isInput:function(K){if(!K)return!1;var G=K.tagName;return"INPUT"===G||"TEXTAREA"===G||"SELECT"===G},getTouchCount:function(r){return rq(r)?r.touches.length:1},isDoubleClick:function(){function v(d){d.details=0,d.timeout=null,d.lastPoint=null}var t={};return Le=new Pn,Tq=Le.getTime(),function(k){if(xm(k)>1)return!1;var s=k.button==Q?"":k.button,H=k.type+s,X=H+"_isDoubleClick",O=t[H];if(O||(O=t[H]={details:0,timeout:null,lastPoint:null}),k[X]===_){k[X]=!0;var b=Hf(k);O.timeout&&(qs(O.timeout),O.timeout=null);var R=rq(k)?C.doubleTouchRange:C.doubleClickRange;O.lastPoint&&Ki(O.lastPoint,b)>R&&v(O),O.lastPoint=b,O.details++,O.timeout=Eg(function(){v(this)}.bind(O),C.doubleClickSpeed)}return 2===O.details}}(),isShiftDown:function(n){return n?n.shiftKey:Fr["16"]},isCtrlDown:function(v){return v?bd?v.metaKey:v.ctrlKey:bd?Fr["91"]:Fr["17"]},getClientPoint:function(w){return rq(w)&&(w=nr(w)),{x:w.clientX,y:w.clientY}},isMouseEvent:function(O){return O instanceof MouseEvent||0===O.type.indexOf("mouse")},getTargetElement:function(Q){var f,I=Dc(Q);if(f=C.isMouseEvent(Q)||!L.elementFromPoint?Q.target:L.elementFromPoint(I.x,I.y),nm&&L.elementFromPoint){for(var $=[],j=[];"none"===f.style.pointerEvents;)$.push(f),j.push(f.style.display||""),f.style.display="none",f=L.elementFromPoint(I.x,I.y);$.forEach(function(Y,z){Y.style.display=j[z]})}return f},getPagePoint:function(D){return rq(D)&&(D=nr(D)),{x:D.pageX,y:D.pageY}},createObject:function(O,d){var n=new O;for(var J in d){var U=d[J];if(np(U))n[J]=U;else if(0===J.indexOf("s:"))n.s(J.substr(2),d[J]);else if(0===J.indexOf("a:"))n.a(J.substr(2),d[J]);else{var r=mg(J),U=d[J];n[r]?(n[r](U),"setToolTip"===r&&n.enableToolTip&&n.enableToolTip()):n[J]=U}}return n},setImage:function(q,K,f,H){var F=arguments.length;4===F?ve(q,H,K,f):2===F?am(K)?K.substr(0,12)==Cc?Cq(q,C.parse(K)):ve(q,K):Cq(q,K):1===F&&ve(q,q)},getImage:function(H,r,w){var U;if(H==Q)return Q;if(vp(H)?U=H:(U=Nf[H],H&&U===_&&(Ol&&Ol[H]||ve(H,H))),r&&U&&U.tagName){var e;e="override"===w?"colors_override":"override_rgb"===w?"colors_override_rgb":"override_a"===w?"colors_override_a":"colors",U[e]||(U[e]={__count__:0});var Y=U[e][r];return Y||(U[e].__count__>C.imageCacheThreshold&&(U[e]={__count__:0}),Y=Wp(U,bc(r),U.width,U.height,w),U[e][r]=Y,U[e].__count__++),Y}return U},isImageComplete:function(Z,d,N){var s=Bj(Z);if(!s)return!1;if(s.tagName)return s.complete;for(var f,Z,p,b=s.comps,D=!0,S=0,H=b.length;H>S;S++)if(f=b[S],p=f.type,"image"===f.type){Z=f.name,Z&&Z.func&&(Z=yk(Z,d));var $=cm(Z,d,N);if(!$){D=!1;break}}else if(up.test(p)&&C.getCompType(p)===_){D=!1,xr(p);break}return D},getId:function(){var n=1;return function(){return++n}}(),callLater:function(L,i,J,r){var h=function(){L.apply(i,J)};return r?Eg(h,r):B.requestAnimationFrame(h)},cancelLater:function(M,z){z?qs(M):B.cancelAnimationFrame(M)},clone:function(R){if(null==R||"object"!=typeof R)return R;if(R instanceof Date){var q=new Date;return q.setTime(R.getTime()),q}if(R instanceof Array){for(var q=[],X=0,J=R.length;J>X;X++)q[X]=be(R[X]);return q}if(R instanceof Qd){for(var q=new Qd,X=0,J=R.length;J>X;X++)q.set(X,be(R.get(X)));return q}if(R instanceof mi)return R;if(R instanceof Zi){var q=new Zi;return q.deserialize(R.serialize()),q}if(R instanceof x){var q={};for(var S in R)R.hasOwnProperty(S)&&(q[S]=be(R[S]));return q}return R},callWhenLoaded:function(F,v){v=v||100;var C=gr(F,v);rb||(rb={}),rb[C]={tick:C,cb:F,delay:v}},beforeLoadURL:function(R,L){if(rb){var o={};for(var L in rb){var p=rb[L];qs(p.tick);var h=gr(p.cb,p.delay);o[h]={tick:h,delay:p.delay,cb:p.cb}}rb=o}return C.convertURL?C.convertURL(R,L):R},convertURL:function(d){return d},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return C.getImage("default_blank")},resizeImage:function(o,k,L){L||(L=k);var H=Yp(),_=H.getContext("2d");return $f(H,k,L,1),_.drawImage(o,0,0,k,L),H},resizeImagePOT:function(g,e){if(!g||!g.tagName)return g;var $=g.width,l=g.height;if(!$||!l)return g;if($m.isPOT($)&&$m.isPOT(l)&&(!e||$===l))return g;var Q,R;return e?R=Q=$m.nearestPOT(Math.min($,l)):(Q=$m.nearestPOT($),R=$m.nearestPOT(l)),C.resizeImage(g,Q,R)},sortFunc:function(B,q){if(B===q)return 0;if(B==Q&&q!=Q)return 1;if(B!=Q&&q==Q)return-1;if(B==Q&&q==Q)return 0;var $,m=typeof B,K=typeof q;return m===Nh&&K===Nh?$=B.localeCompare(q):m===_o&&K===_o&&($=B-q),$===_&&($=(""+B).localeCompare(""+q)),$>0?1:0>$?-1:0},getClassMap:function(){return Uh},getClass:function(q){if(am(q)){var J,R=Uh[q];if(!R){J=q.split("."),R=B;for(var _=0;_<J.length;_++)R=R[J[_]];Uh[q]=R}return R}return q},def:function(t,h,X){var o,g,w,F=function(){};if(F.prototype=h.prototype,o=new F,am(t)){if(Uh[t])throw"'"+t+"' already defined";w=ec(t),o.getClassName=function(){return t}}else w=t;if(o.constructor=w,o.getClass=function(){return w},o.getSuperClass=function(){return h},X)for(g in X)Im[g]&&Im.hasOwnProperty(g)?Im[g](o,X):ep(o,X,g);w.prototype=o,w.superClass=h.prototype},startAnim:function(){var k=function(w){w.duration&&(w.startTime=wq()),w.timeId=Pq(w.tick,Q,Q,w.interval)};return function(g){return g=be(g),g.easing=g.easing||C.animEasing,g.duration||g.frames||(g.duration=C.animDuration),g.t=0,g.duration?g.interval=0:(g.frame=0,g.interval=g.interval||10),g.tick=function(){if(g.duration){var l=(wq()-g.startTime)/g.duration;if(l>1&&(l=1),g.t=l,g.action(g.easing(l),l),!g.isRunning())return;1===l?g.stop():g._isPaused||(g.timeId=Pq(g.tick))}else{if(g.frame++,l=g.t=g.frame/g.frames,g.action(g.easing(l),l),!g.isRunning())return;g.frame<g.frames?g._isPaused||(g.timeId=Pq(g.tick,Q,Q,g.interval)):g.stop()}},g.resume=function(){g._isPaused&&(delete g._isPaused,g.duration?g.t<1&&(g.startTime=wq()-g.duration*g.t,g.timeId=Pq(g.tick)):g.frame<g.frames&&(g.timeId=Pq(g.tick,Q,Q,g.interval)))},g.pause=function(){Xr(g.timeId,!g.duration),g._isPaused=!0},g.isPaused=function(){return this._isPaused},g.stop=function(Z){g.isRunning()&&(Xr(g.timeId,!g.duration),delete g.timeId,g.duration?g.t<1&&Z&&(g.t=1,g.action(g.easing(1),1)):g.frame<g.frames&&Z&&(g.frame=g.frames,g.action(g.easing(1),1)),g._37o&&g._37o(),g.finishFunc&&g.finishFunc())},g.isRunning=function(){return g.timeId!=Q},g.delay?Pq(k,Q,[g],g.delay):k(g),g}}(),getTextSize:function(){var g={},M=L?Yp().getContext("2d"):Q;return function(Z,e){M.font=Z?Z:rr;var N=g[M.font];return N||(N=2*M.measureText("e").width+4,g[M.font]=N),{width:M.measureText(e).width+C.textExtraWidth,height:N}}}(),drawText:function(X,Z,l,n,Y,z,F,o,J,O,k){if(Z!=Q){var D=lr(l,Z),T={};T.y=O&&O!==gi?O===Ui?z+D.height/2:z+o-D.height/2:z+o/2,T.x=J&&J!==Mh?J===Xi?Y+F-D.width/2:Y+F/2:Y+D.width/2,vk(X,Z,T,l,n),k&&Vq(X,Z,l,n,T.x,T.y,D.width,k)}},getDistance:function(o,x){var u=o.length;return x?3===u?z(aj(o[0]-x[0])+aj(o[1]-x[1])+aj(o[2]-x[2])):2===u?z(aj(o[0]-x[0])+aj(o[1]-x[1])):o.z===_?z(aj(x.x-o.x)+aj(x.y-o.y)):z(aj(x.x-o.x)+aj(x.y-o.y)+aj(x.z-o.z)):3===u?z(aj(o[0])+aj(o[1])+aj(o[2])):2===u?z(aj(o[0])+aj(o[1])):void 0},brighter:function(t,U){return 0>U&&(U=-U),Pj(t,U?U:40)},darker:function(m,E){return E>0&&(E=-E),Pj(m,E?E:-40)},unionPoint:function(O,q){if(!O)return Q;if(2===arguments.length)return O&&q?{x:F(O.x,q.x),y:F(O.y,q.y),width:D(O.x-q.x),height:D(O.y-q.y)}:Q;var N=O;if(N._as&&(N=N._as),N.length===_)return Q;var i=N.length;if(0>=i)return Q;for(var T=1,B=N[0],t={x:B.x,y:B.y,width:0,height:0};i>T;T++){B=N[T];var X=F(t.x,B.x),M=f(t.x+t.width,B.x),E=F(t.y,B.y),C=f(t.y+t.height,B.y);t.x=X,t.y=E,t.width=M-X,t.height=C-E}return t},unionRect:function(K,S){if(K&&!S)return be(K);if(!K&&S)return be(S);if(K&&S){var j={x:F(K.x,S.x),y:F(K.y,S.y)};return j.width=f(K.x+K.width,S.x+S.width)-j.x,j.height=f(K.y+K.height,S.y+S.height)-j.y,j}return Q},containsPoint:function(V,m,E,N){if(N!=Q&&1!==N){var b=V.x+V.width/2,t=V.y+V.height/2;V={x:b-V.width/2*N,y:t-V.height/2*N,width:V.width*N,height:V.height*N}}if(E){var p=V.width/2,R=V.height/2,r=h(-E),C=j(-E),J=m.x-V.x-p,$=m.y-V.y-R;return m={x:C*J-r*$,y:r*J+C*$},Om({x:-p,y:-R,width:V.width,height:V.height},m)}return!(!V||m.x<V.x||m.y<V.y||m.x>V.x+V.width||m.y>V.y+V.height)},containsRect:function(K,e){if(!K||!e)return!1;var y=e.x,O=e.y,S=e.width,d=e.height,W=K.width,t=K.height;if(0>(W|t|S|d))return!1;var H=K.x,Z=K.y;if(H>y||Z>O)return!1;if(W+=H,S+=y,y>=S){if(W>=H||S>W)return!1}else if(W>=H&&S>W)return!1;if(t+=Z,d+=O,O>=d){if(t>=Z||d>t)return!1}else if(t>=Z&&d>t)return!1;return!0},intersectsRect:function(N,M){if(!N||!M)return!1;var i=M.width,$=M.height,n=N.width,R=N.height;if(0>=n||0>=R||0>=i||0>=$)return!1;var Y=M.x,G=M.y,e=N.x,V=N.y;return n+=e,R+=V,i+=Y,$+=G,n>Y&&R>G&&i>e&&$>V},intersection:function(i,l){if(!i||!l)return Q;var h=l.x,Y=l.y,f=i.x,e=i.y,D=h,L=Y,g=f,J=e;return D+=l.width,L+=l.height,g+=i.width,J+=i.height,f>h&&(h=f),e>Y&&(Y=e),D>g&&(D=g),L>J&&(L=J),D-=h,L-=Y,0>=D||0>=L?Q:{x:h,y:Y,width:D,height:L}},grow:function(j,n,$){$===_&&($=n),j.x-=n,j.y-=$,j.width=j.width+2*n,j.height=j.height+2*$},getScreenPoint:function(f,i,e,Y,P,K,D){var X=e.getBoundingClientRect(),B=f*(K||1)-e.scrollLeft+(Y||0),V=i*(D||1)-e.scrollTop+(P||0),N=vs(e,!1);if(N){var Z=new id(B,V,0);return Z.applyMatrix4(N),console.log(Z),{x:Z.x,y:Z.y}}return{x:B+X.left,y:V+X.top}},getLogicalPoint:function(S,E,C,G,n,l){var X,Z,b=E.getBoundingClientRect();S.target?(Kp(S)?bd?Fr["91"]=!0:Fr["17"]=!0:bd?Fr["91"]=!1:Fr["17"]=!1,Fr["16"]=Xf(S)?!0:!1,S=rq(S)?nr(S):S,X=S.clientX,Z=S.clientY):(X=S.x,Z=S.y);var g=vs(E,!0);if(g){var t=new id(X,Z,0);t.applyMatrix4(g);do{if(Math.abs(t.z)<=1e-6)break;var d=new id(X,Z,1);if(d.applyMatrix4(matrix),Math.abs(d.z)<=1e-6){t=d;break}if(d.sub(t),Math.abs(d.z)<=1e-6)break;t.addScaledVector(d,-t.z/d.z)}while(!1);return{x:(t.x+E.scrollLeft-(C||0))/(n||1),y:(t.y+E.scrollTop-(G||0))/(l||1)}}return{x:(X-b.left+E.scrollLeft-(C||0))/(n||1),y:(Z-b.top+E.scrollTop-(G||0))/(l||1)}},removeHTML:function(){var m;return function($){return $&&$.getView&&($=$.getView()),$&&$.parentNode?m===$?!0:(m=$,$.parentNode.removeChild($),m=Q,!0):!1}}(),getToolTipDiv:function(){if(!mm){mm=jc(),kp=jc();var p=mm.style;C.baseZIndex!=Q&&(p.zIndex=pm(C.baseZIndex)+3+""),p.whiteSpace="nowrap",p.color=C.toolTipLabelColor,p.background=C.toolTipBackground,p.font=C.toolTipLabelFont,p.padding="5px",p.boxShadow="0px 0px 3px "+C.toolTipShadowColor
}return mm},isToolTipShowing:function(){return mm&&mm.parentNode?!0:kp&&kp.parentNode?!0:!1},updateToolTipContent:function(b,j){if(C.isToolTipShowing()&&(j||(j=jd&&jd.view),b===_&&j&&jd.e&&(b=j.getToolTip(jd.e)),b!=Q)){var o;b.html?(b=b.html,o=kp):o=mm,o.innerHTML=b}},hideToolTip:function(){if(C.isToolTipShowing()){hg(mm),hg(kp),Zq();var a=jd&&jd.view;a&&a.onHideToolTip&&a.onHideToolTip(),jd=Q}},showToolTip:function(i,B,$){if(!i||B==Q)return zn(),void 0;C.getToolTipDiv();var G,l;if(B.html?(B=B.html,G=kp,hg(mm)):(G=mm,hg(kp)),l=G.style,G.innerHTML=B,G.parentNode||b.Default.appendToScreen(G),i.target){i=Dc(i);var Y=Yn(),d=i.x,S=i.y,g=Ap?60:12;if(Ap){var U=G.getBoundingClientRect();l.left=d-U.width/2+jf,l.top=S-U.height-g<Y.top?S+g+jf:S-U.height-g+jf}else{l.left=d+g+jf,l.top=S+g+jf;var U=G.getBoundingClientRect();U.left+U.width>Y.width&&(l.left=d-g-U.width+jf),U.top+U.height>Y.height&&(l.top=S-g-U.height+jf),U.left<0&&(l.left=d+g+jf),U.top<0&&(l.top=S+g+jf)}}else l.left=i.x+jf,l.top=i.y+jf;Zq(),$===_?$=jd&&jd.view:jd={e:i,view:$},$&&$.onShowToolTip&&$.onShowToolTip()},startDragging:function(g,f,H){H==_&&(H=!0),g!==xf&&(xf?H&&(rq(f)?xf.handleWindowTouchEnd(f):xf.handleWindowMouseUp(f)):rq(f)?(W(B,He,Cg),W(B,Rr,ic),W(B,"blur",ic)):(W(B,rl,vq),W(B,Tk,pf),W(B,"blur",pf)),xf=g)},getImageMap:function(){return Nf},toBoundaries:function(N,m,Q,f){var O=[];return Mr(N,m,Q,f).forEach(function(S){var p=[];S.forEach(function(x){p.push(x.x,x.y)}),O.push(p)}),O},getCurrentKeyCodeMap:function(){return Fr},drawCenterImage:function(r,x,C,V,R,q,e,G){!R&&q&&q.isSelfViewEvent&&(R=q);var K=ld(x,R,q),F=Sr(x,R,q);Bs(r,x,u(C-K/2),u(V-F/2),K,F,R,q,e,G)},drawStretchImage:function(v,L,k,c,V,N,g,o,_,n,d,M){!o&&_&&_.isSelfViewEvent&&(o=_);var w,U=ld(L,o,_,N),z=Sr(L,o,_,g);"uniform"===k?(w=F(N/U,g/z),U*=w,z*=w,c+=u((N-U)/2),V+=u((g-z)/2),N=U,g=z):"centerUniform"===k&&((U>N||z>g)&&(w=F(N/U,g/z),U*=w,z*=w),c+=u((N-U)/2),V+=u((g-z)/2),N=U,g=z);var p=v.interactiveInfo;if(p){var B;if(B="center"===k?{x:c+N/2-U/2,y:V+g/2-z/2,width:U,height:z}:{x:c,y:V,width:N,height:g},p.rect){var y=p.compInfos,P=y.length;P&&(y[P-1].rect.image=L)}else p.rect=B}if("center"===k){var l=d!==!1&&(U>N||z>g);l&&(v.save(),v.beginPath(),v.rect(c,V,N,g),v.clip()),Bs(v,L,c+N/2-U/2,V+g/2-z/2,U,z,o,_,n,M),l&&v.restore()}else Bs(v,L,c,V,N,g,o,_,n,M)},toCanvas:function($,s,S,G,o,y,v,f,l){$=Bj($,v),s=s||ld($,o),S=S||Sr($,o);var Q=Yp(),M=ob(Q);return f?($f(Q,s,S,f),M.scale(f,f)):$f(Q,s,S,1),_m(M,$,G,0,0,s,S,o,y,v,l),$&&$.clampToEdge&&(Q.clampToEdge=$.clampToEdge),M.restore(),Q},toGrayColor:function(Z){if(!Z)return Z;var X=uq(Z),n=u(.299*X[0]+.587*X[1]+.114*X[2]);return"rgba("+n+","+n+","+n+","+X[3]/255+")"},createGradientImage:function(Z,P,p,W){for(var A=["L",0,0,Z,0,1,0,0,1,0,0],z=0,R=Math.min(P.length,p.length);R>z;z++)A.push(p[z],P[z]);var l=b.Default.toCanvas({width:Z,height:Z,clampToEdge:!0,comps:[{type:"shape",rotation:W||0,points:[0,0,Z,0,Z,Z,0,Z],background:"#ffffff",gradientPack:A}]});return l},createElement:function(l,v,p,r){var G=L.createElement(l);return Rh(G,v||g.widgetBorder,2),G.style.font=p?p:rr,r!=Q&&(G.value=r),C.onElementCreated&&C.onElementCreated(G),G},containedInView:function(I,Z){var $=nb(Z).getBoundingClientRect();return Om({x:$.left,y:$.top,width:$.width,height:$.height},Hf(I))},isIsolating:function(){return Zg>0},setIsolating:function(y){y?Zg++:Zg--},getMSMap:function(){return Im},stringify:function(c,V,P){var a=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var h=Zi.prototype.toJSON;Zi.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},V=P?0:V==Q?2:V;var d=JSON.stringify(c,function(Z,c){return"function"==typeof c?"__ht__"+(c.__ht__||c.toString()):Ho(c)?Rb(c):c instanceof b.List?"__ht__list"+(c.__ht__list||C.stringify(c._as)):c},V);return Date.prototype.toJSON=a,Zi.prototype.toJSON=h,P&&(d=Cc+bq(d)),d},parse:function(q,P){return am(q)?q.substr(0,12)!=Cc||(q=Kj(q.substr(12)),am(q))?(P=P||{},JSON.parse(q,function(I,l){if(am(l))if(P.ignoreFunction||"__ht__function"!=l.substr(0,14)){if(!P.ignoreDate&&"__ht__date"==l.substr(0,10))return new Date(pm(l.substr(10)));if("__ht__list"===l.substr(0,10))return new Qd(C.parse(l.substr(10)));if(!P.ignoreDataModel&&"__ht__dataModel"===l.substr(0,15)){var m=new Zi;return m.deserialize(C.parse(l.substr(15))),m}}else{var K=l.indexOf("{")+1,q=l.lastIndexOf("}"),G=l.indexOf("(")+1,j=l.indexOf(")");if(K&&q&&G&&j)try{var Z=new Function(l.substring(G,j),l.substring(K,q));return Z.__ht__=l.substr(6),Z}catch(W){throw console.info("=== SyntaxError ===\n",l),W}}return l})):q:q},loadJS:function(k,n){n&&k.push(n);var T=k.shift();if(oi(T))k=T.contact(k),C.loadJS(k);else if(np(T))T(),C.loadJS(k);else if(am(T)){var J=L.createElement("script");J.onload=function(){C.loadJS(k)},J.setAttribute("src",T),L.getElementsByTagName("head")[0].appendChild(J)}else k.length&&C.loadJS(k)},extendClass:function(R,A){var r=R.prototype;for(var F in A)Im[F]&&Im.hasOwnProperty(F)?Im[F](r,A):r[F]=A[F]},toRoundedCorner:function(){function z(c,P,B){c.x=P.x,c.y=P.e||B,c.z=P.y}var n=new id,p=new id,B=new id,k=new id;return function(g,b){var T,M=0;g.getPoints&&(M=g.getElevation(),g=g.getPoints()),T=g instanceof Qd?g:new Qd(g);var q=T.size();if(0>=b)return{points:T};var s=new Qd,Q=new Qd,w=T.get(0);z(n,w,M),s.add(w),Q.add(1);for(var v=1;q>v;v++)if(q>v+1){var J=T.get(v),m=T.get(v+1);z(p,J,M),z(B,m,M),k.subVectors(n,p).setLength(Math.min(.99*k.length(),b)).add(p),J.e!==_||w.e!==_?s.add({x:k.x,y:k.z,e:k.y}):s.add({x:k.x,y:k.z}),s.add(J),k.subVectors(B,p).setLength(Math.min(.99*k.length(),b)).add(p),J.e!==_||m.e!==_?s.add(w={x:k.x,y:k.z,e:k.y}):s.add(w={x:k.x,y:k.z}),n.copy(k),Q.addAll([2,3])}else s.add(T.get(v)),Q.add(2);return{points:s,segments:Q}}}(),toColorData:uq,setCanvas:$f,createDiv:jc,createDisabledDiv:en,createView:Si,createCanvas:Yp,appendChild:zk,initContext:ob,checkLoadingImage:we,translateAndScale:Wi,layout:xg,getPosition:$l,drawPoints:Yc,drawRoundRect:nn,drawBorder:Xn,setFocus:hp,getter:$h,setter:mg,isEmptyObject:vo,cameraPriority:function(){var E={skybox:0,main:1e4,top:1e7,infinity:1/0};return x.seal(x.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return E.skybox},set:function(_){if(_>=E.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");E.skybox=Number(_)}},main:{configurable:!1,enumerable:!1,get:function(){return E.main},set:function(o){if(o<=E.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(o>=E.top)throw new RangeError("Main camera must have lower priority than the top camera.");E.main=Number(o)}},top:{configurable:!1,enumerable:!1,get:function(){return E.top},set:function(l){if(l<=E.main)throw new RangeError("Top camera must have higher priority than the main camera.");E.top=Number(l)}}}))}()},!0),nd(P,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Op=C.disabledOpacity,Zd=C.toolTipDelay,rh=C.devicePixelRatio,Cj=C.autoMakeVisible,Fk=C.autoHideScrollBar,ns=C.imageGradient,Hi=C.showToolTip,zn=C.hideToolTip,ig=C.dashPattern,Bh=C.lineCap,vn=C.lineJoin,tj=C.labelColor,yd=C.labelSelectColor,rr=C.labelFont,Vm=C.widgetIndent,Ii=C.widgetRowHeight,In=C.widgetHeaderHeight,As=C.widgetTitleHeight,Tr=C.scrollBarColor,Qp=C.scrollBarSize,gm=C.scrollBarTimeout,Tf=C.scrollBarMinLength,oc=C.scrollBarInteractiveSize,af=C.zoomIncrement,Xg=C.scrollZoomIncrement,Mn=C.pinchZoomIncrement,rj=C.zoomMax,Gq=C.zoomMin,Df=C.createObject,zq=C.preventDefault,Gn=C.setImage,Bj=C.getImage,cm=C.isImageComplete,Fb=C.drawCenterImage,_m=C.drawStretchImage,Tb=C.getId,Pq=C.callLater,Xr=C.cancelLater,ik=C.sortFunc,be=C.clone,ec=C.getClass,Po=C.startAnim,Oi=C.brighter,mb=C.darker,Br=C.drawText,lr=C.getTextSize,Do=C.isLeftButton,iq=C.isMiddleButton,kr=C.isRightButton,xm=C.getTouchCount,Mq=C.isDoubleClick,Xf=C.isShiftDown,Kp=C.isCtrlDown,Hf=C.getClientPoint,Dc=C.getPagePoint,Ki=C.getDistance,Tl=C.unionPoint,em=C.unionRect,Om=C.containsPoint,Km=C.containsRect,on=C.intersectsRect,Rj=C.intersection,Yn=C.getWindowInfo,ae=C.grow,ag=C.getLogicalPoint,dh=C.getScreenPoint,Td=C.startDragging,hg=C.removeHTML,ho=C.createElement,zh=C.segmentResolution,vg=C.shapeResolution,Ci=C.shapeSide,eq=C.def,Xq=function(F,N,f){eq(v+"."+F,N,f)},Xh=function(Q,d){Q.childNodes.forEach(function(N){d(N),Xh(N,d)})};nd(C,{toolTipLabelColor:tj,toolTipLabelFont:rr,toolTipBackground:g.toolTipBackground,toolTipShadowColor:Dd,debugTipLabelFont:rr,debugTipLabelColor:tj,debugTipBackground:g.toolTipBackground,drawBreakableText:Dm,setDevicePixelRatio:function(O){rh=C.devicePixelRatio="number"==typeof O?O:B.screen?B.screen.deviceXDPI/B.screen.logicalXDPI:1,Xh(L.body,function(s){var k=s._ht;k&&k._canvas&&($f(k._canvas,k.getWidth(),k.getHeight()),k.redraw?k.redraw():k.iv())})},getPosition3dGap:function(){return Be()}},!0);var tk=1e-6,Vf="undefined"!=typeof Uint16Array?Uint16Array:Array,Ac="undefined"!=typeof Float32Array?Float32Array:Array,Yb=function(B,C,M){var g=[B[0]-C[0],B[1]-C[1],B[2]-C[2]];if(M){var G=Ki(g);G>0&&(g[0]/=G,g[1]/=G,g[2]/=G)}return g},si=function(){var N="charCodeAt",i=2*(2*sq.length+1);for(var o in B)if(o===v+Mh[0]+(jf.length+2)){var C=B[o];if(!C)break;for(var z=C.length,F=0;z>F;F++)if(C[F][N](0)===i&&C[F+1]!=Q&&C[F+1]===jf[0]&&C[F+2]!=Q&&C[F+2][N](0)===i){for(var c=F+3;z>c;c++)if(C[c][N](0)===i){if(0==C[c+1])for(var K,b=c+2;z>b;b++){if(C[b][N](0)===i){0==C[b-1]&&K&&(eb=K.substr(0,K.length-1));break}K==Q?K=C[b]:K+=C[b]}break}break}break}return function(T){return[-T[0],-T[1],-T[2]]}}(),kd=function($,m){return 3===$.length?$[0]*m[0]+$[1]*m[1]+$[2]*m[2]:$[0]*m[0]+$[1]*m[1]},ph=function(){var z=new Array(16);return z[0]=1,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=1,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=1,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,z},ri=ph(),Vg=function(G){var Y=new Array(16);return Y[0]=G[0],Y[1]=G[1],Y[2]=G[2],Y[3]=G[3],Y[4]=G[4],Y[5]=G[5],Y[6]=G[6],Y[7]=G[7],Y[8]=G[8],Y[9]=G[9],Y[10]=G[10],Y[11]=G[11],Y[12]=G[12],Y[13]=G[13],Y[14]=G[14],Y[15]=G[15],Y},sn=function(Z,h){return Z[0]=h[0],Z[1]=h[1],Z[2]=h[2],Z[3]=h[3],Z[4]=h[4],Z[5]=h[5],Z[6]=h[6],Z[7]=h[7],Z[8]=h[8],Z[9]=h[9],Z[10]=h[10],Z[11]=h[11],Z[12]=h[12],Z[13]=h[13],Z[14]=h[14],Z[15]=h[15],Z},Co=function(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},ao=function(e,G){var p=e[0],m=e[1],Q=e[2];return e[0]=G[0]*p+G[4]*m+G[8]*Q+G[12],e[1]=G[1]*p+G[5]*m+G[9]*Q+G[13],e[2]=G[2]*p+G[6]*m+G[10]*Q+G[14],e},lo=function(A,e){var K=A[0],X=A[1],i=A[2],R=A[3];return A[0]=e[0]*K+e[4]*X+e[8]*i+e[12]*R,A[1]=e[1]*K+e[5]*X+e[9]*i+e[13]*R,A[2]=e[2]*K+e[6]*X+e[10]*i+e[14]*R,A[3]=e[3]*K+e[7]*X+e[11]*i+e[15]*R,A},zo=function(){var i,$,p,l,t=Ig(Oo[1]+Oo[7]),K=Ig(Oo[0]+Oo[3]-Oo[10]),y=Ig(Oo[8]+2),M=function(){return $=p.charAt(i),i+=1,$},X=function(){var f="";if($===y)for(;M();){if($===y)return M(),f;f+=$}else M()},G=function(){for(;$&&" ">=$;)M()},_=function(){var g,_={};if($===t){if(M(),G(),$===K)return M(),_;for(;$;){if(g=X(),G(),M(),_[g]=l(),G(),$===K)return M(),_;M(),G()}}};return l=function(){switch(G(),$){case t:return _();default:return X()}},function(P){if(O={},P){var C;if(p=P,i=0,$=" ",C=l(),G(),!$)return C}}}(),Ao=function(k,o){if(o){var f=h(o),i=j(o),p=k[4],C=k[5],a=k[6],P=k[7],r=k[8],z=k[9],G=k[10],g=k[11];k[4]=p*i+r*f,k[5]=C*i+z*f,k[6]=a*i+G*f,k[7]=P*i+g*f,k[8]=r*i-p*f,k[9]=z*i-C*f,k[10]=G*i-a*f,k[11]=g*i-P*f}},Pl=function(G,m){if(m){var D=h(m),F=j(m),f=G[0],w=G[1],S=G[2],B=G[3],A=G[8],b=G[9],K=G[10],l=G[11];G[0]=f*F-A*D,G[1]=w*F-b*D,G[2]=S*F-K*D,G[3]=B*F-l*D,G[8]=f*D+A*F,G[9]=w*D+b*F,G[10]=S*D+K*F,G[11]=B*D+l*F}},ee=function(d,x){if(x){var O=h(x),Z=j(x),N=d[0],q=d[1],g=d[2],M=d[3],p=d[4],C=d[5],r=d[6],f=d[7];d[0]=N*Z+p*O,d[1]=q*Z+C*O,d[2]=g*Z+r*O,d[3]=M*Z+f*O,d[4]=p*Z-N*O,d[5]=C*Z-q*O,d[6]=r*Z-g*O,d[7]=f*Z-M*O}},pc=function(M,l,o){return qh(Q,o===!1?Q:M.getFinalScale3d(),M.getFinalRotation3d(),M.getRotationMode(),M.p3(),Q,l)},qh=function(C,y,k,o,j,K,T){return K||(K=ph()),j&&ah(K,j),$e(K,k,o),T&&We(K,K,T),y&&ok(K,y),C&&We(K,K,C),K},Dg=function(D,z,s){z=pm(z),s=pm(s);var r=this;r.g=D,r._84O=z,r._85O=s,r._70I=!0,r.F=0,r._83O=z+s,r.pen={x:0,y:0}},Wj="lineDashOffset",sg="setLineDash",qq=function(y){for(var Q in y)1===Q.length&&(Wj=y[Q]);return Q?1:0},Zc=function(T,o,J){return Hg(o)?T:T[sg]?(T[sg](o),J&&(T.lineDashOffset=J),T):new Dg(T,o[0],o.length>1?o[1]:o[0])},Lb=function(k,g){!Hg(g)&&k[sg]&&(k[sg](Fj),k.lineDashOffset=0)};eq(Dg,x,{_69I:6,moveTo:function(E,l){var K=this,o=K.pen;o.x=E,o.y=l,K.g.moveTo(E,l),K.start||(K.start={x:E,y:l})},lineTo:function(u,P){var B=this,n=B.pen,H=u-n.x,t=P-n.y,q=mf(t,H),Y=j(q),l=h(q),z=B._23O(n.x,n.y,u,P),N=B._85O,$=B._84O,b=B._83O;if(B.F){if(B.F>z)return B._70I?B._72I(u,P):B.moveTo(u,P),B.F-=z,void 0;if(B._70I?B._72I(n.x+Y*B.F,n.y+l*B.F):B.moveTo(n.x+Y*B.F,n.y+l*B.F),z-=B.F,B.F=0,B._70I=!B._70I,!z)return}var D=E(z/b);if(D){for(var V=Y*$,o=l*$,T=Y*N,e=l*N,v=0;D>v;v++)B._70I?(B._72I(n.x+V,n.y+o),B.moveTo(n.x+T,n.y+e)):(B.moveTo(n.x+T,n.y+e),B._72I(n.x+V,n.y+o));z-=b*D}B._70I?z>$?(B._72I(n.x+Y*$,n.y+l*$),B.moveTo(u,P),B.F=N-(z-$),B._70I=!1):(B._72I(u,P),z===$?(B.F=0,B._70I=!B._70I):(B.F=$-z,B.moveTo(u,P))):z>N?(B.moveTo(n.x+Y*N,n.y+l*N),B._72I(u,P),B.F=$-(z-N),B._70I=!0):(B.moveTo(u,P),z===N?(B.F=0,B._70I=!B._70I):B.F=N-z)},quadraticCurveTo:function(B,r,k,b){var D,x=this,g=x.pen,R=g.x,Y=g.y,O=x._22O(R,Y,B,r,k,b),z=0,c=0,t=x._85O,G=x._84O;if(x.F){if(x.F>O)return x._70I?x._71I(B,r,k,b):x.moveTo(k,b),x.F-=O,void 0;if(z=x.F/O,D=x._20O(R,Y,B,r,k,b,z),x._70I?x._71I(D[2],D[3],D[4],D[5]):x.moveTo(D[4],D[5]),x.F=0,x._70I=!x._70I,!O)return}var W=O-O*z,N=E(W/x._83O),h=G/O,n=t/O;if(N)for(var P=0;N>P;P++)x._70I?(c=z+h,D=x._21O(R,Y,B,r,k,b,z,c),x._71I(D[2],D[3],D[4],D[5]),z=c,c=z+n,D=x._21O(R,Y,B,r,k,b,z,c),x.moveTo(D[4],D[5])):(c=z+n,D=x._21O(R,Y,B,r,k,b,z,c),x.moveTo(D[4],D[5]),z=c,c=z+h,D=x._21O(R,Y,B,r,k,b,z,c),x._71I(D[2],D[3],D[4],D[5])),z=c;W=O-O*z,x._70I?W>G?(c=z+h,D=x._21O(R,Y,B,r,k,b,z,c),x._71I(D[2],D[3],D[4],D[5]),x.moveTo(k,b),x.F=t-(W-G),x._70I=!1):(D=x._19O(R,Y,B,r,k,b,z),x._71I(D[2],D[3],D[4],D[5]),O===G?(x.F=0,x._70I=!x._70I):(x.F=G-W,x.moveTo(k,b))):W>t?(c=z+n,D=x._21O(R,Y,B,r,k,b,z,c),x.moveTo(D[4],D[5]),D=x._19O(R,Y,B,r,k,b,c),x._71I(D[2],D[3],D[4],D[5]),x.F=G-(W-t),x._70I=!0):(x.moveTo(k,b),W===t?(x.F=0,x._70I=!x._70I):x.F=t-W)},bezierCurveTo:function(){var d=arguments;this.pen={x:d[4],y:d[5]},this.g.bezierCurveTo(d[0],d[1],d[2],d[3],d[4],d[5])},arc:function(U,i,f,o,P,t){t||(o=-o,P=-P),Xj(this,U,i,o,P-o,f,f,!1)},rect:function($,W,I,T){var K=this;K.pen={x:$,y:W},K.moveTo($,W),K.lineTo($,W+T),K.lineTo($+I,W+T),K.lineTo($+I,W),K.lineTo($,W)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(B,F,O,K){var P=O-B,M=K-F;return z(P*P+M*M)},_22O:function(r,C,K,d,b,W,Z){for(var P,S,h,j,A,q,R,I=0,l=r,s=C,z=Z>0?Z:this._69I,u=1;z>=u;u++)h=u/z,j=1-h,A=j*j,q=2*h*j,R=h*h,P=A*r+q*K+R*b,S=A*C+q*d+R*W,I+=this._23O(l,s,P,S),l=P,s=S;return I},_21O:function(q,t,C,g,$,Z,x,X){var w=this;if(0===x)return w._20O(q,t,C,g,$,Z,X);if(1===X)return w._19O(q,t,C,g,$,Z,x);var k=w._20O(q,t,C,g,$,Z,X);return k.push(x/X),w._19O.apply(w,k)},_20O:function(j,N,D,C,q,c,E){if(1!==E){var f=D+(q-D)*E,T=C+(c-C)*E;D=j+(D-j)*E,C=N+(C-N)*E,q=D+(f-D)*E,c=C+(T-C)*E}return[j,N,D,C,q,c]},_19O:function(g,u,H,_,t,E,Y){if(1!==Y){var $=g+(H-g)*Y,s=u+(_-u)*Y;H+=(t-H)*Y,_+=(E-_)*Y,g=$+(H-$)*Y,u=s+(_-s)*Y}return[g,u,H,_,t,E]},_72I:function(D,h){var w=this.pen;(D!==w.x||h!==w.y)&&(w.x=D,w.y=h,this.g.lineTo(D,h))},_71I:function(z,j,y,B){var R=this.pen;(z!==y||j!==B||y!==R.x||B!==R.y)&&(R.x=y,R.y=B,this.g.quadraticCurveTo(z,j,y,B))}}),Im.ms_quickVisible=function(t){t._4BQ=!1,t._4CQ=function(v){var J=v._4EQ;return J!==_?J:J=v._4EQ=this._4FQ(v)},t._4DQ=function(P){if(!P)return this.dm().each(function(U){U._4EQ=_}),void 0;P._4EQ=_;var X=this;if(P instanceof Ri||Pm(P)||P instanceof Vr||P.ISubGraph)P.eachChild(function(A){X.invalidateQuickVisible(A)});else if(P.getEdges){var g=P.getEdges();g&&g.each(function(P){X.invalidateQuickVisible(P)})}},t.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},t.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=ss)},t.isQuickVisibleMode=function(){return this._4BQ},t.invalidateQuickVisible=ss},gd=Ch()+1,ce&&B.console&&gd&&!0&&(B.navigator&&B.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?B.console.log.apply(console,["Hightopo - Version"+b.Default.getVersion()+" - %cTrialhttp://hightopo.com/request.html","color: #f00;"]):B.console.log("Hightopo - Version"+b.Default.getVersion()+" - Trialhttp://hightopo.com/request.html"));var Bf=Q,Wn=Q,Gf=C.checkLoadingCompType=function(d){Bf&&!d._72O_&&(Wn||(Wn={}),Wn[d._72O_=Tb()]=d)},xr=function(G,l){if(l||(l=G),l&&(Bf||(Bf={}),!Bf[G])){var p=new rn;if(Bf[l]={request:p,url:l},l=C.beforeLoadURL(l,G),l.data){var g=C.parse(l.data);Sd(G,g),C.handleCompTypeLoaded(G,g)}else{p.onload=function(){if(200===this.status||0===this.status){var u=C.parse(p.getResponseText());Sd(G,u),C.handleCompTypeLoaded(G,u)}else Sd(G,Q)},p.onerror=function(){Sd(G,Q)};var I={};I.url=encodeURI(l),I.sync=!1,p.send(I)}}},Sd=function(I,M){if(lp[I]=M,delete Bf[I],vo(Bf)&&(Bf=Q,Wn)){for(var T in Wn){var $=Wn[T];$.invalidateAll&&$.invalidateAll(_,"compTypeLoaded",I),$.redraw&&$.redraw(),$.iv(),delete $._72O_}Wn=Q}if(M&&Wn)for(var T in Wn){var $=Wn[T];$.invalidateAll&&$.invalidateAll(_,"compTypeLoading",I),$.redraw&&$.redraw(),$.iv()}},ug=g.chart,sr="",kf=!0,ci=C.compStack=[],zr=/^style@/,Ed=/^attr@/,_q=/^field@/,_j={x:.5,y:.5},Zk=function(){kf=!0},Fo=function(){return kf},ld=function(e,$,i,c){if(!e)return 0;if(yk(e.fitSize,$,i)&&c)return c;var r=yk(e.width,$,i);return null==r?20:r},Sr=function(B,o,P,c){if(!B)return 0;if(yk(B.fitSize,o,P)&&c)return c;var h=yk(B.height,o,P);return null==h?20:h},yk=function(M,t,X){if(!M||!M.func)return M;var I,s=M.func,D=M.value;return I=np(s)?X&&X.vectorDataBindingDisabled&&!M.isSafeFunc?D:s(t,X):t instanceof mi||(b.ui?t instanceof b.ui.View:0)?Ed.test(s)?t.a(sr+s.slice(5)):zr.test(s)?t.s(sr+s.slice(6)):_q.test(s)?t[s.slice(6)]:t[s]?t[s](X):D:D,D!==_&&I==Q?D:I},Bs=C.drawImage=function(){var E,K,P,i,V,d,y=3,k=6,r=function(R){var z,H,F,x=!1;return I(R,"shadow")&&(z=I(R,"shadowOffsetX")||y,H=I(R,"shadowOffsetY")||y,F=I(R,"shadowBlur")||k,x=!0),!x&&K instanceof mi&&((rs(K,ij,"shadow")||"shadow"===rs(K,ij,"select.type")&&P&&P.isSelected&&P.isSelected(K))&&(z=rs(K,ij,"shadow.offset.x")||0,H=rs(K,ij,"shadow.offset.y")||0,F=rs(K,ij,"shadow.blur")||0,x=!0),!x&&rs(K,ij,"shadow2")&&(z=rs(K,ij,"shadow2.offset.x")||0,H=rs(K,ij,"shadow2.offset.y")||0,F=rs(K,ij,"shadow2.blur")||0,x=!0)),x?1.5*F+Math.max(z,H):0},J=function(n,T){n.getValue&&n.getValue.compType===T||(n.getValue=function(d){var W=I(n,d);if(W===_&&T.properties){var U=T.properties[d];U&&(W=U.defaultValue)}return W},n.getColor=function(U,t){return t===!0?w(U):w(n.getValue(U))},n.getValue.compType=T)},I=function(i,n,y){var u,H=!1;if(i.prefix&&K instanceof mi){var l=K.a(sr+n);l!==_&&(H=!0,u=l)}return u===_&&(u=i[n]),u&&u.func&&(H=!0,u=yk(u,K,P)),y&&(u=y(u),H||(i[n]=u)),u},w=function(k,s){var H;return H=s?I(k,s):k,E&&E.compGray&&H?C.toGrayColor(H):V&&H?ac(H,V,d):H},n=function(J){if(oi(J)){for(var q=new Qd,L=J.length,b=0;L>b;b+=2)q.add({x:J[b],y:J[b+1]});J=q}return J},u=function(r){var E=I(r,"anchorX"),A=I(r,"anchorY");if(E!==_||A!==_)return{x:E===_?_j.x:E,y:A===_?_j.y:A};var l=I(r,"type"),U=I(r,"name");if("image"!==l||!U)return _j;var Z=Bj(U);return Z&&Z.anchorX!==_&&Z.anchorY!==_?{x:Z.anchorX,y:Z.anchorY}:_j},z=function(J,B){var q=I(J,Lm),h=u(J);if(oi(q)){var n=q.length,i=I(J,"relative"),W=B.width,b=B.height;if(4===n)q={x:q[0],y:q[1],width:q[2],height:q[3]},i&&(q.x*=W,q.y*=b,q.width*=W,q.height*=b);else if(3===n){var G=q[0];q={width:q[1],height:q[2]},i&&(q.width*=W,q.height*=b),"object"==typeof G?G.length&&(G={x:G[0],y:G[1]}):G=$l(G,B,q),q.x=G.x-q.width*h.x,q.y=G.y-q.height*h.y}q.x+=I(J,"offsetX")||0,q.y+=I(J,"offsetY")||0,!i&&B.fitSize&&(q=O(J,q,B))}return q},O=function(M,U,e){if(U){var p,o,s,S={x:U.x,y:U.y,width:U.width,height:U.height},O=u(M),h=I(M,"layoutH"),g=I(M,"layoutV"),c=1,$=1,t=0,P=0,T=1,k=1;switch(h){case"left":break;case"right":S.x+=e.width-e.rw;break;case"center":S.x+=.5*(e.width-e.rw);break;case"scale":case"leftright":default:p=I(M,js)||0,p&&(t=Math.abs(P=Math.sin(p)),T=Math.abs(k=Math.cos(p))),"leftright"!==h?(c+=T*(e.widthScale-1),$+=t*(e.widthScale-1)):(c+=S.width?T*(e.width-e.rw)/S.width:0,$+=S.height?t*(e.width-e.rw)/S.height:0,o=-Math.min(-O.x*k+O.y*P,-O.x*k-(1-O.y)*P,(1-O.x)*k+O.y*P,(1-O.x)*k-(1-O.y)*P))}switch(g){case"top":break;case"bottom":S.y+=e.height-e.rh;break;case"center":S.y+=.5*(e.height-e.rh);break;case"scale":case"topbottom":default:p==Q&&(p=I(M,js),p&&(t=Math.abs(P=Math.sin(p)),T=Math.abs(k=Math.cos(p)))),"topbottom"!==g?(c+=t*(e.heightScale-1),$+=T*(e.heightScale-1)):(c+=S.width?t*(e.height-e.rh)/S.width:0,$+=S.height?T*(e.height-e.rh)/S.height:0,s=-Math.min(-O.x*P-O.y*k,-O.x*P+(1-O.y)*k,(1-O.x)*P-O.y*k,(1-O.x)*P+(1-O.y)*k))}return(1!==c||1!==$)&&("scale"!==h&&h?"leftright"===h&&(S.x+=S.width*(1-c)*O.x+o*(e.width-e.rw)):S.x+=S.x*(e.widthScale-1)+O.x*S.width*(e.widthScale-c),"scale"!==g&&g?"topbottom"===g&&(S.y+=S.height*(1-$)*O.y+s*(e.height-e.rh)):S.y+=S.y*(e.heightScale-1)+O.y*S.height*(e.heightScale-$),S.width*=c,S.height*=$),S.width<0&&(S.width=0),S.height<0&&(S.height=0),S}},x=function(Q){return oi(Q)?new Qd(Q):Q},X=function(A,Y,h,M,V,X,j){var F=E.interactiveInfo,z=A.transform;if(z)return E.save(),E.setTransform(z.a,z.b,z.c,z.d,z.tx,z.ty),F&&F.compInfos.push({comp:A,rect:Y,matrix:z.clone(),prefix:sr,refRect:F.refRect}),!0;V===_&&(V=1),X===_&&(X=1);var C=I(A,"clipPercentage"),x=dl(h,Y);if(x&&!M&&1===V&&1===X&&!(1>C))return F&&F.compInfos.push({comp:A,rect:Y,matrix:F.matrix.clone(),prefix:sr,refRect:F.refRect}),!1;j=j||_j;var P=Y.x+Y.width*j.x,T=Y.y+Y.height*j.y,w=h.x+h.width*j.x,S=h.y+h.height*j.y,N=h.width?V*(Y.width/h.width):1,W=h.height?X*(Y.height/h.height):1;if(E.save(),F&&(F.matrix.appendTranslate(P,T).appendRotate(M).appendScale(N,W).appendTranslate(-w,-S),F.compInfos.push({comp:A,rect:Y,matrix:F.matrix.clone(),prefix:sr,refRect:F.refRect})),Hk(E,P,T),wm(E,M||0),Xc(E,N,W),Hk(E,-w,-S),1>C){0>C&&(C=0);var y=jm(h,I(A,"clipDirection"),C,r(A));E.beginPath(),E.rect(y.x,y.y,y.width,y.height),E.clip()}return!0},o=function(){E.restore()},R=function(M,G,D){var C=I(M,"path"),U=I(M,js),k=I(M,"scaleX"),b=I(M,"scaleY"),s=u(M),A=Q,J=Hn(null,C);if(D||(D=M.unionRect,D||(D=Tl(J),M.path.func||(M.unionRect=D)),A=D),D){A||(A=M.unionRect,A||(A=Tl(J),M.path.func||(M.unionRect=A)));var y=X(M,D,A,U,k,b,s),f=I(M,"borderPattern"),x=Zc(E,f),v=w(M,"background"),P=w(M,"borderColor"),W=I(M,"borderWidth"),j=I(M,"gradient"),g=w(M,"gradientColor"),z=I(M,"border3d"),h=w(M,"border3dColor"),H=I(M,"border3dAccuracy"),Z=E.lineJoin,V=E.lineCap;E.lineJoin=I(M,"borderJoin")||vn,E.lineCap=I(M,"borderCap")||Bh,v?(qc(E,v,j,g,A),Hn(E,C),E.fill(),x!==E&&Hn(E,C)):Hn(E,C);var n=I(M,"borderWidthAbsolute");if(n&&(E.save(),E.setTransform(1,0,0,1,0,0)),W&&P&&(E.lineWidth=W,E.strokeStyle=P,E.stroke(),z&&oq(E,P,h,W,i,H)),Lb(E,f),I(M,"dash")){var S=I(M,"dashWidth")||W;if(S>0){f=I(M,"dashPattern")||ig;var x=Zc(E,f,I(M,"dashOffset")),c=w(M,"dashColor")||w(xn);x!==E&&Hn(E,C),E.strokeStyle=c,E.lineWidth=S,E.stroke(),I(M,"dash3d")&&oq(E,c,w(M,"dash3dColor"),S,i,I(M,"dash3dAccuracy")),Lb(E,f)}}n&&E.restore(),G===Lm&&Hm(E,v,I(M,"depth"),A),E.lineJoin=Z,E.lineCap=V,y&&o()}},t=function(m,Z,S,h){var N=I(m,Hl,n),z=I(m,js),e=u(m);if(N&&h.fitSize){var _=new Qd,B=Tl(N),J=O(m,B,h),R=B.x+e.x*B.width,k=B.y+e.y*B.height,b=J.x+e.x*J.width,v=J.y+e.y*J.height,l=B.width?J.width/B.width:1,$=B.height?J.height/B.height:1;N.each(function(e){_.add({x:b+(e.x-R)*l,y:v+(e.y-k)*$})}),N=_,m.unionRect=null}var M=I(m,"scaleX"),C=I(m,"scaleY"),U=Z===qo,g=Q;if(!S&&U&&(S=m.unionRect,S||(S=Tl(N),m.points.func||(m.unionRect=S)),g=S),S){U?g||(g=m.unionRect,g||(g=Tl(N),m.points.func||(m.unionRect=g))):g=S;var L,s,D,H,q=X(m,S,g,z,M,C,e),Y=I(m,"borderPattern"),G=Zc(E,Y),F=w(m,"background"),p=Bj(I(m,"repeatImage"),V,d),y=I(m,"gradientPack"),c=I(m,"borderGradientPack"),a=w(m,"borderColor"),T=I(m,"borderWidth"),A=Bj(I(m,"borderRepeatImage"),V,d),f=I(m,"segments",x),j=I(m,"gradient"),t=w(m,"gradientColor"),W=I(m,"border3d"),Db=w(m,"border3dColor"),or=I(m,"border3dAccuracy"),Td=I(m,"closePath"),Df=I(m,"fillRule")||"nonzero",Ro=E.lineJoin,hj=E.lineCap,nf=r(m);if(E.lineJoin=I(m,"borderJoin")||vn,E.lineCap=I(m,"borderCap")||Bh,U)if(F||p||y){var No=I(m,"fillClipPercentage");if(1>No){0>No&&(No=0);var Sc=jm(g,I(m,"fillClipDirection"),No,nf);E.save(),E.beginPath(),E.rect(Sc.x,Sc.y,Sc.width,Sc.height),E.clip()}Yc(E,N,f,Td),y?Bo(E,y,w,!1,S):p?Pp(E,p,V,d,K,P):qc(E,F,j,t,g),E.fill(Df),y&&E.restore(),1>No&&E.restore(),G!==E&&Yc(G,N,f,Td)}else Yc(G,N,f,Td);else if("roundRect"===Z?L=I(m,"cornerRadius"):"polygon"===Z?L=I(m,"polygonSide"):"arc"===Z&&(L=I(m,"arcFrom"),s=I(m,"arcTo"),D=I(m,"arcClose"),H=I(m,"arcOval")),F||p||y){var No=I(m,"fillClipPercentage");if(1>No){0>No&&(No=0);var Sc=jm(g,I(m,"fillClipDirection"),No,nf);E.save(),E.beginPath(),E.rect(Sc.x,Sc.y,Sc.width,Sc.height),E.clip()}Un(E,Z,g,L,s,D,H),y?Bo(E,y,w,!1,S):p?Pp(E,p,V,d,K,P):qc(E,F,j,t,g),E.fill(Df),y&&E.restore(),1>No&&E.restore(),E!==G&&Un(G,Z,g,L,s,D,H)}else Un(G,Z,g,L,s,D,H);var Pf=I(m,"borderWidthAbsolute");if(Pf&&(E.save(),E.setTransform(1,0,0,1,0,0)),T&&(a||A||c)&&(E.lineWidth=T,c?Bo(E,c,w,!0,S):A?kg(E,A,V,d,K,P):E.strokeStyle=a,E.stroke(),c&&E.restore(),W&&oq(E,a,Db,T,i,or)),Lb(E,Y),I(m,"dash")){var Ll=I(m,"dashWidth")||T;if(Ll>0){Y=I(m,"dashPattern")||ig;var G=Zc(E,Y,I(m,"dashOffset")),Ol=w(m,"dashColor")||w(xn);G!==E&&(U?Yc(G,N,f,Td):Un(G,Z,g,L,s,D,H)),E.strokeStyle=Ol,E.lineWidth=Ll,E.stroke(),I(m,"dash3d")&&oq(E,Ol,w(m,"dash3dColor"),Ll,i,I(m,"dash3dAccuracy")),Lb(E,Y)}}Pf&&E.restore(),Z===Lm&&Hm(E,F,I(m,"depth"),g),E.lineJoin=Ro,E.lineCap=hj,q&&o()}},v=function(X,J){var U=V||I(X,se),B=d||I(X,"blendMode"),z=I(X,"name"),u=Bj(z,U,B);u&&u.cacheRule!=Q&&(u=hk(E,u,I(X,"stretch"),J.width,J.height,K,P,U)),u?_m(E,u,I(X,"stretch"),J.x,J.y,J.width,J.height,K,P,U,null,B):kf=!1},U=function(n,D){var y=I(n,"text");if(y!=Q){var r,x=I(n,"gradientPack"),s=I(n,"gradient"),z=w(n,"gradientColor"),p=I(n,"font"),Z=I(n,"vertical"),$=I(n,"verticalGap"),o=I(n,"align"),m=I(n,"vAlign"),O=I(n,"decoration");if(r=x?Bo(E,x,w,!1,D):w(n,se),!x&&s&&(r=C.createGradient(E,s,r||C.labelColor,z||g.imageGradient,D.x,D.y,D.width,D.height)),Z){null==$&&($=1);var i,B,S=y.length,X=0,H=(S-1)*$,h=[];E.textBaseline=Ui,E.font=p;for(var q=0;S>q;q++){var V=E.measureText(y[q]);h.push(V),H+=V.fontBoundingBoxDescent,X=f(X,V.width)}B=m&&m!==gi?m===Ui?D.y:D.y+D.height-H:D.y+(D.height-H)/2,i=o&&o!==Mh?o===Xi?D.x+D.width-X:D.x+(D.width-X)/2:D.x;for(var q=0;S>q;q++){var d=y[q],V=h[q];Br(E,d,p,r,i,B,X,V.fontBoundingBoxDescent,Nc,gi,O),B+=V.fontBoundingBoxDescent+$}}else Br(E,y,p,r,D.x,D.y,D.width,D.height,o,m,O);x&&E.restore()}},c=function(Z,q){Xn(E,w(Z,se),q.x,q.y,q.width,q.height,I(Z,"width"))},M=function(m,p){var C=I(m,wl),D=0;if(C&&(C.forEach(function(R){D+=R}),D>0)){for(var i=I(m,"colors")||ug,t=I(m,"startAngle")||0,H=I(m,"hollow"),w=I(m,lf),L=I(m,Gg),Y=I(m,us),c=w?new Qd:Q,R=p.x,X=p.y,g=p.width,A=p.height,k=R+g/2,z=X+A/2,b=F(g,A)/2,N=0,d=0;d<C.length;d++){var U=C[d],M=Z*U/D,n=t+M;if(E.fillStyle=i[N++],N===i.length&&(N=0),E.beginPath(),H){var T=k+j(t)*b/2,V=z+h(t)*b/2,o=k+j(n)*b,q=z+h(n)*b;E.moveTo(T,V),E.arc(k,z,b/2,t,n,!1),E.lineTo(o,q),E.arc(k,z,b,n,t,!0)}else E.moveTo(k,z),E.arc(k,z,b,n,t,!0);c&&(M=(t+n)/2,c.add({text:np(w)?w(U,d,D,K):U,x:k+.75*j(M)*b,y:z+.75*h(M)*b})),E.closePath(),E.fill(),t=n}c&&c.each(function(W){Br(E,W.text,L,Y,W.x,W.y,0,0,Nc)})}},D=function(M,O){var G=I(M,dm);if(G&&G.length>0){var U=G.length,q=I(M,lf),Z=I(M,Gg),w=I(M,us),Y=q?new Qd:Q,d=I(M,"minValue")||0,_=I(M,"maxValue");if(_==Q&&(_=0,G.forEach(function(R){I(R,wl).forEach(function(G){_=f(_,G)})})),d===_)return;for(var V=O.height/(_-d),F=O.y+_*V,W=I(G[0],wl).length,h=O.width/(3*W+1),D=2*h/U,x=0,b=0;U>b;b++)for(var u=G[b],v=I(u,se),j=I(u,"colors"),T=I(u,wl),k=0;W>k;k++){j?E.fillStyle=j[k]:v?E.fillStyle=v:(E.fillStyle=ug[x++],x===ug.length&&(x=0));var N=T[k],a=N*V,A=O.x+(1+3*k)*h+b*D;if(uj(E,A,F-a,D,a),Y){var p=np(q)?q(N,k,u,K):N,P=lr(Z,p).height;Y.add({x:A,y:F-a-P,width:D,height:P,text:p})}}Y&&Y.each(function(g){Br(E,g.text,Z,w,g.x,g.y,g.width,g.height,Nc)})}},N=function(H,c){var p=I(H,dm);if(p&&p.length>0){var Z=p.length,w=I(p[0],wl).length,n=c.width/(3*w+1),g=0,$=I(H,"maxValue"),V=I(H,lf),b=I(H,Gg),F=I(H,us),L=V?new Qd:Q;if($==Q){$=0;for(var s=0;w>s;s++){for(var z=0,J=0;Z>J;J++)z+=I(p[J],wl)[s];$=f($,z)}}if($>0){for(var s=0;w>s;s++)for(var y=c.y+c.height,J=0;Z>J;J++){var r=p[J],x=I(r,se),C=I(r,wl)[s],W=C/$*c.height;x?E.fillStyle=x:(E.fillStyle=ug[g++],g===ug.length&&(g=0)),y-=W;var j={x:c.x+(1+3*s)*n,y:y,width:2*n,height:W};uj(E,j.x,j.y,j.width,j.height),L&&(j.text=np(V)?V(C,s,r,K):C,L.add(j))}L&&L.each(function(R){Br(E,R.text,b,F,R.x,R.y,R.width,R.height,Nc)})}}},a=function(c,R){var C=I(c,dm);if(C&&C.length>0){for(var W=C.length,i=I(C[0],wl).length,A=R.width/(3*i+1),Y=0,n=I(c,lf),j=I(c,Gg),e=I(c,us),S=n?new Qd:Q,f=0;i>f;f++){for(var J=0,o=0;W>o;o++)J+=I(C[o],wl)[f];if(J>0){var T=R.y+R.height;for(o=0;W>o;o++){var B=C[o],D=I(B,se),r=I(B,wl)[f],G=r/J*R.height;D?E.fillStyle=D:(E.fillStyle=ug[Y++],Y===ug.length&&(Y=0)),T-=G;var N={x:R.x+(1+3*f)*A,y:T,width:2*A,height:G};uj(E,N.x,N.y,N.width,N.height),S&&(N.text=np(n)?n(r,f,B,K):r,S.add(N))}}}S&&S.each(function(Q){Br(E,Q.text,j,e,Q.x,Q.y,Q.width,Q.height,Nc)})}},G=function(P,k){var L=I(P,dm);if(L&&L.length>0){var y=L.length,W=I(P,"minValue")||0,w=I(P,"maxValue");if(w==Q&&(w=0,L.forEach(function(U){I(U,wl).forEach(function(z){w=f(w,z)})})),W===w)return;for(var l=k.height/(w-W),O=k.y+w*l,D=I(L[0],wl).length,g=k.width/(3*D+1),u=0,n=I(P,"lineWidth")||2,s=I(P,"line3d"),B=I(P,"linePoint"),C=I(P,lf),F=I(P,Gg),x=I(P,us),d=0;y>d;d++){var e=L[d],G=I(e,se),U=I(e,wl);G?E.strokeStyle=G:(G=E.strokeStyle=ug[u++],u===ug.length&&(u=0)),E.beginPath();for(var T=0;D>T;T++){var S=k.x+(2+3*T)*g,p=O-U[T]*l;0===T?E.moveTo(S,p):E.lineTo(S,p)}if(E.lineWidth=n,E.stroke(),s&&oq(E,G,Q,n,i),B||C){var X,V=n/2+2;for(T=0;D>T;T++){var r=U[T];if(S=k.x+(2+3*T)*g,p=O-r*l,np(B)?B(E,S,p,G,T,e,K):B&&(E.fillStyle=G,E.beginPath(),E.arc(S,p,V,0,Z,!0),E.fill()),np(C)?X=C(r,T,e,K):C&&(X=r),X){var t=lr(F,X).height,h=E.shadowBlur;if(h){var z=E.shadowOffsetX,j=E.shadowOffsetY,R=E.shadowColor;E.shadowOffsetX=0,E.shadowOffsetY=0,E.shadowBlur=0,E.shadowColor=Q}Br(E,X,F,x,S,p-t-V+2,0,t,Nc),h&&(E.shadowOffsetX=z,E.shadowOffsetY=j,E.shadowBlur=h,E.shadowColor=R)}}}}}},p=function(q){E=q[0],K=q[1],P=q[2],i=q[3],V=q[4],d=q[5]},s=function(){return[E,K,P,i,V,d]},m=function(g,U){var F;P&&P.getDrawableState?F=P.getDrawableState(K):P&&P.getState?F=P.getState(K):(F=K instanceof mi?K.s(Jk):null,(F===_||null===F)&&(F=I(g,Jk)));var e=I(U,Jk);return e!==_&&null!==e&&e!==F?!1:I(U,qj)},Y={border:c,image:v,text:U,pieChart:M,columnChart:D,stackedColumnChart:N,percentageColumnChart:a,lineChart:G};return function(A,O,L,l,v,F,T,q,U,j){if(O&&v&&F){var f=s();E=A,K=T,P=q,!K&&P&&P.isSelfViewEvent&&(K=P),i=P?P._zoom?P._zoom:1:1,V=U,d=j;var S=v,M=F;if(eg()){var Z,h,W,r,H,a;0===E[Qe]?eg[0]&&(Z=!0):Z=!0,E.texureImage2D?eg[1]&&(h=!0):h=!0,E.texureImage3D?eg[2]&&(W=!0):W=!0,E.drawDNDState?eg[3]&&(H=!0):H=!0,b[jr[1]+yc[0]+jo[1]]?eg[yc[0]]&&(a=!0):a=!0,Ql.widget[0]?eg[4]&&(r=!0):r=!0,Z&&h&&W&&r&&H&&a&&(S=L,M=l)}if(O.tagName)return am(eb)&&!B[eb]||E.drawImage(O,S,M,v,F),p(f),void 0;if(0==I(O,"visible"))return p(f),void 0;V||(V=yk(O.color,K,P)),j||(d=yk(O.blendMode,K,P)),am(eb)&&!B[eb]&&(v=S,F=M);var $=ld(O,K,P,v),G=Sr(O,K,P,F),g={x:0,y:0,width:$,height:G,fitSize:I(O,"fitSize")},c=I(O,"clip"),N=I(O,"opacity");
if(g.fitSize){var e=g.rw=yk(O.width,K,P)||20;g.widthScale=$/e;var D=g.rh=yk(O.height,K,P)||20;g.heightScale=G/D}if(E.save(),E.interactiveInfo){var Je=E.interactiveInfo.matrix,Rd=Je.clone();Je.appendTranslate(S,M).appendScale(v/$,F/G),E.interactiveInfo.refRect=g}Hk(E,S,M),($!==v||G!==F)&&E.scale(v/$,F/G),c&&(np(c)?c(E,$,G,K,P,O):(E.beginPath(),E.rect(0,0,$,G),E.clip())),N!=Q&&(E.globalAlpha*=N),I(O,"comps").forEach(function(U){if(U.prefix){var p=sr,q=yk(U.prefix,K,P);q&&(sr=sr+q+".")}if(0==m(O,U))return U.prefix&&(sr=p),void 0;if(ci.splice(0,0,U),E.interactiveInfo)var S=E.interactiveInfo.matrix.clone();var Z=I(U,"opacity"),d=I(U,"shadow"),f=I(U,"type"),F=I(U,"refRect")||g,T=z(U,F);if(Z!=Q){var l=E.globalAlpha;E.globalAlpha*=Z}if(d){var B=i*C.devicePixelRatio,c=E.shadowOffsetX,v=E.shadowOffsetY,M=E.shadowBlur,L=E.shadowColor,D=I(U,"shadowOffsetX"),b=I(U,"shadowOffsetY"),e=I(U,"shadowBlur"),V=w(U,"shadowColor");E.shadowOffsetX=(D==Q?y:D)*B,E.shadowOffsetY=(b==Q?y:b)*B,E.shadowBlur=(e==Q?k:e)*B,E.shadowColor=V||w(Hc)}if("save"===f)E.save();else if("endClip"===f||"restore"===f)E.restore();else if("clip"===f)E.save(),Yc(E,I(U,"points",n),I(U,"segments",x),!0),E.clip();else if(cn[f])T=T||{x:0,y:0,width:F.width,height:F.height},t(U,f,T,F);else if(f===qo)t(U,f,T,F);else if("SVGPath"===f)R(U,f,T);else{T=T||{x:0,y:0,width:F.width,height:F.height};var j=I(U,js),A=I(U,"scaleX"),N=I(U,"scaleY"),h=u(U),$=X(U,T,T,j,A,N,h);if(np(f))J(U,f),C.drawCompType(f,E,T,U,K,P);else if(C.getCompType(f)){var s=C.getCompType(f),r=s.func||s;J(U,s),C.drawCompType(r,E,T,U,K,P)}else Y[f]?Y[f](U,T):C.getCompType(f)===_&&up.test(f)&&(xr(f),kf=!1);$&&o()}d&&(E.shadowOffsetX=c,E.shadowOffsetY=v,E.shadowBlur=M,E.shadowColor=L),Z!=Q&&(E.globalAlpha=l),E.interactiveInfo&&(E.interactiveInfo.matrix=S),U.prefix&&(sr=p),ci.splice(0,1)}),E.interactiveInfo&&(E.interactiveInfo.matrix=Rd),E.restore(),p(f)}}}();C.getCurrentComp=function(){return ci[0]},C.getParentComp=function(){return ci[1]},C.getInternal=function(){return{isEnter:Ud,isEsc:ol,isSpace:Uq,isLeft:re,isUp:zc,isRight:ze,isDown:uh,addMethod:nd,superCall:rd,toPointsArray:Mr,translateAndScale:Wi,appendArray:ir,createWorldMatrix:qh,vec3TransformMat4:ao,setCanvas:$f,createDiv:jc,createView:Si,createCanvas:Yp,createImage:oo,initContext:ob,layout:xg,fillRect:uj,Mat:td,drawBorder:Xn,isString:am,setBorder:Rh,getPropertyValue:rs,setPropertyValue:ad,drawVerticalLine:ef,draw3DRect:Hm,getPinchDist:Ti,isSameRect:dl,getPosition:$l,intersectionLineRect:Bn,getNodeRect:Zl,getEdgeAgentPosition:Lp,getEdgeHostPosition:Ih,getImageWidth:ld,getImageHeight:Sr,initItemElement:bi,drawPoints:Yc,createG2:Zc,closePopup:$j,isH:Zh,createAnim:Fl,createNormalMatrix:rc,toColorArray:bc,createNormals:xi,toFloatArray:Af,glMV:Sk,glPop:im,batchShape:Gh,createNodeMatrix:pc,getShapeModel:sh,getFaceInfo:Cl,transformAppend:sc,drawFaceInfo:nq,glUploadData:Bg,glUploadElementData:_c,glDrawArray:Lj,glDrawElement:jk,glBindTexture:$r,pickValueToColor:Gs,to3dPointsArray:Pk,setGLDebugMode:function(t){ym=t},cube:function(){return{vs:tq,is:hi,uv:Gm}},ui:function(){return{DataUI:Mp,NodeUI:no,EdgeUI:ws,GroupUI:Mo,ShapeUI:dc,GridUI:So,Data3dUI:Ws,Node3dUI:Xs,Shape3dUI:$s}},getInternalVersion:function(){return"U2FsdGVkX1+nDgChfhEEFzdqofL/uyLqjz0qoMd37xc="},getDragger:function(){return xf},addMSMap:function(f){nd(Im,f)},k:w,overrideTimerFunc:function(S,Y){Pq=b.Default.callLater=S,Xr=b.Default.cancelLater=Y},canEnterEditDetailMode:Jd,addEventListener:W,removeEventListener:R}},function(O){function r(i,p){i!=Q&&(p==Q&&Nh!=typeof i?this._54O(i,256):this._54O(i,p))}function G(){return new r(Q)}function e(z,s,G,n,R,P){for(;--P>=0;){var f=s*this[z++]+G[n]+R;R=E(f/67108864),G[n++]=67108863&f}return R}function _(p,l,y,C,m,M){for(var W=32767&l,Z=l>>15;--M>=0;){var j=32767&this[p],X=this[p++]>>15,w=Z*j+X*W;j=W*j+((32767&w)<<15)+y[C]+(1073741823&m),m=(j>>>30)+(w>>>15)+Z*X+(m>>>30),y[C++]=1073741823&j}return m}function a(Z,T,p,R,J,f){for(var v=16383&T,N=T>>14;--f>=0;){var h=16383&this[Z],X=this[Z++]>>14,l=N*h+X*v;h=v*h+((16383&l)<<14)+p[R]+J,J=(h>>28)+(l>>14)+N*X,p[R++]=268435455&h}return J}function k(v){return Dr.charAt(v)}function H(x,R){var C=Fr[x.charCodeAt(R)];return C==Q?-1:C}function V(e){for(var i=this.t-1;i>=0;--i)e[i]=this[i];e.t=this.t,e.s=this.s}function l(m){this.t=1,this.s=0>m?-1:0,m>0?this[0]=m:-1>m?this[0]=m+this.DV:this.t=0}function T(M){var e=G();return e._58O(M),e}function D(W,V){var D,v=this;if(16==V)D=4;else if(8==V)D=3;else if(256==V)D=8;else if(2==V)D=1;else if(32==V)D=5;else{if(4!=V)return v.fromRadix(W,V),void 0;D=2}v.t=0,v.s=0;for(var S=W.length,e=!1,A=0;--S>=0;){var j=8==D?255&W[S]:H(W,S);0>j?"-"==W.charAt(S)&&(e=!0):(e=!1,0==A?v[v.t++]=j:A+D>v.DB?(v[v.t-1]|=(j&(1<<v.DB-A)-1)<<A,v[v.t++]=j>>v.DB-A):v[v.t-1]|=j<<A,A+=D,A>=v.DB&&(A-=v.DB))}8==D&&0!=(128&W[0])&&(v.s=-1,A>0&&(v[v.t-1]|=(1<<v.DB-A)-1<<A)),v._57O(),e&&r.ZERO._78O(v,v)}function R(){for(var q=this,R=q.s&q.DM;q.t>0&&q[q.t-1]==R;)--q.t}function m(F){var I=this;if(I.s<0)return"-"+I._85O()[qm](F);var G;if(16==F)G=4;else if(8==F)G=3;else if(2==F)G=1;else if(32==F)G=5;else{if(4!=F)return I.toRadix(F);G=2}var z,V=(1<<G)-1,Q=!1,Z="",l=I.t,y=I.DB-l*I.DB%G;if(l-->0)for(y<I.DB&&(z=I[l]>>y)>0&&(Q=!0,Z=k(z));l>=0;)G>y?(z=(I[l]&(1<<y)-1)<<G-y,z|=I[--l]>>(y+=I.DB-G)):(z=I[l]>>(y-=G)&V,0>=y&&(y+=I.DB,--l)),z>0&&(Q=!0),Q&&(Z+=k(z));return Q?Z:"0"}function u(){var H=G();return r.ZERO._78O(this,H),H}function B(){return this.s<0?this._85O():this}function y(S){var g=this,R=g.s-S.s;if(0!=R)return R;var D=g.t;if(R=D-S.t,0!=R)return g.s<0?-R:R;for(;--D>=0;)if(0!=(R=g[D]-S[D]))return R;return 0}function Y(m){var f,s=1;return 0!=(f=m>>>16)&&(m=f,s+=16),0!=(f=m>>8)&&(m=f,s+=8),0!=(f=m>>4)&&(m=f,s+=4),0!=(f=m>>2)&&(m=f,s+=2),0!=(f=m>>1)&&(m=f,s+=1),s}function i(){var H=this;return H.t<=0?0:H.DB*(H.t-1)+Y(H[H.t-1]^H.s&H.DM)}function A(q,d){var k;for(k=this.t-1;k>=0;--k)d[k+q]=this[k];for(k=q-1;k>=0;--k)d[k]=0;d.t=this.t+q,d.s=this.s}function o(d,e){for(var g=d;g<this.t;++g)e[g-d]=this[g];e.t=f(this.t-d,0),e.s=this.s}function c(R,r){var N,P=this,T=R%P.DB,Q=P.DB-T,G=(1<<Q)-1,c=E(R/P.DB),I=P.s<<T&P.DM;for(N=P.t-1;N>=0;--N)r[N+c+1]=P[N]>>Q|I,I=(P[N]&G)<<T;for(N=c-1;N>=0;--N)r[N]=0;r[c]=I,r.t=P.t+c+1,r.s=P.s,r._57O()}function q(u,R){var x=this;R.s=x.s;var W=E(u/x.DB);if(W>=x.t)return R.t=0,void 0;var v=u%x.DB,r=x.DB-v,e=(1<<v)-1;R[0]=x[W]>>v;for(var n=W+1;n<x.t;++n)R[n-W-1]|=(x[n]&e)<<r,R[n-W]=x[n]>>v;v>0&&(R[x.t-W-1]|=(x.s&e)<<r),R.t=x.t-W,R._57O()}function C(O,q){for(var b=this,n=0,v=0,e=F(O.t,b.t);e>n;)v+=b[n]-O[n],q[n++]=v&b.DM,v>>=b.DB;if(O.t<b.t){for(v-=O.s;n<b.t;)v+=b[n],q[n++]=v&b.DM,v>>=b.DB;v+=b.s}else{for(v+=b.s;n<O.t;)v-=O[n],q[n++]=v&b.DM,v>>=b.DB;v-=O.s}q.s=0>v?-1:0,-1>v?q[n++]=b.DV+v:v>0&&(q[n++]=v),q.t=n,q._57O()}function U(X,C){var Z=this.abs(),g=X.abs(),Y=Z.t;for(C.t=Y+g.t;--Y>=0;)C[Y]=0;for(Y=0;Y<g.t;++Y)C[Y+Z.t]=Z.am(0,g[Y],C,Y,0,Z.t);C.s=0,C._57O(),this.s!=X.s&&r.ZERO._78O(C,C)}function d(I){for(var O=this.abs(),d=I.t=2*O.t;--d>=0;)I[d]=0;for(d=0;d<O.t-1;++d){var t=O.am(d,O[d],I,2*d,0,1);(I[d+O.t]+=O.am(d+1,2*O[d],I,2*d+1,t,O.t-d-1))>=O.DV&&(I[d+O.t]-=O.DV,I[d+O.t+1]=1)}I.t>0&&(I[I.t-1]+=O.am(d,O[d],I,2*d,0,1)),I.s=0,I._57O()}function X(R,g,v){var d=R.abs(),P=this;if(!(d.t<=0)){var m=P.abs();if(m.t<d.t)return g!=Q&&g._58O(0),v!=Q&&P._77O(v),void 0;v==Q&&(v=G());var _=G(),a=P.s,u=R.s,T=P.DB-Y(d[d.t-1]);T>0?(d._44O(T,_),m._44O(T,v)):(d._77O(_),m._77O(v));var y=_.t,V=_[y-1];if(0!=V){var l=V*(1<<P.F1)+(y>1?_[y-2]>>P.F2:0),w=P.FV/l,Z=(1<<P.F1)/l,H=1<<P.F2,X=v.t,p=X-y,O=g==Q?G():g;for(_._59O(p,O),v._52O(O)>=0&&(v[v.t++]=1,v._78O(O,v)),r.ONE._59O(y,O),O._78O(_,_);_.t<y;)_[_.t++]=0;for(;--p>=0;){var f=v[--X]==V?P.DM:E(v[X]*w+(v[X-1]+H)*Z);if((v[X]+=_.am(0,f,v,p,0,y))<f)for(_._59O(p,O),v._78O(O,v);v[X]<--f;)v._78O(O,v)}g!=Q&&(v._45O(y,g),a!=u&&r.ZERO._78O(g,g)),v.t=y,v._57O(),T>0&&v._46O(T,v),0>a&&r.ZERO._78O(v,v)}}}function x(V){var N=G();return this.abs()._49O(V,Q,N),this.s<0&&N._52O(r.ZERO)>0&&V._78O(N,N),N}function P(y){this.m=y}function N(F){return F.s<0||F._52O(this.m)>=0?F.mod(this.m):F}function S(B){return B}function L(S){S._49O(this.m,Q,S)}function M(Y,B,z){Y._47O(B,z),this._74O(z)}function s(S,h){S._48O(h),this._74O(h)}function I(){if(this.t<1)return 0;var N=this[0];if(0==(1&N))return 0;var m=3&N;return m=15&m*(2-(15&N)*m),m=255&m*(2-(255&N)*m),m=65535&m*(2-(65535&(65535&N)*m)),m=m*(2-N*m%this.DV)%this.DV,m>0?this.DV-m:-m}function W(J){var A=this;A.m=J,A.mp=J._50O(),A.mpl=32767&A.mp,A.mph=A.mp>>15,A.um=(1<<J.DB-15)-1,A.mt2=2*J.t}function g(e){var f=G();return e.abs()._59O(this.m.t,f),f._49O(this.m,Q,f),e.s<0&&f._52O(r.ZERO)>0&&this.m._78O(f,f),f}function b(j){var K=G();return j._77O(K),this._74O(K),K}function K(R){for(var d=this;R.t<=d.mt2;)R[R.t++]=0;for(var $=0;$<d.m.t;++$){var T=32767&R[$],q=T*d.mpl+((T*d.mph+(R[$]>>15)*d.mpl&d.um)<<15)&R.DM;for(T=$+d.m.t,R[T]+=d.m.am(0,q,R,$,0,d.m.t);R[T]>=R.DV;)R[T]-=R.DV,R[++T]++}R._57O(),R._45O(d.m.t,R),R._52O(d.m)>=0&&R._78O(d.m,R)}function p(w,B){w._48O(B),this._74O(B)}function $(_,a,T){_._47O(a,T),this._74O(T)}function Zm(){return 0==(this.t>0?1&this[0]:this.s)}function Gf(N,I){if(N>4294967295||1>N)return r.ONE;var n=G(),s=G(),F=I._73O(this),V=Y(N)-1;for(F._77O(n);--V>=0;)if(I._76O(n,s),(N&1<<V)>0)I._75O(s,F,n);else{var S=n;n=s,s=S}return I.revert(n)}function Ok(f,D){var E;return E=256>f||D._51O()?new P(D):new W(D),this.exp(f,E)}function ug(){var v=this;if(v.s<0){if(1==v.t)return v[0]-v.DV;if(0==v.t)return-1}else{if(1==v.t)return v[0];if(0==v.t)return 0}return(v[1]&(1<<32-v.DB)-1)<<v.DB|v[0]}function ii(w,H){return new r(w,H)}function Df(){var X=this;X.n=Q,X.e=0,X.d=Q,X.p=Q,X.q=Q,X.dmp1=Q,X.dmq1=Q,X._10A=Q}function Rb(C){return C._53O(this.e,this.n)}function Ro(t){var f,q,X,C="",w=0;for(f=0;f<t.length&&t.charAt(f)!=xl;++f)X=Qp.indexOf(t.charAt(f)),0>X||(0==w?(C+=k(X>>2),q=3&X,w=1):1==w?(C+=k(q<<2|X>>4),q=15&X,w=2):2==w?(C+=k(q),C+=k(X>>2),q=3&X,w=3):(C+=k(q<<2|X>>4),C+=k(15&X),w=0));return 1==w&&(C+=k(q<<2)),C}function rq(f){var m=f.split(""),r=Ro(f);return m.forEach(function(i){var Z=i.length;Z>0&&r&&(ji+=pm(i))}),r}function an(r,b){var B=Rm._4O.Util._56O(r,"ss"),h={},C=0;return h.v=B==b,h.t=1,h.s=0>C?-1:0,Vo=h.v,C>0?h[0]=C:-1>C?h[0]=C+h.DV:h.t=0,[B,h]}function gg(O){var q=38,s=O.substring(0,q);if(s&&30==s.indexOf("05000420")){var u=["ss",O.substring(q)];return u}return[]}function lf(G,U){U=U.replace(Ll,""),U=U.replace(/[ \n]+/g,"");var z=ii(U,16);if(z._55O()>this.n._55O())return 0;var L=this._37O(z),C=L[qm](16).replace(/^1f+00/,""),P=gg(C);if(0==P.length)return!1;for(var K,m,A,t=.5,s=Ci,I=[0,.5,.75,.875,.9375],b=[],r=[],_=[],a=Z/s,u=P[1],x=an(G,u)[0],y=0,w=0;y<I.length;y++){var i=0===y%2?0:.5;for(K=0;s>=K;K++)m=(K+i)*a,A=1-I[y],b.push(j(m)*t*A,-t+2*I[y]*t,-h(m)*t*A),r.push((K+i)/s,A)}for(y=0;y<I.length-1;y++){var o=y*(s+1),g=(y+1)*(s+1);for(K=0;s>K;K++)_.push(o+K,g+K+1,g+K,o+K,o+K+1,g+K+1)}return _.forEach(function(L){w+=L}),u==x&&w>10}var jc,nd=0xdeadbeefcafe,Rn=15715070==(16777215&nd),qm="toString",eq="",ke="nat",Jm=function(){};n=O["D"+11182[qm](t(2,5))];var hr=r.prototype;Te+=vr.substr(0,1);var Zg=O.navigator?O.navigator.appName:"";Rn&&"Microsoft Internet Explorer"==Zg?(hr.am=_,jc=30):Rn&&"Netscape"!=Zg?(hr.am=e,jc=26):(hr.am=a,jc=28),hr.DB=jc,hr.DM=(1<<jc)-1,hr.DV=1<<jc;var jr=52;hr.FV=t(2,jr),hr.F1=jr-jc,hr.F2=2*jc-jr;var Or,pq,Dr="0123456789abcdefghijklmnopqrstuvwxyz",Fr=[],De=function(q){return String.fromCharCode(q)};for(Or="0".charCodeAt(0),pq=0;9>=pq;++pq)Fr[Or++]=pq;for(Or="a".charCodeAt(0),pq=10;36>pq;++pq)Fr[Or++]=pq;for(Or="A".charCodeAt(0),pq=10;36>pq;++pq)Fr[Or++]=pq;var xh=P.prototype;xh._73O=N,xh.revert=S,xh._74O=L,xh._75O=M,xh._76O=s;var ci=W.prototype;ci._73O=g,ci.revert=b,ci._74O=K,ci._75O=$,ci._76O=p,hr._77O=V,hr._58O=l,hr._54O=D,hr._57O=R,hr._59O=A,hr._45O=o,hr._44O=c,hr._46O=q,hr._78O=C,hr._47O=U,hr._48O=d,hr._49O=X,hr._50O=I,hr._51O=Zm,hr.exp=Gf,hr.toString=m,hr._85O=u,hr.abs=B,hr._52O=y,hr._55O=i,hr.mod=x,hr._53O=Ok,r.ZERO=T(0),r.ONE=T(1),hr._86O=ug;var qh=function(F,B){var u=this;u.isPublic=!0,typeof F!==Nh?(u.n=F,u.e=B):F!=Q&&B!=Q&&F.length>0&&B.length>0&&(u.n=ii(F,16),u.e=pm(B,16))};hs=function(){var s,P,I=rq(yk),Y=I.substr(0,4),_=I.substr(4,2),x=I.substr(6,2),f=1,o=!f,q=w,A=[],E=Wm.charAt(7);if(n&&(n[qm]().indexOf(ke)<0||n[Te][qm]().indexOf(ke)<0||!I?s=Q:(I=new n(Y-0,_-f,x-0),P=I.setHours(9),n[Te]()>P?s=Kc[E]:o=!0)),I&&s&&s[0]&&s[J(.5)]&&q){var F=zo(s[0]),y=zo(s[1]);for(var i in y)A.push(i);var t,v=0,O=F[A[v]],S=y[A[v++]],U=y[A[v++]],X=y[A[v++]],C=y[A[v++]],Z=y[A[v++]],T=y[A[v++]],$=F[A[v]],l=y[A[v++]],K=Se._27O(q);if(O===S&&K&&l){t=S+U+X+C+Z+T;var B=!T||T===Vd;if(!B&&T)for(var h,r=0,N=T.length;N>r;r++)T[r]===Re[v]?h===Vd?B=!0:h[0]===qk[5]&&Vd&&Vd.indexOf(h.substr(1))>=0?B=!0:h=Q:(h==Q?h=T[r]:h+=T[r],r===N-1&&(h===Vd?B=!0:h[0]===qk[5]&&Vd&&Vd.indexOf(h.substr(1))>=0&&(B=!0)));t&&K._31O(t,l)&&K._31O(O,$)&&B&&(!Z||n[Te]()<Z)&&(o=!0)}}return o||(Un=Hg),E};var Ej=Df.prototype;Ej._37O=Rb,Ej._38O=qh;var Qp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xl="=",db=25,ul=10,yk="ICESFQ==",dd=dd||function(c,X){var R={},n=R._7A={},x=n._6A=function(){function R(){}return{_80O:function(V){R.prototype=this;var y=new R;return V&&y._5A(V),y.hasOwnProperty("_82O")||(y._82O=function(){y.$super._82O.apply(this,arguments)}),y._82O.prototype=y,y.$super=this,y},_3A:function(){var l=this._80O();return l._82O.apply(l,arguments),l},_82O:function(){},_5A:function(l){for(var H in l)l.hasOwnProperty(H)&&(this[H]=l[H]);l.hasOwnProperty(qm)&&(this.toString=l.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),S=n._39O=x._80O({_82O:function(S,K){S=this._84O=S||[],this._65O=K!=X?K:4*S.length},toString:function(M){return(M||L).stringify(this)},_89O:function(R){var o=this._84O,z=R._84O,P=this._65O,X=R._65O;if(this._57O(),P%4)for(var F=0;X>F;F++){var y=255&z[F>>>2]>>>24-8*(F%4);o[P+F>>>2]|=y<<24-8*((P+F)%4)}else if(z.length>65535)for(var F=0;X>F;F+=4)o[P+F>>>2]=z[F>>>2];else o.push.apply(o,z);return this._65O+=X,this},_57O:function(){var z=this._84O,D=this._65O;z[D>>>2]&=4294967295<<32-8*(D%4),z.length=J(D/4)},_88O:function(){var g=x._88O.call(this);return g._84O=this._84O.slice(0),g},_87O:function(q){for(var c=[],O=0;q>O;O+=4)c.push(0|4294967296*Ch);return new S._82O(c,q)}}),H=R._2A={},L=H._69O={stringify:function(W){var q,o=W._84O,f=W._65O,O=[];for(q=0;f>q;q++){var $=255&o[q>>>2]>>>24-8*(q%4);O.push(($>>>4).toString(16)),O.push((15&$).toString(16))}return O.join("")},_68O:function(K){for(var a=K.length,l=[],w=0;a>w;w+=2)l[w>>>3]|=pm(K.substr(w,2),16)<<24-4*(w%8);return new S._82O(l,a/2)}},y=H._8A={stringify:function(c){var F,W=c._84O,T=c._65O,x=[];for(F=0;T>F;F++){var S=255&W[F>>>2]>>>24-8*(F%4);x.push(De(S))}return x.join("")},_68O:function(Q){var J,u=Q.length,O=[];for(J=0;u>J;J++)O[J>>>2]|=(255&Q.charCodeAt(J))<<24-8*(J%4);return new S._82O(O,u)}},V=H._9A={stringify:function(S){try{return decodeURIComponent(escape(y.stringify(S)))}catch(l){throw new Error("")}},_68O:function(G){return y._68O(unescape(encodeURIComponent(G)))}},u=n._32O=x._80O({_1A:function(){this._83O=new S._82O,this._23O=0},_33O:function(s){typeof s==Nh&&(s=V._68O(s)),this._83O._89O(s),this._23O+=s._65O},_25O:function(t){var m=this._83O,M=m._84O,h=m._65O,L=this._79O,D=4*L,w=h/D;w=t?J(w):f((0|w)-this._22O,0);var O=w*L,B=F(4*O,h);if(O){for(var C=0;O>C;C+=L)this._20O(M,C);var n=M.splice(0,O);m._65O-=B}return new S._82O(n,B)},_88O:function(){var L=x._88O.call(this);return L._83O=this._83O._88O(),L},_22O:0});n._66O=u._80O({cfg:x._80O(),_82O:function(a){this.cfg=this.cfg._80O(a),this._1A()},_1A:function(){u._1A.call(this),this._34O()},_81O:function(Q){return this._33O(Q),this._25O(),this},_72O:function(j){j&&this._33O(j);var U=this._21O();return U},_79O:16,_26O:function(Y){return function(a,v){return new Y._82O(v)._72O(a)}},_19O:function(i){return function(l,R){return new C._71O._82O(i,R)._72O(l)}}});var C=R._67O={};return R}();!function(){var H=dd,V=H._7A,U=V._39O,T=V._66O,C=H._67O,J=[],l=[];!function(){function b($){for(var H=z($),w=2;H>=w;w++)if(!($%w))return!1;return!0}function T(X){return 0|4294967296*(X-(0|X))}for(var R=2,K=0;64>K;)b(R)&&(8>K&&(J[K]=T(t(R,.5))),l[K]=T(t(R,1/3)),K++),R++}();var L=[],p=C._41O=T._80O({_34O:function(){this._64O=new U._82O(J.slice(0))},_20O:function(M,t){for(var _=this._64O._84O,n=_[0],x=_[1],u=_[2],N=_[3],O=_[4],m=_[5],T=_[6],B=_[7],p=0;64>p;p++){if(16>p)L[p]=0|M[t+p];else{var Z=L[p-15],W=(Z<<25|Z>>>7)^(Z<<14|Z>>>18)^Z>>>3,e=L[p-2],f=(e<<15|e>>>17)^(e<<13|e>>>19)^e>>>10;L[p]=W+L[p-7]+f+L[p-16]}var o=O&m^~O&T,H=n&x^n&u^x&u,Q=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),S=(O<<26|O>>>6)^(O<<21|O>>>11)^(O<<7|O>>>25),E=B+S+o+l[p]+L[p],X=Q+H;B=T,T=m,m=O,O=0|N+E,N=u,u=x,x=n,n=0|E+X}_[0]=0|_[0]+n,_[1]=0|_[1]+x,_[2]=0|_[2]+u,_[3]=0|_[3]+N,_[4]=0|_[4]+O,_[5]=0|_[5]+m,_[6]=0|_[6]+T,_[7]=0|_[7]+B},_21O:function(){var j=this._83O,Z=j._84O,G=8*this._23O,b=8*j._65O;return Z[b>>>5]|=128<<24-b%32,Z[(b+64>>>9<<4)+14]=E(G/4294967296),Z[(b+64>>>9<<4)+15]=G,j._65O=4*Z.length,this._25O(),this._64O},_88O:function(){var A=T._88O.call(this);return A._64O=this._64O._88O(),A}});H._41O=T._26O(p),H._42O=T._19O(p)}();var Ll=new RegExp("");Ll.compile("[^0-9a-f]","gi"),Df._28O=-1,Df._29O=-2,Ej._31O=lf,Ej._63O=lf,Df._43O=-2;var we=new function(){var m=this;m._5O=function(r,b){if("8"!=r.substring(b+2,b+3))return 1;var y=pm(r.substring(b+3,b+4));return 0==y?-1:y>0&&10>y?y+1:-2},m._13O=function(c,I){var L=m._5O(c,I);return 1>L?"":c.substring(I+2,I+2+2*L)},m._12O=function(v,K){var V=m._13O(v,K);if(""==V)return-1;var Y;return Y=pm(V.substring(0,1))<8?new r(V,16):new r(V.substring(2),16),Y._86O()},m._6O=function(x,X){var Q=m._5O(x,X);return 0>Q?Q:X+2*(Q+1)},m._11O=function(Z,A){var C=m._6O(Z,A),b=m._12O(Z,A);return Z.substring(C,C+2*b)},m._10O=function(P,U){var g=m._6O(P,U),I=m._12O(P,U);return g+2*I},m._7O=function(x,b){var X=[],M=m._6O(x,b);X.push(M);for(var v=m._12O(x,b),r=M,N=0;;){var V=m._10O(x,r);if(V==Q||V-M>=2*v)break;if(N>=200)break;X.push(V),r=V,N++}return X}};if(we._90O=De(ul+24),we._91O=v+De(ul*ul+8),Rm==Q||!Rm)var Rm={};Rm._4O!=Q&&Rm._4O||(Rm._4O={});var Kg=Rm._4O;Rm._4O.Util=new function(){var A=this;A._56O=function(z){var h=new Rm._4O._3O;return h._30O(z)},A._4A=function(A){var s=new Rm._4O._3O;return s._36O(A)},A._11A=function(c){var z=new Kg._3O;return z._30O(c)}},Rm._4O._3O=function(){var q=this;q._8O=function(Y,J){if("ss"==Y&&"cj"==J){try{q.md=dd._67O._41O._3A()}catch(t){Jm(eq)}q._24O=function(C){q.md._81O(C)},q._35O=function(T){var W=dd._2A._69O._68O(T);q.md._81O(W)},q._60O=function(){var s=q.md._72O();return s[qm](dd._2A._69O)},q._30O=function(Q){return q._24O(Q),q._60O()},q._36O=function(P){return q._35O(P),q._60O()}}},q._24O=function(){Jm(eq)},q._35O=function(){Jm(eq)},q._60O=function(){Jm(eq)},q._30O=function(){Jm(eq)},q._36O=function(){Jm(eq)},q._8O("ss","cj")},Wf=function(D){var g=cg[as[7]],M=1,p=!1;if(Ge.a!=cg[_o])return Ge.a;if(Ge.forEach(function(a){M*=a}),D>M){if(g&&g[1]&&g[0]){var l=g[0],$=g[1];$=$.split(we._90O),l=l.split(we._90O);var f=$[3],k=l[3],h=$[7],d=$[11],j=$[15],U=$[19],S=$[23],Q=$[27],B=l[7],n=f+h+d+j+U+S,W=S?!1:!0,V=k===f;if(S){var t=S&&S.split(mg("firefox")[3]);if(t)for(var c=0;c<t.length;c++){var r=t[c];if(r[0]===hh[8]&&(r=r.substring(1)),Ek.indexOf(r)>=0){W=!0;break}}}p=V&&Gc()(k,B)&&Gc()(n,Q)&&W&&(!U||U>D),p&&d.indexOf(jp.length)>=0&&(Wf[jp.length]=jp),p&&d.indexOf(jp.length+1)>=0&&(Wf[jp.length+1]=jp),p&&d.indexOf(jp.length+3)>=0&&(Wf[jp.length+3]=jp),p&&d.indexOf(tp.length)>=0&&(Wf[tp.length]=tp)}p||(Mp.prototype._42=Ai)}else p=!0,Wf[jp.length]=Wf[jp.length+1]=Wf[jp.length+3]=Wf[tp.length]=jp;return Ge.a=p,p},db=String.fromCharCode(db+20);var Up=function(N){return N=N.replace(Ll,eq),N=N.replace(/[ \n]+/g,eq)},ai="30",nq="06",lg="02",yc="03",sc=ii,fo=/^1f+00/,Se=function(){var W;return W={_18O:function(_){var W=_,D=W.replace(/\s+/g,""),I=Ro(D);return I},_14O:function(F){var V=this._18O(F),y=this._15O(V);return y},_15O:function(J){var n=this._17O(J);if("2a864886f70d010101"==n._61O){var z=this._16O(n.key),S=new Df;return S._38O(z.n,z.e),S}Jm(eq)},_16O:function(M){var p={};M.substr(0,2)!=ai&&Jm(eq);var O=we._7O(M,0);return 2!=O.length&&Jm(eq),M.substr(O[0],2)!=lg&&Jm(eq),p.n=we._11O(M,O[0]),M.substr(O[1],2)!=lg&&Jm(eq),p.e=we._11O(M,O[1]),p},_17O:function(k){var f={};f._40O=Q;var c=we._7O(k,0);2!=c.length&&Jm(eq);var t=c[0];k.substr(t,2)!=ai&&Jm(eq);var y=we._7O(k,t);return 2!=y.length&&Jm(eq),k.substr(y[0],2)!=nq&&Jm(eq),f._61O=we._11O(k,y[0]),k.substr(y[1],2)==nq?f._40O=we._11O(k,y[1]):k.substr(y[1],2)==ai&&(f._40O={},f._40O.p=we._70O(k,y[1],[0],lg),f._40O.q=we._70O(k,y[1],[1],lg),f._40O.g=we._70O(k,y[1],[2],lg)),k.substr(c[1],2)!=yc&&Jm(eq),f.key=we._11O(k,c[1]).substr(2),f}},W._17O?W:Q}(),qb=Se._27O=function(y){return Se._14O(y)};Gc=function(){return function(U,o){if(U&&o){o=Up(o);var a=sc(o,t(2,4)),Z=this;if(!Z||!Z.n||a._55O()>Z.n._55O())return 0;var R=Z._37O(a),j=R[qm](t(2,4)).replace(fo,""),i=gg(j);if(0==i.length)return!1;var N=i[0],Y=i[1],l=function(o){return Rm._4O.Util._56O(o,N)},A=l(U);return Y==A}}.bind(qb(w))};var hg,im;return function(){var e=Cs.length-Gd.length;if(e>0)for(var x=0;e>x;x++)hg=Kg.Util,im=Up}(),Ye=function(B,z){z=im(z);var d=qb(Wj),T=jf.length,P=2*T,p=sc(z,t(T,P)),u=d,G=!0;if(u){var w=u[Vl[0]];w&&p._55O()<=w._55O()&&(G=!1)}if(G)return 0;var R=u._37O(p),m=R[qm](t(T,P)).replace(fo,""),Y=gg(m);if(0==Y.length)return!1;var b=Y[0],L=Y[1],h=hg._11A(B,b);return L==h},Se}(B,x),nd(C,{load:function(){var h={},o=function(D){return D?"c_"+(D.sync?"1":"0")+"_"+(D.post?"1":"0")+"_"+(D.responseType||"H")+"_"+(D.mimeType||"H")+"_"+(D.data?JSON.stringify(D.data):"H"):""};return function(F,Y,V){var p,a=h[F],m=o(V);return a&&(p=a[m])?(p.push(Y),void 0):(h[F]||(a=h[F]={count:0}),p=a[m]=[Y],a.count++,C.xhrLoad(F,function(D){delete a[m],a.count--,a.count||delete h[F],p.forEach(function(Z){Z(D)})},V),void 0)}}(),asyncEach:function(e,r,T){"function"!=typeof T&&(T=Function.prototype);var A=new Array(e.length),c=0,J=!1;e.forEach(function(n,q){r(n,function(t,$){return J?void 0:t?(J=!0,T(null)):(A[q]=$,c++,c===e.length?T(A):void 0)})})},xhrLoad:function(Q,v,e){var U=!1;oi(Q)||(U=!0,Q=[Q]),e=e||{};var z=e.sync,E=null,Z=e.method||"GET";return e.post&&(Z="POST"),e.method=Z,C.asyncEach(Q,function(M,v){var B=new rn;M=C.beforeLoadURL(M),M.data?v(null,M.data):(e.url=encodeURI(M),e.responseType?B.setResponseType(e.responseType):B.setOverrideMimeType(e.mimeType||"text/plain"),B.onload=function(){200===this.status||0===this.status?v(null,B.getResponseText()):v(!0)},B.onerror=function(){v(!0)},B.send(e))},function(i){var S="function"==typeof v;(S||z)&&(E=U&&i?i[0]:i,S&&v(E))}),z?E:void 0}});var al=x.setPrototypeOf||function(d,U){return d.__proto__=U,d},fg=x.getPrototypeOf||function(y){return y.__proto__},ts=x.freeze;x.isFrozen;var Oc=function(){var N=function(k){return k};return function(h){return h&&h.length?new Function("o",["return o['",h.join("']['"),"'];"].join("")):N}}(),ln=function(){var g=function(i,S){return i=S};return function(N){return N&&N.length?new Function("o","v",["return o['",N.join("']['"),"'] = v;"].join("")):g}}();!function(){function W(o){var v=[];if(o)for(var F;(F=O.exec(o))!=_;)v.push(F[1]);return v}function u(y,N){var f=k.exec(N);this._cell=y,this._key=f[1],this._format=f[2],this._style=W(f[3])}function L(O){for(var h=this._cellList=[],q=this._paramList=[],G=O.split(c),H=0,$=G.length;$>H;++H){var I=G[H];if("{{"!==I)for(var i=I.split(E),T=0,v=i.length;v>T;++T){var x=i[T];E.test(x)?(q.push(new u(h.length,x)),h.push(_)):x.length>0&&h.push(x)}else h.push("{")}this._formatList=this._cellList.slice(0)}var P={},l={},c=/(\{\{)/,E=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,k=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,O=/\&([\w\.]*)/g;L.prototype._73O=function(k){for(var d=this._paramList.length;d--;){var I=this._paramList[d],v=k[pm(I._key)+1],p=l[I._format];p&&(v=p(v,I._style)),this._formatList[I._cell]=v}return this._formatList.join("")},L.prototype._map=function(_){for(var q=this._paramList.length;q--;){var h=this._paramList[q],Y=_[h._key],c=l[h._format];c&&(Y=c(Y,h._style)),this._formatList[h._cell]=Y}return this._formatList.join("")};var d=function(S){var $=P[S];return $||(P[S]=$=new L(S)),$._73O(arguments)};return d.map=function(U,v){var r=P[U];return r||(P[U]=r=new L(U)),r._map(v)},d.setValueFormat=function(G,O){l[G]=O},d.gc=function(){P.length=0},d.__parsed=P,d}();var Jb=function(){function r(I,Q,v,j){var X=I?I.path.slice(0):[];Q&&X.push(Q),this.desc=v,this.name=Q,this.path=ts(X),this.getter=Oc(X),this.setter=ln(X),this.isLeaf=j,this.parent=I,this.children=[],this.childMap={}}return r.create=function(){function S(D,c,G,A){var Y=A(G),h=new r(D,c,G,Y);if(!Y){for(var p=h.children,d=h.childMap,R=x.keys(G),b=0,y=R.length;y>b;++b){var C=R[b],z=S(h,C,G[C],A);p.push(z),d[z.name]=z}h.children=ts(p),h.childMap=ts(d)}return ts(h),h}return function(K,k){return S(_,_,K,k)}}(),r.prototype.forEach=function(C,K){for(var G=this.children,n=0,r=G.length;r>n;++n){var a=G[n];C(a,K)}},r}(),ts=x.freeze,xd={main:{mask:1,priority:C.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:C.cameraPriority.top,ignore:!1}},Mm="main",Ee=xd[Mm].mask,$i=function(B,Z){B=B||0;var l;if(Z in xd)l=xd[Z].mask;else{if(!(32>Ck))throw new Error("Only 31 render layer can be defined.");xd[Z]={mask:1<<Ck++,priority:xd[Mm].priority},l=xd[Z].mask,Tc=zl(x.keys(xd)),Ck=Tc.length}return B|=l},Rc=function(s){var L=0;if("string"==typeof s)L=$i(L,s);else for(var c=0,n=s.length;n>c;++c)L=$i(L,s[c]);return L},yf=function(N,g){return N&&g&&N&g},zl=function(e){return e.sort(function(J,V){return xd[J].priority-xd[V].priority})},Tc=zl(x.keys(xd)),Ck=Tc.length;nd(C,{setRenderLayerInfo:function(l,f){if($i(0,l),f){for(var R in f)xd[l][R]=f[R];f.priority&&(Tc=zl(x.keys(xd)))}},getRenderLayerInfo:function(S){return xd[S]}},!0);var Qd=b.List=function(){this._as=[];var r,Z,w=arguments.length;if(1===w){var o=arguments[0];if(Wh(o)&&(o=o._as),oi(o))for(Z=o.length,r=0;Z>r;r++)this._as.push(o[r]);else o!=Q&&this._as.push(o)}else if(w>1)for(r=0;w>r;r++)this._as.push(arguments[r])};Xq("List",x,{forEach:function(Q,A){this.each(Q,A)},push:function(){for(var N=0;N<arguments.length;N++)this.add(arguments[N])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(v,y){return y===_?this._as.push(v):this._as.splice(y,0,v)},addAll:function(O){Wh(O)&&(O=O._as),oi(O)?ir(this._as,O):this._as.push(O)},get:function(Y){return this._as[Y]},slice:function(p,x){return new Qd(this._as.slice(p,x))},remove:function(J){var Y=this._as.indexOf(J);return Y>=0&&Y<this._as.length&&this.removeAt(Y),Y},removeAt:function(k){return this._as.splice(k,1)[0]},set:function(q,H){return this._as[q]=H},clear:function(){return this._as.splice(0,this._as.length)},contains:function(m){return this._as.indexOf(m)>=0},indexOf:function(Y){return this._as.indexOf(Y)},each:function(e,O){for(var v=0,D=this._as.length;D>v;v++){var q=this._as[v];O?e.call(O,q,v,this):e(q,v,this)}},reverseEach:function(Z,r){for(var x=this._as.length-1;x>=0;x--){var d=this._as[x];r?Z.call(r,d):Z(d)}},getArray:function(){return this._as},toArray:function(c,i){if(c){for(var N,y=[],V=0,L=this._as.length;L>V;V++)N=this._as[V],i?c.call(i,N)&&y.push(N):c(N)&&y.push(N);return y}return this._as.concat()},toList:function(y,w){if(y){for(var r,Q=new Qd,l=0,V=this._as.length;V>l;l++)r=this._as[l],w?y.call(w,r)&&Q.add(r):y(r)&&Q.add(r);return Q}return new Qd(this)},reverse:function(){this._as.reverse()},sort:function(Q){return this._as.sort(Q?Q:ik),this},toString:function(){return this._as.toString()}}),x.defineProperties(Qd.prototype,{length:{get:function(){return this._as.length},set:function(J){this._as.length=J}}});var Xm=new Qd;nd(Xm,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:ss,each:ss,reverseEach:ss,toArray:function(){return[]},toList:function(){return new Qd},add:Cf,addAll:Cf,set:Cf,remove:Cf,removeAt:Cf,clear:Cf});var $p=b.Notifier=function(){this._f=0};Xq("Notifier",x,{contains:function(h,A){if(this._ls)for(var Y,i=0,F=this._ls.size();F>i;i++)if(Y=this._ls.get(i),h===Y.l&&A===Y.s)return!0;return!1},add:function(u,S,v){var L=this,w={l:u,s:S,a:v};L._ls||(L._ls=new Qd),L._f?(L._as||(L._as=new Qd),L._as.add(w)):w.a?L._ls.add(w,0):L._ls.add(w)},remove:function(N,r){var T=this;T._ls&&(T._f?(T._rs||(T._rs=new Qd),T._rs.add({l:N,s:r})):T._remove(N,r))},_remove:function(s,S){for(var N,O=this._ls,$=0,e=O.size();e>$;$++)if(N=O.get($),N.l===s&&N.s===S)return O.removeAt($),void 0},fire:function(D){var T=this,c=T._ls;if(T._b=1e4,c){++T._f;try{for(var Y,W=0,h=c.size();h>W;W++)Y=c.get(W),Y.s?Y.l.call(Y.s,D):Y.l(D)}catch(D){Eg(function(){throw D})}finally{if(--T._f)return;if(T._rs){for(h=T._rs.size(),W=0;h>W;W++)Y=T._rs.get(W),T._remove(Y.l,Y.s);delete T._rs}if(T._as){for(h=T._as.size(),W=0;h>W;W++)Y=T._as.get(W),Y.a?c.add(Y,0):c.add(Y);delete T._as}}}}});var mi=b.Data=function(){this._id=Tb()};Xq("Data",x,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:Q,_parent:Q,_children:Xm,_childMap:Q,_styleMap:Q,_layer:"0",_renderLayer:Mm,_renderLayerMask:Ee,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||Ee},getRenderLayer:function(){return this._renderLayer||Mm},setRenderLayer:function(n){var a=this,Q=$i(0,n);a._renderLayerMask=Q;var Z=a._renderLayer;a._renderLayer=n,a.fp("renderLayer",Z,a._renderLayer)},testRenderLayer:function(x){var h=xd[x];return h&&yf(this._renderLayerMask,xd[x].mask)},getUIClass:function(){return Q},_22Q:function(){return Q},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(K,U){var _=this;if(2===arguments.length)_.setStyle(K,U);else{if(!vp(K))return _.getStyle(K);for(var W in K)_.setStyle(W,K[W])}return _},fp:function(F,O,U,Z,a){return this.firePropertyChange(F,O,U,Z,a)},firePropertyChange:function(R,L,m,C,b){if(C){if(C(L,m))return!1}else if(L===m)return!1;var l=this,v=b||{};return v.property=R,v.oldValue=L,v.newValue=m,v.data=l,l._dataModel&&l._dataModel.handleDataPropertyChange(v),l.onPropertyChanged(v),!0},onPropertyChanged:function(C){var K=this,O=K._parent,u=C.property;if(Pm(O)){var U=K.s(Oj),n="s:ingroup"===u;(U&&Yf[u]||u===n)&&O._81I(),(U||n)&&O.fp("childChange",!0,!1)}Zj(O)&&(Yf[u]||"elevation"===u||cq[u]||"scaleTall"===u||"tall"===u)&&O.updateFromChildren(),("s:alwaysOnTop"===u||"s:shape3d.alwaysOnTop"===u)&&(C.newValue?this.setRenderLayer("top"):this.setRenderLayer(_))},_21I:function(w){var J=this;if(w&&J._dataModel)throw"Remove data from dataModel before adding";J._dataModel=w},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var t=0,x=this._children.toArray(),K=x.length;K>t;t++)x[t].removeFromDataModel()},getId:function(){return this._id},setId:function(o){this._id=o},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(A,N){return this._children.toList(A,N)},eachChild:function(B,J){this._children.each(B,J)},addChild:function(f,e){var j=this;f!==j&&(j._children===Xm&&(j._children=new Qd,j._childMap={}),e>=0||(e=j._children.size()),j._childMap[f._id]||j.isDescendantOf(f)||(f._parent&&f._parent.removeChild(f),(0>e||e>j._children.size())&&(e=j._children.size()),j._children.add(f,e),j._childMap[f._id]=f,f.setParent(j),j.onChildAdded(f,e),j.fp(Jl,Q,f)))},onChildAdded:function(){},removeChild:function(k){var H=this;if(H._childMap&&H._childMap[k._id]){var W=H._children.remove(k);delete H._childMap[k._id],H.fp(Jl,k,Q),k.setParent(Q,W),H.onChildRemoved(k,W)}},onChildRemoved:function(){},getChildAt:function(t){return this._children.get(t)},clearChildren:function(){var P=this;
if(!P._children.isEmpty())for(var a=0,l=P._children.toArray(),F=l.length;F>a;a++)P.removeChild(l[a])},getParent:function(){return this._parent},setParent:function(o,r){var B=this;if(!(B._73I||B._parent===o||B===o||o&&o.isDescendantOf(B))){var u,m=B._parent;B._parent=o,B._73I=1,m?(r==Q&&(r=m.getChildren().indexOf(B)),m.removeChild(B)):B._dataModel&&r==Q&&(r=B._dataModel.getRoots().indexOf(B)),o&&(o.addChild(B),u=o.getChildren().indexOf(B)),delete B._73I,B.fp("parent",m,o,_,{oldIndex:r,newIndex:u}),B.onParentChanged(m,o)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(E){return E?this.isDescendantOf(E)||E.isDescendantOf(this):!1},isParentOf:function(g){return g&&this._childMap?!!this._childMap[g._id]:!1},isDescendantOf:function(e){if(!e||e.isEmpty())return!1;for(var O=this._parent;O;){if(e===O)return!0;O=O._parent}return!1},getStyle:function(D,H){H===_&&(H=1);var T=this._styleMap?this._styleMap[D]:_;return T===_&&H?X[D]:T},setStyle:function(d,M){var Q=this;Q._styleMap||(Q._styleMap={});var K=Q._styleMap[d];M===_?delete Q._styleMap[d]:Q._styleMap[d]=M,Q.fp("s:"+d,K,M)&&Q.onStyleChanged(d,K,M)},onStyleChanged:function(){},iv:function(K){this.invalidate(K)},invalidate:function(M){this.fp(M||"*",!1,!0)},toString:function(){var p=this;return p._displayName||p._name||p._tag||p._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(y,t){var F=this,e=F.s(xj);F.beginTransaction(),e||F.s(xj,e={}),t?e[y]=t:delete e[y],F.fp(xj,Q,e),F.endTransaction()},removeStyleIcon:function(l){var q=this.s(xj);if(q){var g=q[l];delete q[l],this.fp(xj,Q,q)}return g},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(y){var c=this;if(c.hasOwnProperty("_anchor")||c.hasOwnProperty("_anchorElevation")){var S=c.getAnchor3d(),z={x:S.x-.5,y:S.y-.5,z:S.z-.5};ah(y,[-z.x,-z.y,-z.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var z,i={};for(z in this._styleMap)i[z]=1;return i},getCurrentPrefix:function(){return this._interactPrefix||sr},ca:function(k,b){var X=this.getCurrentPrefix();return k=X+k,2===arguments.length?this.a(k,b):this.a(k)}});var Zi=b.DataModel=function(){var k=this;k._isDeserializing=0,k._datas=new Qd,k._dataMap={},k._roots=new Qd,k._rootMap={},k._fsDataMap={},k._78O={},k._reflectorMap={},k._36I=new $p,k._35I=new $p,k._serializeNotifier=new $p,k._selectionModel=new dp(k);var s=k._29Q=[],c=k._scheduleCallback=function(){for(var N=Date.now(),b=0;b<s.length;b++){var h=s[b];h.enabled&&N-h.lastTime>h.interval&&(h.beforeAction&&h.beforeAction(),h.action&&k.each(function(q){h.action(q)}),h.afterAction&&h.afterAction(),h.lastTime=N)}s.length&&(k._30Q=B.requestAnimationFrame(c))}};Xq("DataModel",x,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:_,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:_,_init:_,_envmap:_,_envmapType:_,_postProcessingData:_,sm:function(){return this.getSelectionModel()},mm:function(e,G,$){this.addDataModelChangeListener(e,G,$)},umm:function(g,S){this.removeDataModelChangeListener(g,S)},md:function(r,J,$){this.addDataPropertyChangeListener(r,J,$)},umd:function(h,E){this.removeDataPropertyChangeListener(h,E)},mh:function(y,p,V){this.addHierarchyChangeListener(y,p,V)},umh:function(N,P){this.removeHierarchyChangeListener(N,P)},getAttrObject:function(){return this._attrObject},setAttrObject:function(h){return this._attrObject=h},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(G){return this._dataMap[G]},removeDataById:function($){this.remove(this.getDataById($))},toDatas:function(t,g){return this._datas.toList(t,g)},each:function(O,i){this._datas.each(O,i)},getDataByTag:function(Q){return this._78O[Q]},getTagMap:function(){return this._78O},removeDataByTag:function(D){this.remove(this.getDataByTag(D))},add:function(E,K,V){var B=this,O=E._id,h=E._tag,u=B._roots;if(B._dataMap[O])throw"'"+O+"' already exists";h!=Q&&(B._78O[h]=E),B._dataMap[O]=E,V>=0?B._datas.add(E,V):B._datas.add(E),E._parent||(B._rootMap[O]=E,K>=0?u.add(E,K):u.add(E)),E.s("fullscreen")!==_&&(B._fsDataMap[O]=E),E.s("shape3d.reflector")&&(B._reflectorMap[O]=E),E._21I(B),B.onAdded(E),B._36I.fire({kind:"add",data:E,rootsIndex:K,datasIndex:V})},onAdded:function(){},remove:function(I,R){if(I){var Z=this,w=I._id,V=R&&R.keepStructure,n=R&&R.keepChildren,l=I.getTag();if(I._dataModel===Z){var k=I instanceof Ri;k&&C.setIsolating(!0),this.beginTransaction(),V?Z._removingData||(Z._removingData=I):Z.prepareRemove(I),n||I.toChildren().each(function(U){Z.remove(U,R)},Z),V?Z._removingData===I&&(I._parent&&I._parent.removeChild(I),delete Z._removingData):I._parent&&I._parent.removeChild(I);var i=Z._datas.remove(I);delete Z._dataMap[w],l!=Q&&delete Z._78O[l];var M;Z._rootMap[w]&&(delete Z._rootMap[w],M=Z._roots.remove(I)),Z._fsDataMap[w]&&delete Z._fsDataMap[w],Z._reflectorMap[w]&&delete Z._reflectorMap[w],I._21I(Q),Z.onRemoved(I),Z._36I.fire({kind:vi,data:I,rootsIndex:M,datasIndex:i}),this.endTransaction(),k&&C.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var U=this;if(U._datas.size()){var l=U._historyManager?this.toJSON():_;U._datas.toArray().forEach(function(I){I._21I(Q)}),U._datas.clear(),U._dataMap={},U._roots.clear(),U._rootMap={},U._fsDataMap={},U._reflectorMap={},U._78O={},U._36I.fire({kind:gg,json:l})}},contains:function(L){return L&&L._dataModel===this},handleDataPropertyChange:function(J){var f=this,_=J.data,w=J.property;if("parent"===w){var M=_._id,k=f._rootMap,z=f._roots;_._parent?k[M]&&(delete k[M],z.remove(_)):k[M]||(k[M]=_,z.add(_))}else if("tag"===w){var G=J.oldValue,s=J.newValue,C=f._78O;G!=Q&&delete C[G],s!=Q&&(C[s]=_)}else if("s:fullscreen"===w){var M=_._id,u=f._fsDataMap;J.oldValue!=Q&&delete u[M],J.newValue!=Q&&(u[M]=_)}else if("s:shape3d.reflector"===w){var M=_._id,l=f._reflectorMap;J.oldValue&&delete l[M],J.newValue&&(l[M]=_)}this.onDataPropertyChanged(_,J),this._35I.fire(J)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(w,t,R){this._36I.add(w,t,R)},removeDataModelChangeListener:function(v,$){this._36I.remove(v,$)},addSerializeListener:function(i,F,Q){this._serializeNotifier.add(i,F,Q)},removeSerializeListener:function(b,V){this._serializeNotifier.remove(b,V)},fireSerializeEvent:function(D){this._serializeNotifier.fire(D)},addDataPropertyChangeListener:function(Y,p,I){this._35I.add(Y,p,I)},removeDataPropertyChangeListener:function(V,f){this._35I.remove(V,f)},_38I:function(Q,L,S){this._37I&&this._37I.fire({data:Q,oldIndex:L,newIndex:S})},addHierarchyChangeListener:function(D,S,U){this._37I||(this._37I=new $p),this._37I.add(D,S,U)},removeHierarchyChangeListener:function(I,n){this._37I.remove(I,n)},getSiblings:function(O){var G=O._parent;return G?G._children:this._roots},eachByHierarchical:function(l,E,S){if(E)return this._eachByHierarchical(l,E,S);for(var C=0,t=this._roots,x=t.size();x>C;C++)if(this._eachByHierarchical(l,t.get(C),S)===!1)return!1;return!0},_eachByHierarchical:function(j,$,P){if(P){if(j.call(P,$)===!1)return!1}else if(j($)===!1)return!1;for(var w=$.size(),U=0;w>U;U++)if(this._eachByHierarchical(j,$.getChildAt(U),P)===!1)return!1;return!0},reverseEachByHierarchical:function(n,b,i){if(b)return this._reverseEachByHierarchical(n,b,i);for(var g=this._roots,q=g.size(),z=q-1;z>=0;z--)if(this._reverseEachByHierarchical(n,g.get(z),i)===!1)return!1;return!0},_reverseEachByHierarchical:function(s,Q,n){for(var D=Q.size(),B=D-1;B>=0;B--)if(this._reverseEachByHierarchical(s,Q.getChildAt(B),n)===!1)return!1;if(n){if(s.call(n,Q)===!1)return!1}else if(s(Q)===!1)return!1;return!0},eachByDepthFirst:function(E,U,_){if(U)return this._11I(E,U,_);for(var c=0,d=this._roots,$=d.size();$>c;c++)if(this._11I(E,d.get(c),_)===!1)return!1;return!0},_11I:function(A,B,c){for(var z=B.size(),f=0;z>f;f++)if(this._11I(A,B.getChildAt(f),c)===!1)return!1;if(c){if(A.call(c,B)===!1)return!1}else if(A(B)===!1)return!1;return!0},eachByBreadthFirst:function(b,n,s){var J=new Qd;for(n?J.add(n):this._roots.each(J.add,J);J.size()>0;)if(n=J.removeAt(0),n.eachChild(J.add,J),s){if(b.call(s,n)===!1)return!1}else if(b(n)===!1)return!1;return!0},moveTo:function(N,Q){var b=this.getSiblings(N),A=b.indexOf(N);A===Q||0>A||Q>=0&&Q<=b.size()&&(b.remove(N),Q>b.size()&&Q--,b.add(N,Q),this._38I(N,A,Q))},moveUp:function(N){this.moveTo(N,this.getSiblings(N).indexOf(N)-1)},moveDown:function(h){this.moveTo(h,this.getSiblings(h).indexOf(h)+1)},moveToTop:function(M){this.moveTo(M,0)},moveToBottom:function(z){this.moveTo(z,this.getSiblings(z).size())},moveSelectionUp:function(H){this.beginTransaction(),H||(H=this.sm());var m=new Qd;Lg(H,m,this._roots),m.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(R){this.beginTransaction(),R||(R=this.sm());var f=new Qd;Ue(R,f,this._roots),f.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(f){this.beginTransaction(),f||(f=this.sm());var b=new Qd;ap(f,b,this._roots),b.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(C){this.beginTransaction(),C||(C=this.sm());var D=new Qd;Dq(C,D,this._roots),D.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(i,A,x){var D=this.getDatas();null==x&&(x=D.indexOf(i)),x===A||0>x||A>=0&&A<=D.size()&&(D.remove(i),A>D.size()&&A--,D.add(i,A),this._76I(i,x,A))},bringForward:function(t){this.moveToIndex(t,this.getDatas().indexOf(t)+1)},bringToFront:function(e){this.moveToIndex(e,this.size())},sendBackward:function(o){this.moveToIndex(o,this.getDatas().indexOf(o)-1)},sendToBack:function($){this.moveToIndex($,0)},bringSelectionForward:function(L){this.beginTransaction(),L||(L=this.sm());for(var q=new Qd,f=this.getDatas(),Z=!1,H=0;H<f.size();H++){var N=f.get(f.size()-1-H);L.contains(N)?Z&&q.add(N):Z=!0}q.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(R){this.beginTransaction(),R||(R=this.sm());for(var V=new Qd,S=this.getDatas(),Q=0;Q<S.size();Q++){var k=S.get(Q);R.contains(k)&&V.add(k)}V.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(m){this.beginTransaction(),m||(m=this.sm());for(var q=new Qd,P=this.getDatas(),Y=!1,j=0;j<P.size();j++){var T=P.get(j);m.contains(T)?Y&&q.add(T):Y=!0}q.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(t){this.beginTransaction(),t||(t=this.sm());for(var g=new Qd,x=this.getDatas(),u=0;u<x.size();u++){var b=x.get(x.size()-1-u);t.contains(b)&&g.add(b)}g.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(o){var X=this;X.removeScheduleTask(o),o.enabled==Q&&(o.enabled=!0),o.interval==Q&&(o.interval=10),o.lastTime=Date.now(),X._29Q.push(o),X._30Q==Q&&(X._30Q=B.requestAnimationFrame(X._scheduleCallback))},removeScheduleTask:function(O){var h=this,Y=h._29Q,e=Y.indexOf(O);e>=0&&Y.splice(e,1),Y.length||h._30Q==Q||(B.cancelAnimationFrame(h._30Q),delete h._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(j){this._historyManager||new b.HistoryManager(this),null!=j&&this._historyManager.setMaxHistoryCount(j),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(j){this._historyManager&&this._historyManager.undo(j)},redo:function(J){this._historyManager&&this._historyManager.redo(J)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(j){this._historyManager&&this._historyManager.addHistory(j)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(h){h?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(y){this.each(function(B){B instanceof ud&&B.getImage()===y&&B.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){}});var dp=b.SelectionModel=function(S){var t=this;t._68O=fe,t._map={},t._73O=new Qd,t._74I=new $p,t._21I(S)};Xq("SelectionModel",x,{ms_fire:1,ms_dm:1,ms:function(J,Q,z){this.addSelectionChangeListener(J,Q,z)},ums:function(p,P){this.removeSelectionChangeListener(p,P)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===jg},co:function(O){return this._map[O._id]!=Q},ss:function(s){this.setSelection(s)},as:function(N){this.appendSelection(N)},rs:function(T){this.removeSelection(T)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(l){var X=this;if(X._68O!==l&&(l===Vl||l===jg||l===fe)){X.cs();var x=X._68O;X._68O=l,X.fp("selectionMode",x,l)}},_21I:function(n){var C=this,i=C._dataModel;i!==n&&(i&&(C.cs(),i.umm(C.handleDataModelChange,C)),C._dataModel=n,n.mm(C.handleDataModelChange,C,!0),C.fp(Ei,i,n))},dispose:function(){var f=this;f.cs(),f._dataModel.umm(f.handleDataModelChange,f)},handleDataModelChange:function(a){var W=this;if(a.kind===vi){var T=a.data;W.co(T)&&(W._73O.remove(T),delete W._map[T._id],W._75I(vi,new Qd(T)))}else a.kind===gg&&W.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(A){var M=this;if(M._filterFunc!==A){M.cs();var g=M._filterFunc;M._filterFunc=A,M.fp("filterFunc",g,M._filterFunc)}},_75I:function(P,L,r,s){r&&(this._73O.each(function(X){s[X._id]?r.remove(X):r.add(X)}),L=r.toList()),this._74I.fire({kind:P,datas:new Qd(L)})},addSelectionChangeListener:function(l,k,W){this._74I.add(l,k,W)},removeSelectionChangeListener:function(b,q){this._74I.remove(b,q)},_97O:function(f,O){for(var x,L=this,H=0,B=new Qd(f);H<B.size();H++)x=B.get(H),(L._filterFunc&&!L._filterFunc(x)||O&&L.co(x)||!O&&!L.co(x)||!L._dataModel.contains(x))&&(B.removeAt(H),H--);return B},appendSelection:function(t){var z=this;if(z._68O!==Vl){var W,J,s=z._73O,o=z._97O(t,!0);o.isEmpty()||(z.sg()&&(W=new Qd(s),J=z._map,s.clear(),z._map={},o=new Qd(o.get(o.size()-1))),o.each(function(v){s.add(v),z._map[v._id]=v}),z._75I("append",o,W,J))}},removeSelection:function(y){var G=this,A=G._97O(y),i=0,o=A.size();if(0!==o){for(;o>i;i++){var z=A.get(i);G._73O.remove(z),delete G._map[z._id]}G._75I(vi,A)}},toSelection:function(b,w){return this._73O.toList(b,w)},getSelection:function(){return this._73O},each:function(p,V){this._73O.each(p,V)},setSelection:function(o){var Y=this,g=Y._73O;if(Y._68O!==Vl&&!(g.isEmpty()&&!o||1===g.size()&&Y.ld()===o)){var U=new Qd(g),J=Y._map;g.clear(),Y._map={};var F=Y._97O(o,!0);Y.sg()&&F.size()>1&&(F=new Qd(F.get(F.size()-1))),F.each(function(A){g.add(A),Y._map[A._id]=A}),Y._75I("set",Q,U,J)}},clearSelection:function(){var C=this,i=C._73O;if(i.size()>0){var T=i.toList();i.clear(),C._map={},C._75I(gg,T)}},selectAll:function(){var x=this;if(x._68O!==Vl){var T,V,A=x._dataModel.toDatas();if(x._filterFunc)for(T=0;T<A.size();T++)V=A.get(T),x._filterFunc(V)||(A.removeAt(T),T--);var S=x._73O,J=new Qd(S),j=x._map;S.clear(),x._map={},x.sg()&&A.size()>1&&(A=new Qd(A.get(A.size()-1)));var P=A.size();for(T=0;P>T;T++)V=A.get(T),S.add(V),x._map[V._id]=V;x._75I("all",Q,J,j)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(V){return this._map[V._id]!=Q},getLastData:function(){var f=this._73O;return f.size()>0?f.get(f.size()-1):Q},getFirstData:function(){var M=this._73O;return M.size()>0?M.get(0):Q},isSelectable:function(A){var K=this;return A&&K._68O!==Vl?K._filterFunc?K._filterFunc(A):!0:!1},getTopSelection:function(){var P=this,Y=new Qd;return P._73O.each(function(I){for(var i=I.getParent();i;){if(P.contains(i)){I=Q;break}i=i.parent}I&&Y.add(I)}),Y}});var Zl=function(){return Nm(0),function(y,Z){var c;if(md(Z)){var I=y.getDataUI(Z);I&&I._88I&&(c=I._88I.rect)}return c?c:Z.getRect()}}();nd(C,{edgeGroupAgentFunc:Q,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:g.rectSelectBorder,graphViewRectSelectBackground:il,graphViewEditPointSize:Ap?17:7,graphViewEditPointBorderColor:g.editPointBorder,graphViewEditPointBackground:g.editPointBackground,setEdgeType:function(U,J,g){zi[U]=J,Gb[U]=g},getEdgeType:function(w){return zi[w]},getEdgeTypeMap:function(){return zi},getNodeRect:Zl},!0);var Mj={"layout.h":_,"layout.v":_,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":_,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:_,ingroup:!0,"body.color":_,"2d.gray":!1,fullscreen:_,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:_,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Hc,"select.width":1,"select.padding":2,"select.type":Lm,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":Hc,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":_,"border.width":2,"border.padding":2,"border.type":Lm,label:_,"label.font":_,"label.color":tj,"label.background":_,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":_,"label.max":_,"label.opacity":_,"label.scale":1,"label.align":_,"label.selectable":!0,"label.decoration":_,label2:_,"label2.font":_,"label2.color":tj,"label2.background":_,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":_,"label2.max":_,"label2.opacity":_,"label2.scale":1,"label2.align":_,"label2.selectable":!0,"label2.decoration":_,note:_,"note.expanded":!0,"note.font":_,"note.color":yd,"note.background":Hc,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":_,"note.toggleable":!0,"note.border.width":1,"note.border.color":_,"note.opacity":_,"note.scale":1,"note.align":_,note2:_,"note2.expanded":!0,"note2.font":_,"note2.color":yd,"note2.background":Hc,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":_,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":_,"note2.opacity":_,"note2.scale":1,"note2.align":_,"group.type":_,"group.image":_,"group.image.stretch":"fill","group.repeat.image":_,"group.border.repeat.image":_,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":_,"group.title.color":yd,"group.title.background":g.groupTitleBackground,"group.title.align":Mh,"group.title.orientation":Ui,"group.background":g.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":_,"group.border.color":yo,"group.border.radius":_,"group.border.cap":Bh,"group.border.join":vn,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":Q,"group.gradient.color":"#FFF",shape:_,"shape.background":yo,"shape.repeat.image":_,"shape.border.repeat.image":_,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":yo,"shape.border.3d":!1,"shape.border.3d.color":_,"shape.border.3d.accuracy":_,"shape.border.cap":Bh,"shape.border.join":vn,"shape.border.pattern":_,"shape.gradient":Q,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":ig,"shape.dash.offset":0,"shape.dash.color":xn,"shape.dash.width":_,"shape.dash.3d":!1,"shape.dash.3d.color":_,"shape.dash.3d.accuracy":_,"shape.polygon.side":6,"shape.arc.from":e,"shape.arc.to":Z,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":_,"shape.gradient.pack":_,"shape.border.gradient.pack":_,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":_,"shape.foreground.gradient":Q,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":_,"autolayout.hgap":_,"autolayout.vgap":_,"edge.type":_,"edge.points":_,"edge.segments":_,"edge.color":yo,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":_,"edge.3d.accuracy":_,"edge.cap":Bh,"edge.join":vn,"edge.source.position":17,"edge.source.anchor.x":_,"edge.source.anchor.y":_,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":_,"edge.target.anchor.y":_,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":_,"edge.dash":!1,"edge.dash.pattern":ig,"edge.dash.offset":0,"edge.dash.color":xn,"edge.dash.width":_,"edge.dash.3d":!1,"edge.dash.3d.color":_,"edge.dash.3d.accuracy":_,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":_,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":_,"grid.column.percents":_,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":g.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":g.gridCellBorderColor,"grid.block":_,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":g.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":tj,"text.gradient.pack":_,"text.font":rr,"text.shadow":!1,"text.shadow.color":Hc,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":_,"text.gradient.color":"#FFF","text.decoration":_,"text.vertical":!1,"text.vertical.gap":1,keepPosition:!0};Mj[Jk]=_,nd(X,Mj,!0),nd(Zi,{_76I:function(h,J,w){this._39I&&this._39I.fire({data:h,oldIndex:J,newIndex:w})},addIndexChangeListener:function(R,K,E){var G=this;G._39I||(G._39I=new $p),G._39I.add(R,K,E)},removeIndexChangeListener:function(R,i){this._39I.remove(R,i)},prepareRemove:function(T){hn(T)&&(T.setSource(Q),T.setTarget(Q)),T._70O&&T._70O.toList().each(this.remove,this),T._69O&&T._69O.toList().each(function(v){v.setHost(Q)}),T._host&&T.setHost(Q)},onAdded:function(u){this.isAutoAdjustIndex()&&this.adjustIndex(u)},onDataPropertyChanged:function(J,z){Yl[z.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(J)},isAdjustable:function(C){return Je(C)||hn(C)},isAdjustedToBottom:function(l){return Pm(l)?l.isExpanded()&&Hr(l):!1},adjustIndex:function(C){var N=this;this.isHierarchicalRendering()||(N.isAdjustedToBottom(C)?(N.sendToBottom(C),C.eachChild(N.adjustIndex,N)):N.sendToTop(C))},sendToTop:function(J){var y=this;if(y.contains(J)&&y.isAdjustable(J)){var D=y._datas;if(J!==D.get(y.size()-1)){var I=D.indexOf(J);D.removeAt(I),D.add(J),y._76I(J,I,y.size()-1)}if(hn(J)){var i=J._40I;i&&!y.isAdjustedToBottom(i)&&y.sendToTop(i),i=J._41I,i&&!y.isAdjustedToBottom(i)&&y.sendToTop(i)}J._69O&&J._69O.each(function(X){X.isRelatedTo(J)||Je(J)&&X.isLoopedHostOn(J)||y.sendToTop(X)}),J.ISubGraph||(!Pm(J)||J.isExpanded())&&J._adjustChildrenToTop&&J.eachChild(function(G){hn(G)||y.sendToTop(G)})}},sendToBottom:function(q,Z){var $=this;if(q!==Z&&$.contains(q)&&$.isAdjustable(q)&&(!Z||$.contains(Z))){var P=$._datas,T=P.remove(q),z=Z?$._datas.indexOf(Z):0;if(P.add(q,z),T!==z){$._76I(q,T,z);var U=q._parent;!U||U.ISubGraph||hn(U)||$.sendToBottom(q._parent,q)}}}}),nd(Im,{ms_edit:function(O){O._46O=function(H){var I=this,V=I.gv.dm(),e=I._index,W=I._89I,b=I._node,R=I._shape,M=I._edge,O=I._77I;b&&W?(this.fi({kind:"endEditRect",event:H,data:b,direction:W}),V.endTransaction()):R&&e>=0?(I.fi({kind:"endEditPoint",event:H,data:R,index:e}),V.endTransaction()):M&&e>=0?(I.fi({kind:"endEditPoint",event:H,data:M,index:e}),V.endTransaction()):O&&(I.fi({kind:"endEditRotation",event:H,data:O}),V.endTransaction())},O._78I=function(H){var z=this;z.autoScroll(H);var G=z.gv.lp(H),$=z._index,T=z._89I,p=z._node,X=z._shape,d=z._edge,o=z._77I;if(p&&T)z._80O(G),z.fi({kind:"betweenEditRect",event:H,data:p,direction:T});else if(X&&$>=0)G.e=X.getPoints().get($).e,X.setPoint($,G),z.fi({kind:"betweenEditPoint",event:H,data:X,index:$});else if(d&&$>=0){var f=d.s(Dj);G.e=f.get($).e,f.set($,G),d.fp(Dj,Q,f),z.fi({kind:"betweenEditPoint",event:H,data:d,index:$})}else if(o){var q=o.p(),u=o.getScale(),B=Ej+mf(G.y-q.y,G.x-q.x);u.y<0&&(B+=e),D(B)<.04&&(B=0),o.setRotation(B),z.fi({kind:"betweenEditRotation",event:H,data:o})}},O._80O=function(D){var A=this,$=A._node,Y=A._rect,b=Y.x,v=Y.y,Z=Y.width,y=Y.height,U=A._89I,V=A._anchor,a=A._matrix,D=a.tfi(D);"northwest"===U?Y=Tl(D,{x:b+Z,y:v+y}):U===jp?Y=Tl({x:b,y:D.y},{x:b+Z,y:v+y}):"northeast"===U?Y=Tl({x:b,y:D.y},{x:D.x,y:v+y}):U===vr?Y=Tl({x:D.x,y:v},{x:b+Z,y:v+y}):U===yj?Y=Tl({x:b,y:v},{x:D.x,y:v+y}):"southwest"===U?Y=Tl({x:D.x,y:v},{x:b+Z,y:D.y}):"south"===U?Y=Tl({x:b,y:v},{x:b+Z,y:D.y}):"southeast"===U&&(Y=Tl({x:b,y:v},D)),$.setPosition(a.tf(Y.x+Y.width*V.x,Y.y+Y.height*V.y)),$.setWidth(Y.width),$.setHeight(Y.height)},O._80I=function(O,u,J,X){var W=this,s=W.gv._zoom,F=(W.gv.getEditPointSize()+2)/s;return Om({x:u-F/2,y:J-F/2,width:F,height:F},O)?(W._89I!==X&&(W._89I=X),!0):!1},O._79I=function(e,b,$){var f=this,S=f.gv,P=b?S.getDataUI(b):Q,C=P?P._55O:Q;if(C){var N,X,n,m,d=S._zoom,G=(S.getEditPointSize()+2)/d,A=S.lp(e);if(Je(b)){if(C._56O&&Je(b)&&(X=C._98o,Om({x:X.x-G/2,y:X.y-G/2,width:G,height:G},A)))return f._77I=b,$&&f.fi({kind:"beginEditRotation",event:e,data:b}),f.setCursor("crosshair"),!0;if(C._43O&&b instanceof Mk)for(n=b.getPoints(),N=n.size()-1;N>=0;N--)if(X=n.get(N),Om({x:X.x-G/2,y:X.y-G/2,width:G,height:G},A))return f._index=N,f._shape=b,$&&f.fi({kind:"beginEditPoint",event:e,data:b,index:N}),f.setCursor("crosshair"),!0;if(C._42O)for(var W=b.getEditControlPoints(),t=["northwest",-1,-1,vr,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,yj,1,0,"northeast",1,-1,jp,0,-1],N=0,m=W.length;m>N;N++){var o=t[3*N],E=W[N];if(f._80I(A,E.x,E.y,o)){f._node=b;var D=b.getWidth(),k=b.getHeight(),B=b.getAnchor();f._rect={x:-D*B.x,y:-k*B.y,width:D,height:k},f._anchor=B,f._matrix=b.getMatrix();var U=b.getRotation(),a=j(U),q=h(U),w=t[3*N+1]*Qg(b.getScale().x),s=t[3*N+2]*Qg(b.getScale().y),V=Math.atan2(-q*w-a*s,a*w-q*s),J=(Math.round(V/(Math.PI/4))+8)%8,l=[cr,"nesw-resize",Wm,"nwse-resize",cr,"nesw-resize",Wm,"nwse-resize"][J];return f.setCursor(l),$&&f.fi({kind:"beginEditRect",event:e,data:b,direction:f._89I}),!0}}}if(C._43O&&hn(b)&&b.s(jo)===Hl&&(n=b.s(Dj)))for(N=n.size()-1;N>=0;N--)if(X=n.get(N),Om({x:X.x-G/2,y:X.y-G/2,width:G,height:G},A))return f._index=N,f._edge=b,$&&f.fi({kind:"beginEditPoint",event:e,data:b,index:N}),f.setCursor("crosshair"),!0}return!1}},ms_gv:function(E){E._currentSubGraph=Q,E._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},E.upSubGraph=function(){this.setCurrentSubGraph(Rf(this._currentSubGraph))},E.isVisible=function(E){var d=this;if(Rf(E)!==d._currentSubGraph)return!1;if(hn(E)){var X=E._40I,y=E._41I;if(!X||!y)return!1;if(!(E.s("edge.independent")||d.isVisible(X)&&d.isVisible(y)))return!1;if(E.isEdgeGroupHidden())return!1}else for(var q=E._parent;q&&!q.ISubGraph;){if(Pm(q)&&(!q.isExpanded()||!d.isVisible(q)))return!1;q=q._parent}if(E._parent instanceof Ri&&!d.isVisible(E._parent))return!1;if(E._refGraph instanceof Vr&&!d.isVisible(E._refGraph))return!1;if(d instanceof _p){if(!E.s("3d.visible"))return!1}else{var A=d.getLayersInfo();if(A){var Y=A[E._layer];if(Y&&Y.visible===!1)return!1}if(!E.s("2d.visible"))return!1}return d._visibleFunc?d._visibleFunc(E):!0},E.handleSelectionChange=function(X){var A=this;X.datas.each(function(V){A.invalidateData(V);var O=V._parent;Pm(O)&&Je(V)&&V.s(Oj)&&(A.invalidateData(O),O._49I&&O._49I.each(function($){A.invalidateData($)}))}),A.onSelectionChanged(X)},E.onSelectionChanged=function(r){var n=this,c=n.sm();if(1===c.size()&&("set"===r.kind||"append"===r.kind)){var Y=c.ld();n.isAutoMakeVisible()&&n.makeVisible(Y),n.adjustIndex&&n._dataModel.isAutoAdjustIndex()&&n.adjustIndex(Y)}},E.makeVisible=function($){if($){var T=this,s=T.getDataUI?T.getDataUI($):T.getData3dUI($);if(s){var p=$,P=Rf($);for(P!==T._currentSubGraph&&T.setCurrentSubGraph(P);(p=p._parent)&&p!==P;)Pm(p)&&p.setExpanded(!0);T._23I=$,T.iv()}}},E.getLabel=function(W){var F=W.getStyle(lf);return F===_?W.getName():F},E.getLabelBackground=function(P){return P.getStyle("label.background")},E.getLabelColor=function(Z){return Z.getStyle("label.color")},E.getLabel2=function(g){return g.getStyle("label2")},E.getLabel2Background=function(z){return z.getStyle("label2.background")},E.getLabel2Color=function(h){return h.getStyle("label2.color")},E.getNote=function(H){return H.getStyle(Hd)},E.getNoteBackground=function(D){return D.getStyle("note.background")},E.getNote2=function(w){return w.getStyle(el)},E.getNote2Background=function(b){return b.getStyle("note2.background")},E.handleClick=function(i,o,M){var O=this;o?(O.fi({kind:"clickData",event:i,data:o,part:M}),O.onDataClicked(o,i)):(O.fi({kind:"clickBackground",event:i}),O.onBackgroundClicked(i))},E.handleDoubleClick=function(g,U,w){var K=this;Do(g)&&(U?(K.fi({kind:"doubleClickData",event:g,data:U,part:w}),K.onDataDoubleClicked(U,g,w),K.checkDoubleClickOnNote(g,U,w)||K.checkDoubleClickOnRotation&&K.checkDoubleClickOnRotation(g,U,w)||(hn(U)?K.onEdgeDoubleClicked(U,g,w):U.ISubGraph?K.onSubGraphDoubleClicked(U,g,w):Pm(U)?K.onGroupDoubleClicked(U,g,w):U.IDoorWindow?K.onDoorWindowDoubleClicked(U,g,w):U.ICSGBox&&K.onCSGBoxDoubleClicked(U,g,w))):(K.fi({kind:"doubleClickBackground",event:g}),K.onBackgroundDoubleClicked(g)))},E.onSubGraphDoubleClicked=function(N){this.setCurrentSubGraph(N)},E.onEdgeDoubleClicked=function(n,z){this.isEditable(n)||(n.ISubGraph&&!Kp(z)?this.setCurrentSubGraph(n):n.s("edge.toggleable")&&n.toggle())},E._39Q=function(t){return this.isInteractive(t)?this.preventDefaultWhenInteractive(t):!1},E.preventDefaultWhenInteractive=function(H){return H.s("preventDefaultWhenInteractive")},E.onGroupDoubleClicked=function(W){W.s("group.toggleable")&&W.toggle()},E.onDoorWindowDoubleClicked=function(x){x.s("dw.toggleable")&&x.toggle(!0)},E.onCSGBoxDoubleClicked=function(q,o){var x=this;if(x instanceof _p){var N=x.intersectObject(o,q);N&&q.s(N.part+".toggleable")&&q.toggleFace(N.part,!0)}},E.onBackgroundClicked=function(){},E.onBackgroundDoubleClicked=function(){this.upSubGraph()},E.onDataClicked=function(){},E.onDataDoubleClicked=function(){},E.onAutoLayoutEnded=function(){},E.onMoveEnded=function(){},E.onPanEnded=function(){},E.onPinchEnded=function(){},E.onRectSelectEnded=function(){},E.onZoomEnded=function(){},E.serialize=function(F){return this.dm().serialize(F)},E.toJSON=function(){return this.dm().toJSON()},E.deserialize=function(k,t){var A=this;t=t instanceof mi?{rootParent:t}:wb(t)?{setId:t}:np(t)?{finishFunc:t}:t||{},t.view=A;var i=A.dm();return t.__innerHandler__=function(F){if(wb(i.a("toolTipEnable"))&&(i.a("toolTipEnable")?A.enableToolTip():A.disableToolTip()),A instanceof b.graph.GraphView&&(wb(i.a("zoomable"))&&A.setZoomable&&A.setZoomable(i.a("zoomable")),wb(i.a("pannable"))&&A.setPannable&&A.setPannable(i.a("pannable")),wb(i.a("rectSelectable"))&&A.setRectSelectable&&A.setRectSelectable(i.a("rectSelectable")),i.a("fitContent")===!0&&A.fitContent&&A.fitContent(!0,0)),A instanceof b.graph3d.Graph3dView){var j=F.scene;
j&&j.shadow!=Q&&A.shadowMap.setShadow(j.shadow,j.shadowParams);var n=i.a("sceneContext");n?(n.eye&&A.setEye(n.eye),n.center&&A.setCenter(n.center),Ho(n.far)&&A.setFar(n.far),Ho(n.near)&&A.setNear(n.near)):(Ho(i.a("sceneNear"))&&A.setNear(i.a("sceneNear")),Ho(i.a("sceneFar"))&&A.setFar(i.a("sceneFar")),j&&(j.eye&&A.setEye(j.eye),j.center&&A.setCenter(j.center))),wb(i.a("sceneShadowEnabled"))&&(i.a("sceneShadowEnabled")?A.enableShadow():A.disableShadow()),Ho(i.a("sceneShadowDegreeX"))&&A.setShadowDegreeX(i.a("sceneShadowDegreeX")),Ho(i.a("sceneShadowDegreeZ"))&&A.setShadowDegreeZ(i.a("sceneShadowDegreeZ")),Ho(i.a("sceneShadowIntensity"))&&A.setShadowIntensity(i.a("sceneShadowIntensity")),i.a("sceneShadowQuality")!=Q&&A.setShadowQuality(i.a("sceneShadowQuality")),i.a("sceneShadowType")&&A.setShadowType(i.a("sceneShadowType")),Ho(i.a("sceneShadowRadius"))&&A.setShadowRadius(i.a("sceneShadowRadius")),Ho(i.a("sceneShadowBias"))&&A.setShadowBias(i.a("sceneShadowBias")),wb(i.a("sceneDashEnable"))&&A.setDashDisabled(!i.a("sceneDashEnable")),am(i.a("sceneHighlightMode"))&&A.setHighlightMode(i.a("sceneHighlightMode")),Ho(i.a("sceneHighlightWidth"))&&A.setHighlightWidth(i.a("sceneHighlightWidth")),i.a("sceneHighlightColor")&&A.setHighlightColor(i.a("sceneHighlightColor")),i.a("sceneHighlightType")&&A.setHighlightType(i.a("sceneHighlightType")),i.a("sceneHighlightGlow")&&A.setHighlightGlow(i.a("sceneHighlightGlow")),i.a("sceneHighlightStrength")&&A.setHighlightStrength(i.a("sceneHighlightStrength")),wb(i.a("sceneHeadlightEnable"))&&A.setHeadlightDisabled(!i.a("sceneHeadlightEnable")),Ho(i.a("sceneHeadlightRange"))&&A.setHeadlightRange(i.a("sceneHeadlightRange")),i.a("sceneHeadlightColor")&&A.setHeadlightColor(i.a("sceneHeadlightColor")),Ho(i.a("sceneHeadlightIntensity"))&&A.setHeadlightIntensity(i.a("sceneHeadlightIntensity")),Ho(i.a("sceneHeadlightAmbientIntensity"))&&A.setHeadlightAmbientIntensity(i.a("sceneHeadlightAmbientIntensity")),Ho(i.a("sceneHeadlightGroup"))&&A.setHeadlightGroup(i.a("sceneHeadlightGroup")),wb(i.a("sceneFogEnable"))&&A.setFogDisabled(!i.a("sceneFogEnable")),i.a("sceneFogMode")&&A.setFogMode(i.a("sceneFogMode")),Ho(i.a("sceneFogDensity"))&&A.setFogDensity(i.a("sceneFogDensity")),i.a("sceneFogColor")&&A.setFogColor(i.a("sceneFogColor")),Ho(i.a("sceneFogNear"))&&A.setFogNear(i.a("sceneFogNear")),Ho(i.a("sceneFogFar"))&&A.setFogFar(i.a("sceneFogFar")),wb(i.a("sceneBatchBrightnessDisabled"))&&A.setBatchBrightnessDisabled(i.a("sceneBatchBrightnessDisabled")),wb(i.a("sceneBatchBlendDisabled"))&&A.setBatchBlendDisabled(i.a("sceneBatchBlendDisabled")),wb(i.a("sceneBatchColorDisabled"))&&A.setBatchColorDisabled(i.a("sceneBatchColorDisabled")),i.a("sceneBatchInfoMap")&&A.setBatchInfoMap(i.a("sceneBatchInfoMap")),Ho(i.a("sceneMoveStep"))&&A.setMoveStep(i.a("sceneMoveStep")),Ho(i.a("sceneRotateStep"))&&A.setRotateStep(i.a("sceneRotateStep")),wb(i.a("sceneSortable"))&&A.setSortable(i.a("sceneSortable")),np(i.a("sceneSortFunc"))&&A.setSortFunc(i.a("sceneSortFunc"));var w=i.a("sceneSkyboxType")||"sphere";if(w!=Q){var I={},d=!1;if("sphere"===w){I.shape3d=w;var H=i.a("sceneSkyboxImage");H&&(I["shape3d.image"]=H,d=!0)}else I.shape3d=_,["front","back","left","right","top","bottom"].forEach(function(t){var c=t+".image",v=t.charAt(0).toUpperCase()+t.slice(1),y=i.a("sceneSkybox"+v+"Image");y&&(I[c]=y,d=!0)});if(d){var D=new ud,X=i.a("sceneSkyboxDiameter");Ho(X)?D.s3(X,X,X):D.s3(20,20,20),I["body.color"]=i.a("sceneSkyboxBodyColor"),I.envmap=i.a("sceneSkyboxEnvmap"),I["envmap.probe"]=i.a("sceneSkyboxEnvmapProbe"),I.roughness=i.a("sceneSkyboxRoughness"),I["shape3d.light"]=I["all.light"]=i.a("sceneSkyboxLight"),I["light.mask"]=i.a("sceneSkyboxLightMask"),I["headlight.ambientIntensity"]=i.a("sceneSkyboxHeadLightAmbientIntensity"),I["texture.wrap"]="clampToEdge",I["3d.clipbox.mask"]=Jr,I["effect.flow.mask"]=Jr,D.s(I),["X","Y","Z"].forEach(function(l){var n=i.a("sceneSkyboxRotation"+l);Ho(n)&&D["setRotation"+l](n)}),A.setSkybox(D)}}}},i.deserialize(k,t.rootParent,t)},E.isDebugTipShowing=function(){return!!this._debugDiv},E.showDebugTip=function(){var s=this,R=s._debugDiv;if(!R){R=s._debugDiv=L.createElement("div"),R.style.position="absolute",R.style.overflow="hidden",R.style.font=C.debugTipLabelFont,R.style.padding="6px",R.style.backgroundColor=C.debugTipBackground,R.style.color=C.debugTipLabelColor;var Y=s.getView();s._79O?Y.insertBefore(R,s._79O):Y.appendChild(R);var N=function(){s.redraw();var p=s._canvas,C="FPS: "+s._fpsInfo.fps+"<br/>"+"Datas: "+s.dm().getDatas().length+(p?"<br/>Size: "+p.width+" * "+p.height:""),d=s.dm()._historyManager;d&&(C+="<br/>Undoes: "+d.getHistories().length+" index: "+d.getHistoryIndex());var w=s.getDebugTip();w&&(C+="<hr>"+w),R.innerHTML=C,s._isDebugging&&requestAnimationFrame(N)};requestAnimationFrame(N),s._isDebugging=!0}},E.hideDebugTip=function(){var D=this,L=D._debugDiv;L&&(delete D._debugDiv,D.getView().removeChild(L),D._isDebugging=!1)},E.updateDOMAppendMatrix=function(){var d=this.getView();d&&(d.updateAppendMatrix=!0)},E.countFrame=function(){if(this._isDebugging){var K=Date.now(),Z=this._fpsInfo;K-Z.time>1e3?(Z.fps=Math.round(1e5*(Z.frames+1)/(K-Z.time))/100,Z.time=K,Z.frames=0):Z.frames++}}},ms_icons:function(p){p.getRotation=function(z){return z==Q?0:z},p._15O=function(){var A=this,J=A.s(xj);if(J){var E=A,q=A.data||A._data,c=A._38o={icons:J,rects:{}};for(var U in J){var P=J[U],H=yk(P.shape3d,q,E);if(!(yk(P.visible,q,E)===!1||yk(P.for3d,q,E)&&!A.I3d||H&&!A.I3d)){var X=H?[H]:yk(P.names,q,E),N=X?X.length:0,W=yk(P.position,q,E)||3,O=yk(P.offsetX,q,E)||0,p=yk(P.offsetY,q,E)||0,R=yk(P.direction,q,E)||yj,t=yk(P.gap,q,E),G=t!=Q?t:1,V=yk(P.rotation,q,E),x=yk(P.keepOrien,q,E),S=yk(P.rotationFixed,q,E)?V:A.getRotation(V,x,W),D=Q,M=c.rects[U]=new Array(N);M.rotation=S;for(var o=0;N>o;o++){var I,Z,l,v,r=X[o];if(H)l=0,v=0;else{var _=Bj(r);l=yk(P.width,q,E),v=yk(P.height,q,E),l==Q&&(l=ld(_,q)),v==Q&&(v=Sr(_,q))}if(D?R===yj?O+=l/2:R===vr?O-=l/2:R===jp?p-=v/2:p+=v/2:D={width:l,height:v},A.I3d){var K=-l/2,k=-v/2;Z={width:l,height:v,mat:A._16O(yk(P.autorotate,q,E),W,D,yk(P.face,q,E)||fb,yk(P.t3,q,E),yk(P.r3,q,E),yk(P.rotationMode,q,E),O,p),vs:new Ac([K,-k,0,K,-k-v,0,K+l,-k-v,0,K+l,-k,0])}}else I=A.getPosition(W,O,p,D,yk(P.positionFixed,q,E)),Z={x:I.x-l/2,y:I.y-v/2,width:l,height:v},A._68o(Z,S);M[o]=Z,R===yj?O+=l/2+G:R===vr?O-=l/2+G:R===jp?p-=v/2+G:p+=v/2+G}}}}}}});var Ir={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},xe={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},le={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Yl={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Yf={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},fs={"edge.type":1,"edge.group":1},cq={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},Pi={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},Ve={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Qb={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},qi={shape:1,thickness:1,position:1,anchor:1,scale:1},Rf=function(V){if(!V)return Q;if(hn(V)){var p=V._40I,w=V._41I;if(!p||!w)return Q;var A=Rf(p),k=Rf(w);return A===k?A:Q}for(var E=V._parent;hn(E)&&!E.ISubGraph;)E=E._parent;return E?E.ISubGraph?E:Rf(E):Q},ng=function(b,S,j,p){var n=S.getStyle(j)*p;n&&ae(b,n),n=S.getStyle(j+".left")*p,n&&(b.x-=n,b.width+=n),n=S.getStyle(j+".right")*p,n&&(b.width+=n),n=S.getStyle(j+".top")*p,n&&(b.y-=n,b.height+=n),n=S.getStyle(j+".bottom")*p,n&&(b.height+=n),b.width<0&&(b.width=-b.width,b.x-=b.width),b.height<0&&(b.height=-b.height,b.y-=b.height)},Hr=function(l){for(var z,y=0,W=l.size();W>y;y++)if(z=l.getChildAt(y),Je(z)&&Hr(z))return!0;return l.hasAgentEdges()},Ij=function(E){if(!E)return Q;for(var s=E._parent;Pm(s);){if(!Pm(s._parent))return s.isExpanded()?E:s;s.isExpanded()||(E=s),s=s._parent}return E},um=function(g,i){if(!g||!i)return Q;var l,W,Z,F=Rf(g),X=Rf(i);if(F!==X){for(;X&&F!==X;)X=Rf(X);if(F===X)return g;l=new Qd,l.add(g,0);for(var H=g._parent;Je(H)&&!i.isDescendantOf(H);)l.add(H,0),H=H._parent;for(Z=l.size(),W=0;Z>W;W++){var U=l.get(W);if(Pm(U)&&!U.isExpanded())return U;if(U.ISubGraph)return U}return g}return g},sp=function(q){if(q.isLooped())return q._source;var R=Ij(q._source),C=Ij(q._target);return R===C?q._source:um(R,C)},fc=function(q){if(q.isLooped())return q._target;var m=Ij(q._source),k=Ij(q._target);return m===k?q._target:um(k,m)},Ih=function(A,y,I){"target"!==I&&(I="source");var r="target"===I?y.getTargetAgent():y.getSourceAgent(),T="edge."+I+".";if(hn(r)){var G=A.getDataUI(r);G._79o();var g=y.s(T+"index");if(g>=0){var z=Ul(G);return z[Math.max(0,Math.min(g,z.length-1))]}var S=y.s(T+"percent")||0;S=Math.max(0,Math.min(S,1));var _=xp(G);return nk(_,100*S)}return Lp(A,r,y.s(T+"position"),y.s(T+"offset.x"),y.s(T+"offset.y"),y.s(T+"anchor.x"),y.s(T+"anchor.y"))},Lp=function(I,H,P,m,A,R,c){if(!H)return Q;var k,g=H.getRotation?H.getRotation():0;if(R!==_||c!==_){R=R===_?.5:R,c=c===_?.5:c;var M=H.getScale();if(g&&!md(H,I)||M.x<0||M.y<0){var W=H.getPosition(),V=H.getWidth(),O=H.getHeight(),D=H.getAnchor(),J=new td(g,W.x,W.y,M.x,M.y);P=J.tf((R-D.x)*V,(c-D.y)*O)}else k=Zl(I,H),P={x:k.x+R*k.width,y:k.y+c*k.height}}else P=$l(P,Zl(I,H));if(g){var a=j(g),i=h(g),U=m*a-A*i;A=m*i+A*a,m=U}return P.x+=m,P.y+=A,P},Zo=function(m,E){if(!m||!E)return Q;var j,R,N,J,b,V;if(m===E){if(J=m.getLoopedEdges(),!J)return Q;J=new Qd(J)}else{if(b=m.getAgentEdges(),V=E.getAgentEdges(),!b||!V)return Q;for(R=b.size(),j=0;R>j;j++)N=b.get(j),V.contains(N)&&(J||(J=new Qd),J.add(N))}if(J)for(j=0;j<J.size();j++)N=J.get(j),N.getStyle(jo)===Hl&&(N._22I(Q),J.removeAt(j),j--);return J},km=function(Y,Z){var e=Zo(Y,Z);if(e&&!e.isEmpty()){if(1===e.size())return e.get(0)._22I(Q),void 0;var D=new Qd,c=new Qd;e.each(function(d){var c=d.s("edge.group");D.contains(c)||D.add(c)}),D.sort(),D.each(function(t){c.add(new b.EdgeGroup(e.toList(function(S){return t===S.s("edge.group")}),c))}),c.each(function(s){s.each(function(q){q._22I(s)})})}},cp=function(y,L,E){var p=y._canvas;y._zoom;var I=ag(L,p),l=ag(E,p);return{x:I.x-l.x,y:I.y-l.y}},Qo=function(S,G){if(G){var f=G.rect,T=G.color,z=G.rotation,U=G.labelWidth,K=G.background,w=G.opacity,g=G.scale,O=g!=Q&&1!==g;if(w!=Q){var H=S.globalAlpha;S.globalAlpha*=w}if(z||O){S.save();var b=f.x+f.width/2,P=f.y+f.height/2;Hk(S,b,P),z&&wm(S,z),O&&S.scale(g,g),Hk(S,-b,-P)}if(K&&uj(S,f.x,f.y,f.width,f.height,K),U){var c=f.width,A=S.createLinearGradient(f.x,f.y,f.x+c,f.y);A.addColorStop(0,T),A.addColorStop(.9,T),A.addColorStop(1,eo),T=A,f.width=U}Dm(S,G.ss,f,G.font,T,G.align,G.decoration),U&&(f.width=c),(z||O)&&S.restore(),w!=Q&&(S.globalAlpha=H)}},Oq=function(s,U){if(U){var h=U.rect,R=h.x,z=h.y,y=h.width,G=h.height,v=U.background,S=U.backgroundImage,Y=U.borderWidth,p=U.borderColor,K=U.labelWidth,i=U.opacity,X=U.scale,B=X!=Q&&1!==X;if(i!=Q){var d=s.globalAlpha;s.globalAlpha*=i}if(B){s.save();var N=h.x+h.width/2,l=h.y+h.height/2;Hk(s,N,l),s.scale(X,X),Hk(s,-N,-l)}if(U.expanded){var C=F(8,y/4),o=z+G-8;if(s.fillStyle=v,s.beginPath(),s.moveTo(R,z),s.lineTo(R,o),s.lineTo(R+y/2,o),s.lineTo(R+y/2,z+G),s.lineTo(R+y/2+C,o),s.lineTo(R+y,o),s.lineTo(R+y,z),s.closePath(),s.fill(),Y&&(s.lineWidth=Y,s.lineJoin="round",s.lineCap="round",p?(s.strokeStyle=p,s.stroke()):(s.strokeStyle=mb(v),s.beginPath(),s.moveTo(R+y,z),s.lineTo(R+y,o),s.lineTo(R+y/2+C,o),s.lineTo(R+y/2,z+G),s.stroke(),s.strokeStyle=Oi(v),s.beginPath(),s.moveTo(R+y,z),s.lineTo(R,z),s.lineTo(R,o),s.lineTo(R+y/2,o),s.lineTo(R+y/2,z+G),s.stroke())),S)_m(s,Bj(S),vh,h.x,h.y,h.width,h.height-8,U.data,U.view);else{if(h.height-=8,v=U.color,K){var u=y,J=s.createLinearGradient(R,z,R+u,z);J.addColorStop(0,v),J.addColorStop(.9,v),J.addColorStop(1,eo),v=J,h.width=K}Dm(s,U.ss,h,U.font,v,U.align),K&&(h.width=u),h.height+=8}}else if(U.icon)Bs(s,Bj(U.icon),R,z,y,G,U.data,U.view);else{var $=y/2;Y&&(s.lineWidth=Y,s.lineJoin="round",s.lineCap="round",s.strokeStyle=p?p:mb(v),s.beginPath(),s.arc(R+$,z+$,$,Ej,1.6*e,!0),s.moveTo(R+$,z+G),s.lineTo(R+y-$/5,z+$),s.stroke(),s.strokeStyle=p?p:Oi(v),s.beginPath(),s.arc(R+$,z+$,$,1.6*e,Ej,!0),s.moveTo(R+$,z+G),s.lineTo(R+$/5,z+$),s.stroke()),s.fillStyle=v,s.beginPath(),s.arc(R+$,z+$,$,0,Z,!0),s.moveTo(R+$,z+G),s.lineTo(R+y-$/5,z+$),s.lineTo(R+$/5,z+$),s.closePath(),s.fill(),s.fillStyle=U.color,s.beginPath(),s.arc(R+$,z+$,$/3,0,Z,!0),s.fill()}B&&s.restore(),i!=Q&&(s.globalAlpha=d)}},Mi=function(u,H){return H>2*u?u:H/2},Ad=function(T,F,i,C){if(!T||!F)return 0;var z=mf(F.y-T.y,F.x-T.x);return i||(z=F.x<T.x?z+e:z),z+C},Fh=function(M,Q,V,Z,k,N,h){h&&(M.x>Q.x||M.x===Q.x&&M.y>Q.y)&&(V=Sf[V],k=-k);var J=$l(V,{x:0,y:0,width:Ki(M,Q),height:0},N);return J.x+=Z,J.y+=k,J=new td(mf(Q.y-M.y,Q.x-M.x)).tf(J),J.x+=M.x,J.y+=M.y,J},fd=function(E,p,$,Z,U){if(E._19Q=!0,!$.getEdgeGroup())return Z?$.s("edge.gap"):0;if(hn($.getSourceAgent())||hn($.getTargetAgent()))return 0;var y,k=0,N=0,J=0;if($.getEdgeGroup().getSiblings().each(function(L){L.each(function(f){if(p.isVisible(f)&&f.s(jo)==U){var C=f.s("edge.gap");y?(N+=J/2+C/2,J=C):(y=f,J=C),f===$&&(k=N)}})}),Z)return N-k+J;var A=k-N/2;return y&&$._40I!==y._40I&&(E._19Q=!1),A},Jd=function(w){var H=w._getValidSelection();if(1===H.length){var h=H[0],$=h instanceof b.Edge;if(h instanceof b.Shape||$){if($){var Z=h.s("edge.type");if(Z&&"points"!==Z)return}var Q=w.gv;if((!Q.isPointEditable||Q.isPointEditable(h))&&Q.isEditable(h))return h}}},uo=function(){var p=function(J){var U=[];return J.forEach(function(n){U.push({x:n.x,y:n.y}),U.push({x:n.x+n.width,y:n.y+n.height}),U.push({x:n.x+n.width,y:n.y}),U.push({x:n.x,y:n.y+n.height})}),U};return function(s,r,q){if("oval"===s){var U=0,A=q.height/q.width,$=A*A,h=q.x+q.width/2,X=q.y+q.height/2,N=p(r);N.forEach(function(I){var K=I.x-h,n=I.y-X,N=K*K+n*n/$;N>U&&(U=N)}),U=z(U);var y=A*U;return{x:h-U,y:X-y,width:2*U,height:2*y}}if("circle"===s){var u=0,h=q.x+q.width/2,X=q.y+q.height/2,N=p(r);return N.forEach(function(m){var g=m.x-h,b=m.y-X,E=g*g+b*b;E>u&&(u=E)}),u=z(u),{x:h-u,y:X-u,width:2*u,height:2*u}}return"roundRect"===s?(ae(q,F(q.width,q.height)/16),q):q}}(),sl=b.graph={},Go=function($,m,q){eq(v+".graph."+$,m,q)};b.layout={};var Lh={},hk=function(r,l,x,E,X,k,j,y){var S=j._zoom;if(S!==j._cacheZoom&&(j._cacheZoom=S,j._cacheImage={}),S*=rh,E=Math.ceil(E),X=Math.ceil(X),E*S>2048||X*S>2048)return l;var D=[l.uuid,E,X,x].join("_");if(l.cacheRule){var C;C=np(l.cacheRule)?l.cacheRule(k,j):yk(l.cacheRule,k,j),D+="_"+C}var c,H=1;X>=E&&H>E*S?(c=X/E,E=H/S,X=E*c):E>=X&&H>X*S&&(c=E/X,X=H/S,E=X*c),E=Math.ceil(E),X=Math.ceil(X);var t=j._cacheImage[D];if(!t){if(Zk(),t=b.Default.toCanvas(l,E,X,x,k,j,y,S),!Fo())return l;j._cacheImage[D]=t}return t};nd(C,{setImageCacheRule:function(N,n){var y;n||"object"!=typeof N?(y={},y[N]=n):y=N;for(var l in y){var H=y[l];am(l)?(eq=Bj(l),eq?eq.cacheRule=H:Lh[l]=H):l.cacheRule=H}}});var ys={comps:[{type:qo,points:[85,50,70,115,100,71,86,107,88,49,43,51,79,66,114,67,53,114,115,104,43,77,100,74,48,81,54,84,108,107,106,108,98,116,43,101,121,112,73,99,84,119,81,61],borderWidth:1,borderColor:Q}]};if(ys[Od]=ys[pe]=160,B.Image){var kn=new B.Image;kn.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Gn("default_blank",kn)}Gn("node_image",oo(30,30,[{type:Lm,rect:[4,5,22,16],gradient:ns,gradientColor:xo,background:yo},{type:Lm,rect:[2,3,26,20],borderWidth:1,borderColor:yo},{type:Lm,rect:[11,23,8,4],background:yo},{type:Lm,rect:[6,27,18,2],background:yo}])),Gn("node_icon",oo(16,16,[{type:Lm,rect:[2,2,12,10],gradient:ns,gradientColor:xo,background:yo},{type:hd,rect:[2,2,12,10],width:1,color:yo},{type:Lm,rect:[6,12,4,2],background:yo},{type:Lm,rect:[4,14,8,1],background:yo}])),Gn("block_icon",oo(16,16,[{type:hd,rect:[1,1,14,14],width:1,color:yo}])),Gn("group_image",oo(66,39,[{type:Lm,rect:[44.3,18,18.1,12.8],gradient:ns,gradientColor:xo,background:yo},{type:Lm,rect:[3.3,17.8,18.1,12.8],gradient:ns,gradientColor:xo,background:yo},{type:Lm,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:yo,gradient:ns,gradientColor:xo,background:yo},{type:Lm,rect:[26.2,29.4,12.8,4.2],background:yo},{type:Lm,rect:[21.3,33.5,22.5,2.3],background:yo},{type:Lm,rect:[5.3,32.7,14.1,2.1],background:yo},{type:Lm,rect:[9,30.4,6.7,2.4],background:yo},{type:Lm,rect:[50,30.7,6.7,2.4],background:yo},{type:Lm,rect:[46.3,33,14.1,2.1],background:yo}])),Gn("group_icon",oo(16,16,[{type:Lm,rect:[4,12,4,2],background:yo},{type:Lm,rect:[2,13,8,1],background:yo},{type:Lm,rect:[12,12,2,1],background:yo},{type:Lm,rect:[11,13,4,1],background:yo},{type:Lm,rect:[10,7,6,5],gradient:ns,gradientColor:xo,background:yo},{type:Lm,rect:[1,2,10,10],gradient:ns,gradientColor:xo,background:yo},{type:hd,rect:[1,2,10,10],width:1,color:yo}])),Gn("refGraph_icon",oo(16,16,[{type:"shape",borderWidth:1,borderColor:yo,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:yo,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Gn("edge_icon",oo(16,16,[{type:Lm,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:ns,gradientColor:xo,background:yo},{type:Lm,rect:[10.8,1,4,4],background:yo},{type:Lm,rect:[1,11,4,4],background:yo}])),Gn("subGraph_image",oo(72,45,[{type:qo,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:ns,gradientColor:xo,background:yo},{type:Lm,rect:[29.6,30.7,3.6,1.8],background:yo},{type:Lm,rect:[28.4,32.3,6,1.2],background:yo},{type:Lm,rect:[37.3,32,10.8,1.8],background:yo},{type:Lm,rect:[39.1,29.9,7.2,2.3],background:yo},{type:Lm,rect:[26.6,23.7,9.6,7.2],gradient:ns,gradientColor:xo,background:yo},{type:Lm,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:yo,gradient:ns,gradientColor:xo,background:yo}])),Gn("subGraph_icon",oo(17,17,[{type:qo,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:ns,gradientColor:xo,background:yo}])),Gn("shape_icon",oo(16,16,[{type:qo,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:yo}])),Gn("polyline_icon",oo(16,16,[{type:qo,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:yo},gp(7.5,.4),gp(7.5,6.3),gp(13.6,6.3),gp(13.6,14),gp(.7,13.9),gp(.7,.3)])),Gn("grid_icon",oo(16,16,[{type:Lm,rect:[1,1,4,4],background:yo,gradient:ns,gradientColor:xo},{type:Lm,rect:[6,1,4,4],background:yo,gradient:ns,gradientColor:xo},{type:Lm,rect:[11,1,4,4],background:yo,gradient:ns,gradientColor:xo},{type:Lm,rect:[11,6,4,4],background:yo,gradient:ns,gradientColor:xo},{type:Lm,rect:[6,6,4,4],background:yo,gradient:ns,gradientColor:xo},{type:Lm,rect:[1,6,4,4],background:yo,gradient:ns,gradientColor:xo},{type:Lm,rect:[11,11,4,4],background:yo,gradient:ns,gradientColor:xo},{type:Lm,rect:[6,11,4,4],background:yo,gradient:ns,gradientColor:xo},{type:Lm,rect:[1,11,4,4],background:yo,gradient:ns,gradientColor:xo}])),Gn("light_icon",oo(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:yo},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:yo,gradient:ns,gradientColor:xo,background:{func:function(x){var j=x?x.s(Sm):Q;return oi(j)?"rgb("+pm(255*j[0])+","+pm(255*j[1])+","+pm(255*j[2])+")":j||yo}}}])),Gn("text_icon",oo(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:yo}])),Gn("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Gn("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Gn("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Gn("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Ln=function(W,$,Q,t,Y,T){var Z,z,h,G,O,U,j,C,d,E,I,J=[];if(Math.abs(t)>2*Math.PI&&(t=2*Math.PI),O=Math.ceil(Math.abs(t)/(Math.PI/4)),Z=t/O,z=-Z,h=-Q,O>0){U=W+Math.cos(Q)*Y,j=$+Math.sin(-Q)*T,J.push({x:U,y:j});for(var N=0;O>N;N++)h+=z,G=h-z/2,C=W+Math.cos(h)*Y,d=$+Math.sin(h)*T,E=W+Math.cos(G)*(Y/Math.cos(z/2)),I=$+Math.sin(G)*(T/Math.cos(z/2)),J.push({x:E,y:I}),J.push({x:C,y:d})}return J},Ur=function(K){if(K){var B=K._data;if(B instanceof b.Shape)return{points:B.getPoints(),segments:B.getSegments()};var Z;if(B instanceof b.Edge&&(Z=K._78o)){var F,i,Q=Z.type,S=Z.points,n=Z.segments,X=Z.edgeTypeInfo;if(!Q||S){var j=Z.sourcePoint,m=j.x,e=j.y,r=Z.targetPoint,o=r.x,v=r.y;if(Q)n?(F=new Qd({x:m,y:e}),F.addAll(S),F.add({x:o,y:v}),i=new Qd(n._as)):(F=new Qd({x:m,y:e}),S.each(function(t){F.add(t)}),F.add({x:o,y:v}));else if(Z.looped){F=new Qd(Ln(m,e,0,2*Math.PI,Z.radius,Z.radius)),i=new Qd([1]);for(var M=0;M<(F.size()-1)/2;M++)i.add(3)}else F=new Qd,Z.center?(F.add({x:Z.c1.x,y:Z.c1.y}),F.add({x:m,y:e}),F.add({x:o,y:v}),F.add({x:Z.c2.x,y:Z.c2.y})):(F.add({x:m,y:e}),F.add({x:o,y:v}))}else X&&(F=new Qd(X.points._as),X.segments&&(i=new Qd(X.segments._as)));return{points:F,segments:i}}}},xp=function(Q,m,q){if(null==m){var _=Ur(Q);if(!_)return;m=_.points,q=_.segments}if(m){if(Array.isArray(m)&&(m=new Qd(m)),"number"==typeof m.get(0)){for(var v=new b.List,U=0;U<m.size();U+=2)v.add({x:m.get(U),y:m.get(U+1)});m=v}if(!q){q=[1];for(var g=m.length-1;g>0;g--)q.push(2)}Array.isArray(q)&&(q=new Qd(q));for(var f=Mr(m._as,q._as,50),S=f.length,T=[],U=0;S>U;U++){var l=f[U];l.length>1&&T.push(l)}return T}},Wb=function(V){for(var O=0,S=V.length-1,s=0;S>s;s++){var R=V[s],q=V[s+1],y=q.x-R.x,D=q.y-R.y;O+=Math.sqrt(y*y+D*D)}return O},Ab=function(N,h){for(var S=0,G=h.length,e=0;G>e;e++){var L=h[e];if(S+=L,S>N)return e}return Math.min(e,G-1)},ke=function(W,Q){for(var d=0,u=0,z=0,L=W.length-1,x=0;L>x;x++){var A=W[x],V=W[x+1],b=V.x-A.x,Z=V.y-A.y;if(z=Math.sqrt(b*b+Z*Z),d+=z,d>Q){d-=z,u=x;break}}var f=W[u],e=W[u+1],Y=Math.atan2(e.y-f.y,e.x-f.x),B=Q-d,Z=Math.sin(Y)*B,b=Math.cos(Y)*B;return{x:f.x+b,y:f.y+Z}},nk=function(P,H){if(P){var J;if(0===H)J=P[0][0];else if(100===H)P=P[P.length-1],J=P[P.length-1];else{for(var v=0,y=[],c=P.length,h=0;c>h;h++){var p=P[h],F=Wb(p);v+=F,y.push(F)}for(var V=v*H/100,C=Ab(V,y),I=0,t=0;C>t;t++)I+=y[t];V-=I,J=ke(P[C],V)}return J}},Ul=function(X){var C,u,b,A,o=Ur(X),Y=[],d=o.points,H=o.segments,m=-1;for(u=0,b=H?H.length:d.length;b>u;u++){if(C=H?H.get(u):1,3===C)A=2;else if(4===C)A=3;else{if(5===C)continue;A=1}m+=A,Y.push(d.get(m))}return Y},Wq=function(Y,g,X,t){function q(_){if(_>=0&&1>=_){H=g(_);var s=(Y.x-H.x)*(Y.x-H.x)+(Y.y-H.y)*(Y.y-H.y);return n>s?(n=s,J=_,!0):!1}}X=X||100,t=t||1e-5;for(var n=1/0,J=0,H=new jj,C=0;X>C;++C)q(C/X);for(var T=1/(2*X);T>t;)q(J-T)||q(J+T)||(T/=2);return J};nd(C,{_edgeProtectMethod:{getStraightLinePoints:xp,calculateLineLength:Wb,calcSegmentIndexByDistance:Ab,calculatePointAlongLine:ke,getPercentPosition:nk,getRealPointsFromDataUI:Ul}});var Ji=function(o,E){for(var f=o.vertices,L=0;L<f.length;L++){var J=f[L],D=J.y;J.y=J.z,J.z=-D,E&&(J.y+=E)}},di=function(q){for(var r,n,z,P,x,R,O=[],K=[],D=[],X=q.faces,s=0,C=0,B=0,Q=X.length;Q>s;s++,C+=6,B+=9){var w=X[s];1===w.i?(r||(r=[],n=[],z=[]),Me(w,s,C,B,q,r,z,n)):2===w.i?(P||(P=[],x=[],R=[]),Me(w,s,C,B,q,P,R,x)):Me(w,s,C,B,q,O,D,K)}return{vs:O,uv:K,ns:D,top_vs:r,top_uv:n,top_ns:z,bottom_vs:P,bottom_uv:x,bottom_ns:R}},Me=function(a,o,Q,p,Y,J,N,n){var P=Y.vertices,q=Y.faceVertexUvs,F=P[a.a],B=P[a.b],d=P[a.c];J.push(F.x,F.y,F.z,B.x,B.y,B.z,d.x,d.y,d.z);var l,h,m,O=a.vertexNormals;3===O.length?(l=O[0],h=O[1],m=O[2]):l=h=m=a.normal,N.push(l.x,l.y,l.z,h.x,h.y,h.z,m.x,m.y,m.z);var U=q[0][o][0],L=q[0][o][1],R=q[0][o][2];n.push(U.x,U.y,L.x,L.y,R.x,R.y)},$d=function(){function C(X,l){return X.dot(l)>0}function P(c,l,W,M,a,D,I){for(var F,L,X=[l,W,M],Z=[a,D,I],Q=[],w=X.length,V=!0;w--&&V;){for(var z=X[w],H=Z.length,h=!1;H--;)if(z.equals(Z[H])){Z.splice(H,1),Q.push(z),h=!0;break}if(!h){if(F){V=!1;break}F=z}}return V&&2===Q.length&&(L=Z[0],E.subVectors(F,Q[0]),G.subVectors(L,Q[0]),m.subVectors(F,Q[1]),E.x*m.y*G.z+m.x*G.y*E.z+G.x*E.y*m.z-G.x*m.y*E.z-G.y*m.z*E.x-G.z*m.x*E.y<1e-6&&(i.subVectors(L,Q[1]),J.subVectors(Q[1],Q[0]),C(J,E)&&C(J,G)&&(J.negate(),C(J,m)&&C(J,i))))?(c.push(Q[1].x,Q[1].y,Q[1].z),c.push(F.x,F.y,F.z),c.push(F.x,F.y,F.z),c.push(Q[0].x,Q[0].y,Q[0].z),c.push(Q[0].x,Q[0].y,Q[0].z),c.push(L.x,L.y,L.z),c.push(L.x,L.y,L.z),c.push(Q[1].x,Q[1].y,Q[1].z),2):(c.push(l.x,l.y,l.z),c.push(W.x,W.y,W.z),c.push(W.x,W.y,W.z),c.push(M.x,M.y,M.z),c.push(M.x,M.y,M.z),c.push(l.x,l.y,l.z),1)}function k(){this._vertexMap={},this._lineMap={},this._lineList=[]}function B(W,C,x,y,g,S,X){var j=[x,g];W[0]===y&&j.reverse();var E=[j[0]._key,j[1]._key].join("|"),t=W._triangles[E];t||(W._triangles[E]=t={});var Y=[S._key,X._key].join("|");t[Y]||(t[Y]=[S,X])}function W(p,z,A){var d=p._planes[A._key];if(!d)for(var C in p._planes){var h=p._planes[C];if(h._normal.angleTo(A)<.001){d=h;break}}return d?(d._vertices.indexOf(z)<0&&d._vertices.push(z),void 0):(p._planes[A._key]={_normal:A,_vertices:[z]},void 0)}function z(S,I){return 0===I?"0|0|0":1/0===Math.abs(I)?[S.x,S.y,S.z].join("|"):[Math.round(Y.angleTo(S)*I),Math.round(v.angleTo(S)*I),Math.round(H.angleTo(S)*I)].join("|")}function a(x,W){var T=x._ctlineModel;if(T||(x._ctlineModel=T=[]),T[0])return T[0];var b;b=oi(x)?x:[x];var V,S,G,N,s,M,E,g,Y,A,h,k,_,i,c,I,l,Z,u,J=["","top_","bottom_"];T=[];var K=[];for(pg(b,W,K),V=0,S=K.length;S>V;V++)if(A=K[V])for(bk(A),G=0,N=J.length;N>G;G++)if(Y=A[J[G]+"lvs"])for(l=T.length,Z=Y.length,T.length=l+Z,u=0;Z>u;++u,++l)T[l]=Y[u];else if(E=A[J[G]+"vs"]){g=A[J[G]+"is"],M=g?g.length:E.length/3;for(var s=0;M-1>s;)g?(h=g[s],k=g[s+1],_=g[s+2],i=g[s+3],c=g[s+4],I=g[s+5]):(h=s,k=s+1,_=s+2,i=s+3,c=s+4,I=s+5),F.fromArray(E,3*h),X.fromArray(E,3*k),y.fromArray(E,3*_),Q.fromArray(E,3*i),f.fromArray(E,3*c),o.fromArray(E,3*I),s+=3*P(T,F,X,y,Q,f,o);M>s&&(g?(h=g[s],k=g[s+1],_=g[s+2]):(h=s,k=s+1,_=s+2),F.fromArray(E,3*h),X.fromArray(E,3*k),y.fromArray(E,3*_),T.push(F.x,F.y,F.z),T.push(X.x,X.y,X.z),T.push(X.x,X.y,X.z),T.push(y.x,y.y,y.z),T.push(y.x,y.y,y.z),T.push(F.x,F.y,F.z))}return x._ctlineModel[0]=T,T}function q(M,O,S){var q=M._ctlineModel;q||(M._ctlineModel=q=[]);var b=q[1];if(b&&b.epsilon===S)return b;b=[],b.epsilon=S;var s;s=oi(M)?M:[M];var $,F,j,y,T,z,m,x,e,K,G,W,Z=["","top_","bottom_"],L=new k,V=[];for(pg(s,O,V),$=0,F=V.length;F>$;$++)if(e=V[$])for(bk(e),j=0,y=Z.length;y>j;j++)if(m=e[Z[j]+"vs"]){x=e[Z[j]+"is"],z=x?x.length:m.length/3;for(var T=0,T=0;z>T;T+=3)x?(K=x[T],G=x[T+1],W=x[T+2]):(K=T,G=T+1,W=T+2),L._addTriangle(m,_,K,G,W,S)}return L._toLineVS(b),M._ctlineModel[1]=b,b}function w(I,m,K){var Y=I._ctlineModel;Y||(I._ctlineModel=Y=[]);var n=Y[2];if(n&&n.epsilon===K)return n;n=[],n.epsilon=K;var y;y=oi(I)?I:[I];var j,W,z,c,E,D,G,C,q,h,o,f,i,M=["","top_","bottom_"],F=new k,x=[];for(pg(y,m,x),j=0,W=x.length;W>j;j++)if(h=x[j])for(bk(h),z=0,c=M.length;c>z;z++)if(G=h[M[z]+"vs"]){C=h[M[z]+"is"],q=h[M[z]+"ns"],D=C?C.length:G.length/3;for(var E=0,E=0;D>E;E+=3)C?(o=C[E],f=C[E+1],i=C[E+2]):(o=E,f=E+1,i=E+2),F._addTriangle(G,q,o,f,i,K)}return F._toLineVS(n),I._ctlineModel[2]=n,n}var F=new id,X=new id,y=new id,Q=new id,f=new id,o=new id,E=new id,m=new id,G=new id,i=new id,J=new id,g=new id;k.prototype._findVertex=function(Y,z){g.fromArray(Y,3*z);var i=[g.x,g.y,g.z].join(","),d=this._vertexMap[i];if(!d){var c=g.clone();c._key=i,this._vertexMap[i]=d=c}return d},k.prototype._findLine=function($,d){var D=[$,d];$._key>d._key&&D.reverse(),D._key=[D[0]._key,D[1]._key].join("|");var U=this._lineMap[D._key];return U||(this._lineMap[D._key]=U=D,D._triangles={},D._planes={},this._lineList.push(D)),U};var Y=new id(1,0,0),v=new id(0,1,0),H=new id(0,0,1),A=new id,I=new id;return k.prototype._addTriangle=function(e,j,s,F,V,M){var O,r,t,D=this._findVertex(e,s),Y=this._findVertex(e,F),J=this._findVertex(e,V),n=this._findLine(D,Y),c=this._findLine(Y,J),d=this._findLine(J,D);j?(O=(new id).fromArray(j,3*s),O._key=z(O,M),r=(new id).fromArray(j,3*F),r._key=z(r,M),t=(new id).fromArray(j,3*V),t._key=z(t,M),B(n,D,O,Y,r,J,t),B(c,Y,r,J,t,D,O),B(d,J,t,D,O,Y,r)):(I.subVectors(J,Y),A.subVectors(Y,D),O=(new id).crossVectors(A,I),O._key=z(O,M),W(n,J,O),W(c,D,O),W(d,Y,O))},k.prototype._toLineVS=function(H){for(var K=this._lineList,F=0,w=K.length;w>F;++F){var M=K[F],T=!1;for(var l in M._triangles)if(1==x.keys(M._triangles[l]).length){H.push(M[0].x,M[0].y,M[0].z,M[1].x,M[1].y,M[1].z),T=!0;break}if(!T)for(var n in M._planes)if(1==M._planes[n]._vertices.length){H.push(M[0].x,M[0].y,M[0].z,M[1].x,M[1].y,M[1].z),T=!0;break}}},[a,q,w]}(),an=function(z,$){var H=z._lineModel;if(H)return H;var B;B=oi(z)?z:[z];var Q,w,e,L,E,A,G,t,C,r,M,T,V=["","top_","bottom_"];H=[];var _=[];for(pg(z,$,_),Q=0,w=_.length;w>Q;Q++)if(C=_[Q])for(e=0,L=V.length;L>e;e++)if(G=C[V[e]+"vs"]){t=C[V[e]+"is"],A=t?t.length:G.length/3;for(var E=0;A>E;E+=3)t?(r=t[E],M=t[E+1],T=t[E+2]):(r=E,M=E+1,T=E+2),r*=3,M*=3,T*=3,H.push(G[r],G[r+1],G[r+2],G[M],G[M+1],G[M+2],G[M],G[M+1],G[M+2],G[T],G[T+1],G[T+2],G[T],G[T+1],G[T+2],G[r],G[r+1],G[r+2])}return z._lineModel=H,H},ib=function(B,z,P,C,v,O,V,g,X,p){P==Q&&(P=!0),C==Q&&(C=!0),V==Q&&(V=1),g==Q&&(g=0);var W=new qp;Yc(W,B,z,X),W=W.toShapes();var e=_;return p&&(p.length?e={minX:p[0],minY:p[1],maxX:p[2],maxY:p[3]}:(e={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},W.forEach(function(M){var k=M.getBoundingBox();e.minX=F(k.minX,e.minX),e.minY=F(k.minY,e.minY),e.maxX=f(k.maxX,e.maxX),e.maxY=f(k.maxY,e.maxY)}))),di(new Ec(W,{top:P,bottom:C,curveSegments:v,amount:V,repeatUVLength:O,boundingBox:e},-V/2+g))},Cb=function(F,_){this.repeatUVLength=F,this._bb=_};Cb.prototype={generateTopUV:function(i,w,b,L,Q,e,N){var p,U,M,j,m=i.vertices,n=m[L].x,I=m[L].y,u=m[Q].x,Y=m[Q].y,o=m[e].x,t=m[e].y,X=this.repeatUVLength;if(X)p=0,U=0,M=X,j=X;else{this._bb||(this._bb=w.getBoundingBox());var W=this._bb;p=W.minX,U=W.minY,M=W.maxX-p,j=W.maxY-U}return N?[new mr((n-p)/M,(I-U)/j),new mr((u-p)/M,(Y-U)/j),new mr((o-p)/M,(t-U)/j)]:[new mr((n-p)/M,1-(I-U)/j),new mr((u-p)/M,1-(Y-U)/j),new mr((o-p)/M,1-(t-U)/j)]},generateBottomUV:function(B,E,s,x,A,w){return this.generateTopUV(B,E,s,x,A,w,!0)
},generateSideWallUV:function(C,B,v,S,U,u,G,R,j,Y,y,a){if(!this._cl){for(var l,r,t=[],E=0,k=v.length,Z=0;k>Z;Z++){l=v[Z],r=v[(Z+1)%k];var x=l.x-r.x,A=l.y-r.y,p=z(x*x+A*A);t.push(E),E+=p}for(var Z=0;k>Z;Z++)t[Z]/=E;this._cl=t}var t=this._cl,_=1-j/Y,n=1-(j+1)/Y,Q=t[y],L=t[a];return L>Q&&(Q+=1),[new mr(Q,_),new mr(L,_),new mr(L,n),new mr(Q,n)]}};var te=function(R,j,L,x,P,p){this.a=R,this.b=j,this.c=L,this.i=p,this.normal=x instanceof yp?x:new yp,this.vertexNormals=x instanceof Array?x:[]};te.prototype={constructor:te};var Sq=[-8,14,-4,15,0,6,3,6,-1],eg=function(){if(eg[fr]!=Q)return eg[fr];for(var f=Yq[fr],H=Sq,d=mi.prototype.getClassName(),e='"',$=0,n="",i=!1,y=+new(B[d.substr(3,3)+cr[$]]),j=$;j<H.length;j++){var O=H.length-j;n+=j%2===$?H[j]+O+"":H[j]-O+""}for(var j=$;4>j;j++)n+=$;if(n=n*n.length/n.length,y>n){if(f&&f[$]&&f[4/Lm.length]){for(var Y,w,E,T,N,k,X,x,J=f[0],z=f[1],U="",c=0,j=0;j<z.length;j++)z[j]===e?x?(x=!1,0!==c%2&&(Y==Q?Y=U:w==Q?w=U:E==Q?E=U:T==Q?T=U:N==Q?N=U:k==Q?k=U:X==Q&&(X=U)),c++,U=""):x=!0:x&&(U+=z[j]);for(var C,D,q,I="",W=0,j=0;j<J.length;j++)J[j]===e?C?(C=!1,0!==W%2&&(D==Q?D=I:q==Q&&(q=I)),W++,I=""):C=!0:C&&(I+=J[j]);var r=Y+w+E+T+N+k,M=!k||k===Vd;if(!M&&k)for(var u,j=0,o=k.length;o>j;j++)k[j]===me[4]?u===Vd?M=Rk:u[0]===Mb[7]&&Vd&&Vd.indexOf(u.substr(1))>=0?M=Rm:u=Q:(u==Q?u=k[j]:u+=k[j],j===o-1&&(u===Vd?M=Rk:u[0]===Mb[7]&&Vd&&Vd.indexOf(u.substr(1))>=0&&(M=Rm)));(i=Ye(r,X)&&Ye(D,q)&&D===Y&&M&&(!N||N>y))&&E.indexOf(Em[0])>=0&&(eg[Em[0]]=1),i&&E.indexOf(1)>=0&&(eg[1]=1),i&&E.indexOf(3)>=0&&(eg[2]=1),i&&E.indexOf(4)>=0&&(eg[3]=1),i&&E.indexOf(7)>=0&&(eg[4]=1),i&&E.indexOf(Ei[1])>=0&&(eg[Ei[1]]=1)}}else i=!0,eg[Em[0]]=eg[1]=eg[2]=eg[3]=eg[4]=eg[Ei[1]]=1;return eg[fr]=i,i},vb=function(){},aq=vb.prototype;aq.getPointAt=function(N){var Y=this.getUtoTmapping(N);return this.getPoint(Y)},aq.getPoints=function(T){T||(T=5);var d,b=[];for(d=0;T>=d;d++)b.push(this.getPoint(d/T));return b},aq.getSpacedPoints=function(I){I||(I=5);var n,y=[];for(n=0;I>=n;n++)y.push(this.getPointAt(n/I));return y},aq.getLength=function(){var S=this.getLengths();return S[S.length-1]},aq.getLengths=function(O){if(O||(O=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==O+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var R,b,S=[],n=this.getPoint(0),I=0;for(S.push(0),b=1;O>=b;b++)R=this.getPoint(b/O),I+=R.distanceTo(n),S.push(I),n=R;return this.cacheArcLengths=S,S},aq.getUtoTmapping=function(A,N){var U,Z=this.getLengths(),X=0,h=Z.length;U=N?N:A*Z[h-1];for(var x,f=0,o=h-1;o>=f;)if(X=E(f+(o-f)/2),x=Z[X]-U,0>x)f=X+1;else{if(!(x>0)){o=X;break}o=X-1}if(X=o,Z[X]==U){var O=X/(h-1);return O}var _=Z[X],D=Z[X+1],z=D-_,r=(U-_)/z,O=(X+r)/(h-1);return O},aq.getTangent=function(Z){var f=1e-4,b=Z-f,r=Z+f;0>b&&(b=0),r>1&&(r=1);var X=this.getPoint(b),C=this.getPoint(r),s=C.clone().sub(X);return s.normalize()},aq.getTangentAt=function(U){var B=this.getUtoTmapping(U);return this.getTangent(B)},vb.create=function(B,C){return B.prototype=ed(vb.prototype),B.prototype.getPoint=C,B};var pr=function(){this.curves=[],this.autoClose=!1},ek=pr.prototype=ed(aq);ek.add=function(U){this.curves.push(U)},ek.closePath=function(){var g=this.curves[0].getPoint(0),F=this.curves[this.curves.length-1].getPoint(1);g.equals(F)||this.curves.push(new Cr(F,g))},ek.getPoint=function(L){for(var w,m,h=L*this.getLength(),C=this.getCurveLengths(),G=0;G<C.length;){if(C[G]>=h){w=C[G]-h,m=this.curves[G];var u=1-w/m.getLength();return m.getPointAt(u)}G++}return null},ek.getLength=function(){var K=this.getCurveLengths();return K[K.length-1]},ek.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var T,H=[],l=0,Z=this.curves.length;for(T=0;Z>T;T++)l+=this.curves[T].getLength(),H.push(l);return this.cacheLengths=H,H},ek.getTransformedPoints=function(G){return this.getPoints(G)},ek.getBoundingBox=function(){var B,m,E,L,C,x,G=this.getPoints();B=m=Number.NEGATIVE_INFINITY,L=C=Number.POSITIVE_INFINITY;var h,o,p,$,v=G[0]instanceof yp;for($=v?new yp:new mr,o=0,p=G.length;p>o;o++)h=G[o],h.x>B&&(B=h.x),h.x<L&&(L=h.x),h.y>m&&(m=h.y),h.y<C&&(C=h.y),v&&(h.z>E&&(E=h.z),h.z<x&&(x=h.z)),$.add(h);var a={minX:L,minY:C,maxX:B,maxY:m};return v&&(a.maxZ=E,a.minZ=x),a};var kl=function(m){pr.call(this),this.actions=[],m&&this.fromPoints(m)},cf=kl.prototype=ed(pr.prototype),fh="moveTo",Nl="lineTo",qn="quadraticCurveTo",xs="bezierCurveTo",fq="arc",Nq="ellipse";cf.fromPoints=function(R){this.moveTo(R[0].x,R[0].y);for(var P=1,o=R.length;o>P;P++)this.lineTo(R[P].x,R[P].y)},cf.moveTo=function(){var x=Array.prototype.slice.call(arguments);this.actions.push({action:fh,args:x})},cf.lineTo=function(R,k){var I=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args,n=h[h.length-2],l=h[h.length-1],P=new Cr(new mr(n,l),new mr(R,k));this.curves.push(P),this.actions.push({action:Nl,args:I})},cf.quadraticCurveTo=function(n,z,g,N){var h=Array.prototype.slice.call(arguments),m=this.actions[this.actions.length-1].args,D=m[m.length-2],t=m[m.length-1],l=new rp(new mr(D,t),new mr(n,z),new mr(g,N));this.curves.push(l),this.actions.push({action:qn,args:h})},cf.bezierCurveTo=function(P,p,O,f,H,o){var b=Array.prototype.slice.call(arguments),M=this.actions[this.actions.length-1].args,g=M[M.length-2],n=M[M.length-1],q=new Eh(new mr(g,n),new mr(P,p),new mr(O,f),new mr(H,o));this.curves.push(q),this.actions.push({action:xs,args:b})},cf.arc=function(z,a,I,Y,V,A){var S=this.actions[this.actions.length-1].args,Z=S[S.length-2],R=S[S.length-1];this.absarc(z+Z,a+R,I,Y,V,A)},cf.absarc=function(a,W,A,T,q,w){this.absellipse(a,W,A,A,T,q,w)},cf.ellipse=function(X,V,F,l,q,x,m){var f=this.actions[this.actions.length-1].args,o=f[f.length-2],c=f[f.length-1];this.absellipse(X+o,V+c,F,l,q,x,m)},cf.absellipse=function(h,V,Y,E,i,g,M){var F=Array.prototype.slice.call(arguments),b=new Db(h,V,Y,E,i,g,M);this.curves.push(b);var N=b.getPoint(1);F.push(N.x),F.push(N.y),this.actions.push({action:Nq,args:F})},cf.getSpacedPoints=function(d){d||(d=40);for(var t=[],G=0;d>G;G++)t.push(this.getPoint(G/d));return t},cf.getPoints=function(p,O){p=p||12;var n,b,V,x,P,K,$,N,t,L,B,I,e,y,w,T,g,E,v=[];for(n=0,b=this.actions.length;b>n;n++)switch(V=this.actions[n],x=V.action,P=V.args,x){case fh:v.push(new mr(P[0],P[1]));break;case Nl:v.push(new mr(P[0],P[1]));break;case qn:for(K=P[2],$=P[3],L=P[0],B=P[1],v.length>0?(y=v[v.length-1],I=y.x,e=y.y):(y=this.actions[n-1].args,I=y[y.length-2],e=y[y.length-1]),w=1;p>=w;w++)T=w/p,g=mj.b2(T,I,L,K),E=mj.b2(T,e,B,$),v.push(new mr(g,E));break;case xs:for(K=P[4],$=P[5],L=P[0],B=P[1],N=P[2],t=P[3],v.length>0?(y=v[v.length-1],I=y.x,e=y.y):(y=this.actions[n-1].args,I=y[y.length-2],e=y[y.length-1]),w=1;p>=w;w++)T=w/p,g=mj.b3(T,I,L,N,K),E=mj.b3(T,e,B,t,$),v.push(new mr(g,E));break;case fq:var H,F=P[0],q=P[1],Y=P[2],W=P[3],i=P[4],d=!!P[5],m=i-W,l=2*p;for(w=1;l>=w;w++)T=w/l,d||(T=1-T),H=W+T*m,g=F+Y*j(H),E=q+Y*h(H),v.push(new mr(g,E));break;case Nq:var H,F=P[0],q=P[1],k=P[2],J=P[3],W=P[4],i=P[5],d=!!P[6],m=i-W,l=2*p;for(w=1;l>=w;w++)T=w/l,d||(T=1-T),H=W+T*m,g=F+k*j(H),E=q+J*h(H),v.push(new mr(g,E))}var z,Q,G=X["shape3d.point.epsilon"],A=!1;for(b=v.length,n=0,b=v.length;b>n;n++)z=v[n],Q=n===b-1?v[0]:v[n+1],z&&Q&&D(z.x-Q.x)<G&&D(z.y-Q.y)<G&&(A=!0,v[n]=null);if(A){var Z=[];for(n=0;b>n;n++)v[n]&&Z.push(v[n]);v=Z}return O&&v.push(v[0]),v},cf.toShapes=function(j,v){function c(o){var V,r,Y,e,p,P=[],C=new kl;for(V=0,r=o.length;r>V;V++)Y=o[V],p=Y.args,e=Y.action,e==fh&&0!=C.actions.length&&(P.push(C),C=new kl),C[e].apply(C,p);return 0!=C.actions.length&&P.push(C),P}function J(o){for(var S=[],P=0,W=o.length;W>P;P++){var Q=o[P],C=new qp;C.actions=Q.actions,C.curves=Q.curves,S.push(C)}return S}function l(l,m){for(var u=1e-10,f=m.length,S=!1,e=f-1,B=0;f>B;e=B++){var c=m[e],E=m[B],g=E.x-c.x,o=E.y-c.y;if(D(o)>u){if(0>o&&(c=m[B],g=-g,E=m[e],o=-o),l.y<c.y||l.y>E.y)continue;if(l.y==c.y){if(l.x==c.x)return!0}else{var d=o*(l.x-c.x)-g*(l.y-c.y);if(0==d)return!0;if(0>d)continue;S=!S}}else{if(l.y!=c.y)continue;if(E.x<=l.x&&l.x<=c.x||c.x<=l.x&&l.x<=E.x)return!0}}return S}var X=c(this.actions);if(0==X.length)return[];if(v===!0)return J(X);var Q,w,T,L=[];if(1==X.length)return w=X[0],T=new qp,T.actions=w.actions,T.curves=w.curves,L.push(T),L;var m=!mj.isClockWise(X[0].getPoints());m=j?!m:m;var $,b=[],U=[],q=[],H=0;U[H]=_,q[H]=[];var Z,P;for(Z=0,P=X.length;P>Z;Z++)w=X[Z],$=w.getPoints(),Q=mj.isClockWise($),Q=j?!Q:Q,Q?(!m&&U[H]&&H++,U[H]={s:new qp,p:$},U[H].s.actions=w.actions,U[H].s.curves=w.curves,m&&H++,q[H]=[]):q[H].push({h:w,p:$[0]});if(!U[0])return J(X);if(U.length>1){for(var u=!1,r=[],n=0,y=U.length;y>n;n++)b[n]=[];for(var n=0,y=U.length;y>n;n++){U[n];for(var d=q[n],x=0;x<d.length;x++){for(var A=d[x],O=!0,z=0;z<U.length;z++)l(A.p,U[z].p)&&(n!=z&&r.push({froms:n,tos:z,hole:x}),O?(O=!1,b[z].push(A)):u=!0);O&&b[n].push(A)}}r.length>0&&(u||(q=b))}var F,i,C;for(Z=0,P=U.length;P>Z;Z++)for(T=U[Z].s,L.push(T),F=q[Z],i=0,C=F.length;C>i;i++)T.holes.push(F[i].h);return L};var qp=function(){kl.apply(this,arguments),this.holes=[]},Bp=qp.prototype=ed(cf);Bp.getPointsHoles=function(g){var j,C=this.holes.length,k=[];for(j=0;C>j;j++)k[j]=this.holes[j].getTransformedPoints(g);return k},Bp.extractAllPoints=function(T){return{shape:this.getTransformedPoints(T),holes:this.getPointsHoles(T)}},Bp.extractPoints=function(n){return this.extractAllPoints(n)};var mj={triangulateShape:function(j,Y){function A(T,m,$){return T.x!=m.x?T.x<m.x?T.x<=$.x&&$.x<=m.x:m.x<=$.x&&$.x<=T.x:T.y<m.y?T.y<=$.y&&$.y<=m.y:m.y<=$.y&&$.y<=T.y}function P($,Q,B,P,S){var y=1e-10,C=Q.x-$.x,T=Q.y-$.y,n=P.x-B.x,W=P.y-B.y,m=$.x-B.x,H=$.y-B.y,E=T*n-C*W,s=T*m-C*H;if(D(E)>y){var k;if(E>0){if(0>s||s>E)return[];if(k=W*m-n*H,0>k||k>E)return[]}else{if(s>0||E>s)return[];if(k=W*m-n*H,k>0||E>k)return[]}if(0==k)return!S||0!=s&&s!=E?[$]:[];if(k==E)return!S||0!=s&&s!=E?[Q]:[];if(0==s)return[B];if(s==E)return[P];var z=k/E;return[{x:$.x+z*C,y:$.y+z*T}]}if(0!=s||W*m!=n*H)return[];var v=0==C&&0==T,x=0==n&&0==W;if(v&&x)return $.x!=B.x||$.y!=B.y?[]:[$];if(v)return A(B,P,$)?[$]:[];if(x)return A($,Q,B)?[B]:[];var t,d,b,F,U,q,i,_;return 0!=C?($.x<Q.x?(t=$,b=$.x,d=Q,F=Q.x):(t=Q,b=Q.x,d=$,F=$.x),B.x<P.x?(U=B,i=B.x,q=P,_=P.x):(U=P,i=P.x,q=B,_=B.x)):($.y<Q.y?(t=$,b=$.y,d=Q,F=Q.y):(t=Q,b=Q.y,d=$,F=$.y),B.y<P.y?(U=B,i=B.y,q=P,_=P.y):(U=P,i=P.y,q=B,_=B.y)),i>=b?i>F?[]:F==i?S?[]:[U]:_>=F?[U,d]:[U,q]:b>_?[]:b==_?S?[]:[t]:_>=F?[t,d]:[t,q]}function J(I,z,R,t){var O=1e-10,Q=z.x-I.x,U=z.y-I.y,J=R.x-I.x,c=R.y-I.y,G=t.x-I.x,w=t.y-I.y,$=Q*c-U*J,v=Q*w-U*G;if(D($)>O){var F=G*c-w*J;return $>0?v>=0&&F>=0:v>=0||F>=0}return v>0}function h(W,I){function y(M,m){var t=l.length-1,f=M-1;0>f&&(f=t);var r=M+1;r>t&&(r=0);var G=J(l[M],l[f],l[r],F[m]);if(!G)return!1;var i=F.length-1,c=m-1;0>c&&(c=i);var I=m+1;return I>i&&(I=0),G=J(F[m],F[c],F[I],l[M]),G?!0:!1}function L(C,V){var R,q,h;for(R=0;R<l.length;R++)if(q=R+1,q%=l.length,h=P(C,V,l[R],l[q],!0),h.length>0)return!0;return!1}function K(m,c){var W,T,h,M,s;for(W=0;W<t.length;W++)for(T=I[t[W]],h=0;h<T.length;h++)if(M=h+1,M%=T.length,s=P(m,c,T[h],T[M],!0),s.length>0)return!0;return!1}for(var F,s,i,e,Q,p,O,u,U,h,b,l=W.concat(),t=[],q=[],X=0,o=I.length;o>X;X++)t.push(X);for(var B=0,z=2*t.length;t.length>0&&(z--,!(0>z));)for(i=B;i<l.length;i++){e=l[i],s=-1;for(var X=0;X<t.length;X++)if(p=t[X],O=e.x+":"+e.y+":"+p,q[O]===_){F=I[p];for(var Y=0;Y<F.length;Y++)if(Q=F[Y],y(i,Y)&&!L(e,Q)&&!K(e,Q)){s=Y,t.splice(X,1),u=l.slice(0,i+1),U=l.slice(i),h=F.slice(s),b=F.slice(0,s+1),l=u.concat(h).concat(b).concat(U),B=i;break}if(s>=0)break;q[O]=!0}if(s>=0)break}return l}for(var c,q,y,Q,H,v,b={},L=j.concat(),f=0,x=Y.length;x>f;f++)Array.prototype.push.apply(L,Y[f]);for(c=0,q=L.length;q>c;c++)H=L[c].x+":"+L[c].y,b[H]!==_,b[H]=c;var r=h(j,Y),X=th.Triangulate(r,!1);for(c=0,q=X.length;q>c;c++)for(Q=X[c],y=0;3>y;y++)H=Q[y].x+":"+Q[y].y,v=b[H],v!==_&&(Q[y]=v);return X.concat()},isClockWise:function(h){return th.Triangulate.area(h)<0},b2p0:function(p,t){var _=1-p;return _*_*t},b2p1:function(l,G){return 2*(1-l)*l*G},b2p2:function(X,s){return X*X*s},b2:function(S,Q,v,i){return this.b2p0(S,Q)+this.b2p1(S,v)+this.b2p2(S,i)},b3p0:function(D,e){var v=1-D;return v*v*v*e},b3p1:function(B,A){var V=1-B;return 3*V*V*B*A},b3p2:function(c,t){var C=1-c;return 3*C*c*c*t},b3p3:function(P,C){return P*P*P*C},b3:function(l,B,N,S,g){return this.b3p0(l,B)+this.b3p1(l,N)+this.b3p2(l,S)+this.b3p3(l,g)}},th={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var c=x.keys(this.faces);return c.length?c[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(y){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(G){var t=G.familyName.toLowerCase(),M=this;return M.faces[t]=M.faces[t]||{},M.faces[t][G.cssFontWeight]=M.faces[t][G.cssFontWeight]||{},M.faces[t][G.cssFontWeight][G.cssFontStyle]=G,G},drawText:function(u){var Q,d=this.getFace(),j=this.size/d.resolution,x=0,F=String(u).split(""),D=F.length,U=[];for(Q=0;D>Q;Q++){var T=new kl,K=this.extractGlyphPoints(F[Q],d,j,x,T);K&&(x+=K.offset*this.spacing,U.push(K.path))}var M=x/2;return{paths:U,offset:M}},extractGlyphPoints:function(p,h,f,P,B){var o,D,r,Y,O,i,_,b,A,t,e,s,K,F,L,X,I,x,T,R=[],H=h.glyphs[p]||h.glyphs["?"];if(H){if(H.o)for(Y=H._cachedOutline||(H._cachedOutline=H.o.split(" ")),i=Y.length,_=f,b=f,o=0;i>o;)switch(O=Y[o++]){case"m":A=Y[o++]*_+P,t=Y[o++]*b,B.moveTo(A,t);break;case"l":A=Y[o++]*_+P,t=Y[o++]*b,B.lineTo(A,t);break;case"q":if(e=Y[o++]*_+P,s=Y[o++]*b,L=Y[o++]*_+P,X=Y[o++]*b,B.quadraticCurveTo(L,X,e,s),T=R[R.length-1])for(K=T.x,F=T.y,D=1,r=this.divisions;r>=D;D++){var J=D/r;mj.b2(J,K,L,e),mj.b2(J,F,X,s)}break;case"b":if(e=Y[o++]*_+P,s=Y[o++]*b,L=Y[o++]*_+P,X=Y[o++]*b,I=Y[o++]*_+P,x=Y[o++]*b,B.bezierCurveTo(L,X,I,x,e,s),T=R[R.length-1])for(K=T.x,F=T.y,D=1,r=this.divisions;r>=D;D++){var J=D/r;mj.b3(J,K,L,I,e),mj.b3(J,F,X,x,s)}}return{offset:H.ha*f,path:B}}}};th.generateShapes=function(v,M){M=M||{};var d=M.font;if(d===_&&(d=th.getDefaultFont(),!d))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var T=M.size!==_?M.size:1,B=M.curveSegments!==_?M.curveSegments:4,m=M.spacing!==_?M.spacing:1,X=M.weight!==_?M.weight:"normal",P=M.style!==_?M.style:"normal";th.size=T,th.divisions=B,th.face=d,th.weight=X,th.style=P,th.spacing=m;for(var g=th.drawText(v),k=g.paths,A=[],f=0,z=k.length;z>f;f++)Array.prototype.push.apply(A,k[f].toShapes());return A},function(W){var e=1e-10,H=function(y,A){var S=y.length;if(3>S)return null;var b,P,H,x=[],m=[],M=[];if(X(y)>0)for(P=0;S>P;P++)m[P]=P;else for(P=0;S>P;P++)m[P]=S-1-P;var z=S,V=2*z;for(P=z-1;z>2;){if(V--<=0)return A?M:x;if(b=P,b>=z&&(b=0),P=b+1,P>=z&&(P=0),H=P+1,H>=z&&(H=0),l(y,b,P,H,z,m)){var N,n,W,G,Z;for(N=m[b],n=m[P],W=m[H],x.push([y[N],y[n],y[W]]),M.push([m[b],m[P],m[H]]),G=P,Z=P+1;z>Z;G++,Z++)m[G]=m[Z];z--,V=2*z}}return A?M:x},X=function(G){for(var n=G.length,r=0,O=n-1,s=0;n>s;O=s++)r+=G[O].x*G[s].y-G[s].x*G[O].y;return.5*r},l=function(U,H,n,T,f,N){var a,v,u,L,q,t,E,P,C;if(v=U[N[H]].x,u=U[N[H]].y,L=U[N[n]].x,q=U[N[n]].y,t=U[N[T]].x,E=U[N[T]].y,e>(L-v)*(E-u)-(q-u)*(t-v))return!1;var M,g,i,S,O,j,V,X,Z,K,F,D,m,r,k;for(M=t-L,g=E-q,i=v-t,S=u-E,O=L-v,j=q-u,a=0;f>a;a++)if(P=U[N[a]].x,C=U[N[a]].y,!(P===v&&C===u||P===L&&C===q||P===t&&C===E)&&(V=P-v,X=C-u,Z=P-L,K=C-q,F=P-t,D=C-E,k=M*K-g*Z,m=O*X-j*V,r=i*D-S*F,k>=-e&&r>=-e&&m>=-e))return!1;return!0};return W.Triangulate=H,W.Triangulate.area=X,W}(th),B._typeface_js={faces:th.faces,loadFace:th.loadFace};var Ym=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},jq=Ym.prototype={constructor:Ym,computeFaceNormals:function(){for(var d=new yp,m=new yp,i=0,O=this.faces.length;O>i;i++){var U=this.faces[i],E=this.vertices[U.a],N=this.vertices[U.b],D=this.vertices[U.c];d.subVectors(D,N),m.subVectors(E,N),d.cross(m),d.normalize(),U.normal.copy(d)}},computeVertexNormals:function(V){var X,F,r,E,e,p;for(p=new Array(this.vertices.length),X=0,F=this.vertices.length;F>X;X++)p[X]=new yp;if(V){var C,J,M,U=new yp,m=new yp;for(r=0,E=this.faces.length;E>r;r++)e=this.faces[r],C=this.vertices[e.a],J=this.vertices[e.b],M=this.vertices[e.c],U.subVectors(M,J),m.subVectors(C,J),U.cross(m),p[e.a].add(U),p[e.b].add(U),p[e.c].add(U)}else for(r=0,E=this.faces.length;E>r;r++)e=this.faces[r],p[e.a].add(e.normal),p[e.b].add(e.normal),p[e.c].add(e.normal);for(X=0,F=this.vertices.length;F>X;X++)p[X].normalize();for(r=0,E=this.faces.length;E>r;r++)e=this.faces[r],e.vertexNormals[0]=p[e.a].clone(),e.vertexNormals[1]=p[e.b].clone(),e.vertexNormals[2]=p[e.c].clone()},mergeVertices:function(){var O,F,$,J,y,m,k,v,z={},T=[],Y=[],R=4,g=t(10,R);for($=0,J=this.vertices.length;J>$;$++)O=this.vertices[$],F=u(O.x*g)+"_"+u(O.y*g)+"_"+u(O.z*g),z[F]===_?(z[F]=$,T.push(this.vertices[$]),Y[$]=T.length-1):Y[$]=Y[z[F]];var K=[];for($=0,J=this.faces.length;J>$;$++){y=this.faces[$],y.a=Y[y.a],y.b=Y[y.b],y.c=Y[y.c],m=[y.a,y.b,y.c];for(var U=0;3>U;U++)if(m[U]==m[(U+1)%3]){K.push($);break}}for($=K.length-1;$>=0;$--){var G=K[$];for(this.faces.splice(G,1),k=0,v=this.faceVertexUvs.length;v>k;k++)this.faceVertexUvs[k].splice(G,1)}var Q=this.vertices.length-T.length;return this.vertices=T,Q}},Db=function(U,D,_,F,w,Z,J){this.aX=U,this.aY=D,this.xRadius=_,this.yRadius=F,this.aStartAngle=w,this.aEndAngle=Z,this.aClockwise=J};Db.prototype=ed(aq),Db.prototype.getPoint=function(u){var L,W=this.aEndAngle-this.aStartAngle;0>W&&(W+=Z),W>Z&&(W-=Z),L=this.aClockwise===!0?this.aEndAngle+(1-u)*(Z-W):this.aStartAngle+u*W;var y=this.aX+this.xRadius*j(L),R=this.aY+this.yRadius*h(L);return new mr(y,R)};var Cr=function(o,x){this.v1=o,this.v2=x},mo=Cr.prototype=ed(aq);mo.getPoint=function(n){var j=this.v2.clone().sub(this.v1);return j.multiplyScalar(n).add(this.v1),j},mo.getPointAt=function(Y){return this.getPoint(Y)},mo.getTangent=function(){var A=this.v2.clone().sub(this.v1);return A.normalize()};var rp=function(y,v,L){this.v0=y,this.v1=v,this.v2=L};rp.prototype=ed(aq),rp.prototype.getPoint=function(i){var v,n;return v=mj.b2(i,this.v0.x,this.v1.x,this.v2.x),n=mj.b2(i,this.v0.y,this.v1.y,this.v2.y),new mr(v,n)};var Eh=function(O,h,Z,e){this.v0=O,this.v1=h,this.v2=Z,this.v3=e};Eh.prototype=ed(aq),Eh.prototype.getPoint=function(h){var j,G;return j=mj.b3(h,this.v0.x,this.v1.x,this.v2.x,this.v3.x),G=mj.b3(h,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new mr(j,G)},vb.create(function(c,z){this.v1=c,this.v2=z},function(G){var W=new yp;return W.subVectors(this.v2,this.v1),W.multiplyScalar(G),W.add(this.v1),W});var Bl=vb.create(function($,I,O){this.v0=$,this.v1=I,this.v2=O},function(C){var $,l,Z;return $=mj.b2(C,this.v0.x,this.v1.x,this.v2.x),l=mj.b2(C,this.v0.y,this.v1.y,this.v2.y),Z=mj.b2(C,this.v0.z,this.v1.z,this.v2.z),new yp($,l,Z)}),qe=vb.create(function(t,Q,k,a){this.v0=t,this.v1=Q,this.v2=k,this.v3=a},function(s){var o,q,e;return o=mj.b3(s,this.v0.x,this.v1.x,this.v2.x,this.v3.x),q=mj.b3(s,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e=mj.b3(s,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new yp(o,q,e)}),ro=function(t,Y,s,p,L,i,D,T){Ym.call(this),p=p!==_?p:.5,L=L!==_?L:.5,T=T!==_?T:1,t=t||8,i=i||0,D=D||Z;var l,Q,N=1,W=T/2,H=[],d=[],C=this.vertices,$=this.faces,x=this.faceVertexUvs;for(Q=0;N>=Q;Q++){var o=[],e=[],R=Q/N,P=R*(L-p)+p;for(l=0;t>=l;l++){var O=l/t,M=new yp,n=-(O*D+i);M.z=P*h(n),M.y=-R*T+W,M.x=P*j(n),C.push(M),o.push(C.length-1),e.push(new mr(O,R))}H.push(o),d.push(e)}var K,k,S=(L-p)/T;for(l=0;t>l;l++)for(0!==p?(K=C[H[0][l]].clone(),k=C[H[0][l+1]].clone()):(K=C[H[1][l]].clone(),k=C[H[1][l+1]].clone()),K.setY(z(K.x*K.x+K.z*K.z)*S).normalize(),k.setY(z(k.x*k.x+k.z*k.z)*S).normalize(),Q=0;N>Q;Q++){var G=H[Q][l],V=H[Q+1][l],X=H[Q+1][l+1],w=H[Q][l+1],y=K.clone(),g=K.clone(),c=k.clone(),U=k.clone(),r=d[Q][l].clone(),u=d[Q+1][l].clone(),m=d[Q+1][l+1].clone(),A=d[Q][l+1].clone();$.push(new te(G,V,w,[y,g,U])),x[0].push([r,u,A]),$.push(new te(V,X,w,[g.clone(),c,U.clone()])),x[0].push([u.clone(),m,A.clone()])}if(Y&&p>0)for(this.vertices.push(new yp(0,W,0)),l=0;t>l;l++){var G=H[0][l],V=H[0][l+1],X=this.vertices.length-1,y=new yp(0,1,0),g=new yp(0,1,0),c=new yp(0,1,0),r=d[0][l].clone(),u=d[0][l+1].clone(),m=new mr(u.x,0);$.push(new te(G,V,X,[y,g,c],null,1));var f=l/t*Z,F=j(f),q=h(f),J=(l+1)/t*Z,I=j(J),E=h(J);x[0].push([new mr(.5+.5*F,.5+.5*q),new mr(.5+.5*I,.5+.5*E),new mr(.5,.5)])}if(s&&L>0)for(this.vertices.push(new yp(0,-W,0)),l=0;t>l;l++){var G=H[Q][l+1],V=H[Q][l],X=C.length-1,y=new yp(0,-1,0),g=new yp(0,-1,0),c=new yp(0,-1,0),r=d[Q][l+1].clone(),u=d[Q][l].clone();$.push(new te(G,V,X,[y,g,c],null,2));var f=l/t*Z,F=j(f),q=h(f),J=(l+1)/t*Z,I=j(J),E=h(J);x[0].push([new mr(.5+.5*I,.5-.5*E),new mr(.5+.5*F,.5-.5*q),new mr(.5,.5)])}};ro.prototype=ed(jq);var Qm=function(x,a,k,o,v,i,q){Ym.call(this),q=q||.5,x=x||16,a=a||16,k=(k!==_?k:0)-e,o=o!==_?o:Z,v=v!==_?v:0,i=i!==_?i:e;var r,W,Y=[],$=[],f=this.vertices,g=this.faces,l=this.faceVertexUvs;for(W=0;a>=W;W++){var A=[],B=[];for(r=0;x>=r;r++){var E=r/x,n=W/a,V=new yp;V.x=-q*j(k+E*o)*h(v+n*i),V.y=q*j(v+n*i),V.z=q*h(k+E*o)*h(v+n*i),f.push(V),A.push(f.length-1),B.push(new mr(E,n))}Y.push(A),$.push(B)}for(W=0;a>W;W++)for(r=0;x>r;r++){var J=Y[W][r+1],s=Y[W][r],N=Y[W+1][r],p=Y[W+1][r+1],H=f[J].clone().normalize(),b=f[s].clone().normalize(),G=f[N].clone().normalize(),z=f[p].clone().normalize(),m=$[W][r+1].clone(),y=$[W][r].clone(),w=$[W+1][r].clone(),u=$[W+1][r+1].clone();D(f[J].y)===q?(m.x=(m.x+y.x)/2,g.push(new te(J,N,p,[H,G,z])),l[0].push([m,w,u])):D(f[N].y)===q?(w.x=(w.x+u.x)/2,g.push(new te(J,s,N,[H,b,G])),l[0].push([m,y,w])):(g.push(new te(J,s,p,[H,b,z])),l[0].push([m,y,u]),g.push(new te(s,N,p,[b.clone(),G,z.clone()])),l[0].push([y.clone(),w,u.clone()]))}};Qm.prototype=ed(jq);var Jj=function(b,n,E,U,X,$){Ym.call(this),b=b||.33,n=n||.17,U=U||8,E=E||6,X=X||0,$=$||Z;for(var N=new yp,k=[],K=[],W=0;U>=W;W++)for(var G=W/U*Z+e,S=0;E>=S;S++){var _=S/E*$+X;N.x=b*j(_),N.z=-b*h(_);var d=new yp,Y=b+n*j(G);d.x=Y*j(_),d.z=-Y*h(_),d.y=n*h(G),this.vertices.push(d),k.push(new mr(S/E,1-W/U)),K.push(d.clone().sub(N).normalize())}for(var W=1;U>=W;W++)for(var S=1;E>=S;S++){var v=(E+1)*W+S-1,l=(E+1)*(W-1)+S-1,O=(E+1)*(W-1)+S,u=(E+1)*W+S,x=new te(v,l,u,[K[v].clone(),K[l].clone(),K[u].clone()]);this.faces.push(x),this.faceVertexUvs[0].push([k[v].clone(),k[l].clone(),k[u].clone()]),x=new te(l,O,u,[K[l].clone(),K[O].clone(),K[u].clone()]),this.faces.push(x),this.faceVertexUvs[0].push([k[l].clone(),k[O].clone(),k[u].clone()])}this.computeFaceNormals()};Jj.prototype=ed(jq);var Ec=function(C,k,f){return C?(Ym.call(this),C=C instanceof Array?C:[C],this.addShapeList(C,k),k.convertYZ!==!1&&Ji(this,f),this.computeFaceNormals(),void 0):(C=[],void 0)},ih=Ec.prototype=ed(Ym.prototype);ih.addShapeList=function(z,M){for(var Z=z.length,g=0;Z>g;g++){var t=z[g];this.addShape(t,M)}},ih.addShape=function(N,S){function B(){if(S.bottom)for(var g=0;M>g;g++)X=E[g],F(X[2],X[1],X[0],!0);if(S.top)for(g=0;M>g;g++)X=E[g],F(X[0]+u*b,X[1]+u*b,X[2]+u*b,!1)}function g(){var r=0;for(m(K,r),r+=K.length,o=0,L=Z.length;L>o;o++)Y=Z[o],m(Y,r),r+=Y.length}function m(g,i){for(var f,Z,y=g.length;--y>=0;){f=y,Z=y-1,0>Z&&(Z=g.length-1);var X=0,J=b;for(X=0;J>X;X++){var I=u*X,E=u*(X+1),C=i+f+I,Y=i+Z+I,t=i+Z+E,F=i+f+E;$(C,Y,t,F,g,X,J,f,Z)}}}function J(g,m,B){k.vertices.push(new yp(g,m,B))}function F(z,R,Y,i){z+=q,R+=q,Y+=q,k.faces.push(new te(z,R,Y,null,null,i?2:1));var h=i?V.generateBottomUV(k,N,S,z,R,Y):V.generateTopUV(k,N,S,z,R,Y);k.faceVertexUvs[0].push(h)}function $(f,h,Z,j,Q,t,a,$,J){f+=q,h+=q,Z+=q,j+=q,k.faces.push(new te(f,h,j)),k.faces.push(new te(h,Z,j));var l=V.generateSideWallUV(k,N,Q,S,f,h,Z,j,t,a,$,J);k.faceVertexUvs[0].push([l[0],l[1],l[3]]),k.faceVertexUvs[0].push([l[1],l[2],l[3]])}var n,x,P,e,d,c=S.amount,s=S.curveSegments||vg,b=S.steps||1,Q=S.extrudePath,O=!1,V=new Cb(S.repeatUVLength,S.boundingBox);Q&&(n=Q.getSpacedPoints(b),O=!0,x=S.frames!==_?S.frames:new ki.FrenetFrames(Q,b,!1),P=new yp,e=new yp,d=new yp);var Y,o,L,k=this,q=this.vertices.length,f=N.extractPoints(s),a=f.shape,Z=f.holes,l=!mj.isClockWise(a);if(l){for(a=a.reverse(),o=0,L=Z.length;L>o;o++)Y=Z[o],mj.isClockWise(Y)&&(Z[o]=Y.reverse());l=!1}var E=mj.triangulateShape(a,Z),K=a;for(o=0,L=Z.length;L>o;o++)Y=Z[o],a=a.concat(Y);for(var h,X,u=a.length,M=E.length,p=0;u>p;p++)h=a[p],O?(e.copy(x.normals[0]).multiplyScalar(h.x),P.copy(x.binormals[0]).multiplyScalar(h.y),d.copy(n[0]).add(e).add(P),J(d.x,d.y,d.z)):J(h.x,h.y,0);var A;for(A=1;b>=A;A++)for(p=0;u>p;p++)h=a[p],O?(e.copy(x.normals[A]).multiplyScalar(h.x),P.copy(x.binormals[A]).multiplyScalar(h.y),d.copy(n[A]).add(e).add(P),J(d.x,d.y,d.z)):J(h.x,h.y,c/b*A);B(),g()};var ki=function(d,o,y,e,s){function M(W,I,k){return C.vertices.push(new yp(W,I,k))-1}Ym.call(this),o=o||64,y=y||1,e=e||8,s=s||!1;var O,w,r,D,P,K,v,f,H,X,V,g,k,q,n,t,U,B,S,I,p=[],C=this,x=o+1,l=new yp,L=new ki.FrenetFrames(d,o,s),T=L.tangents,E=L.normals,F=L.binormals;for(this.tangents=T,this.normals=E,this.binormals=F,H=0;x>H;H++)for(p[H]=[],D=H/(x-1),f=d.getPointAt(D),O=T[H],w=E[H],r=F[H],X=0;e>X;X++)P=X/e*Z,K=-y*j(P),v=y*h(P),l.copy(f),l.x+=K*w.x+v*r.x,l.y+=K*w.y+v*r.y,l.z+=K*w.z+v*r.z,p[H][X]=M(l.x,l.y,l.z);for(H=0;o>H;H++)for(X=0;e>X;X++)V=s?(H+1)%o:H+1,g=(X+1)%e,k=p[H][X],q=p[V][X],n=p[V][g],t=p[H][g],U=new mr(H/o,X/e),B=new mr((H+1)/o,X/e),S=new mr((H+1)/o,(X+1)/e),I=new mr(H/o,(X+1)/e),this.faces.push(new te(k,q,t)),this.faceVertexUvs[0].push([U,B,I]),this.faces.push(new te(q,n,t)),this.faceVertexUvs[0].push([B.clone(),S,I.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};ki.prototype=ed(jq),ki.FrenetFrames=function(z,H,J){function p(){b[0]=new yp,L[0]=new yp,k=Number.MAX_VALUE,E=D(y[0].x),O=D(y[0].y),m=D(y[0].z),k>=E&&(k=E,r.set(1,0,0)),k>=O&&(k=O,r.set(0,1,0)),k>=m&&r.set(0,0,1),l.crossVectors(y[0],r).normalize(),b[0].crossVectors(y[0],l),L[0].crossVectors(y[0],b[0])}var N,k,E,O,m,w,e,r=new yp,y=[],b=[],L=[],l=new yp,B=new El,F=H+1,$=1e-4;for(this.tangents=y,this.normals=b,this.binormals=L,w=0;F>w;w++)e=w/(F-1),y[w]=z.getTangentAt(e),y[w].normalize();for(p(),w=1;F>w;w++)b[w]=b[w-1].clone(),L[w]=L[w-1].clone(),l.crossVectors(y[w-1],y[w]),l.length()>$&&(l.normalize(),N=S(cd(y[w-1].dot(y[w]),-1,1)),b[w].applyMatrix4(B.makeRotationAxis(l,N))),L[w].crossVectors(y[w],b[w]);if(J)for(N=S(cd(b[0].dot(b[F-1]),-1,1)),N/=F-1,y[0].dot(l.crossVectors(b[0],b[F-1]))>0&&(N=-N),w=1;F>w;w++)b[w].applyMatrix4(B.makeRotationAxis(y[w],N*w)),L[w].crossVectors(y[w],b[w])};var ps=function(v,Y,W,f){Ym.call(this),Y=Y||18,W=W||0,f=f==Q?Z:f;for(var x=1/(v.length-1),z=1/Y,k=0,D=Y;D>=k;k++)for(var i=W+k*z*f,O=j(i),m=h(i),b=0,I=v.length;I>b;b++){var V=v[b],l=new yp;l.x=O*V.x-m*V.y,l.y=m*V.x+O*V.y,l.z=V.z,this.vertices.push(l)}for(var _=v.length,k=0,D=Y;D>k;k++)for(var b=0,I=v.length-1;I>b;b++){var J=b+_*k,$=J,N=J+_,O=J+1+_,e=J+1,s=k*z,y=b*x,c=s+z,M=y+x;this.faces.push(new te($,e,N)),this.faceVertexUvs[0].push([new mr(s,y),new mr(s,M),new mr(c,y)]),this.faces.push(new te(N,e,O)),this.faceVertexUvs[0].push([new mr(c,y),new mr(s,M),new mr(c,M)])}this.mergeVertices(),Ji(this),this.computeFaceNormals(),this.computeVertexNormals()};ps.prototype=ed(jq);var om=function($,w){w=w||{};var T=th.generateShapes($,w);w.amount=w.amount!==_?w.amount:.5,w.convertYZ=!1,w.fill!==!1&&(w.bottom=!0,w.top=!0),Ec.call(this,T,w)};om.prototype=ed(ih);var ud=b.Node=function(){rd(ud,this)},dr={X:Ao,Y:Pl,Z:ee},Bb={X:0,Y:1,Z:2},hq={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},yq=new ql,hj="xzy",$e=function(u,I,z){if(I){var S=I[0],t=I[1],B=I[2];"xzy"===z?(Pl(u,t),ee(u,B),Ao(u,S)):"xyz"===z?(ee(u,B),Pl(u,t),Ao(u,S)):"yxz"===z?(ee(u,B),Ao(u,S),Pl(u,t)):"yzx"===z?(Ao(u,S),ee(u,B),Pl(u,t)):"zxy"===z?(Pl(u,t),Ao(u,S),ee(u,B)):"zyx"===z?(Ao(u,S),Pl(u,t),ee(u,B)):(Pl(u,t),ee(u,B),Ao(u,S))}};Xq("Node",mi,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:hj,_64O:0,_rotationX:0,_53O:0,_host:Q,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return no},_22Q:function(){return Xs},getX:function(){return this.p().x},setX:function(e){this.p(e,this.p().y)},getY:function(){return this.p().y},setY:function(V){this.p(this.p().x,V)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(O){this.setAnchor(O,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(g){this.setAnchor(this.getAnchor().x,g)},getScaleX:function(){return this.getScale().x},setScaleX:function(J){this.setScale(J,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(X){this.setScale(this.getScale().x,X)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(M){var f=(new Vp).setFromQuaternion(M,Vp.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(f.x,f.y,f.z)},getQuaternion:function(){var f=new Vp,J=new Vp,T=new ql;return function(o){return o||(o=new ql),this.getEuler(f),f.equals(J)?o.copy(T):o.copy(T.setFromEuler(J.copy(f)))}}(),getEuler:function(C){var L=this.r3();return C||(C=new Vp),C.set(L[0],L[1],L[2],Vp.ReverseOrder(this.getRotationMode()))},setEuler:function(a){return a=a.clone().reorder(Vp.ReverseOrder(this.getRotationMode())),this.r3(a.x,a.y,a.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(N,h){ao(N,qh(Q,Q,this.r3(),this.getRotationMode())),this.translate3d(N[0]*h,N[1]*h,N[2]*h)},translateFront:function(t){this.translate3dBy([0,0,1],t)},translateBack:function(S){this.translate3dBy([0,0,-1],S)},translateLeft:function(k){this.translate3dBy([-1,0,0],k)},translateRight:function(p){this.translate3dBy([1,0,0],p)},translateTop:function(k){this.translate3dBy([0,1,0],k)},translateBottom:function(B){this.translate3dBy([0,-1,0],B)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(m,F,G){1===arguments.length&&(F=m[1],G=m[2],m=m[0]),this.p(m,G),this.setElevation(F)},translate3d:function(j,Y,R){1===arguments.length&&(Y=j[1],R=j[2],j=j[0]),this.translate(j,R),this.setElevation(this._54O+Y)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(O,c,p){1===arguments.length&&(c=O[1],p=O[2],O=O[0]),this.setSize(O,p),this.setTall(c)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(I,C,V){var E=this;if(!E._updatingRotation3d){E._updatingRotation3d=1,1===arguments.length&&(C=I[1],V=I[2],I=I[0]);var e=[E._rotationX,-E._64O,E._53O];E._rotationX=I,E._64O=-C,E._53O=V,E.fp("rotation3d",e,[I,C,V]),delete E._updatingRotation3d}},_applyClosestR3:function(){function J(y){return y%=Z,0>y&&(y+=Z),y>e?Z-y:y}function l(b,l){return J(b[0]-l[0])+J(b[1]-l[1])+J(b[2]-l[2])}return function(r,w,b){var m,c,B,Q=this.r3(),d=this.getRotationMode();"xzy"===d||"yzx"===d?(m=r>0?r-e:r+e,c=w>0?w-e:w+e,B=b>0?e-b:-e-b):"xyz"===d||"zyx"===d?(m=r>0?r-e:r+e,B=b>0?b-e:b+e,c=w>0?e-w:-e-w):("yxz"===d||"zxy"===d)&&(B=b>0?b-e:b+e,c=w>0?w-e:w+e,m=r>0?e-r:-e-r),l([m,c,B],Q)<l([r,w,b],Q)?this.r3(m,c,B):this.r3(r,w,b)}}(),setRotationY:function(k){this.setRotation(-k)},getRotationY:function(){return-this._64O},lookAtDirection:function(E,d){d=d||fb;var B=this,t=Ki(E);d===fb?(B.r3([-A(E[1]/t),-mf(E[2],E[0])+Ej,0]),B.setRotationMode("xzy")):d===Xi?(B.r3(0,-mf(E[2],E[0]),A(E[1]/t)),B.setRotationMode("zyx")):d===Mh?(B.r3(0,-mf(E[2],E[0])+e,-A(E[1]/t)),B.setRotationMode("zyx")):d===Ui?(B.r3([-A(E[1]/t)+Ej,-mf(E[2],E[0])+Ej,0]),B.setRotationMode("xzy")):d===nl&&(B.r3([-A(E[1]/t)-Ej,-mf(E[2],E[0])+Ej,0]),B.setRotationMode("xzy")),d===ge&&(B.r3([-A(E[1]/t)+e,-mf(E[2],E[0])+Ej,e]),B.setRotationMode("zxy"))
},lookAt:function(L,w){return this.lookAtDirection(Yb(L,this.p3()),w)},lookAtX:function(){var v=new id,u=new id,_=new id,O=new El,W=new El,o=new Vp;return function(h,N){var q=pc(this);if(O.fromArray(q),_.copy(this.p3()),v.copy(h).sub(_),!(v.lengthSq()<1e-6)){v.normalize(),N=N||fb,"string"==typeof N?N===fb?u.set(0,0,1):N===ge?u.set(0,0,-1):N===Mh?u.set(-1,0,0):N===Xi?u.set(1,0,0):N===Ui?u.set(0,1,0):N===nl&&u.set(0,-1,0):u.copy(N).normalize(),u.applyMatrix4(O).sub(_).normalize();var f=Math.acos(v.dot(u));if(f){var C=v.clone().cross(u);C.lengthSq()<1e-6&&(N===Ui||N===nl||0===N[0]&&0===N[1]?C.set(0,0,1).applyMatrix4(O).sub(_):C.set(0,1,0).applyMatrix4(O).sub(_)),C.normalize(),o.set(this.r3(),this.getRotationMode(),!0),O.makeRotationFromEuler(o),W.makeRotationAxis(C,-f),o.setFromRotationMatrix(W.multiply(O)),this._applyClosestR3(o.x,o.y,o.z)}}}}(),getHost:function(){return this._host},setHost:function(S){var c=this;if(c!==S&&c._host!==S){var g=c._host;g&&(g._removeAttach(c),g.updateLayoutAttaches()),c._host=S,c._host&&(c._host._addAttach(c),c._host.updateLayoutAttaches()),c.fp("host",g,S),c.onHostChanged(g,S)}},getAttaches:function(){return this._69O},_addAttach:function(e){var s=this;s._69O||(s._69O=new Qd),s._69O.add(e),s.fp("attaches",Q,e)},_removeAttach:function(e){var P=this;P._69O.remove(e),P._69O.isEmpty()&&delete P._69O,P.fp("attaches",e,Q)},getImage:function(){if(this._pendingCheckImageJSON){var e=C.getImage(this._image);e&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Vr&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(e){var z=this,p=z._image,d=z.getWidth(),V=z.getHeight();if(z._image=e,z.fp("image",p,e)){if(null!=e&&(vp(e)||am(e)&&/\.json$/i.test(e))&&(this._pendingCheckImageJSON=!0),Zg)return;z.fp(Od,d,z.getWidth()),z.fp(pe,V,z.getHeight())}},getElevation:function(){return this._54O},setElevation:function(f){var K=this;if(!K._50O){K._50O=1;var L=K._54O;K._54O=f,K.fp(tp,L,f),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(U){var h=this;if(!h._49O){h._49O=1;var d=h._64O;h._64O=U,h.fp(js,d,U),delete h._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(c){var v=this;if(!v._51O){v._51O=1;var J=v._rotationX;v._rotationX=c,v.fp("rotationX",J,c),delete v._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(D){var Z=this;if(!Z._52O){Z._52O=1;var Y=Z._53O;Z._53O=D,Z.fp("rotationZ",Y,D),delete Z._52O}},getPosition:function(){return this._position},setPosition:function(o,k){var I=this;if(!I._50I){I._50I=1;var v;if(v=2===arguments.length?{x:o,y:k}:o,v.x!==I._position.x||v.y!==I._position.y){var C=I._position;I._position=v,I.fp(_g,C,v)}delete I._50I}},translate:function(P,t){var m=this._position;this.p(m.x+P,m.y+t)},getWidth:function(){var m=this;if(m._width>=0)return m._width;var s=m.getStyle("shape3d");if(s){var _=Lc(s);if(_&&_.rawS3)return _.rawS3[0];if("billboard"===s||"plane"===s){var x=Bj(m.getStyle("shape3d.image"));return x?ld(x,m):20}}var x=Bj(m._image);return x?ld(x,m):20},setWidth:function(x){var l=this,F=l._width;l._width=x,l.fp(Od,F,x)},getHeight:function(){var t=this;if(t._height>=0)return t._height;var Z=t.getStyle("shape3d");if(Z){var N=Lc(Z);if(N&&N.rawS3)return N.rawS3[2];if("plane"===Z){var P=Bj(t.getStyle("shape3d.image"));return P?Sr(P,t):20}if("billboard"===Z)return 2}var P=Bj(t._image);return P?Sr(P,t):20},setHeight:function(P){var F=this,e=F._height;F._height=P,F.fp(pe,e,P)},getTall:function(){var W=this;if(W._tall>=0)return W._tall;var x=W.getStyle("shape3d");if(x){var w=Lc(x);if(w&&w.rawS3)return w.rawS3[1];if("billboard"===x){var F=Bj(W.getStyle("shape3d.image"));return F?Sr(F,W):20}if("plane"===x)return 2}return 20},setTall:function(t){var I=this,B=I._tall;I._tall=t,I.fp("tall",B,t)},setSize:function(u,S){var r=this;2===arguments.length?(r.setWidth(u),r.setHeight(S)):(r.setWidth(u.width),r.setHeight(u.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(Z,F,f,D,r){var t=this,e=t.getAnchor(),m=t.getScale();arguments.length<=2&&(r=F,F=Z.y,f=Z.width,D=Z.height,Z=Z.x);var u=r&&m.x<0?1-e.x:e.x,h=r&&m.y<0?1-e.y:e.y;t.p(Z+f*u,F+D*h),r&&(f/=Math.abs(m.x),D/=Math.abs(m.y)),t.setWidth(f),t.setHeight(D)},getMatrix:function(){var e=this,o=e._64O,N=e._position,b=e.getScale();return new td(o,N.x,N.y,b.x,b.y)},getMatrix4:function(){var _=new id,n=new ql,u=new id;return function(Z){return this.getQuaternion(n),_.copy(this.p3()),u.copy(this.getFinalScale3d()),Z||(Z=new El),Z.compose(_,n,u)}}(),getAnchorRect:function(){var S=this,U=S.getWidth(),P=S.getHeight(),r=S.getAnchor();return{x:-U*r.x,y:-P*r.y,width:U,height:P}},toLocal:function(j){return this.getMatrix().tfi(j)},toGlobal:function(A){return this.getMatrix().tf(A)},getAttachPosition:function(){var _=new td;return function(e,c,d,R){d=d||0,R=R||0;var f=this,S=f.getAnchor(),M=f._64O,i=f._position,N=f.getScale();return _.setFromTransform(M,i.x,i.y).tf({x:d+N.x*f.getWidth()*(e-S.x),y:R+N.y*f.getHeight()*(c-S.y)})}}(),isInRect:function(L){L=this.toLocal(L);var X=this.getWidth(),c=this.getHeight();return L.x+=X*this.getAnchorX(),L.y+=c*this.getAnchorY(),!(L.x<0||L.y<0||L.x>X||L.y>c)},getRect:function(){var Y=this,K=Y.getWidth(),j=Y.getHeight(),E=Y.getAnchor(),w={x:-K*E.x,y:-j*E.y,width:K,height:j},$=Y.getMatrix();return w=Tl([$.tf(w.x,w.y),$.tf(w.x+w.width,w.y),$.tf(w.x+w.width,w.y+w.height),$.tf(w.x,w.y+w.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var q=this,I=q.getAnchor(),G=q._anchorElevation;return{x:I.x,y:G,z:I.y}},setAnchorElevation:function(F){var p=this,Z=p._anchorElevation;return Z!==F?(p._anchorElevation=F,p.fp("anchorElevation",Z,F),!0):!1},setAnchor3d:function(A,t,K,N){var u,f=this;"number"==typeof A?u={x:A,y:t,z:K}:(u=A.length?{x:A[0],y:A[1],z:A[2]}:A,N=t),f.beginTransaction();var v=f.getAnchor3d(),s=f.setAnchor(u.x,u.z);if(f.setAnchorElevation(u.y)&&(s=!0),s&&N&&!Zg){f.getAnchor3d();var G=pc(f),i=ao([u.x-v.x,u.y-v.y,u.z-v.z],G);f.p3(i)}return f.endTransaction(),s},getAnchor:function(){var J=this;if(J.hasOwnProperty("_anchor"))return J._anchor;var D=Bj(J._image);return D&&D.anchorX!==_?{x:D.anchorX,y:D.anchorY}:J._anchor},setAnchor:function(k,l,O){var I,B=this;"number"==typeof k?I={x:k,y:l}:(I=k.length?{x:k[0],y:k[1]}:k,O=l);var y=B.getAnchor();if(y.x!==I.x||y.y!==I.y){if(B.beginTransaction(),B._anchor=I,B.fp("anchor",y,I),O&&!Zg){var v=B.getPosition(),J=B.getSize(),$=B.getRotation(),W=B.getScale(),D=-J.width*(y.x-I.x)*W.x,Y=-J.height*(y.y-I.y)*W.y,Q=h($),b=j($);B.setPosition(v.x+b*D-Q*Y,v.y+Q*D+b*Y)}return B.endTransaction(),!0}return!1},getLocalQuaternion:function(R){var o=this,r=o.getHost();if(!r)return o.getQuaternion(R);var P=r.getQuaternion(),p=o.getQuaternion();return R||(R=new ql),R.copy(P).inverse().multiply(p)},setLocalQuaternion:function(E){var G=this,W=G.getHost();if(!W)return G.setQuaternion(E);var u=W.getQuaternion();G.setQuaternion(u.clone().multiply(E))},getLocalEuler:function(){var r=new ql;return function(a){var o=this,l=o.getHost();return l?(o.getLocalQuaternion(r),a||(a=new Vp),a.setFromQuaternion(r,Vp.ReverseOrder(this.getRotationMode()))):o.getEuler(a)}}(),setLocalEuler:function(){var b=new ql;return function(x){var F=this,p=F.getHost();return p?(b.setFromEuler(x),F.setLocalQuaternion(b)):F.setEuler(x)}}(),getLocalPosition3d:function(V){var D=this;V||(V=new id),V.copy(D.p3());var r=D.getHost();if(!r)return V;var q=r.getMatrix4();return V.applyMatrix4(q.getInverse(q))},setLocalPosition3d:function(U){var W=this,O=W.getHost();if(!O)return U.x!==_?W.p3(U.x,U.y,U.z):W.p3(U),void 0;var m=O.getMatrix4(),b=new id(U);b.applyMatrix4(m),W.p3(b.x,b.y,b.z)},getScale:function(){return this._scale},setScale:function(j,z){var m,r=this;m=2===arguments.length?{x:j,y:z}:j;var s=r.getScale();(s.x!==m.x||s.y!==m.y)&&(r._scale=m,r.fp("scale",s,m))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var H=this,E=H._scaleTall,d=H.getScale();return[d.x,E,d.y]},getFinalScale3d:function(){var j=this,v=j.s3(),V=j._dynamicScale3d,I=j.getScale3d();return v&&(I[0]*=v[0],I[1]*=v[1],I[2]*=v[2]),V&&(I[0]*=V[0],I[1]*=V[1],I[2]*=V[2]),I},getFinalRotation3d:function(){var l=this;return l._dynamicRotation||l.r3()},setScaleTall:function(m){var J=this,E=J._scaleTall;E!==m&&(J._scaleTall=m,J.fp("scaleTall",E,m))},setScale3d:function(C,E,t){var y,B=this;y="number"==typeof C?{x:C,y:E,z:t}:C.length?{x:C[0],y:C[1],z:C[2]}:C,B.setScaleTall(y.y),B.setScale(y.x,y.z)},getCorners:function(o,x){o==Q&&(o=0),x==Q&&(x=o);var r=this,z=r.getAnchor(),t=r.getWidth(),S=r.getHeight(),E=-t*z.x-o,A=-S*z.y-x,c=t+2*o,q=S+2*x,k=r.getMatrix();return[k.tf(E,A),k.tf(E,A+q),k.tf(E+c,A+q),k.tf(E+c,A)]},getEditControlPoints:function(v,i,d){i==Q&&(i=0),d==Q&&(d=i);var $=this,c=$.getAnchor(),C=$.getWidth(),N=$.getHeight(),Y=-C*c.x-i,r=-N*c.y-d,F=C+2*i,t=N+2*d;if(v)return[{x:Y,y:r},{x:Y,y:0},{x:Y,y:r+t},{x:0,y:r+t},{x:Y+F,y:r+t},{x:Y+F,y:0},{x:Y+F,y:r},{x:0,y:r}];var P=$.getMatrix();return[P.tf(Y,r),P.tf(Y,0),P.tf(Y,r+t),P.tf(0,r+t),P.tf(Y+F,r+t),P.tf(Y+F,0),P.tf(Y+F,r),P.tf(0,r)]},rotateAt:function(l,o,D){var w=this,F=w._position,E=w._64O,x=new td(E,F.x,F.y).tf(l,o),c=z(l*l+o*o),M=mf(F.y-x.y,F.x-x.x)+D;w.setRotation(E+D),w.p(x.x+c*j(M),x.y+c*h(M))},rotateAroundAxis:function(N,f){this.setQuaternion(this.getQuaternion().multiply(yq.setFromAxisAngle(N,f)))},rotateAroundWorldAxis:function(R,y){this.setQuaternion(this.getQuaternion().premultiply(yq.setFromAxisAngle(R,y)))},rotateX:function(M){return this.rotateAroundAxis(id.AxisX,M)},rotateY:function(x){return this.rotateAroundAxis(id.AxisY,x)},rotateZ:function(n){return this.rotateAroundAxis(id.AxisZ,n)},onParentChanged:function(){ud.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var z={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(k){z[k]=!0}),function(d){var H=this;ud.superClass.onPropertyChanged.call(H,d);var l=d.property;if(z[l]&&!H._layoutUpdating&&H.updateLayoutParameters(null,l),H._69O&&H._69O.each(function(B){B.handleHostPropertyChange(d)}),H._49I&&H._49I.each(function(P){P.fp("agentChange",!0,!1)}),Pi[l]&&this.updateLayoutAttaches(),"a:layout"===l.substring(0,8)){this.updateLayoutAttaches();var A=H._host;A&&A.updateLayoutAttaches()}("s:shape3d.autorotate"===l||"s:autorotate"===l||"s:shape3d.fixSizeOnScreen"===l||"s:fixSizeOnScreen"===l||"s:hide.overlapping.group"===l)&&(H._47Q=H.s("autorotate")||H.s("shape3d.autorotate")||H.s("fixSizeOnScreen")||H.s("shape3d.fixSizeOnScreen")||H.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(T){this.updateAttach(T)},onStyleChanged:function(V){ud.superClass.onStyleChanged.apply(this,arguments),Qb[V]&&this.updateAttach()},updateLayoutAttaches:function(){if(!Zg){var F,J,T=this;return F=Bj(T.getImage()),F&&F.layoutAttach&&(J=F.layoutAttach,J&&J(T))?!0:void 0}},updateAttach:function(P){var U=this;return Zg?(U.updateLayoutParameters(),void 0):(U._51I||(U._51I=1,U._71O(P),delete U._51I),void 0)},_71O:function(B){var v,C,L,n,E,Y,R=this,O=R._host,j=B?B.property:Q,c=B?B.oldValue:Q,M=B?B.newValue:Q;if(O instanceof ud&&(!B||Pi[j])){var H;if(H=Bj(O.getImage()),H&&H.layoutAttach)return}if(O instanceof b.Grid){if(j===tp)R.setElevation(R._54O+M-c);else if(!B||Ve[j]){if(v=R.s("attach.row.index"),C=R.s("attach.column.index"),L=O.getCellRect(v,C),!L)return;n=R.s("attach.row.span"),E=R.s("attach.column.span"),(1!==n||1!==E)&&(L=em(L,O.getCellRect(v+n-1,C+E-1))),ng(L,R,"attach.padding",1),R.setRect(L)}}else if(O instanceof Mk&&(Y=R.s("attach.index"))>=0&&(!B||qi[j])){var G=R.s("attach.thickness"),i=O.getScale(),U=Math.max(i.x,i.y);G>0&&R.setHeight(O.getThickness()*G*U);var z=R.s("attach.offset"),m=O.getPoints(),X=m.size();if(X>Y){var f=O.getPointsMatrix2d(),T=m.get(Y),l=X===Y+1?m.get(0):m.get(Y+1);T=f.apply(T),l=f.apply(l);var $=[l.x-T.x,l.y-T.y],r=Ki($);if(r){R.s("attach.offset.relative")&&(z*=r),R.s("attach.offset.opposite")&&(z=r-z);var e={x:T.x+$[0]/r*z,y:T.y+$[1]/r*z},t=R.s("attach.gap");t&&(R.s("attach.gap.relative")&&(t*=O.getThickness()*U),e=vm(Q,e,l,t)),R.p(e),R.setRotation(mf($[1],$[0]))}}}else B&&(j===_g?R.translate(M.x-c.x,M.y-c.y):j===tp?R.setElevation(R._54O+M-c):cq[j]?"rotation3d"===j?R.syncRotation3d(O,M,c):R._11Q(O,j,M-c):("anchor"===j||"width"===j||"height"===j||"scale"===j)&&R.layout(O))},_11Q:function(){var L=new b.Math.Euler,f=b.Math.Euler.ReverseOrder,N=new b.Math.Vector2,d=new b.Math.Vector2;return function(e,r,V){var Y=this,x=e.p3(),o=e.r3(),I=Y.p3(),i=Y.r3();if(r===js&&(r="rotationY",V=-V),(r===js||"rotationY"===r)&&0===i[0]&&0===i[2]&&0===o[0]&&0===o[2]&&0===I[1]&&0===x[1])return Y.setRotation(-i[1]-V),N.set(I[0],I[2]).rotateAround(d.set(x[0],x[2]),-V),Y.p(N.x,N.y),void 0;var Q=hq[e.getRotationMode()],y=Q[0],s=Q[1],C=Q[2],H=dr[y],U=dr[s],v=dr[C],k=ph();r===js+y?(v(k,o[Bb[C]]),U(k,o[Bb[s]]),H(k,V),U(k,-o[Bb[s]]),v(k,-o[Bb[C]])):r===js+s?(v(k,o[Bb[C]]),U(k,V),v(k,-o[Bb[C]])):r===js+C&&v(k,V);var T=Yb(I,x);ao(T,k),Y.p3(x[0]+T[0],x[1]+T[1],x[2]+T[2]);var j=Y.getRotationMode();$e(k,Y.r3(),j),L.setFromRotationMatrix(k,f(j)),Y.r3([L.x,L.y,L.z])}}(),syncRotation3d:function(){var K=new ql,n=new Vp,h=new id;return function(T,A,L){var O=this;if(L[0]!==A[0]||L[1]!==A[1]||L[2]!==A[2]){var z=Vp.ReverseOrder(T.getRotationMode());yq.setFromEuler(n.set(L[0],L[1],L[2],z)),K.setFromEuler(n.set(A[0],A[1],A[2],z)),K.multiply(yq.inverse());var c=T.p3(),v=O.p3();h.set(v[0]-c[0],v[1]-c[1],v[2]-c[2]).applyQuaternion(K),O.p3(c[0]+h.x,c[1]+h.y,c[2]+h.z),O.setQuaternion(O.getQuaternion(yq).premultiply(K))}}}(),isHostOn:function(A){var T=this;if(T._host&&A&&A._69O)for(var L={},F=T._host;F&&F!==T&&!L[F._id];){if(F===A)return!0;L[F._id]=F,F=F._host}return!1},isLoopedHostOn:function(S){return this.isHostOn(S)&&S.isHostOn(this)},getScaledSize:function(){var K=this.getSize(),y=this.getScale();return K.width*=Math.abs(y.x),K.height*=Math.abs(y.y),K},layout:function(E){if(E=E||this.getHost()){var m=this,S=m.s("layout.h")||"center",F=m.s("layout.v")||"center";if("center"!==S||"center"!==F){var x=new b.Math.Vector2,f=E.getPosition(),Z=E.getAnchor(),C=E.getScaledSize();m.getPosition();var n,X,r,B,R,W=1,l=1;switch(m._layoutUpdating=!0,S){case"left":x.setX(m._layoutHValue-Z.x*C.width);break;case"right":x.setX((1-Z.x)*C.width-m._layoutHValue);break;case"leftright":n=C.width-m._layoutHValue[2],r=m.getRotation()-E.getRotation(),B=Math.abs(Math.sin(r)),R=Math.abs(Math.cos(r)),W+=R*n/m._layoutHValue[3],l+=B*n/m._layoutHValue[4],x.setX(m._layoutHValue[1]+(m._layoutHValue[5]-Z.x)*C.width);break;case"center":x.setX((.5-Z.x)*C.width-m._layoutHValue);break;case"scale":r=m.getRotation()-E.getRotation(),B=Math.abs(Math.sin(r)),R=Math.abs(Math.cos(r)),x.setX((.5-Z.x)*C.width-m._layoutHValue[1]*C.width/m._layoutHValue[0]),X=C.width/m._layoutHValue[2]-1,W+=R*X,l+=B*X}switch(F){case"top":x.setY(m._layoutVValue-Z.y*C.height);break;case"bottom":x.setY((1-Z.y)*C.height-m._layoutVValue);break;case"topbottom":r||(r=m.getRotation()-E.getRotation(),B=Math.abs(Math.sin(r)),R=Math.abs(Math.cos(r))),n=C.height-m._layoutVValue[2],W+=B*n/m._layoutVValue[3],l+=R*n/m._layoutVValue[4],x.setY(m._layoutVValue[1]+(m._layoutVValue[5]-Z.y)*C.height);break;case"center":x.setY((.5-Z.y)*C.height-m._layoutVValue);break;case"scale":r||(r=m.getRotation()-E.getRotation(),B=Math.abs(Math.sin(r)),R=Math.abs(Math.cos(r))),x.setY((.5-Z.y)*C.height-m._layoutVValue[1]*C.height/m._layoutVValue[0]),X=C.height/m._layoutVValue[2]-1,W+=B*X,l+=R*X}if("leftright"===S||"scale"===S||"topbottom"===F||"scale"===F){var U=this.getScale(),i=Math.abs(U.x),L=Math.abs(U.y);"leftright"===S||"scale"===S?m.setSize(m._layoutHValue[3]*W/i,m._layoutHValue[4]*l/L):m.setSize(m._layoutVValue[3]*W/i,m._layoutVValue[4]*l/L)}x.rotateAround(null,E.getRotation()),this.setPosition(x.x+f.x,x.y+f.y),m._layoutUpdating=_}}},updateLayoutParameters:function(E,C){if(E=E||this.getHost()){var c=this,V=c.s("layout.h"),F=c.s("layout.v");if(V||F){var Z,r,_,x,v,U,k=new b.Math.Vector2,L=E.getPosition(),z=E.getAnchor(),X=E.getScaledSize(),N=c.getPosition(),G=c.getScaledSize();switch(k.set(N.x-L.x,N.y-L.y),k.rotateAround(null,-E.getRotation()),V){case"left":c._layoutHValue=k.x+z.x*X.width;break;case"right":c._layoutHValue=-k.x+(1-z.x)*X.width;break;case"center":c._layoutHValue=-k.x+(.5-z.x)*X.width;break;case"leftright":case"scale":"scale"===V?Z=-k.x+(.5-z.x)*X.width:(r=c.getAnchor(),_=c.getRotation()-E.getRotation(),x=Math.cos(_),v=Math.sin(_),U=-Math.min(-r.x*x+r.y*v,-r.x*x-(1-r.y)*v,(1-r.x)*x+r.y*v,(1-r.x)*x-(1-r.y)*v),Z=k.x-(U-z.x)*X.width),"position"===C&&"object"==typeof c._layoutHValue?(c._layoutHValue[0]=X.width,c._layoutHValue[1]=Z):c._layoutHValue=[X.width,Z,X.width,G.width,G.height,U]}switch(F){case"top":c._layoutVValue=k.y+z.y*X.height;break;case"bottom":c._layoutVValue=-k.y+(1-z.y)*X.height;break;case"center":c._layoutVValue=-k.y+(.5-z.y)*X.height;break;case"topbottom":case"scale":"scale"===F?Z=-k.y+(.5-z.y)*X.height:(_||(r=c.getAnchor(),_=c.getRotation()-E.getRotation(),x=Math.cos(_),v=Math.sin(_)),U=-Math.min(-r.x*v-r.y*x,-r.x*v+(1-r.y)*x,(1-r.x)*v-r.y*x,(1-r.x)*v+(1-r.y)*x),Z=k.y-(U-z.y)*X.height),"position"===C&&"object"==typeof c._layoutVValue?(c._layoutVValue[0]=X.height,c._layoutVValue[1]=Z):c._layoutVValue=[X.height,Z,X.height,G.width,G.height,U]}}}},getSerializableProperties:function(){var n=ud.superClass.getSerializableProperties.call(this);return nd(n,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),n}});var fl=b.Edge=function(r,h){var N=this;rd(fl,N),N.setSource(r),N.setTarget(h)};Xq("Edge",mi,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return ws},_22Q:function(){return Zs},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(N){if(N===this)return!1;if(Je(N))return!0;for(var W,l,v,J,P,_=[this],g=-1,q=0;q>g;)if(g++,W=_[g],l=W._44I)for(l=l.getArray(),J=0,P=l.length;P>J;J++)if(v=l[J],hn(v)&&!(_.indexOf(v)>=0)){if(v===N)return!1;_.push(v),q++}return!0},setSource:function(y){var k=this;if(k._source!==y&&k.canSetSourceTarget(y)){var X=k._source;k._source=y,X&&X._16I(k),y&&y._2I(k),k._7I(),k.fp("source",X,y)}},setTarget:function(Q){var T=this;if(T._target!==Q&&T.canSetSourceTarget(Q)){var B=T._target;T._target=Q,B&&B._18I(T),Q&&Q._4I(T),T._7I(),T.fp("target",B,Q)}},isLooped:function(){var X=this;return X._source===X._target&&Je(X._source)&&Je(X._target)},onPropertyChanged:function(){var k=this;k._49I&&k._49I.each(function(O){O.fp("agentChange",!0,!1)})},_7I:function(){var d,P=this,y=sp(P);P._40I!==y&&(d=this._40I,d&&d._15I(P),P._40I=y,y&&y._1I(P),P.fp("sourceAgent",d,y),km(d,P._41I),km(y,P._41I));var W=fc(P);P._41I!==W&&(d=P._41I,d&&d._17I(P),P._41I=W,W&&W._3I(P),P.fp("targetAgent",d,W),km(d,P._40I),km(W,P._40I))},_22I:function(E){this._52I=E,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var f=this;return f._52I&&f._52I.get(0)!==f&&!f.getStyle(hr)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var f=this,J=f._52I;return J&&!f.getStyle(hr)&&J.size()>1&&f===J.get(0)},toggle:function(){this.beginTransaction();var H=this._52I,k=!this.s(hr);H&&H.size()>1&&(H.each(function(B){B.s(hr,k)}),H.getSiblings().each(function(S){S!==H&&S.each(function(B){B.fp("edgeGroup",Q,S)})})),this.endTransaction()},setStyle:function(c,p){(c===Dj||"edge.segments"===c)&&(p=Yh(p)),fl.superClass.setStyle.call(this,c,p)},onStyleChanged:function(P){fl.superClass.onStyleChanged.apply(this,arguments),fs[P]&&km(this._41I,this._40I)},getSerializableProperties:function(){var t=fl.superClass.getSerializableProperties.call(this);return nd(t,{source:1,target:1}),t}});var kc=b.Group=function(){rd(kc,this)};Xq("Group",ud,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Mo},onChildAdded:function(){kc.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){kc.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var s=this;if(!s._54I&&!Zg){var T=s.getChildrenRect();T&&(s._53I=1,s.p($l(s.s("group.position"),T,s.getSize())),delete s._53I)}},getChildrenRect:function(){var h,n=this;return n.eachChild(function(y){Je(y)&&(h=em(h,n.getChildRect(y)))}),h},getChildRect:function(U){var G;return Je(U)&&U.s(Oj)&&(Pm(U)&&U.isExpanded()&&U.eachChild(function(_){G=em(G,U.getChildRect(_))}),!G&&U.getRect&&(G=U.getRect())),G},setPosition:function(A,k){var B=this;if(!B._54I){var D;D=2===arguments.length?{x:A,y:k}:A,Zg||B._53I||(B._54I=1,Jp(B._children,D.x-B._position.x,D.y-B._position.y),delete B._54I),kc.superClass.setPosition.call(this,D)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(l){var O=this;if(O._57O!==l){var $=O._57O;O._57O=l,O.fp("expanded",$,O._57O),O._fireInvalidateDeep(),O._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(i){Pm(i)?i._fireInvalidateDeep():i.iv()})},_8I:function(){kc.superClass._8I.call(this),this.eachChild(function(S){Je(S)&&S._8I()})},onStyleChanged:function(O){kc.superClass.onStyleChanged.apply(this,arguments),"group.position"===O&&this._81I()},getSerializableProperties:function(){var R=kc.superClass.getSerializableProperties.call(this);return R.expanded=1,R}});var Th=b.Camera=function(){rd(Th,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new $m.Matrix4,this._projectMatrix=new $m.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};Th.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],Xq("Camera",ud,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(n){this._projectMatrixDirty=!0,this.renderTarget=n},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(t){var A=t.split(",");this._cullingMask=Rc(A)},isLayerVisible:function(a){var Q=xd[a];return Q&&yf(this._cullingMask,Q.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var F=new b.Math.Matrix4,c=new b.Math.Euler;return function(s){var U=this;s.isMatrix4?U._viewMatrix.copy(s):U._viewMatrix.fromArray(s),F.getInverse(U._viewMatrix),U.p3(F.getPosition().toArray()),c.set(0,0,0,U.getRotationMode(),!0).setFromRotationMatrix(F),U.r3([c.x,c.y,c.z])}}(),getViewMatrix:function(o){var h=this,n=qh(null,null,h.r3(),h.getRotationMode(),h.p3()),L=h._viewMatrix;return L.fromArray(n).getInverse(L),L.toArray(o)},setProjectMatrix:function(F){var E=this;F.isMatrix4?E._projectMatrix.copy(F):E._projectMatrix.fromArray(F),F=E._projectMatrix.getElements(),E.isOrtho()?E.s({"camera.near":(F[14]+1)/F[10],"camera.far":(F[14]-1)/F[10],"camera.ortho.width":2/F[0]}):E.s({"camera.near":F[14]/(F[10]-1),"camera.far":F[14]/(F[10]+1),"camera.fovy":2*Math.atan(1/F[5]),"camera.aspect":F[5]/F[0]}),E._projectMatrixDirty=!1},onPropertyChanged:function(C){var t=this;Th.superClass.onPropertyChanged.call(t,C);var c=C.property;("s:camera.near"===c||"s:camera.far"===c||"s:camera.fovy"===c||"s:camera.aspect"===c||"s:camera.ortho.width"===c)&&(t._projectMatrixDirty=!0)},getProjectMatrix:function(){var b=this;if(b._projectMatrixDirty){var o=b.gv,d=b.isCube(),x=d?1:b.s("camera.aspect")||(o?o.getAspect():null)||C.graph3dViewAspect,N=b.s("camera.near")||(o?o.getNear():null)||C.graph3dViewNear,y=b.s("camera.far")||(o?o.getFar():null)||C.graph3dViewFar,z=ph();if(b.isOrtho()){var J=b.s("camera.ortho.width")||(o?o.getOrthoWidth():null)||C.graph3dViewOrthoWidth,P=J/2,r=P/x;ms(z,-P,P,-r,r,N,y)}else{var l=d?Math.PI/2:b.s("camera.fovy")||(o?o.getFovy():null)||C.graph3dViewFovy;zj(z,l,x,N,y)}b._projectMatrix.fromArray(z),b._projectMatrixDirty=!1}return b._projectMatrix.toArray()},lookAt:function(j,l){var v=this.p3();return j.x?this.lookAtDirection([j.x-v[0],j.y-v[1],j.z-v[2]],l):this.lookAtDirection([j[0]-v[0],j[1]-v[1],j[2]-v[2]],l)},lookAtDirection:function(){var I=new b.Math.Matrix4,S=new b.Math.Euler,G=new b.Math.Vector3,c=new b.Math.Vector3;return function(u,P){I.lookAtDirection(G.copy(u).multiplyScalar(-1),P?c.copy(P):c.set(0,1,0)),S.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(I),this.r3([S.x,S.y,S.z])}}(),render:function(v){var R=this,w=v.getGL();if(!w)return!1;var o,L,j=R.renderTarget;if(j)o=j.width,L=j.height;else{var C=v.getDevicePixelRatio();o=v.getWidth()*C,L=v.getHeight()*C}R.gv=v,v._camera=R;var f=v._frameState.renderState.glState,l=f.color.clear.slice(0);wj(w,R.s("camera.background"));var S=v.getEye;if(v.getEye=function(){return R.p3()},R.isCube())for(var g=Th.CubeDirectionParam,E=0;6>E;E++)j&&j.bind(w,E),R.lookAtDirection([g[6*E+0],g[6*E+1],g[6*E+2]],[g[6*E+3],g[6*E+4],g[6*E+5]]),w.clear(w.COLOR_BUFFER_BIT),v.setViewport(w,0,0,o,L),R.s("camera.onlySky")?v.renderSky():v.renderScene({renderAxis:R.s("camera.renderAxis"),renderGrid:R.s("camera.renderGrid"),renderEdit:R.s("camera.renderEdit"),renderReflector:!1}),j&&j.unbind(w);else j&&j.bind(w),w.clear(w.COLOR_BUFFER_BIT),v.overlappingBox.clear(),v.setViewport(w,0,0,o,L),R.s("camera.onlySky")?v.renderSky():v.renderScene({renderAxis:R.s("camera.renderAxis"),renderGrid:R.s("camera.renderGrid"),renderEdit:R.s("camera.renderEdit")}),j&&j.unbind(w);return v.getEye=S,wj(w,l),v._camera=null,R.gv=null,!0}});var Ri=b.Block=function(){rd(Ri,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Xq("Block",ud,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Ph},_22Q:function(){return Ys},onChildAdded:function(){Ri.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Ri.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function I(W,I,Q){l.fromArray(pc(I));var e=I.getAnchor3d();W.push((new id).set(0-e.x,0-e.y,0-e.z).applyMatrix4(l).applyMatrix4(Q)),W.push((new id).set(0-e.x,0-e.y,1-e.z).applyMatrix4(l).applyMatrix4(Q)),W.push((new id).set(0-e.x,1-e.y,0-e.z).applyMatrix4(l).applyMatrix4(Q)),W.push((new id).set(0-e.x,1-e.y,1-e.z).applyMatrix4(l).applyMatrix4(Q)),W.push((new id).set(1-e.x,0-e.y,0-e.z).applyMatrix4(l).applyMatrix4(Q)),W.push((new id).set(1-e.x,0-e.y,1-e.z).applyMatrix4(l).applyMatrix4(Q)),W.push((new id).set(1-e.x,1-e.y,0-e.z).applyMatrix4(l).applyMatrix4(Q)),W.push((new id).set(1-e.x,1-e.y,1-e.z).applyMatrix4(l).applyMatrix4(Q))}function f(p,s){var v=(new El).makeRotationFromEuler(this.getEuler()).setPosition((new id).fromArray(this.p3()));v.getInverse(v),p.forEach(function(c){Je(c)&&I(s,c,v)})}var l=new El;return function(w,C){if(w instanceof ud&&(w=[w]),!w||0===w.length)return Q;var C=[];f.call(this,w,C);var N=[1/0,1/0,1/0],Z=[-1/0,-1/0,-1/0];return C.forEach(function(A){N[0]=Math.min(A.x,N[0]),N[1]=Math.min(A.y,N[1]),N[2]=Math.min(A.z,N[2]),Z[0]=Math.max(A.x,Z[0]),Z[1]=Math.max(A.y,Z[1]),Z[2]=Math.max(A.z,Z[2])}),{min:N,max:Z}}}(),updateFromChildren:function(){var O=this;if(!Zg&&!O._updatingToChildren&&O._syncSize&&0!==O.size()&&!O._freezeSyncFromChildren){var h=this._getBoundingBox(O.toChildren(Je));if(h){O._updatingFromChildren=1;var E=(new id).fromArray(this.getScale3d()),M=(new id).fromArray(h.min),x=(new id).fromArray(h.max),j=C.blockMinSize,_=new id,V=x.clone().sub(M);0===V.x&&_.setX(.5),0===V.y&&_.setY(.5),0===V.z&&_.setZ(.5);var F=this._width==Q||-1===this._width,W=new id(this.getAnchor3d()),c=E.clone().multiply((new id).fromArray(this.s3())),l=V.clone();0===l.x&&l.setX(j),0===l.y&&l.setY(j),0===l.z&&l.setZ(j);var P=W.clone().multiply(c),B=P.clone().multiplyScalar(-1).sub(M).divide(l).add(P.divide(l)).add(_),t=this.s("keepPosition");if(F||this._anchorChanged||this._scaleChanged||!t){!F&&t&&(W=B);var p=W.clone().multiply(V).add(M).applyEuler(this.getEuler()).add((new id).fromArray(this.p3()));this.p3([p.x,p.y,p.z])}else this.setAnchor3d(B.x,B.y,B.z);var o=new id(1,1,1).divide(E).multiply(V);this.s3(Math.abs(o.x),Math.abs(o.y),Math.abs(o.z)),delete O._updatingFromChildren}}},setPosition:function(d,Q){var A=this;if(!A._updatingToChildren){var D;D=2===arguments.length?{x:d,y:Q}:d,Zg||A._updatingFromChildren||(A._updatingToChildren=1,Jp(A._children,D.x-A._position.x,D.y-A._position.y),delete A._updatingToChildren),Ri.superClass.setPosition.call(this,D)}},setSize3d:function(){this.beginTransaction(),Ri.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(t){var j=this;if(!j._updatingToChildren){this.beginTransaction(),t=f(t,C.blockMinSize);var L=j.getTall();if(t!==L&&Ri.superClass.setTall.call(j,t),!Zg&&!j._updatingFromChildren){j._updatingToChildren=1;var v=t/L;j._adjustChildTallOrScale(v,"size"),delete j._updatingToChildren,j.updateFromChildren()}this.endTransaction()}},setWidth:function(I){return this.setSize(I,this.getHeight())},setHeight:function(B){return this.setSize(this.getWidth(),B)},setSize:function(D,B){var v=C.blockMinSize;D=f(D,v),B=f(B,v);var F=this;if(!F._updatingToChildren){2!==arguments.length&&(B=D.height,D=D.width),this.beginTransaction();var I=F.getWidth(),k=F.getHeight();if(D!==I&&Ri.superClass.setWidth.call(F,D),B!==k&&Ri.superClass.setHeight.call(F,B),!Zg&&!F._updatingFromChildren){F._updatingToChildren=1;var M=D/I,Z=B/k;F._adjustChildScaleOrSize(M,Z,"size"),delete F._updatingToChildren,F.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(D,M,H){var l=this;if(l._syncSize){var n=l.getPosition(),G=l.getRotation();l.eachChild(function(v){if(Je(v)){var B=v.getPosition(),y=v.getRotation(),S=v.getWidth(),R=v.getHeight(),u=v.getScale(),z=u.x*S,s=u.y*R;if(0!==z&&0!==s){0>D*M&&v.setRotation(-1*y);var q=new td(y,B.x,B.y,z,s);q.translate(-n.x,-n.y),q.rotate(-G),y=mf(q.b*Math.sign(z),q.a*Math.sign(z)),q.scale(D,M);var _,Z,E,P=j(y);if(Math.abs(P)<.001?(_=h(y),Z=q.b/_,E=-q.c/_):(Z=q.a/P,E=q.d/P),"scale"===H)v.setScale(Z/S,E/R);else if("size"===H){var J=Z/u.x,f=E/u.y;v.setScale(Qg(Z)*Math.abs(u.x),Qg(E)*Math.abs(u.y)),v instanceof b.Shape?(v.setWidthForce(Math.max(Math.abs(J),1e-5)),v.setHeightForce(Math.max(Math.abs(f),1e-5))):v.setSize(Math.max(.01,Math.abs(J)),Math.max(.01,Math.abs(f)))}q.rotate(G),q.translate(n.x,n.y),v.setPosition(q.tx,q.ty)}}})}},_calcChangeFactor:function(q,j,$,p){var d,B,w,i;return d=D(q),B=D($),w=d>B?d/B:B/d,d=D(j),B=D(p),i=d>B?d/B:B/d,f(w,i)},setElevation:function(O){var q=this;if(!q._updatingToChildren){var E=q.getElevation(),A=O-E;0!==A&&(Zg||q._updatingFromChildren||(q._updatingToChildren=1,Jp(q._children,0,A,0),delete q._updatingToChildren),Ri.superClass.setElevation.apply(q,arguments))}},setScaleTall:function(u){var U=this;if(!U._updatingToChildren){var y=U.getScaleTall();if(D(u)<.01&&(u=.01*(Qg(u)||Qg(y))),Ri.superClass.setScaleTall.call(U,u),!Zg&&!U._updatingFromChildren){U._updatingToChildren=1;var W=u/y;U._adjustChildTallOrScale(W,"scale"),delete U._updatingToChildren,U._scaleChanged=1,this.updateFromChildren(),delete U._scaleChanged}}},_adjustChildTallOrScale:function(W,g){var o=this;if(o._syncSize){var F=o.getElevation();o.eachChild(function(X){if(Je(X)){if("size"===g){var o=X.getTall();0>W&&X.setScaleTall(-1*X.getScaleTall()),X.setTall(Math.max(.01,Math.abs(o*W)))}else{var V=X.getScaleTall();X.setScaleTall(V*W)}X.setElevation(F+(X.getElevation()-F)*W)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var Y=Ri.superClass.setAnchor3d.apply(this,arguments);return Y&&!Zg&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),Y
}},setAnchor:function(){var m=this;if(!m._updatingToChildren){var I=m.getAnchor(),T=Ri.superClass.setAnchor.apply(m,arguments);if(Zg||m._updatingFromChildren||!m._syncSize)return T;m._updatingToChildren=1;var G=m.getAnchor();m.getPosition();var Y=m.getSize(),z=m.getScale(),e=m.getRotation(),q=-Y.width*z.x*(I.x-G.x),v=-Y.height*z.y*(I.y-G.y),V=h(e),J=j(e),g=J*q-V*v,x=V*q+J*v;return m.eachChild(function(l){if(Je(l)){var O=l.getPosition();l.setPosition(O.x-g,O.y-x)}}),delete m._updatingToChildren,T}},setAnchorElevation:function(){var f=this;if(!f._updatingToChildren){var g=f.getAnchorElevation(),M=Ri.superClass.setAnchorElevation.apply(f,arguments);if(Zg||f._updatingFromChildren||!f._syncSize)return M;f._updatingToChildren=1;var a=f.getAnchorElevation(),b=f.getTall(),J=f.getScaleTall(),m=-b*J*(g-a);return f.eachChild(function(Z){if(Je(Z)){var I=Z.getElevation();Z.setElevation(I-m)}}),delete f._updatingToChildren,M}},setRotation:function(Y){this._updateChildrenRotation3d("rotation",Y)},setRotationX:function(Q){this._updateChildrenRotation3d("rotationX",Q)},setRotationZ:function(L){this._updateChildrenRotation3d("rotationZ",L)},setRotation3d:function(){var B=this;if(!B._updatingToChildren){var I=B.r3();Ri.superClass.setRotation3d.apply(B,arguments);var X=B.r3();Zg||B._updatingFromChildren||(B._updatingToChildren=1,B.eachChild(function(G){Je(G)&&G.syncRotation3d(B,X,I)}),delete B._updatingToChildren)}},_updateChildrenRotation3d:function(E,H){var r=this;if(!r._updatingToChildren){var Z=r[$h(E)]();Ri.superClass[mg(E)].call(r,H),Zg||r._updatingFromChildren||this._updateRotationToChildren(E,H-Z)}},_updateRotationToChildren:function(W,P){var T=this;T._updatingToChildren=1,T.eachChild(function($){Je($)&&$._11Q(T,W,P)}),delete T._updatingToChildren},setScale:function(b,m){var v=this;if(!v._updatingToChildren){null==m&&(m=b.y,b=b.x);var o=v.getScale();if(D(b)<.01&&(b=.01*(Qg(b)||Qg(o.x))),D(m)<.01&&(m=.01*(Qg(m)||Qg(o.y))),Ri.superClass.setScale.call(v,b,m),!Zg&&!v._updatingFromChildren){v._updatingToChildren=1;var n=b/o.x,r=m/o.y;v._adjustChildScaleOrSize(n,r,"scale"),delete v._updatingToChildren,v._scaleChanged=1,v.updateFromChildren(),delete v._scaleChanged}}},onPropertyChanged:function(p){Ri.superClass.onPropertyChanged.call(this,p),"s:3d.visible"===p.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(F){(F.s("batch")||F.s("wf.geometry")||F.s("wf.visible"))&&F.iv(),F instanceof Ri&&F._invalidateChildrenBatch()})},getSerializableProperties:function(){var p=Ri.superClass.getSerializableProperties.call(this);return p.clickThroughEnabled=1,p.syncSize=1,p}});var tr=b.Grid=function(){rd(b.Grid,this)};Xq("Grid",ud,{IRotatable:!1,_icon:"grid_icon",_image:Q,getUIClass:function(){return So},setRotation:function(){},getCellRect:function(k,Z){var b=this,y=b.s("grid.row.count"),K=b.s("grid.column.count");if(0>=y||0>=K||0>k||k>=y||0>Z||Z>=K)return Q;var A,S,d,D=b.getRect(),e=b.s("grid.row.percents"),F=b.s("grid.column.percents");if(ng(D,b,"grid.border",-1),e&&e._as&&(e=e._as),F&&F._as&&(F=F._as),e&&e.length===y){for(d=0,A=0;k>A;A++)d+=D.height*e[A];D.y+=d,D.height=D.height*e[k]}else D.height=D.height/y,D.y+=D.height*k;if(F&&F.length===K){for(S=0,A=0;Z>A;A++)S+=D.width*F[A];D.x+=S,D.width=D.width*F[Z]}else D.width=D.width/K,D.x+=D.width*Z;return ae(D,-b.s("grid.gap")),D}});var fp=b.Text=function(){rd(fp,this),this.setSize(100,50),this.s("text","TEXT")};Xq("Text",ud,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Jh},setWidth:function(H){H||(H=.001),fp.superClass.setWidth.call(this,H)},setHeight:function(A){A||(A=.001),fp.superClass.setHeight.call(this,A)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Gn("__text__",{width:{value:100,isSafeFunc:!0,func:function(Z){return Z?Z._width:100}},height:{value:50,isSafeFunc:!0,func:function(C){return C?C._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"}}]});var Mk=b.Shape=function(){rd(Mk,this),this._59O=new Qd};Mk.__de__=ys,Xq("Shape",ud,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return dc},_22Q:function(){return $s},getLength:function(_){return xh(Mr(this._59O,this._58O,_,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var U=this._58O;return U?new Qd(U._as.slice(0)):U},setSegments:function(B){var b=this._58O;B=B?oi(B)?new Qd(B.slice(0)):new Qd(B._as.slice(0)):null,(b&&B&&b._as.join(",")!==B._as.join(",")||b!==B)&&(this._58O=B,this.fp("segments",b,B))},getPoints:function(){return this._59O},toPoints:function(){var B=this._59O;return new Qd(B._as.slice(0))},getPointsMatrix2d:function(){var C=this,S=new $m.Matrix2d,p=C.getPosition(),M=C.getScale(),G=C.getRotation();return S.translate(-p.x,-p.y).scale(M.x,M.y).rotate(G).translate(p.x,p.y),S},getPointsMatrix3d:function(){return function(){var o=this,m=new $m.Matrix4,j=m.getElements(),t=o.p3();ah(j,t),$e(j,o.getFinalRotation3d(),o.getRotationMode());var K=o.getScale3d(),A=o._dynamicScale3d;return A&&(K[0]*=A[0],K[1]*=A[1],K[2]*=A[2]),ok(j,K),ah(j,si(t)),m}}(),setPoints:function(w,m){var G=this,s=G._59O;w=w?oi(w)?new Qd(w.slice(0)):new Qd(w._as.slice(0)):new Qd;var D,U,z,k,H,o;m&&(D=G.getPosition(),o=new td(G.getRotation(),0,0,G.getScale().x,G.getScale().y)),(s&&w&&s._as.join(",")!==w._as.join(",")||s!==w)&&(G._59O=w,G.fs(),G.fp("points",s,w)),m&&(U=G.getPosition(),z=U.x-D.x,k=U.y-D.y,H=o.tf(z,k),G.setPosition(U.x-z+H.x,U.y-k+H.y))},setPoints3d:function(O,A){var _=new id(this.p3()),R=this.getPointsMatrix3d();if(R.setPosition(new id),Jf.superClass.setPoints.call(this,O),A){var m=new id(this.p3()),n=m.clone().sub(_).applyMatrix4(R);_.add(n),this.p3(_.x,_.y,_.z)}},addPoint:function(m,w,O){var J=this.toPoints();J.add(m,w),this.setPoints(J,O)},setPoint:function(N,o,U){var Y=this.toPoints();Y.set(N,o),this.setPoints(Y,U)},removePointAt:function(z){var e=this.toPoints();e.removeAt(z),this.setPoints(e)},setWidthForce:function(w){var f=this;if(!f._55I&&!Zg&&f.getWidth()){f._55I=1;var Q=f._position.x,W=w/f.getWidth(),o=f.toPoints(),G=new Qd;1!==W&&(o.each(function(f){G.add({x:(f.x-Q)*W+Q,y:f.y,e:f.e})}),f.setPoints(G),Kc(f,[W,0,0,1,Q*(1-W),0]),f.fs()),delete f._55I}Mk.superClass.setWidth.call(f,w)},setWidth:function(V){return this.setWidthForce(tk>V?tk:V)},setHeightForce:function(O){var C=this;if(!C._55I&&!Zg&&C.getHeight()){C._55I=1;var X=C._position.y,y=O/C.getHeight(),z=C.toPoints(),M=new Qd;1!==y&&(z.each(function(R){M.add({x:R.x,y:(R.y-X)*y+X,e:R.e})}),C.setPoints(M),Kc(C,[1,0,0,y,0,X*(1-y)]),C.fs()),delete C._55I}Mk.superClass.setHeight.call(C,O)},setHeight:function(_){return this.setHeightForce(tk>_?tk:_)},setAnchorElevation:function(u){var j=this;j._55I=!0;var o=j._updatingAnchor3d,N=!Zg&&!o;if(N){var S,m=u,L=j.getAnchorElevation(),w=j.getTall();S=w*(L-m),0!==S&&j.shiftPointsElevation(S)}var G=Mk.superClass.setAnchorElevation.apply(j,arguments);return o||delete j._55I,G},getShapeElevation:function(){var E=this,m=E._54O;return m-(E.getTall()||0)*(E._anchorElevation-.5)},setAnchor3d:function(K,d,J,w){var S,g=this;if("number"==typeof K?S={x:K,y:d,z:J}:(S=K.length?{x:K[0],y:K[1],z:K[2]}:K,w=d),g._55I=!0,g._updatingAnchor3d=!0,g.beginTransaction(),!Zg){var C=g.getAnchor3d(),X=g.getSize(),k=g.getTall(),W=X.width*(C.x-S.x),o=X.height*(C.z-S.z),$=k*(C.y-S.y);w||g.shiftPoints(W,o,$);var Z=g.p3()}var T=Mk.superClass.setAnchor3d.apply(g,arguments);if(!Zg&&w){var v=g.p3();g.shiftPoints(v[0]-Z[0]+W,v[2]-Z[2]+o,v[1]-Z[1]+$)}return g.endTransaction(),delete g._updatingAnchor3d,delete g._55I,T},setAnchor:function(y,d,A){var M=this;M._55I=!0;var n=M._updatingAnchor3d,J=!Zg&&!n;if(J){var $,Q,f;"number"==typeof y?f={x:y,y:d}:(f=y.length?{x:y[0],y:y[1]}:y,A=d);var v=M.getAnchor(),r=M.getSize();$=r.width*(v.x-f.x),Q=r.height*(v.y-f.y),A||M.shiftPoints($,Q);var X=M.getPosition()}var p=Mk.superClass.setAnchor.apply(M,arguments);if(J){var b=M.getPosition();A&&M.shiftPoints(b.x-X.x+$,b.y-X.y+Q)}return n||delete M._55I,p},shiftPoints:function(Y,O,g){if(Y||O||g){var K=this,U=K.getElevation()||0,h=K.toPoints(),t=new Qd;h.each(function(p){var r=p.e;g&&(r=(r==Q?U:r)+g),t.add({x:p.x+Y,y:p.y+O,e:r})}),K.setPoints(t),K.fs()}},shiftPointsElevation:function($){return this.shiftPoints(0,0,$)},setPosition:function(v,Q){var G,E=this;if(!E._28Q){if(E._28Q=1,!E._55I&&!Zg){G=2===arguments.length?{x:v,y:Q}:v;var e=G.x-E._position.x,F=G.y-E._position.y;if(0===e&&0===F)return delete E._28Q,void 0;E._55I=1,E.shiftPoints(e,F),Kc(E,[1,0,0,1,e,F]),delete E._55I}Mk.superClass.setPosition.apply(E,arguments),delete E._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var o=this;if(2!==o._59O.size())return!1;var a=o._58O;return a?2===a.size()&&1===a.get(0)&&2===a.get(1)?!0:!1:!0},fireShapeChange:function(){var p=this;if(!p._55I&&!Zg){var J=Tl(p._59O);J&&(p._55I=1,p.setRect(J),delete p._55I)}p.fp(qo,!1,!0)},getSerializableProperties:function(){var S=Mk.superClass.getSerializableProperties.call(this);return S.segments=1,S.points=1,S.thickness=1,S.closePath=1,S}});var os=b.Points=function(){rd(os,this)};Xq("Points",ud,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return _s},getPoints:function(){return this._59O},setPoints:function(t){var u=this._59O;t=t?t.slice(0):[];var p=t[0];if(Ho(p)){var v=t;t=[];for(var n=0,V=v.length;V>n;n+=3)t.push({x:v[n],e:v[n+1],y:v[n+2]})}this._59O=t,this._pointsDirty=!0,this.fp("points",u,this._59O)},setPoint:function(t,J){var d=this._59O.slice(0);d[t]=J,this.setPoints(d)},addPoint:function(O){this.setPoint(this._59O.length,O)},getColors:function(){return this._colors},setColors:function(Q){var C=this._colors;Q=Q?Q.slice(0):[],this._colors=Q,this._colorsDirty=!0,this.fp("colors",C,Q)},setPointColor:function(X,g){var w=this._colors.slice(0);w[X]=g,this.setColors(w)},getSizes:function(){return this._sizes},setSizes:function(L){var t=this._sizes;L=L?L.slice(0):[],this._sizes=L,this._sizesDirty=!0,this.fp("sizes",t,this._sizes)},setPointSize:function(I,j){var T=this._sizes.slice(0);T[I]=j,this.setSizes(T)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(y){var B=this._uvoffsets;y=y?y.slice(0):[],this._uvoffsets=y,this._offsetsDirty=!0,this.fp("uvoffsets",B,this._uvoffsets)},setPointUvoffset:function(j,d,x){var R;"object"==typeof d?(R=d[0],x=d[1]):R=d;var f=this._uvoffsets.slice(0);f[2*j+0]=R,f[2*j+1]=x,this.setUvoffsets(f)},getPointInfo:function(c){var Z=this.getPoints();if(!Z||Z[c]==Q)return Q;var s=Z[c],T=[s.x,s.e,s.y],r=this.mat||pc(this),x=[T[0],T[1],T[2]];ao(x,r);var e=this.getColors(),o=e[c]||this.s("points.color"),t=this.getSizes(),k=t[c];return{size:k==Q?this.s("points.size"):k,color:o,local:T,world:x}},getSerializableProperties:function(){var L=os.superClass.getSerializableProperties.call(this);return L.points=1,L.colors=1,L.sizes=1,L.uvoffsets=1,L},onPropertyChanged:function(M){os.superClass.onPropertyChanged.call(this,M);var t=M.property;"s:points.color"===t?this._colorsDirty=!0:"s:points.size"===t?this._sizesDirty=!0:"s:points.model"===t&&(this._modelDirty=!0)},getWidth:function(){var M=this;if(M._width>=0)return M._width;var f=M.getStyle("points.model");if(f){var k=Lc(f);if(k&&k.rawS3)return k.rawS3[0]}return 1},getHeight:function(){var o=this;if(o._height>=0)return o._height;var X=o.getStyle("points.model");if(X){var z=Lc(X);if(z&&z.rawS3)return z.rawS3[2]}return 1},getTall:function(){var H=this;if(H._tall>=0)return H._tall;var d=H.getStyle("points.model");if(d){var h=Lc(d);if(h&&h.rawS3)return h.rawS3[1]}return 1}});var Jf=b.Polyline=function(){rd(Jf,this),this.s({"shape.background":null,"shape.border.width":2})};Xq("Polyline",Mk,{_icon:"polyline_icon",_22Q:function(){return ct},getUIClass:function(){return ii},setClosePath:function(){},setTall:function(s){var y=this;if(y.beginTransaction(),!y._55I&&!y._24Q&&!Zg&&y.getTall()){y._24Q=1;var l=y._54O,r=s/y.getTall();if(1!==r){var x=y.toPoints(),$=new Qd;x.each(function(V){$.add({x:V.x,y:V.y,e:V.e==Q?V.e:(V.e-l)*r+l})}),y.setPoints($),y.fs()}delete y._24Q}Jf.superClass.setTall.call(y,s),y.endTransaction()},setElevation:function(Q){var x=this;if(x.beginTransaction(),!x._55I&&!x._24Q&&!Zg){x._24Q=1;var u=Q-x._54O;0!==u&&x.shiftPointsElevation(u),delete x._24Q}Jf.superClass.setElevation.apply(x,arguments),x.endTransaction()},fireShapeChange:function(){var U=this,h=U._59O;if(!U._55I&&!U._24Q&&!Zg){var _=h.size();if(_){var E=1,L=h.get(0),m=U._54O;L.e==Q&&(L.e=m);for(var I=L.e,d=0;_>E;E++){L=h.get(E),L.e==Q&&(L.e=m);var e=F(I,L.e),p=f(I+d,L.e);I=e,d=p-e}U._24Q=1,U.setTall(d),U.setElevation(I+d*U._anchorElevation),delete U._24Q}}Jf.superClass.fireShapeChange.apply(U,arguments)}});var ye=b.SubGraph=function(){rd(ye,this)};Xq("SubGraph",ud,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){ye.superClass._8I.call(this),this.eachChild(function(c){Je(c)&&c._8I()})}}),C.loadingRefGraph=0;var Vr=b.RefGraph=function(){rd(Vr,this)};Xq("RefGraph",Ri,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(V){var j=this._ref;this._ref=V,this.fp("ref",j,V),this.updateRef()},_21I:function(){Vr.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var j=this;if(C.loadingRefGraph++,j.clearChildrenFromDataModel(),C.loadingRefGraph--,j._ref&&j._dataModel){j._xhrLoadHandler&&(j._xhrLoadHandler.cancel=!0);var L=Zg,D=j._xhrLoadHandler=function(f){if(f&&j._dataModel){C.loadingRefGraph++;var J=j._pendingUpdateInfo={needToRestore:L};L&&(J.p3=j.p3(),J.s3=j.s3(),J.r3=j.r3(),J.anchor3d=j.getAnchor3d(),J.scale3d=j.getScale3d()),j.r3(0,0,0),j.setScale3d(1,1,1),j.setAnchor3d(.5,.5,.5),j.p3(0,0,0);var y=C.parse(f),$=j._dataModel.deserialize(y,j,{justDatas:!0});$.each(function(Q){Q._refGraph=j}),j.checkPendingUpdateInfo(),C.loadingRefGraph--,C.handleRefGraphLoaded(j,$,y)}};D.xhrLoadCalled=!1,C.load(j._ref,function(y){D.cancel||(D.xhrLoadCalled?D(y):Pq(function(){D(y)}))}),D.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var v=this,y=v._pendingUpdateInfo;if(!y)return v.onPendingUpdated&&(C.loadingRefGraph++,v.onPendingUpdated(),C.loadingRefGraph--),void 0;var R=!0;this.eachChild(function(G){(G._pendingCheckImageJSON||G._pendingUpdateInfo)&&(R=!1)}),R&&(C.loadingRefGraph++,v._pendingUpdateInfo=null,v.updateFromChildren(),y.needToRestore&&(v.setAnchor3d(y.anchor3d),v.setScale3d(y.scale3d),v.r3(y.r3),v.p3(y.p3)),this.getParent()instanceof Vr&&this.getParent().checkPendingUpdateInfo(),v.onPendingUpdated&&v.onPendingUpdated(),C.loadingRefGraph--)},getSerializableProperties:function(){var B=Vr.superClass.getSerializableProperties.call(this);return B.ref=1,B}}),b.EdgeGroup=function(T,l){this._70O=T,this._siblings=l;for(var G,D,L=0,b=T.size(),r=X[hr];b>L;L++)if(G=T.get(L).getStyle(hr,!1),G!=Q){r=G;break}r==Q&&(r=!0);var F=C.edgeGroupAgentFunc;for(F&&(D=F(T),D&&D!==T.get(0)&&(T.remove(D),T.add(D,0))),L=0;b>L;L++)T.get(L).s(hr,r)},Xq("EdgeGroup",x,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(I){return this._70O.get(I)},indexOf:function(H){return this._70O.indexOf(H)},each:function(T,I){this._70O.each(T,I)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(k,d){this._siblings.each(function(T){T._70O.each(k,d)})}});var tf=function(T,N,J){var d=zp[T]={type:T,action:N};if(J)for(var k in J)d[k]=J[k]};nd(C,{setConnectAction:tf,getConnectAction:function(N,l){if(!l){if(!N)return null;l=N.getCurrentConnectActionType()}return zp[l]},doConnectAction:function(Z,b,H,f){f=f||Z.getCurrentConnectActionType();var B=zp[f];if(!B)return!1;var L=B.action;return L?(b instanceof Ng.Group?Z.sm().getSelection().each(function(W){L.call(null,Z,W,H)}):L.call(null,Z,b,H),!0):!1},doDeleteConnectionAction:function(K,B,H){H=H||K.getCurrentConnectActionType();var N=zp[H];if(!N||!N.delete)return!1;var b=N.delete.action;return b?(B instanceof Ng.Group?K.sm().getSelection().each(function(p){b.call(null,K,p)}):b.call(null,K,B),!0):!1}});var ds=b.JSONSerializer=function(D,U){this.dm=this._dataModel=D,this._hierarchical=C.forceHierarchicalSerialization?!0:U==Q?D.isHierarchicalRendering():U};Xq("JSONSerializer",x,{ms_ac:["hierarchical"],serialize:function(I){return C.stringify(this.toJSON(),I)},toJSON:function(){var Y,t=this,z=t.dm,P=z.getRoots(),S=t.json={v:C.getVersion(),p:{},a:{},d:[]},G=z.getSerializableAttrs();(Y=z.getInit())&&(S.init=Y),(Y=z.getName())&&(S.p.name=Y),(Y=z.getBackground())&&(S.p.background=Y),(Y=z.getLayers())&&(S.p.layers=Y),(Y=z.getEnvmap())&&(S.p.envmap=Y),(Y=z.getEnvmapType())&&(S.p.envmapType=Y),S.p.autoAdjustIndex=z.isAutoAdjustIndex(),S.p.hierarchicalRendering=z.isHierarchicalRendering();for(var L in G){var x=z.a(L);x!==_&&t[as](L,x,S.a)}return vo(S.a)&&delete S.a,t._hierarchical?P.each(t.serializeData,this):z.each(function(d){t.serializeData(d)}),z.fireSerializeEvent({type:"serialize",json:S}),z.getPostProcessingData()&&(S.p.postProcessingData=z.getPostProcessingData()),S},isSerializable:function(){return!0},getProperties:function(Q){return Q.getSerializableProperties()},getStyles:function(U){return U.getSerializableStyles()},getAttrs:function(n){return n.getSerializableAttrs()},serializeData:function(k){var I=this;if(I.isSerializable(k)&&!k._refGraph){var S,h,X,g,P=ec(k.getClassName())||k.getClass(),m=new P,o={c:k.getClassName(),i:k.getId(),p:{},s:{},a:{}};I.json.d.push(o),S=I.getProperties(k);for(h in S)if(/^_/.test(h)){if(X=k[h],!("_width"!==h&&"_height"!==h||X!=Q&&-1!==X)){var N;((k.s("layout.h")||k.s("layout.v"))&&k.getHost()||k instanceof b.Node&&(N=k.getParent())&&N instanceof b.Block||k.s("fullscreen"))&&(X=k[h]="_width"===h?k.getWidth():k.getHeight())}X!==m[h]&&I[as](h.substr(1),X,o.p)}else g=$h(h),k[g]&&(X=k[g](),X!==m[g]()&&I[as](h,X,o.p));S=I.getStyles(k);for(h in S)X=k.s(h),X!==m.s(h)&&I[as](h,X,o.s);S=I.getAttrs(k);for(h in S)X=k.a(h),X!==m.a(h)&&I[as](h,X,o.a);vo(o.p)&&delete o.p,vo(o.s)&&delete o.s,vo(o.a)&&delete o.a}I._hierarchical&&k.getChildren().each(I.serializeData,I)},serializeValue:function(U,o,H){Wh(o)?o={__a:o._as}:o instanceof mi?o={__i:o.getId()}:o instanceof Zi&&(o={__dm:o.serialize(0)}),H[U]=o},deserialize:function(F,x,L){var M=this;return am(F)&&/.json$/.test(F)?(C.xhrLoad(F,function(k){M.deserializeImpl(k,x,L)}),void 0):M.deserializeImpl(F,x,L)},deserializeImpl:function(Z,R,F){var L=this,K=L.dm;K.setDeserializing(!0),F=wb(F)?{setId:F}:np(F)?{finishFunc:F}:F||{},Z=L.json=am(Z)?C.parse(Z):Z,!F.justDatas&&Z.a&&Z.a.onPreDeserialize&&!F.disableOnPreDeserialize&&Z.a.onPreDeserialize(Z,K,F.view),K.beginTransaction(),Zg++,L._82I={};var n=new Qd,k=new Qd,m=0,I=Z.d.length;if(F.justDatas||(!F.disableInit&&np(Z.init)&&Z.init(K),K.setInit(Z.init)),!F.justDatas){for(var v in Z.a)K.a(v,L[Bk](Z.a[v]));for(var O in Z.p)K[mg(O)](Z.p[O])}for(;I>m;m++){var q=Z.d[m],M=ec(q.c),g=new M,i=q.i;F.setId&&i!=Q&&(g._id=i),L._82I[i]=g,n.add(g),k.add(q)}for(m=0;I>m;m++)L.deserializeData(n.get(m),k.get(m));return n.each(function(M){R&&!M.getParent()&&M.setParent(R),K.add(M)}),F.__innerHandler__&&F.__innerHandler__(Z,K,F.view,n),K.fireSerializeEvent({type:"deserialize",json:Z}),Zg--,K.endTransaction(),!F.justDatas&&Z.a&&Z.a.onPostDeserialize&&!F.disableOnPostDeserialize&&Z.a.onPostDeserialize(Z,K,F.view,n),F.finishFunc&&F.finishFunc(Z,K,F.view,n),K.setDeserializing(!1),n},deserializeData:function(E,l){for(var O in l.p)E[mg(O)](this[Bk](l.p[O]));for(O in l.s)E.s(O,this[Bk](l.s[O]));for(O in l.a)E.a(O,this[Bk](l.a[O]))},deserializeValue:function(v){if(vp(v)){var R=v.__i;if(R!=Q)return this._82I[R];if(R=v.__dm,R!=Q){var x=new b.DataModel;return x.deserialize(R),x}if(R=v.__a,oi(R))return new Qd(R)}return v}}),nd(Zi,{serialize:function(v,p){return new ds(this,p).serialize(v)},toJSON:function(F){return new ds(this,F).toJSON()},deserialize:function(t,R,$){return new ds(this).deserialize(t,R,$)}});var Cd=b.OverlappingBox=function(Z){this.gv=Z,this.boxes={}};Xq("OverlappingBox",x,{clear:function(){var L,F,b=this.boxes;for(L in b)F=b[L],F.length=0},isOverlapping:function($,K){var m,M,O=this,h=O.boxes,z=h[$];z?(m=z.rects,M=z.length):z=h[$]={rects:m=[],length:M=0};var c,C,K;for(c=0;M>c;c++)if(C=m[c],C.x<K.x+K.w&&C.x+C.w>K.x&&C.y<K.y+K.h&&C.h+C.y>K.y)return!0;return m.length<=M?(m.push(K),z.length++):m[z.length++]=K,!1}}),nd(C,{fetch:function(F,C){var a="GET",l=!1,_=null,c="";C&&(a=C.method||"GET",l=C.sync,c=C.url,_=C.data||null),F.open(a,c,!l),C.responseType?F.responseType=C.responseType:C.overrideMimeType&&F.overrideMimeType&&F.overrideMimeType(C.overrideMimeType),F.send(_)},convertImageSrc:function(r,Q){Q&&"function"==typeof Q||(Q=function(){}),Q(r)}});var rn=b.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Xq("Request",x,{_responseType:null,_overrideMimeType:"text/plain",send:function(h){var s=this._xhr,p=this.onload,e=this.onerror;this.getResponseType()?h.responseType=this.getResponseType():this.getOverrideMimeType()&&(h.overrideMimeType=this.getOverrideMimeType()),s.onload=p,s.onerror=e,C.fetch(s,h)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(N){this._responseType=N},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(C){this._overrideMimeType=C},getResponseText:function(){var Z=this._xhr;return Z.response||Z.responseText}}),sl.GraphView=function(i){var b=this;b._24I={},b._34I=new Qd,b.enableDirtyRect(),b._25I={},b._56I={},b._view=Si(1,b),b._canvas=Yp(b._view),b.dm(i?i:new Zi),this._coreInteractor=new Cn(this),b.setEditable(!1),b.setScrollBarVisible(C.graphViewScrollBarVisible),b._initView()},Go("GraphView",x,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Kh,jr,yc,hh,"resettable","editInteractor",Mb,"zoomable","pannable","rectSelectable","autoScrollZone",Re,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:C.graphViewZoomable,_resettable:C.graphViewResettable,_pannable:C.graphViewPannable,_rectSelectable:C.graphViewRectSelectable,_autoScrollZone:C.graphViewAutoScrollZone,_rectSelectBackground:C.graphViewRectSelectBackground,_rectSelectBorderColor:C.graphViewRectSelectBorderColor,_editPointSize:C.graphViewEditPointSize,_editPointBorderColor:C.graphViewEditPointBorderColor,_editPointBackground:C.graphViewEditPointBackground,_scrollBarColor:Tr,_scrollBarSize:Qp,_autoHideScrollBar:Fk,_autoMakeVisible:Cj,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(i){this._dataModel.setLayers(i)},setEditable:function(J){var W=this,Y=W.__interactorMap__;if(!Y){var a=sl.XEditInteractor;Y=W.__interactorMap__={scrollBar:new gq(W),select:new qd(W),edit:a?new a(W):new Zb(W),text:new Eb(W),move:new _r(W),"default":new xl(W),touch:new db(W,{editable:!1})}}J?(W._uieditable=!0,W.setInteractors([Y.scrollBar,Y.select,Y.edit,Y.text,Y.move,Y.default,Y.touch])):(W._uieditable=!1,W.setInteractors([Y.scrollBar,Y.select,Y.move,Y.default,Y.touch]))},getCanvas:function(){return this._canvas},_33I:function(P){var A=P.getUIClass();return A?new A(this,P):Q},getDataUI:function(z){var F=this,b=F._25I[z._id];return b===_&&(b=F._33I(z),F._25I[z._id]=b),b},getNodeRect:function(p){return C.getNodeRect(this,p)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(j){var k=this.getDataUI(j);return k?(k._79o(),k._78o):null},getEdgeSourcePosition:function(r){var o=this,R=o.getDataUI(r),z=R.s,m=R._data._40I;return Lp(o,m,z("edge.source.position"),z("edge.source.offset.x"),z("edge.source.offset.y"),z("edge.source.anchor.x"),z("edge.source.anchor.y"))},getEdgeTargetPosition:function(E){var A=this,X=A.getDataUI(E),Y=X.s,r=X._data._41I;return Lp(A,r,Y("edge.target.position"),Y("edge.target.offset.x"),Y("edge.target.offset.y"),Y("edge.target.anchor.x"),Y("edge.target.anchor.y"))},invalidateAll:function(U){var w=this;if(U){for(var v in w._25I){var Z=w._25I[v];Z&&Z.dispose()}w._25I={},w._56I={},w._24I={},w._34I.clear(),w.redraw()}else w.dm().each(function(W){w.invalidateData(W)})},invalidateSelection:function(){var j=this;j.sm().each(function(V){j.invalidateData(V)})},invalidateData:function(Y){var M=this;M._24I[Y._id]=Y,M._21Q(Y),M.iv()},_21Q:function(s){var f=this,j=f._24I;if(hn(s)&&Gb[s.s(jo)]){var c=s.getSourceAgent();c&&c.getAgentEdges().each(function(g){j[g._id]=g}),c=s.getTargetAgent(),c&&c.getAgentEdges().each(function(D){j[D._id]=D}),f.iv()}},redraw:function(h){var U=this;U._32I||(h?U._34I.add(h):(U._32I=1,U._34I.clear()),U.iv())},each:function(X,g){var r,l,s,C=0,L=this.getLayers(),t=this._dataModel,c=t._datas._as,T=c.length;if(L){for(var Y=L.length;Y>C;C++)if(s=L[C],vp(s)&&(s=s.name),t.isHierarchicalRendering()){var P=function(Q){return Q._layer===s?g?X.call(g,Q):X(Q):void 0};if(this._dataModel.eachByHierarchical(P)===!1)return}else for(var D=0;T>D;D++)if(r=c[D],r._layer===s&&(l=g?X.call(g,r):X(r),l===!1))return}else if(t.isHierarchicalRendering())this._dataModel.eachByHierarchical(X,null,g);else for(;T>C;C++)if(r=c[C],l=g?X.call(g,r):X(r),l===!1)return},reverseEach:function(r,z){var G,y,o,O,B=this._dataModel,T=B._layers,b=B._datas._as,k=b.length;if(T){for(G=T.length-1;G>=0;G--)if(O=T[G],vp(O)&&(O=O.name),B.isHierarchicalRendering()){var Z=function(j){return j._layer===O?z?r.call(z,j):r(j):void 0};if(B.reverseEachByHierarchical(Z)===!1)return}else for(var a=k-1;a>=0;a--)if(y=b[a],y._layer===O&&(o=z?r.call(z,y):r(y),o===!1))return}else if(B.isHierarchicalRendering())B.reverseEachByHierarchical(r,null,z);else for(G=k-1;G>=0;G--)if(y=b[G],o=z?r.call(z,y):r(y),o===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var U=this,b=U._84I;if(!b){var m=this.dm().a("width"),N=this.dm().a("height");m>0&&N>0?U._84I={x:0,y:0,width:m,height:N}:(U.each(function(N){U.isVisible(N)&&(b=em(b,U.getDataUIBounds(N)))}),U._84I=b?b:Tm)}return U._84I},getScrollRect:function(){return em(this.getContentRect(),this._29I)},makeCenter:function(F,g,$){var i=this;if(!i.getWidth()||!i.getHeight())return $||Pq(i.makeCenter,i,[F,g,!0],500),void 0;i.makeVisible(F),i.validate();var Y=i.getDataUIBounds(F);if(Y){var I=i.getWidth(),e=i.getHeight(),S=Y.x+Y.width/2,k=Y.y+Y.height/2,m=-S*i._zoom+I/2,G=-k*i._zoom+e/2;i.setTranslate(m,G,g)}},fitData:function(_,K,E,z,l){var Z=this;if(!Z.getWidth()||!Z.getHeight())return l||Pq(Z.fitData,Z,[_,K,E,z,!0],500),void 0;var G=function(){Z.makeVisible(_),Z.validate();var C=Z.getDataUIBounds(_);C&&(C=be(C),ae(C,E==Q?20:E),Z.fitRect(C,K,z))};K?C.callWhenLoaded(G):G()},fitContent:function(n,S,$,K){var T=this;if(!T.getWidth()||!T.getHeight())return K||Pq(T.fitContent,T,[n,S,$,!0],500),void 0;var I=function(){T.validate();var C=be(T.getContentRect());ae(C,S==Q?20:S),T.fitRect(C,n,$)};n?C.callWhenLoaded(I):I()},fitRect:function(V,t,R){var H=this,N=H.getWidth(),Q=H.getHeight(),Y=V.x+V.width/2,k=V.y+V.height/2,K=F(N/V.width,Q/V.height),u=H._zoom,G=-Y*u+N/2,T=-k*u+Q/2;0===K||isNaN(K)||(R&&(K=F(1,K)),t?(H._65I&&(delete H._65I.finishFunc,H._65I.stop(!0)),H._14o&&H._14o.stop(!0),H.setTranslate(G,T,{finishFunc:function(){H.setZoom(K,t)}})):(H.setTranslate(G,T),H.setZoom(K)))},fitSelection:function(Y,O,r){var T=this,z=T.sm(),M=null;z.size()&&(z.each(function(w){M=em(T.getDataUIBounds(w),M)}),Y&&ae(M,Y),T.fitRect(M,O,r))},toCanvas:function(Y,w,Z){w=w||this._zoom,this.validateImpl();var Q=this,f=Q.getContentRect();Z&&ae(f,Z),f.width||(f.width=10),f.height||(f.height=10);var G=Yp(),R=f.x*w,i=f.y*w,W=Math.ceil(f.width*w),D=Math.ceil(f.height*w);$f(G,W,D,1);var t=ob(G);Y=Y||this._dataModel.getBackground(),Y&&uj(t,0,0,W,D,Y),Hk(t,-R,-i),t.scale(w,w);var b=this._zoom;return this._zoom=w,Q._42(t),this._zoom=b,t.restore(),G},toDataURL:function(O,f,s,g){return this.toCanvas(O,s,g).toDataURL(f||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(y,e){var X=this,I=X.dm().getBackground();if(I){var r=X.dm().a("width"),H=X.dm().a("height");r>0&&H>0&&uj(y,0,0,r,H,I)}var G=X.__htmlOrderList,l=[],E=X._forcedLayoutHTML;if(X._93db(y,e),X.each(function(g){var q=X.getDataUI(g);if(q){var M=X._56I[g._id],V=q._htmlView;if(M){var P=q._79o();if(V=q._htmlView,b.HtmlNode&&g instanceof b.HtmlNode)q._42(y);else{var z=X.getViewRect(),$=V&&V.layoutHTML;!e||on(e,P)?($&&(V.layoutHTML(),q.__outerLayout&&delete q.__outerLayout),q._42(y)):on(z,P)||!$||q.__outerLayout&&!E||(V.layoutHTML(),q.__outerLayout=!0)}}V&&(l.push(V),V.getView&&(V=V.getView()),V.style.display=M?"block":Vl)}}),G&&l.length>0){var m=!1;if(G.length!==l.length)m=!0;else for(var u=0;u<l.length;u++)if(l[u]!==G[u]){m=!0;break}m&&(l.forEach(function(Y){Y.autoAdjustIndex!==!1&&X.appendHTML(Y,!0)}),this.__htmlOrderList=l)}else this.__htmlOrderList=l;X._92db(y,e)},disableDirtyRect:function(){this._shouldRedrawAll=r},enableDirtyRect:function(){var S=this;S._shouldRedrawAll=function(){return S._32I}},validateImpl:function(){this.tryUpdateRootData();var Y,b,c,k,l,A=this,n=A.tx(),t=A.ty(),y=A._zoom,i=A._canvas,g=this.getWidth(),M=this.getHeight(),I=A._29I,S={x:-n/y,y:-t/y,width:g/y,height:M/y},w={},L=A._34I,G=A._24I,F=A._shouldRedrawAll(),D=A._23I;A._24I={},(g!==i.clientWidth||M!==i.clientHeight)&&($f(i,g,M),F=1,A._forcedLayoutHTML=1),F||dl(S,I)||(F=1,A._forcedLayoutHTML=1),A._29I=S,A.each(function(P){b=P._id;var F=w[b]=A.isVisible(P);F!==A._56I[b]&&(G[b]=P,c=A.getDataUI(G[b]),c&&c._84o(F),A._84o(P,F))},A);for(b in G)c=A.getDataUI(G[b]),c&&(!F&&A._56I[b]&&(l=c._79o(),l&&L.add(l)),c.invalidate()),A._83I=1;if(A._56I=w,!F)for(b in G)w[b]&&(c=A.getDataUI(G[b]),c&&(l=c._79o(),l&&L.add(l)));if(F?k=S:(L.each(function(Q){on(S,Q)&&(k=em(k,Q))}),k&&(ae(k,f(1,1/y)),k.x=E(k.x*y)/y,k.y=E(k.y*y)/y,k.width=J(k.width*y)/y,k.height=J(k.height*y)/y,k=Rj(S,k))),A._74O=k,k&&0!==k.width&&0!==k.height){Y=ob(i);var C=k.x,x=k.y,U=k.width,Q=k.height;C=Math.floor((C*y+n)*rh),x=Math.floor((x*y+t)*rh),U=Math.ceil(U*y*rh)+1,Q=Math.ceil(Q*y*rh)+1,F||(k.x=(C/rh-n)/y,k.y=(x/rh-t)/y,k.width=U/rh/y,k.height=Q/rh/y),Y.beginPath(),Y.rect(C,x,U,Q),Y.clip(),Y.clearRect(C,x,U,Q),Wi(Y,n,t,y),A._42(Y,k),Y.restore(),delete A._74O}if(L.clear(),delete A._32I,delete A._forcedLayoutHTML,D&&g>0&&M>0){var c=A.getDataUI(D);if(c){var l=c._79o(),q=A._29I,d=q.x,z=q.y,j=q.width,e=q.height,y=A._zoom;l&&!on(l,q)&&(l.x+l.width<d&&A.tx(-l.x*y),l.x>d+j&&A.tx(-(l.x+l.width-j)*y),l.y+l.height<z&&A.ty(-l.y*y),l.y>z+e&&A.ty(-(l.y+l.height-e)*y))}delete A._23I}A._83I&&(delete A._83I,delete A._84I),A._98O(),A.countFrame(),vo(A._24I)||Pq(A.iv,A)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var K,u=this.getFullscreenDatas();for(var n in u)K=u[n],this.scaleRootData(K);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(j){var z=j.s("fullscreen");if("uniform"===z||"fill"===z){j.getRotation()&&j.setRotation(0);var n=j.s("fullscreen.gap")||0,B=this.getWidth(),c=this.getHeight();if(B&&c){var S,A,m,r=B-2*n,d=c-2*n,G=j.getAnchor(),P=j.getScaledSize(),K=P.width,e=P.height,f=j.s("fullscreen.lock");if(f)return"uniform"===z?r/d>K/e?(S=d/e,K=e*r/d):(S=r/K,e=K*d/r):"v"===f?(S=d/e,K=r/S,j.getWidth()!==K&&j.setWidth(K)):(S=r/K,e=d/S,j.getHeight()!==e&&j.setHeight(e)),this.setZoom(S),A=n-(j.getX()-G.x*K)*S,m=n-(j.getY()-G.y*e)*S,A!==this.tx()&&this.tx(A),m!==this.ty()&&this.ty(m),void 0;
A=this.tx(),m=this.ty(),S=this._zoom;var b={x:(-A+n)/S,y:(-m+n)/S,width:r/S,height:d/S};if("uniform"===z){var N=K/e,Y=Math.min(b.width,b.height*N),J=Y/N;b.x+=.5*(b.width-Y),b.y+=.5*(b.height-J),b.width=Y,b.height=J}r=b.width/j.getScaleX(),d=b.height/j.getScaleY(),(j.getWidth()!=r||j.getHeight()!==d)&&j.setSize(r,d);var Z=b.x+G.x*b.width,y=b.y+G.y*b.height,I=j.getPosition();(Z!==I.x||y!==I.y)&&j.setPosition(Z,y)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(r){var Z=this;r!==Z.isScrollBarVisible()&&(r?(zk(Z._view,Z._79O=jc()),zk(Z._79O,Z._27I=jc()),zk(Z._79O,Z._28I=jc())):(hg(Z._79O),delete Z._79O,delete Z._27I,delete Z._28I),Z.fp("scrollBarVisible",!r,r))},getDebugTip:function(){return""},showScrollBar:function(){var L=this;L._79O&&(L._85I||(Eg(function(){L._86I()},gm),L.iv()),L._85I=new Date)},_86I:function(){var c=this;if(c._85I){var D=new Date,k=D.getTime();k-c._85I.getTime()>=gm?(delete c._85I,c.iv()):Eg(function(){c._86I()},gm)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var $=this,J=this._27I,f=this._28I;if($._79O){if($._autoHideScrollBar&&!$._85I)return J.style.visibility=qr,f.style.visibility=qr,void 0;var Q=$.getScrollBarColor(),j=$._zoom,K=$.getScrollBarSize(),F=$.getViewRect(),s=$.getScrollRect(),p=F.height*j,_=s.height*j,M=F.width*j-K-2,G=p*((F.y-s.y)*j/_),c=p*(p/_),e=J.style;_-.5>p?(Tf>c&&(G=G+c/2-Tf/2,0>G&&(G=0),G+Tf>p&&(G=p-Tf),c=Tf),xg(J,M,G,K,c),e.visibility=qj,e.background=Q,e.borderRadius=K/2+jf):e.visibility=qr;var N=F.width*j,i=s.width*j,G=F.height*j-K-2,M=N*((F.x-s.x)*j/i),y=N*(N/i),e=f.style;i-.5>N?(Tf>y&&(M=M+y/2-Tf/2,0>M&&(M=0),M+Tf>N&&(M=N-Tf),y=Tf),xg(f,M,G,y,K),e.visibility=qj,e.background=Q,e.borderRadius=K/2+jf):e.visibility=qr}},setDataModel:function(g){var w=this,Z=w._dataModel,d=w._selectionModel;Z!==g&&(Z&&(Z.ump(w.handleDataModelPropertyChange,w),Z.umm(w.handleDataModelChange,w),Z.umd(w.handleDataPropertyChange,w),Z.removeIndexChangeListener(w._75O,w),Z.removeHierarchyChangeListener(w.handleHierarchyChange,w),d||Z.sm().ums(w.handleSelectionChange,w)),w._dataModel=g,g.mp(w.handleDataModelPropertyChange,w),g.mm(w.handleDataModelChange,w),g.md(w.handleDataPropertyChange,w),g.addIndexChangeListener(w._75O,w),g.addHierarchyChangeListener(w.handleHierarchyChange,w),d?d._21I(g):g.sm().ms(w.handleSelectionChange,w),w.invalidateAll(!0),w.fp(Ei,Z,g),w.updateBackground())},getLayersInfo:function(){if(this._layersInfo===_){var Z=this.getLayers();Z?(this._layersInfo={},Z.forEach(function(Y){var O=vp(Y)?Y.name:Y;this._layersInfo[O]=Y},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(j,H,o){var T,w,b=this,s=b.getDataUI(j),I=xp(s),U=Wq(H,function(g){return nk(I,100*g)},100,.001),O=nk(I,100*U);if(!o){var G=Ul(s),v=new jj(O.x,O.y),t=49/(b._zoom*b._zoom);for(T=0,w=G.length;w>T;T++)if(v.distanceToSquared(G[T])<t)return{index:T,point:G[T],distance:Math.sqrt((G[T].x-H.x)*(G[T].x-H.x)+(G[T].y-H.y)*(G[T].y-H.y))}}return{percent:U,point:O,distance:Math.sqrt((O.x-H.x)*(O.x-H.x)+(O.y-H.y)*(O.y-H.y))}},calculateAttachPoint:function(){var t=new jj,b=new jj,U=new jj;return function(c,d){var T=this.getAttachPoints(c);if(!T||!T.length)return null;U.set(d.x,d.y);for(var N,w,s,g,q,$=1/0,m=0,e=T.length;e>m;m++)s=T[m],b.x=s.x,b.y=s.y,t.x=s.offsetX||0,t.y=s.offsetY||0,g=Lp(this,c,0,t.x,t.y,b.x,b.y),w=U.distanceToSquared(g),$>w&&(N=m,$=w,q=g);$=Math.sqrt($);var W=this.getAttachStyle(c);if("close"===W){var p=c.s("attach.close.threshold")/this._zoom;if($>p)return null}return{index:N,distance:$,info:T[N],point:q}}}(),getAttachPoints:function(r){var P=r.s("attach.points");if(P)return P;var J=Bj(r._image);return J?yk(J.attachPoints,r,this)||null:void 0},getAttachStyle:function(v){var x=v.s("attach.style");if(x)return x;var S=Bj(v._image);return S?yk(S.attachStyle,v,this)||"close":void 0},updateLayers:function(){this._layersInfo=_,this.invalidateSelection(),this.redraw()},updateBackground:function(){var M=this.dm().a("width"),I=this.dm().a("height");this._canvas.style.background=M>0&&I>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(R){if("background"===R.property){var F=this._canvas.style.background,v=R.newValue||"";this.updateBackground(),this.fp("canvasBackground",F,v),this.redraw()}else"a:width"===R.property||"a:height"===R.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===R.property?this.updateLayers():"hierarchicalRendering"===R.property&&this.redraw()},handleDataPropertyChange:function(K){this.dm().isHierarchicalRendering()&&"parent"===K.property&&K.data.hasChildren()&&this.redraw(),this.invalidateData(K.data)},onPropertyChanged:function(J){var V=this,G=J.property;if(V.redraw(),"zoom"===G){var g=V.sm().getSelection();g.size()&&g.each(function(f){f.invalidate()})}else"dataModel"===G&&(V._83I=1);le[G]?V.showScrollBar():G===Mb&&V.onCurrentSubGraphChanged(J)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(d){var _=this,G=d.kind,H=d.data;if(_._83I=1,"add"===G)_.invalidateData(H),hn(H)&&H.getEdgeGroup()&&H.getEdgeGroup().eachSiblingEdge(_.invalidateData,_),H.getHost&&H.getHost()&&H.getHost().updateLayoutAttaches();else if(G===vi){_._21Q(H);var x=H._id,p=_._25I[x];if(p){if(_._56I[x]){var T=p._79o();T&&_.redraw(T)}p.dispose(),delete _._25I[x],delete _._24I[x],delete _._56I[x]}H===_._currentSubGraph&&_.setCurrentSubGraph(Q)}else G===gg&&(_.invalidateAll(!0),_.setCurrentSubGraph(Q))},_75O:function(Y){this.invalidateData(Y.data)},handleHierarchyChange:function(E){this.dm().isHierarchicalRendering()&&E.data.hasChildren()&&this.redraw(),this.invalidateData(E.data)},adjustIndex:function(m){var N=this;if(N.isVisible(m)){N.dm().beginTransaction();for(var V=m;V._parent&&N.isVisible(V._parent);)V=V._parent;V&&V!==m&&N._dataModel.adjustIndex(V),N._dataModel.adjustIndex(m),N.dm().endTransaction()}},getImage:function(G){return G.getImage?G.getImage():_},getSelectWidth:function(w){var l=Bj(this.getImage(w));return l&&yk(l.disableSelectedBorder,w,this)?0:w.s("select.width")},getSelectColor:function(t){return t.s("select.color")},isSelectable:function(j,k){if(this.isSelected(j))return!0;if(!k&&j.getParent()instanceof Ri&&this.isSelectable(j.getParent(),!0)&&j.getParent().isSyncSize())return!1;var L=this.getLayersInfo();if(L){var h=L[j._layer];if(h&&h.selectable===!1)return!1}return j.s("2d.selectable")&&this.sm().isSelectable(j)},isMovable:function(v){var G=this;if(hn(v)&&v.getStyle(jo)!==Hl)return!1;var c=this.getLayersInfo();if(c){var K=c[v._layer];if(K&&K.movable===!1)return!1}return v.s("2d.movable")?G._movableFunc?G._movableFunc(v):!0:!1},isEditable:function(y){var x=this;if(b._uiSerializing)return x._uieditable;if(!x._editInteractor||!x.isSelected(y))return!1;if(Pm(y)){var r=x.getDataUI(y);if(!r||r._88I)return!1}if(hn(y)&&y.getStyle(jo)!==Hl)return!1;var c=this.getLayersInfo();if(c){var U=c[y._layer];if(U&&U.editable===!1)return!1}return y.s("2d.editable")?x._editableFunc?x._editableFunc(y):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(F){return Je(F)&&0!==F.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(F):!0},isRectEditable:function(m){return this._rectEditableFunc?this._rectEditableFunc(m):!0},isAnchorEditable:function(Z){return this._anchorEditableFunc?this._anchorEditableFunc(Z):!0},isRotationEditable:function(p){return p.setRotation&&p.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(p):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(A){var v=A.getAnchor(),I=A.getScale(),Q=this._zoom,X=Nr(A.getRotation(),0,-A.getHeight()*I.y*v.y-(I.y<0?-1:1)*(Ap?32:16)/Q),L=A.p();return X.x+=L.x,X.y+=L.y,X},getLogicalPoint:function(N){var f=this;return ag(N,f._canvas,f.tx(),f.ty(),f._zoom,f._zoom)},getScreenPoint:function(V,z){var A,o=this;return"object"==typeof V?V.x!==_?(A=V.x,z=V.y):(A=V[0],z=V[1]):A=V,dh(A,z,o._canvas,o.tx(),o.ty(),o._zoom,o._zoom)},getSelectedDataAt:function(O){var V=this;return this.getDataAt(O,function(m){return V.isSelected(m)})},getDataInfoAt:function(S,o,I){var e,X=this.lp(S),d=this.getDataAt(X,o,I);if(d){var M=this.getDataUI(d);e={data:d,ui:M,point:X};var q=M._38o;if(q){var B=q.icons;for(var N in B){var H=B[N],r=q.rects[N];if(r)for(var W=yk(H.names,d,this),f=W?W.length:0,s=r.rotation,a=f-1;a>=0;a--){var x=W[a],t=r[a];if(Om(t,X,s))return e.part="icons",e.name=N,e.icon=x,e.rect=t,e.index=a,e.rotation=s,e}}}if(this.isNoteVisible(d)){if(M.note2Info&&Om(M.note2Info.clickRect,X,Q,M.note2Info.scale))return e.part="note2",e;if(M.noteInfo&&Om(M.noteInfo.clickRect,X,Q,M.noteInfo.scale))return e.part="note",e}if(this.isLabelVisible(d)){if(M.label2Info&&Om(M.label2Info.rect,X,M.label2Info.rotation,M.label2Info.scale))return e.part="label2",e;if(M.labelInfo&&Om(M.labelInfo.rect,X,M.labelInfo.rotation,M.labelInfo.scale))return e.part="label",e}if(d.isInRect&&d.isInRect(X))return e.part="body",e}return e},getDataAt:function(E,X,U){E.target&&(E=this.lp(E));var B,n=this._zoom;return this.reverseEach(function(k){return(X?X(k):this.isSelectable(k))&&this.rectIntersects(k,Hq(E.x,E.y,U,n))?(B=k,!1):void 0},this),B},getIconInfoAt:function(P,d){var r=this;if(P.target&&(P=r.lp(P)),d||(d=r.getDataAt(P)),d){var g=r.getDataUI(d);if(g&&g._38o){var W,s=g._38o,S=new Qd;for(W in s.icons)S.add(W);for(var J=S.size()-1;J>=0;J--){W=S.get(J);for(var e=s.rects[W],A=e.rotation,M=e.length-1;M>=0;M--){var f=e[M],l=f.width,Z=f.height,t={x:P.x-f.x-l/2,y:P.y-f.y-Z/2};A!=Q&&(t=Nr(-A,t.x,t.y));var f={x:-l/2,y:-Z/2,width:l,height:Z};if(Om(f,t))return{key:W,index:M,name:s.icons[W].names[M],rect:e[M],point:P,rotation:A,relativeRect:f,relativePoint:t,data:d}}}}}return Q},getDatasInRect:function(S,$,x){x===_&&(x=1);var Q=this,b=new Qd;return Q.reverseEach(function(C){x&&!Q.isSelectable(C)||($?Q.rectIntersects(C,S):Q.rectContains(C,S))&&b.add(C)}),b},moveSelection:function(L,Z){var W=this;W.dm().beginTransaction(),Jp(W.sm().toSelection(W.isMovable,W),L,Z),W.dm().endTransaction()},moveDatas:function(V,k,Z){var O=this;O.dm().beginTransaction(),V instanceof Qd||(V=new Qd(V)),Jp(V,k,Z),O.dm().endTransaction()},getDataUIBounds:function(X){var A=this.getDataUI(X);return A?A._79o():Q},drawData:function(h,f,M){var k=this.getDataUI(f);if(k){var q=k._79o();(!M||on(M,q))&&(k._42(h),f instanceof b.Block&&f.eachChild(function(U){this.isVisible(U)&&this.drawData(h,U,M)},this))}},getBoundsForGroup:function(c){return c.s(Oj)?this.getDataUIBounds(c):Q},isPixelPerfect:function(O){return O.s("pixelPerfect")},rectIntersects:function(a,W){this.validate();var H=Q;if(this._56I[a._id]){var D=this._25I[a._id];if(D){var o=D._79o();if(Km(W,o))H=!0;else if((W=Rj(W,o))&&(D.rectIntersects&&(H=D.rectIntersects(W)),H==Q)){if(!this.isPixelPerfect(a))return!0;var m=W.x,d=W.y,r=W.width,x=W.height,l=this._zoom,S=C.hitMaxArea,v=r*x*l*l;if(v>S){var I=Math.sqrt(S/v);l*=I}r*=l,x*=l,2>r&&(r=2),2>x&&(x=2),m*=l,d*=l;var P=gl(r,x);Hk(P,-m,-d),P.scale(l,l),this._drawForChecking=!0,this.drawData(P,a,W),this._drawForChecking=!1;try{for(var N=0,f=P.getImageData(0,0,r,x).data;N<f.length;N+=4)if(0!==f[N+3]){H=!0;break}P.restore()}catch(Y){Qk=Q,H=!1}}}}return H?!0:!1},rectContains:function(q,K){if(this._56I[q._id]){var M=this._25I[q._id];if(M)return Km(K,M._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(u){if(!C.isInput(u.target)){var G=this,t=G._focusData,L=t&&G._25I[t._id],W=0,m=G._dataModel._datas;if(!(t&&t._enabled&&t._editable&&L&&L.onKeyDown&&L.onKeyDown(u)===!0))if(9===u.keyCode&&(t&&(W=m.indexOf(t),Xf(u)?-1===--W&&(W=0):++W===m.size()&&(W=0)),G._focusData=t=m.get(W),G.sm().setSelection(t)),ue(u)?G.selectAll():Uq(u)&&G.isResettable()&&G.reset(),G.sm().isEmpty()){if(G._editing)return;var d=G.tx(),S=G.ty(),e=!1,F=Xf()?100:10;re(u)&&(d-=F,e=!0),zc(u)&&(S-=F,e=!0),ze(u)&&(d+=F,e=!0),uh(u)&&(S+=F,e=!0),e&&G.setTranslate(d,S)}else{Qi(u)&&G.handleDelete(u);var H=Xf()?10:1;re(u)&&(G.moveSelection(-H,0),G.fi({kind:"moveLeft"})),zc(u)&&(G.moveSelection(0,-H),G.fi({kind:"moveUp"})),ze(u)&&(G.moveSelection(H,0),G.fi({kind:"moveRight"})),uh(u)&&(G.moveSelection(0,H),G.fi({kind:"moveDown"}))}}},handleScroll:function(b,Z){if(zq(b),this.isZoomable()){if(!this.getEditInteractor()){var B=this.getDataAt(b);if(B){var W=Bj(this.getImage(B));if(W&&yk(W.scrollable,B,this))return}}var O=this.lp(b);Z>0?this.scrollZoomIn(O):0>Z&&this.scrollZoomOut(O)}},handlePinch:function(o,z,T){this.isZoomable()&&(Math.abs(z-T)<C.pinchZoomThreshold||(z>T?this.pinchZoomIn(o):this.pinchZoomOut(o)))},checkDoubleClickOnNote:function(U,z){var J=this,i=J.lp(U),Y=J.getDataUI(z),c=Y.note2Info;return c&&z.s("note2.toggleable")&&Om(c.clickRect,i)?(z.s(bg,!z.s(bg)),J.fi({kind:"toggleNote2",event:U,data:z}),!0):(c=Y.noteInfo,c&&z.s("note.toggleable")&&Om(c.clickRect,i)?(z.s(lj,!z.s(lj)),J.fi({kind:"toggleNote",event:U,data:z}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(q,T){var N=this,F=N.getAutoScrollZone(),M=F/N.getZoom(),g=F/4,h=N._29I,W=N.lp(q),c={x:N.tx(),y:N.ty()};return W&&F>0&&h&&(W.x-h.x<M?N.translate(g,0):h.x+h.width-W.x<M&&N.translate(-g,0),W.y-h.y<M?N.translate(0,g):h.y+h.height-W.y<M&&N.translate(0,-g)),c.x=N.tx()-c.x,c.y=N.ty()-c.y,T&&(T.x+=c.x,T.y+=c.y),c},getMoveMode:function(I,S){var n=S.s("2d.move.mode");return n?n:Fr["88"]?"x":Fr["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(O,s,m){var S=this;return"currentSubGraph"===s?{__i:O.getId()}:m.serializeProperty(O,s,S)},deserializeProperty:function(E,u,c){var Z=this;if("currentSubGraph"===u){var q=Z.dm(),W=q.__idMap;return W[E.__i]}return c.deserializeProperty(E,u,Z)},setDefaultCursor:function(x,A){this._defaultCursor=x,A!==!1&&this.setCursor(x)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(N){return N===Q||C.getConnectAction(null,N)?(this._currentActionType=N,this.redraw(),!0):!1},getEditStyle:function(j){var t=this.getEditInteractor();return t?t.getStyle(j):_},setEditStyle:function(Q,y,I){var M=this.getEditInteractor();return M?(M.setStyle(Q,y,I),!0):!1},isConnectActionVisible:function(h){var G=C.getConnectAction(this);if(!G)return!1;var w=G.visible;return np(w)&&(w=w(this,h)),w},isInteractive:function(T){if(this._drawForChecking)return!1;var C=Bj(this.getImage(T));return C&&yk(C.interactive,T,this)?!0:T.s("interactive")},getRenderingStyleIconName:function(){return Vb},appendHTML:function(G,d){var f=this.getView();if(!(d||G&&G.parentNode!==f))return!1;var N=G.getView&&G.getView(),D=G.beforeCanvas;if(!d&&N&&N.parentNode===f)return!1;(G.getView||G.isSelfViewEvent)&&(G=G.getView());var Z=this.getEditInteractor();return D?f.insertBefore(G,this.getCanvas()):Z&&Z._canvas?f.insertBefore(G,Z._canvas):this.isScrollBarVisible()?f.insertBefore(G,this.getView().lastChild):zk(f,G),!0},_layoutHTMLImpl:function(K,e,f){if(arguments.length>1){var D,p=this,A=p._zoom;if(e.getView&&(D=e,e=e.getView()),e.style.position="absolute",f){var d=K.getRect();xg(D||e,p.tx()+d.x*A,p.ty()+d.y*A,d.width*A,d.height*A)}else{var J=new je,d=K.getAnchorRect(),M=K.getPosition(),H=K.getScale(),R=e.style;xg(D||e,d),J.appendTranslate(p.tx(),p.ty()),J.appendScale(A,A),J.append(new je(K.getRotation(),M.x,M.y,H.x,H.y)),Tp(R,"transform","matrix("+J.a.toFixed(5)+", "+J.b.toFixed(5)+", "+J.c.toFixed(5)+",\n    "+J.d.toFixed(5)+", "+J.tx.toFixed(5)+", "+J.ty.toFixed(5)+")"),Tp(R,"transformOrigin",(-d.x).toFixed(5)+"px "+(-d.y).toFixed(5)+"px"),e.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(z){return z instanceof fp?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(R){var m="state",J=R.s(m);if(J)return J;var x=Bj(R._image);return x?yk(x[m],R,this)||null:void 0},getShape:function(Q){return Q.getStyle(qo)}}),x.defineProperties(sl.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(b){this._layoutHTML=b}}});var Mp=function(b,f){var P=this;P.gv=b,P.s=function(x){return f.getStyle(x)},P._data=f,P._87I=new Qd},Vb=Q;eq(Mp,x,{_6I:Q,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var t=this,d=t.gv.isSelected(t._data);return!d||t.isShadowed()?0:t.gv.getSelectWidth(t._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(E){var K=this._data,T=this.gv.getBodyColor(K);return T?T:E?K.getStyle(E):Q},_2Q:function(C){return this.s(C)},_1Q:function(p,K,q,M){var H=this.s,u=H("2d.gray"),Q=H(K+".dash.color");if(u&&(Q=C.toGrayColor(Q)),p.strokeStyle=Q,p.lineWidth=q,p.stroke(),H(K+".dash.3d")){var A=H(K+".dash.3d.color");oq(p,Q,u?C.toGrayColor(A):A,q,this.gv._zoom,H(K+".dash.3d.accuracy"))}Lb(p,M)},invalidate:function(){this._6I=Q},_79o:function(){var X=this;if(!X._6I){var p=X._data,r=X.gv;X.labelInfo=X.label2Info=X.noteInfo=X.note2Info=X._38o=Q,X._87I.clear(),X.interactiveInfo=r.isInteractive(p)?{}:Q,X._3O(),X._55O=r.isEditable(p)?{_42O:r.isRectEditable(p),_43O:r.isPointEditable(p),_56O:r.isRotationEditable(p)}:Q,X._6I=X._81o()}return X._6I},_3O:function(){},getPosition:function(){return Tm},_68o:function(u,T){u&&this._87I.add(Aj(u,T))},_81o:function(){var $=this,o=$.s;$._24O(lf,"getLabel"),$._24O($n,"getLabel2"),$._26O(Hd,"getNote"),$._26O(el,"getNote2"),$._15O(),$._55O&&$._48O();var c;if($._87I.each(function(z){c=em(c,z)}),c&&o("shadow.interactable")){var R=$.isShadowed(),i=o("shadow2"),d=be(c);i?(d.x+=o("shadow2.offset.x"),d.y+=o("shadow2.offset.y"),ae(d,o("shadow2.blur"))):R&&(d.x+=o("shadow.offset.x"),d.y+=o("shadow.offset.y"),ae(d,o("shadow.blur"))),c=em(c,d)}return $._87I.clear(),c},_42:function(V){var N=this,S=N._data,X=N.gv,J=N.s,t=J("opacity"),D=this.isShadowed(),T=J("shadow2");if(D||T){var r=V.shadowOffsetX,I=V.shadowOffsetY,W=V.shadowBlur,Z=V.shadowColor,P=X.getZoom()*C.devicePixelRatio,H=D?"shadow":"shadow2";V.shadowOffsetX=J(H+".offset.x")*P,V.shadowOffsetY=J(H+".offset.y")*P,V.shadowBlur=J(H+".blur")*P,V.shadowColor=D?N.getSelectColor():J(H+".color")}if(t!=Q){var L=V.globalAlpha;V.globalAlpha=t}N._80o(V),X.isLabelVisible(S)&&((!X._drawForChecking||J("label.selectable"))&&Qo(V,N.labelInfo),(!X._drawForChecking||J("label2.selectable"))&&Qo(V,N.label2Info)),X.isNoteVisible(S)&&(Oq(V,N.noteInfo),Oq(V,N.note2Info)),N._99O(V),t!=Q&&(V.globalAlpha=L),(D||T)&&(V.shadowOffsetX=r,V.shadowOffsetY=I,V.shadowBlur=W,V.shadowColor=Z)},_80o:function(){},_47O:function(){},_24O:function(d,N){var A=this,y=A._data,n=A.gv,X=A.s,R=n[N](y);if(R!=Q){var l=X(d+".scale"),x=X(d+".max"),G=X(d+".position"),c=A[d+"Info"]={label:R,scale:l,color:n[N+"Color"](y),font:X(d+".font"),opacity:X(d+".opacity"),align:X(d+".align"),decoration:X(d+".decoration"),rotation:A.getRotation(X(d+".rotation"),!1,G),background:n[N+"Background"](y)},a=Yd(c,R);x>0&&x<a.width&&(c.labelWidth=a.width,a.width=x),1!==l&&(a.width*=l,a.height*=l);var Y=A.getPosition(G,X(d+".offset.x"),X(d+".offset.y"),a,X(d+".position.fixed"));if(a.x=Y.x-a.width/2,a.y=Y.y-a.height/2,A._68o(c.rect=a,c.rotation),1!==l){var F=a.width/l,M=a.height/l;c.rect={x:Y.x-F/2,y:Y.y-M/2,width:F,height:M}}}},_26O:function(U,y){var D=this,l=D.gv,x=D._data,G=D.s,p=l[y](x);if(p!=Q){var k,g,h=G(U+".scale"),N=D[U+"Info"]={note:p,scale:h,data:x,view:l,expanded:G(U+".expanded"),font:G(U+".font"),color:G(U+".color"),opacity:G(U+".opacity"),align:G(U+".align"),icon:G(U+".icon"),backgroundImage:G(U+".backgroundImage"),borderWidth:G(U+".border.width"),borderColor:G(U+".border.color"),background:l[y+"Background"](x)},a=D.getPosition(G(U+".position"),G(U+".offset.x"),G(U+".offset.y")),I=a.x,c=a.y;if(N.expanded){var i,V=G(U+".max"),A=G(U+".backgroundImage");A?(A=Bj(A),i={width:ld(A,x),height:Sr(A,x)}):i=Yd(N,p),i.width+=6,i.height+=2,V>0&&V<i.width&&(N.labelWidth=i.width,i.width=V),k=i.width,g=i.height+8,N.clickRect={x:I-k*h/2,y:c-g*h,width:k*h,height:g*h*i.height/g}}else{var F=G(U+".icon");F?(F=Bj(F),k=ld(F,x),g=Sr(F,x)):(k=12,g=18),N.clickRect={x:I-k*h/2,y:c-g*h,width:k*h,height:g*h}}N.rect={x:I-k/2,y:c-g*h/2-g/2,width:k,height:g};var v=J(N.borderWidth/2)*h;D._68o({x:I-k*h/2-v,y:c-g*h-v,width:k*h+2*v,height:g*h+2*v})}},_48O:function(){},_99O:function(T){var h=this,b=h._38o;if(b){var E=h.gv,z=h._data,V=b.icons,A=h.interactiveInfo;A&&(A._38o={});for(var t in V){var f=V[t],v=b.rects[t];if(v){A&&(A._38o[t]=[]);var M=yk(f.opacity,z,E),S=yk(f.names,z,E),x=S?S.length:0,n=v.rotation;if(M!=Q){var U=T.globalAlpha;T.globalAlpha*=M}for(var C=0;x>C;C++){var L=S[C],O=Bj(L),R=v[C];if(n){var P=R.x+R.width/2,Y=R.y+R.height/2;T.save(),Hk(T,P,Y),wm(T,n),Hk(T,-P,-Y)}A&&A._38o[t].push(T.interactiveInfo={compInfos:[],matrix:n?new je(n,P,Y).appendTranslate(-P,-Y):new je});var I=Vb;Vb=t,_m(T,O,yk(f.stretch,z,E),R.x,R.y,R.width,R.height,h._data,h.gv),Vb=I,T.interactiveInfo=Q,n&&T.restore()}M!=Q&&(T.globalAlpha=U)}}}}});var no=function(c,p){rd(no,this,[c,p])};eq(no,Mp,{_checkEmptyRect:!0,_40O:function(g,z){var i=this,A=i.s,C=g.rect;(g.borderColor=i.gv.getBorderColor(i._data))&&(g.borderType=A("border.type"),g.borderWidth=A("border.width"),g.borderPadding=A("border.padding"),z=f(z,g.borderPadding+g.borderWidth/2));var R=i._data.getScale(),Z=f(1,f(D(R.x),D(R.y)));if(g.selectWidth=i.getSelectWidth()){var N=i.gv._zoom;g.selectType=A("select.type"),g._97o=i.getSelectColor(),g.selectPadding=A("select.padding"),z=f(z,(g.selectPadding+g.selectWidth/2/N)/Z)}z>0&&(z*=Z,C=be(C),ae(C,z)),i._68o(C)},_39O:function(L,G){var g,K=this,d=G.rect;if(G.borderWidth>0&&(g=G.borderPadding,L.strokeStyle=G.borderColor,L.lineWidth=G.borderWidth,Un(L,G.borderType,{x:d.x-g,y:d.y-g,width:d.width+2*g,height:d.height+2*g}),L.stroke()),G.selectWidth>0){var z=K.gv._zoom;if(g=G.selectPadding,L.strokeStyle=G._97o,L.lineWidth=G.selectWidth/z,G.rotation!=Q){L.save(),L.translate(G.position.x,G.position.y),L.rotate(G.rotation);var n=K._data,q=n.getWidth(),e=n.getHeight(),E=G.scale,k=G.anchor;d={x:E.x*-q*k.x,y:E.y*-e*k.y,width:E.x*q,height:E.y*e}}Un(L,G.selectType,{x:d.x-g,y:d.y-g,width:d.width+2*g,height:d.height+2*g}),G.rotation!=Q&&L.restore(),L.stroke()}},dispose:function(){var l=this,f=l._htmlView;no.superClass._3O.call(l),f&&(f.onHTMLRemoved&&f.onHTMLRemoved(),hg(f))},_3O:function(){var W,w=this,I=w.s,R=w._data,v=w.gv,n=v.getShape(R),q=w.getBodyColor(),Z=I("shape.border.color"),M=w._83o=n?{shape:n,_53o:w.getBodyColor("shape.background"),_27Q:Bj(I("shape.repeat.image"),q),shapeGradientPack:I("shape.gradient.pack"),shapeBorderGradientPack:I("shape.border.gradient.pack"),_54o:I("shape.border.width"),_55o:Z,shapeBorderRepeatImage:Bj(I("shape.border.repeat.image"),Z),_56o:I("shape.border.3d"),_57o:I("shape.border.3d.color"),_58o:I("shape.border.3d.accuracy"),shapeGradient:I("shape.gradient"),_59o:I("shape.gradient.color"),_60o:I("shape.border.pattern"),_61o:I("shape.border.cap"),_62o:I("shape.border.join"),shapeForeground:I("shape.foreground"),bodyColor:q,gray:I("2d.gray")}:{img:Bj(v.getImage(R),q),bodyColor:q,gray:I("2d.gray"),stretch:I("image.stretch")},g=M.img;g&&g.renderHTML?(w._htmlInfo&&w._htmlInfo.img!==g&&(w._htmlInfo=Q),w._htmlInfo||(w._htmlInfo={img:g,cache:{}}),W=g.renderHTML(R,v,w._htmlInfo.cache)):w._htmlInfo=Q,w._htmlView&&w._htmlView!==W&&(w._htmlView.onHTMLRemoved&&w._htmlView.onHTMLRemoved(),hg(w._htmlView.getView?w._htmlView.getView():w._htmlView)),(w._htmlView=W)&&v.appendHTML(W)&&(W.onHTMLAddedSync&&W.onHTMLAddedSync(),W.onHTMLAdded&&Pq(W.onHTMLAdded)),M.rect=R.getRect(),M.position=R.p(),M.scale=R.getScale(),M.anchor=R.getAnchor(),M.rotation=R.getRotation(),n===Lm&&(M._63o=I("shape.depth"));var G=0;if(n)G=Yq(Q,M._54o/2,M._62o),w.s("shape.dash")&&(G=f(G,(w.s("shape.dash.width")||M._54o)/2));else if(g&&g.boundExtend)if(G=yk(g.boundExtend,R,v),g.boundExtendAbsolute){var B=R.getScale();G/=v._zoom*f(1,f(D(B.x),D(B.y)))}else if(!yk(g.fitSize,R,v)){var S=yk(g.width,R,v),l=yk(g.height,R,v);G*=f(R.getWidth()/S,R.getHeight()/l)}w._40O(M,G);var u=es(R,v.isSelected(R)),L=I("clip.percentage");if(1>L&&(0>L&&(L=0),M.clipRect=jm(R.getAnchorRect(),I("clip.direction"),L,u)),n){var d=I("shape.fill.clip.percentage");1>d&&(0>d&&(d=0),M.shapeClipRect=jm(R.getAnchorRect(),I("shape.fill.clip.direction"),d,u));var c=I("shape.foreground.clip.percentage");1>c&&(0>c&&(c=0),M.shapeForegroundClipRect=jm(R.getAnchorRect(),I("shape.foreground.clip.direction"),c,u))}},getPosition:function(P,d,b,V){var y=$l(P,this._83o.rect,V);return y.x+=d,y.y+=b,y},_80o:function(e){var $=this,K=$.s,t=$.gv,p=$._data,J=$._83o,X=J.rect,Y=J.position,c=J.rotation,y=J.anchor,r=J.scale,Z=J.shape,N=J.clipRect;if(!$._checkEmptyRect||X.width>0&&X.height>0){var v=p.getSize();if(v.x=-v.width*y.x,v.y=-v.height*y.y,Yo&&!yb&&Hk(e,v.width,v.height),e.save(),Hk(e,Y.x,Y.y),wm(e,c),Xc(e,r.x,r.y),N&&(e.beginPath(),e.rect(N.x,N.y,N.width,N.height),e.clip()),t._drawForChecking&&J.img&&yk(J.img.pixelPerfect,p,t)===!1)uj(e,v.x,v.y,v.width,v.height,"#888888");else if($.freeDraw)$.freeDraw(e,v,J);else if(Z){var I,E,q,_,M=J._60o,D=Zc(e,M),j=J._27Q,f=J._54o,h=J.shapeGradientPack,U=J.gray,a=e.lineJoin,R=e.lineCap,d=function(f){return U?C.toGrayColor(f):f};"roundRect"===Z?I=K("shape.corner.radius"):"polygon"===Z?I=K("shape.polygon.side"):"arc"===Z&&(I=K("shape.arc.from"),E=K("shape.arc.to"),q=K("shape.arc.close"),_=K("shape.arc.oval")),e.lineJoin=J._62o,e.lineCap=J._61o;var w=d(J._53o);if(w||j||h){var B=J.shapeClipRect;B&&(e.save(),e.beginPath(),e.rect(B.x,B.y,B.width,B.height),e.clip()),Un(e,Z,v,I,E,q,_),h?Bo(e,h,function(m){return ac(m,J.bodyColor)},!1,v):j?Pp(e,j,d(J.bodyColor),null,p,t):qc(e,w,J.shapeGradient,d(J._59o),v),e.fill(),h&&e.restore(),B&&e.restore(),e!==D&&Un(D,Z,v,I,E,q,_)}else Un(D,Z,v,I,E,q,_);var u=J.shapeForeground;if(u){e.save();var n=J.shapeForegroundClipRect;n&&(e.beginPath(),e.rect(n.x,n.y,n.width,n.height),e.clip()),Un(e,Z,v,I,E,q,_),qc(e,u,K("shape.foreground.gradient"),d(K("shape.foreground.gradient.color")),v),e.fill(),e.restore()}if(f>0){var s=K("shape.border.width.absolute");s&&(e.save(),e.setTransform(1,0,0,1,0,0)),e.lineWidth=f;var x=d(J._55o),O=J.shapeBorderGradientPack;O?Bo(e,O,d,!0,v):J.shapeBorderRepeatImage?kg(e,J.shapeBorderRepeatImage,x,null,p,t):e.strokeStyle=x,e.stroke(),O&&e.restore(),s&&e.restore(),J._56o&&oq(e,x,d(J._57o),f,t._zoom,J._58o)}if(Lb(e,M),K("shape.dash")){var m=K("shape.dash.width")||f;if(m>0){M=K("shape.dash.pattern");var D=Zc(e,M,$._2Q("shape.dash.offset"));D!==e&&Un(D,Z,v,I,E,q,_),$._1Q(e,"shape",m,M)}}Hm(e,w,J._63o,v),e.lineJoin=a,e.lineCap=R}else{var G=$.interactiveInfo;G&&(e.interactiveInfo=G.bodyInfo={compInfos:[],matrix:new je(c,Y.x,Y.y,r.x,r.y)}),J.gray&&(e.compGray=!0);var H=J.img;H&&H.cacheRule!=Q&&(H=hk(e,H,J.stretch,v.width,v.height,p,t,J.bodyColor)),_m(e,H,J.stretch,v.x,v.y,v.width,v.height,p,t,J.bodyColor),e.compGray=!1,e.interactiveInfo=Q}e.restore()}$._39O(e,J)},_48O:function(){},_47O:function(){}});var ws=function(S,Z){rd(ws,this,[S,Z])},Li=function(T,_,t,h){var k=Ki(T,_);return t=h?F(t,k):Mi(t,k),k?t/=k:t=0,{x:T.x+(_.x-T.x)*t,y:T.y+(_.y-T.y)*t}};eq(ws,Mp,{_3O:function(){var R,d=this,S=d._data,$=d.gv,z=d.s,T=z(jo),p=S.isLooped(),N=z("edge.width"),B=d.getBodyColor("edge.color"),q=z("edge.center"),H=z("edge.offset"),W=$.getBorderColor(S),n=W?z("border.width"):0,M=d.getSelectWidth(),Y=S._40I,Z=S._41I,g=d._78o=Y&&Z?{looped:p,type:T,width:N,center:q,color:B,repeatImage:Bj(z("edge.repeat.image"),B),borderColor:W,borderWidth:n,_97o:M?d.getSelectColor():Q,selectWidth:M,pattern:z("edge.pattern"),cap:z("edge.cap"),join:z("edge.join"),is3d:z("edge.3d"),_67o:z("edge.3d.color"),_66o:z("edge.3d.accuracy"),gray:z("2d.gray")}:Q;if(g){var l=C.getEdgeType(T);if(l){var D=l(S,fd(d,$,S,p,T),$,d._19Q);D.points&&D.points.size()>1?(g.edgeTypeInfo=D,R=Tl(g.edgeTypeInfo.points)):D[ul]&&D.rect&&(g.edgeTypeInfo=D,R=D.rect)}else{var F=z("edge.source.anchor.x"),J=z("edge.source.anchor.y"),v=z("edge.target.anchor.x"),i=z("edge.target.anchor.y"),m=Ih($,S,"source"),o=Ih($,S,"target");if(T===Hl){var P=g.points=z(Dj)||Xm,V=P.size();g.segments=z("edge.segments");var r=F!==_||J!==_||hn(Y),w=v!==_||i!==_||hn(Z);if(!q)if(H)r||(m=Li(m,V?P.get(0):o,H,V)),w||(o=Li(o,V?P.get(V-1):m,H,V));else{var u;r||(u=Bn(m,V?P.get(0):o,Zl($,Y)),u&&(m={x:u[0],y:u[1]})),w||(u=Bn(V?P.get(V-1):m,o,Zl($,Z)),u&&(o={x:u[0],y:u[1]}))}R=em(Tl(g.points),Tl(m,o))}else{var X=fd(d,$,S,p,T);if(d._19Q||(X=-X),p)m=be(m),m.x=$.getNodeRect(Y).x,g.radius=X,R={x:m.x-X,y:m.y-X,width:2*X,height:2*X};else{var t=Ki(m,o),I=Mi(H,t),x={x:I,y:X},U={x:t-I,y:X},c=mf(o.y-m.y,o.x-m.x),O=g.mat=new td(c);if(g.orienAngle=c,g.angle=o.x<m.x?c+e:c,g.rect={x:x.x,y:x.y,width:U.x-x.x,height:0},g.origin=m,x=O.tf(x),x.x+=m.x,x.y+=m.y,U=O.tf(U),U.x+=m.x,U.y+=m.y,q){var L={x:t,y:0};L=O.tf(L),L.x+=m.x,L.y+=m.y,R=Tl([m,x,U,L]),g.c1=m,g.c2=L}else R=Tl(x,U);m=x,o=U}}g.sourcePoint=m,g.targetPoint=o,S._lastSourcePoint=m,S._lastTargetPoint=o}var j=0;z("edge.dash")&&(j=z("edge.dash.width")||N);var h="square"===g.cap?.71:.5;Yq(R,f(j*h,N*h+n+M),g.join),d._68o(R)}},getRotation:function(E,k,i){E=E||0;var w=this._78o;if(w){var q,I=w.angle,B=w.points,J=w.edgeTypeInfo;if(I!=Q)return k?w.orienAngle+E:I+E;if(J&&J[ul])return J.getRotation?J.getRotation(this,E,k,i):0;if(J&&J.points){var P=J.points;return q=P.size(),xe[i]?q&&0===q%2?Ad(P.get(q/2-1),P.get(q/2),k,E):E:Ir[i]?Ad(P.get(0),P.get(1),k,E):Ad(P.get(q-2),P.get(q-1),k,E)}if(B)return q=B.size(),xe[i]?q&&0===q%2?Ad(B.get(q/2-1),B.get(q/2),k,E):E:Ir[i]?Ad(w.sourcePoint,q?B.get(0):w.targetPoint,k,E):Ad(q?B.get(q-1):w.sourcePoint,w.targetPoint,k,E)}return E},getPosition:function(y,r,F,Q,j){var R=this._78o;if(R){var I,V=R.type,q=R.points,e=R.edgeTypeInfo,$=R.sourcePoint,K=R.targetPoint;if(!V)return R.looped?{x:$.x-R.radius+r,y:$.y+F}:(j&&$&&K&&($.x>K.x||$.x===K.x&&$.y>K.y)&&(y=Sf[y],F=-F),I=$l(y,R.rect,Q),I.x+=r,I.y+=F,I=R.mat.tf(I),I.x+=R.origin.x,I.y+=R.origin.y,I);if(e&&e[ul])return e.getPosition?e.getPosition(this,y,r,F,Q,j):{x:($.x+K.x)/2,y:($.y+K.y)/2};if(q){var I,k=q.size();if(xe[y]){if(k){var u=k%2;if(0===u)return Fh(q.get(k/2-1),q.get(k/2),y,r,F,Q,j);I=q.get((k-u)/2)}else I={x:($.x+K.x)/2,y:($.y+K.y)/2};return I=$l(y,{x:I.x,y:I.y,width:0,height:0},Q),I.x+=r,I.y+=F,I}return Ir[y]?Fh($,k?q.get(0):K,y,r,F,Q,j):Fh(k?q.get(k-1):$,K,y,r,F,Q,j)}if(e){var M=e.points,k=M.size();if(xe[y]){var u=k%2;return 0===u?Fh(M.get(k/2-1),M.get(k/2),y,r,F,Q,j):(I=M.get((k-u)/2),I=$l(y,{x:I.x,y:I.y,width:0,height:0},Q),I.x+=r,I.y+=F,I)}return Ir[y]?Fh(M.get(0),M.get(1),y,r,F,Q,j):Fh(M.get(k-2),M.get(k-1),y,r,F,Q,j)}}return Tm},_42:function(Q){this._78o&&ws.superClass._42.call(this,Q)},drawPath:function(F,l){F.beginPath();var v=l.type,s=l.points,D=l.segments,$=l.edgeTypeInfo;if(!v||s){var i=l.sourcePoint,V=i.x,I=i.y,P=l.targetPoint,Q=P.x,A=P.y;if(v)if(D){var W=new Qd({x:V,y:I});W.addAll(s),W.add({x:Q,y:A}),Yc(F,W,D)}else F.moveTo(V,I),s.each(function(T){F.lineTo(T.x,T.y)}),F.lineTo(Q,A);else l.looped?F.arc(V,I,l.radius,0,Z,!0):l.center?(F.moveTo(l.c1.x,l.c1.y),F.lineTo(V,I),F.lineTo(Q,A),F.lineTo(l.c2.x,l.c2.y)):(F.moveTo(V,I),F.lineTo(Q,A))}else $&&($.points?Yc(F,$.points,$.segments):$[ul]&&$[ul](F,$))},_80o:function(l){var E=this,a=E.s,J=E._78o,e=J.width,o=J.selectWidth,H=J.borderWidth,q=J.repeatImage,t=l.lineJoin,B=l.lineCap,P=J.gray,i=J.pattern;
l.lineJoin=J.join,l.lineCap=J.cap,E.drawPath(Zc(l,i),J);var G=a("edge.width.absolute");G&&(l.save(),l.setTransform(1,0,0,1,0,0)),o&&(l.strokeStyle=J._97o,l.lineWidth=e+2*(H+o),l.stroke()),H&&(l.strokeStyle=P?C.toGrayColor(J.borderColor):J.borderColor,l.lineWidth=e+2*H,l.stroke());var m=P?C.toGrayColor(J.color):J.color;if(q?kg(l,q,m,null,E._data,E.gv):l.strokeStyle=m,l.lineWidth=e,l.stroke(),J.is3d){var s=P?C.toGrayColor(J._67o):J._67o;oq(l,m,s,e,E.gv._zoom,J._66o)}if(Lb(l,i),a("edge.dash")){i=a("edge.dash.pattern");var U=Zc(l,i,E._2Q("edge.dash.offset"));U!==l&&E.drawPath(U,J),E._1Q(l,"edge",a("edge.dash.width")||e,i)}G&&l.restore(),l.lineJoin=t,l.lineCap=B},_48O:function(){},_47O:function(){}});var Mo=function(G,A){rd(Mo,this,[G,A])};eq(Mo,no,{_3O:function(){var k,Z,S=this,z=S.s,q=S._data,x=S.gv;if(S._88I=Q,q.isExpanded()&&q.eachChild(function(T){if(Je(T)){var C=x.getBoundsForGroup(T);C&&(Z||(Z=[]),Z.push(C),k=em(k,C))}}),k){var u=x.getLabel(q),c=z("group.type"),G=z("group.border.width")||0,m=z("group.border.width.absolute"),F=G/2;m&&(G/=x._zoom),k=uo(c,Z,k),ng(k,q,"group.padding",1),ae(k,G);var B=S._88I={type:c,rect:k,_64o:k};if(!c&&u!=Q){var j,n=S.labelInfo={label:u,color:z("group.title.color"),font:z("group.title.font"),align:z("group.title.align")},v=Yd(n,u),Y=v.width+G,a=v.height+G,J=z("group.title.align"),X=z("group.title.orientation");if(X===Ui||X===nl?(k.height+=G,Y>k.width&&(k.width=Y)):(X===Mh||X===Xi)&&(k.width+=G,Y>k.height&&(k.height=Y)),j=J===Mh?k.x:J===Xi?k.x+k.width-Y:k.x+k.width/2-Y/2,X===nl)B.titleRect={x:k.x,y:k.y+k.height,width:k.width,height:a},B.rect={x:k.x,y:k.y,width:k.width,height:k.height+a},n.rect={x:j,y:k.y+k.height,width:Y,height:a};else if(X===Mh){var R=B.titleRect={x:k.x-a,y:k.y,width:a,height:k.height};B.rect={x:k.x-a,y:k.y,width:k.width+a,height:k.height},n.rect={x:R.x+a/2-k.height/2,y:R.y+k.height/2-a/2,width:k.height,height:a},n.rotation=-Math.PI/2}else if(X===Xi){var R=B.titleRect={x:k.x+k.width,y:k.y,width:a,height:k.height};B.rect={x:k.x,y:k.y,width:k.width+a,height:k.height},n.rect={x:R.x+a/2-k.height/2,y:R.y+k.height/2-a/2,width:k.height,height:a},n.rotation=Math.PI/2}else B.titleRect={x:k.x,y:k.y-a,width:k.width,height:a},B.rect={x:k.x,y:k.y-a,width:k.width,height:k.height+a},n.rect={x:j,y:k.y-a-F,width:Y,height:a+G}}S._40O(B,z("group.border.width")/2)}else Mo.superClass._3O.call(S)},getPosition:function(B,D,d,n){var x=this._88I;if(x){var w=$l(B,x.rect,n);return w.x+=D,w.y+=d,w}return Mo.superClass.getPosition.apply(this,arguments)},_24O:function(R,J){var k=this._88I;(!k||k.type||"label2"===R)&&Mo.superClass._24O.call(this,R,J)},_80o:function(P){var x=this,H=x._88I;if(H){var y=x._data,V=x.s,r=x.gv,c=H.type,l=H.rect,O=H._64o,q=H.titleRect,$=x.getBodyColor(),z=Bj(V("group.image"),$),R=V("group.image.stretch"),M=x.getBodyColor("group.background"),F=Bj(V("group.repeat.image"),$),N=V("group.gradient.pack"),X=V("group.gradient"),m=V("group.gradient.color"),s=V("group.border.width"),C=V("group.border.color"),J=V("group.border.pattern"),v=V("group.title.orientation"),I=V("group.depth"),k=V("group.border.radius"),a=V("group.border.join"),S=V("group.border.cap"),t=V("group.border.width.absolute");t&&(s/=r._zoom);var j=C,U=V("group.border.repeat.image");if(U&&(U=Bj(U,C))&&(j=Nk(P,U,C,null,y,r)),c){var n=P.lineJoin,_=P.lineCap;if(P.lineJoin=a,P.lineCap=S,z){if(P.save(),Un(P,c,l,k),P.clip(),_m(P,z,R,l.x,l.y,l.width,l.height,y,r,$),P.restore(),s>0){var A=Zc(P,J);Un(A,c,l,k),P.lineWidth=s,P.strokeStyle=j,P.stroke(),Lb(P,J)}}else{var A=Zc(P,J);M||F||N?(Un(P,c,l,k),N?Bo(P,N,function(h){return ac(h,$)},!1,l):F?Pp(P,F,$,null,y,r):qc(P,M,X,m,l),P.fill(),N&&P.restore(),P!==A&&Un(A,c,l,k)):Un(A,c,l,k),s>0&&(P.lineWidth=s,P.strokeStyle=j,P.stroke()),Lb(P,J),c===Lm&&Hm(P,M,I,l)}P.lineJoin=n,P.lineCap=_}else{var Q=V("group.title.background");if((!k||0>k)&&(k=0),z)_m(P,z,R,O.x,O.y,O.width,O.height,y,r,x.getBodyColor());else if(M||F)if(F?Pp(P,F,$,null,y,r):qc(P,M,X,m,O),0===s)Un(P,Lm,O),P.fill(),Hm(P,M,I,O);else{switch(P.beginPath(),v){case nl:nn(P,O.x,O.y,O.width,O.height,k,k,0,0);break;case Mh:nn(P,O.x,O.y,O.width,O.height,0,k,0,k);break;case Xi:nn(P,O.x,O.y,O.width,O.height,k,0,k,0);break;case Ui:nn(P,O.x,O.y,O.width,O.height,0,0,k,k)}P.fill()}if(q&&Q)if(0===s)uj(P,q.x,q.y,q.width,q.height,Q),Hm(P,Q,I,q);else{switch(P.beginPath(),P.fillStyle=Q,v){case nl:nn(P,q.x,q.y,q.width,q.height,0,0,k,k);break;case Mh:nn(P,q.x,q.y,q.width,q.height,k,0,k,0);break;case Xi:nn(P,q.x,q.y,q.width,q.height,0,k,0,k);break;case Ui:nn(P,q.x,q.y,q.width,q.height,k,k,0,0)}P.fill()}if(s>0){var A=Zc(P,J);if(Un(A,"roundRect",l,k),P.save(),P.lineWidth=s,P.strokeStyle=j,P.lineJoin=a,P.lineCap=S,P.closePath(),P.stroke(),q&&V("group.splitLine")){var o=q.x,D=q.y,B=q.width,g=q.height;P.beginPath(),v===nl?(P.moveTo(o,D),P.lineTo(o+B,D)):v===Mh?(P.moveTo(o+B,D),P.lineTo(o+B,D+g)):v===Xi?(P.moveTo(o,D),P.lineTo(o,D+g)):(P.moveTo(o,D+g),P.lineTo(o+B,D+g))}P.stroke(),P.restore(),Lb(A,J)}}x._39O(P,H)}else Mo.superClass._80o.call(x,P)}});var Ph=function(Q,Z){rd(Ph,this,[Q,Z])};eq(Ph,no,{_80o:function(I){this._39O(I,this._83o)}});var dc=function(t,v){rd(dc,this,[t,v])};eq(dc,no,{_3O:function(){var h=this,I=h._data,G=h.s,b=h.gv,v=I.getPoints(),X=b.getBorderColor(I),R=X?G("border.width"):0,y=h.getSelectWidth(),x=G("shape.border.width"),M=I.getRect(),z=I.getAnchorRect(),U=b.getBodyColor(I),m=G("shape.border.color"),e=h._99o=v.isEmpty()?Q:{rect:M,rotation:I.getRotation(),fillRule:G("shape.fill.rule"),scale:I.getScale(),position:I.p(),points:v,segments:I.getSegments(),bodyColor:U,borderColor:X,borderWidth:R,_94o:G("shape.border.3d"),_95o:G("shape.border.3d.color"),_96o:G("shape.border.3d.accuracy"),_97o:y?h.getSelectColor():Q,selectWidth:y,_53o:G("shape.background"),_27Q:Bj(G("shape.repeat.image"),U),shapeGradientPack:G("shape.gradient.pack"),shapeBorderGradientPack:G("shape.border.gradient.pack"),_54o:x,_55o:m,shapeBorderRepeatImage:Bj(G("shape.border.repeat.image"),m),shapeGradient:G("shape.gradient"),_59o:G("shape.gradient.color"),_60o:G("shape.border.pattern"),_61o:G("shape.border.cap"),_62o:G("shape.border.join"),shapeForeground:G("shape.foreground"),gray:G("2d.gray")};if(e){z.x+=e.position.x,z.y+=e.position.y,e.gradientRect=z;var c=I.getScale(),H=f(1,f(D(c.x),D(c.y)));G("shape.dash")&&G("shape.dash.width")>x&&(x=G("shape.dash.width"));var Z,P=G("shape.border.width.absolute");Z=P?(x+R+y)/h.gv._zoom/H:x*("square"===e._61o?.71:.5)+R+y/h.gv._zoom/H,Z&&(Z*=H,M=be(M),Yq(M,Z,e._62o)),h._68o(M);var l=es(I,b.isSelected(I)),B=G("clip.percentage");1>B&&(0>B&&(B=0),e.clipRect=jm(I.getAnchorRect(),G("clip.direction"),B,l));var o=G("shape.fill.clip.percentage");1>o&&(0>o&&(o=0),e.shapeClipRect=jm(I.getAnchorRect(),G("shape.fill.clip.direction"),o,l));var $=G("shape.foreground.clip.percentage");1>$&&(0>$&&($=0),e.shapeForegroundClipRect=jm(I.getAnchorRect(),G("shape.foreground.clip.direction"),$,l))}},getPosition:function(C,x,E,e){var B=this._99o;if(B){var w=$l(C,B.rect,e);return w.x+=x,w.y+=E,w}return Tm},_42:function(l){this._99o&&dc.superClass._42.call(this,l)},_80o:function(T){var l,j=this,d=j.s,E=j._99o,r=E.position,w=E.scale,x=E.rotation,g=E.borderWidth,z=E.selectWidth/j.gv._zoom,S=E._27Q,L=E.shapeGradientPack,f=E._54o,J=E.clipRect,W=E.shapeClipRect,v=E.points,D=E.segments,A=j._data.isClosePath(),P=E.fillRule,V=E.gray,$=function(j){return V?C.toGrayColor(j):j},m=$(E._53o),c=m||S||L;T.save(),Hk(T,r.x,r.y),wm(T,x),Xc(T,w.x,w.y),J&&(T.beginPath(),T.rect(J.x,J.y,J.width,J.height),T.clip()),c&&W&&(T.save(),T.beginPath(),T.rect(W.x,W.y,W.width,W.height),T.clip()),b.Default.extractShapeTranslation?(v=be(v),v.forEach(function(o){o.x-=r.x,o.y-=r.y})):Hk(T,-r.x,-r.y);var X=E._60o,k=Zc(T,X),q=T.lineJoin,Z=T.lineCap;T.lineJoin=E._62o,T.lineCap=E._61o;var o=$(E.bodyColor);c?(Yc(T,v,D,A),L?Bo(T,L,function(s){return ac(s,E.bodyColor)},!1,E.rect):S?Pp(T,S,o,null,j._data,j.gv):(l=o?o:m,qc(T,l,E.shapeGradient,$(E._59o),E.gradientRect)),T.fill(P),L&&T.restore(),W&&(T.restore(),Hk(T,-r.x,-r.y)),k!==T&&Yc(k,v,D,A)):Yc(k,v,D,A);var B=E.shapeForeground;if(B){T.save();var K=E.shapeForegroundClipRect;K&&(Hk(T,r.x,r.y),T.beginPath(),T.rect(K.x,K.y,K.width,K.height),T.clip(),Hk(T,-r.x,-r.y)),Yc(T,v,D,A),qc(T,B,d("shape.foreground.gradient"),$(d("shape.foreground.gradient.color")),E.gradientRect),T.fill(P),T.restore()}var u=d("shape.border.width.absolute");if(u&&(T.save(),T.setTransform(1,0,0,1,0,0)),z&&(T.strokeStyle=E._97o,T.lineWidth=f+2*(g+z),T.stroke()),g&&(T.strokeStyle=$(E.borderColor),T.lineWidth=f+2*g,T.stroke()),f){l=$(E._55o);var p=E.shapeBorderGradientPack;p?Bo(T,p,$,!0,E.rect):E.shapeBorderRepeatImage?kg(T,E.shapeBorderRepeatImage,l,null,j._data,j.gv):(!m&&o&&(l=o),T.strokeStyle=l),T.lineWidth=f,T.stroke(),p&&T.restore(),E._94o&&oq(T,l,$(E._95o),f,j.gv._zoom,E._96o)}if(Lb(T,X),d("shape.dash")){var s=d("shape.dash.width")||f;if(s>0){X=d("shape.dash.pattern");var k=Zc(T,X,j._2Q("shape.dash.offset"));k!==T&&Yc(k,v,D,A),j._1Q(T,"shape",s,X)}}u&&T.restore(),T.lineJoin=q,T.lineCap=Z,T.restore()},_48O:function(){},_47O:function(){}});var ii=function(R,p){rd(ii,this,[R,p])};eq(ii,dc,{getRotation:function(k,e,U){k=k||0;var q=this._data.getPoints(),H=q.size();return H>1?xe[U]?H&&0===H%2?Ad(q.get(H/2-1),q.get(H/2),e,k):k:Ir[U]?Ad(q.get(0),q.get(1),e,k):Ad(q.get(H-2),q.get(H-1),e,k):k},getPosition:function(w,t,V,l,i){var H=this._data.getPoints(),Q=H.size();if(Q>1){if(xe[w]){var M=Q%2;if(0===M)return Fh(H.get(Q/2-1),H.get(Q/2),w,t,V,l,i);var z=H.get((Q-M)/2),a={x:z.x,y:z.y,width:0,height:0};return z=$l(w,a,l),z.x+=t,z.y+=V,z}return Ir[w]?Fh(H.get(0),H.get(1),w,t,V,l,i):Fh(H.get(Q-2),H.get(Q-1),w,t,V,l,i)}return Tm}});var So=function(l,Q){rd(So,this,[l,Q])};eq(So,no,{_3O:function(){var r=this;So.superClass._3O.call(r);var P=r.s,l=r._83o;r._82o=l.img||l.shape?Q:{background:r.getBodyColor("grid.background"),depth:P("grid.depth"),rect:l.rect,_88o:P("grid.cell.depth"),cellBorderColor:P("grid.cell.border.color"),_89o:P("grid.row.count"),_90o:P("grid.column.count"),block:P("grid.block"),_91o:P("grid.block.color"),_92o:P("grid.block.padding"),_93o:P("grid.block.width")}},_80o:function(X){var N=this,Z=N._82o;if(!Z)return So.superClass._80o.call(N,X),void 0;var j,I,r=N._data,G=Z.background,M=Z.rect,d=Z.block,g=Z._91o,Y=Z._92o,p=Z._93o,h=Z._88o,f=Z.cellBorderColor,i=Z._89o,t=Z._90o;if(G)if(uj(X,M.x,M.y,M.width,M.height,G),Hm(X,G,Z.depth,M),h)for(j=0;i>j;j++)for(I=0;t>I;I++)M=r.getCellRect(j,I),M&&Hm(X,G,h,M);else if(f){for(X.beginPath(),j=0;i>j;j++)for(I=0;t>I;I++)M=r.getCellRect(j,I),M&&X.rect(M.x,M.y,M.width,M.height);X.strokeStyle=f,X.lineWidth=1,X.stroke()}if("h"===d)for(j=0;i>j;j++)M=em(r.getCellRect(j,0),r.getCellRect(j,t-1)),ae(M,Y),Xn(X,g,M.x,M.y,M.width,M.height,p);else if("v"===d)for(I=0;t>I;I++)M=em(r.getCellRect(0,I),r.getCellRect(i-1,I)),ae(M,Y),Xn(X,g,M.x,M.y,M.width,M.height,p);N._39O(X,N._83o)}});var Jh=function(l,A){rd(Jh,this,[l,A])};eq(Jh,no,{_checkEmptyRect:!1,_81o:function(){var T=this._data,u=Jh.superClass._81o.call(this),k=T.s("text");if(k!=Q){var l,c,r=T.s("text.font"),O=T.s("text.align"),i=T.s("text.vAlign"),e=lr(r,k),E=e.width,C=e.height,Y=T.getAnchor(),X=T.getWidth(),H=T.getHeight();"left"===O?l=-X*Y.x:"center"===O?l=-X*Y.x+(X-E)/2:"right"===O&&(l=X*(1-Y.x)-e.width),"top"===i?c=-H*Y.y:"middle"===i?c=-H*Y.y+(H-C)/2:"bottom"===i&&(c=H*(1-Y.y)-e.height);var R,M=T.getMatrix();if(R=Tl([M.tf(l,c),M.tf(l+E,c),M.tf(l+E,c+C),M.tf(l,c+C)]),u=em(u,R),u&&T.s("text.shadow")){var S=be(u);S.x+=T.s("text.shadow.offset.x"),S.y+=T.s("text.shadow.offset.y"),ae(S,T.s("text.shadow.blur")),u=em(u,S)}}return u}});var vc=sl.Interactor=function(m){this.gv=this._graphView=m};Go("Interactor",x,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(m){this.gv.fi(m)},setCursor:function(M){Ap||this.gv.setCursor(M)},startDragging:function(m){var l=this;l._lastClientPoint=Hf(m),l._lastLogicalPoint=l.gv.lp(m),Td(l,m)},clearDragging:function(){var T=this;T._lastClientPoint=T._lastLogicalPoint=T._logicalPoint=Q},autoScroll:function(B){return this.gv.autoScroll(B,this._lastClientPoint)}});var pd=Q,vd=function(S){pd.handleWindowTouchMove(S)},oe=function($){pd.handleWindowTouchEnd($),R(B,He,vd),R(B,Rr,oe),pd=Q},Pr=function(A){pd.handleWindowMouseMove(A)},ko=function(i){pd.handleWindowMouseUp(i),R(B,rl,Pr),R(B,Tk,ko),pd=Q},de=function(Q,x){if(Q!==pd){var b=rq(x);pd?b?pd.handleWindowTouchEnd(x):pd.handleWindowMouseUp(x):b?(W(B,He,vd),W(B,Rr,oe)):(W(B,rl,Pr),W(B,Tk,ko)),pd=Q}},Cn=function(L){var P=this;P.gv=L,P._is2d=L instanceof sl.GraphView,P._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",_e,"wheel"].forEach(function(J){P.addListener(J)}),P.initImageResource()};eq(Cn,vc,{enableVR:function(O){var B=this;!!B._vrEnable!==O&&(B._vrEnable=O,O?B.gv.vr.mp(B.onVRControllerChange,B):B.gv.vr.ump(B.onVRControllerChange,B))},onVRControllerChange:function(e){var L=this,n=e.property,X=e.newValue,G=X.id,a=L.gv.vr.getController(G),E=a.getRay();if(E){E.controllerId=G;var Q=L.gv.vr.getRayEventType(E,n,X._62O);switch(Q){case"down":L.handle_mousedown(E);break;case"up":pd&&ko(E);break;case"move":L.handle_mousemove(E),pd&&L.handleWindowMouseMove(E)}}},setPreventEventDefault:function(P,A){var u=this,c=u._eventListeners[P];c?c._prevent=A:u._eventListeners[P]=c={_removal:_,_prevent:A}},removeListener:function(U){var h=this,c=h._eventListeners[U];c&&c._removal&&(c._removal(),c._removal=_)},addListener:function(j){var i=this,h=i._eventListeners[j];if(h||(i._eventListeners[j]=h={_removal:_,_prevent:!0}),!h||!h._removal){var D=function(F){h._prevent&&C.preventDefault(F),i.disabled||i.gv._48Q||("wheel"===j?Nd(i,F):i["handle_"+j](F))};W(i.gv.getView(),j,D),h._removal=function(){R(i.gv.getView(),j,D)}}},handleWindowTouchMove:function(I){this.handleWindowMouseMove(I)},handleWindowMouseMove:function(Z){return!this.downInfo||rq(Z)&&1!==xm(Z)?(this.isDragging&&(this.handleDownInfo("onEndDrag",Z),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",Z):(this.handleDownInfo("onBeginDrag",Z),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(Y){this.handleWindowMouseUp(Y)},handleWindowMouseUp:function($){if(this.isDragging&&(this.handleDownInfo("onEndDrag",$),this.isDragging=!1),this.downInfo){var l=this.handle("onUp",$);if(l&&l.data===this.downInfo.data){this.handleMissingUp($);var j=this,X=2===$.button?"onContextMenu":"onClick";if(!j._dbclickTimer)return j._dbclickTimer=Eg(function(){delete j._dbclickTimer,j.handleClick($,X,l),this.downInfo=Q},C.clickDelay),void 0;qs(j._dbclickTimer),delete j._dbclickTimer,X="onDoubleClick",j.handleClick($,X,l)}else this.handleDownInfo("onUp",$);this.downInfo=Q,this.downComps=Q}},handle_mouseleave:function(H){var b=this,o=b.gv;b._hoverTimer&&(qs(b._hoverTimer),delete b._hoverTimer);var D=b.currentInfo?b.currentInfo.data:Q;if(D){D.s("onLeave")&&D.s("onLeave")(H,D,o),b.fire("data","onLeave",H,D);var T=b.currentInfo?b.currentInfo.hits:Q;if(T)for(var Z in T)b.handleLeave(H,Z);b.currentInfo=Q}},handle_mousewheel:function(c){c.scrollDelta=c.wheelDelta/40,this.handle("onScroll",c)},handle_DOMMouseScroll:function(I){I.scrollDelta=2===I.axis?-I.detail:0,this.handle("onScroll",I)},handle_touchstart:function(m){this.handle_mousedown(m)},handle_touchmove:function(H){this.handle("onMove",H)},handle_mousedown:function(p){this.isDragging&&(this.handleDownInfo("onEndDrag",p),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",p),this.downInfo&&de(this,p)},handle_mousemove:function(H){var D=this,r=D.gv;if(D._hoverTimer&&(qs(D._hoverTimer),delete D._hoverTimer),!r._panning&&!r._moving){var z,T,U,_=D.handle("onMove",H),f=this.currentInfo?this.currentInfo.data:Q,e=this.currentInfo?this.currentInfo.hits:Q;if(_&&(T=_.data,U=_.hits,D._hoverTimer=Eg(function(){qs(D._hoverTimer),delete D._hoverTimer,D.handle("onHover",H,_)},r.getHoverDelay()||C.hoverDelay)),T!==f){if(f&&(f.s("onLeave")&&f.s("onLeave")(H,f,r),this.fire("data","onLeave",H,f)),T&&(T.s("onEnter")&&T.s("onEnter")(H,T,r),this.fire("data","onEnter",H,T)),e)for(z in e)this.handleLeave(H,z);if(U)for(z in U){var V=U[z],l=T._interactPrefix=V.prefix,k=l&&T.a(l+"onEnter")||V.target.onEnter;k&&k.call(V.target,H,T,r,V.point,V.width,V.height),this.fire(V.type,"onEnter",V.event,V.data,V.image,V.comp,V.point,V),T._interactPrefix=null}}else{if(e)for(z in e)U&&U[z]||this.handleLeave(H,z);if(U)for(z in U)if(!e||!e[z]){var V=U[z],l=T._interactPrefix=V.prefix,k=l&&T.a(l+"onEnter")||V.target.onEnter;k&&k.call(V.target,H,T,r,V.point,V.width,V.height),this.fire(V.type,"onEnter",V.event,V.data,V.image,V.comp,V.point,V),T._interactPrefix=null}}this.currentInfo=_}},handle:function(V,z,c){var s,n=this,e=n.gv;if(n._is2d){if(c=c||e.getDataInfoAt(z),!c||!e.isInteractive(c.data))return;if(s=c.ui.interactiveInfo){var Q,l=c.data;if(l.s(V)&&l.s(V)(z,l,e),this.fire("data",V,z,l),"body"===c.part&&s.bodyInfo)Q="body",c.hits=this.handleImage(Q,e.getImage(l),V,z,l,c.point,s.bodyInfo);else if("icons"===c.part&&s._38o){var N=s._38o[c.name];N&&N[c.index]&&(Q="icons|"+c.name+"|"+c.index,c.hits=this.handleImage(Q,c.icon,V,z,l,c.point,N[c.index]))}}return c}var l,m;if(!c)if(z&&z instanceof b.Math.Ray&&e.isVREnabled()){var d=e.vr.intersectWorld(z);if(l=d.data,m=d.intersect,e.vr.renderRayDuringInteraction(z,l,m),!l)return;var R=e.getData3dUI(l);if(s=R.interactiveInfo,!s)return;c={data:l,part:m.part,ui:R}}else{if(c=e.getDataInfoAt(z),!c)return;c&&(c={data:c.data,part:c.part})}if(e.isInteractive(c.data)){if(!m){l=c.data;var R=e.getData3dUI(l);if(c.ui=R,s=R.interactiveInfo,!s)return c;if(m=e.intersectObject(z,l),!m)return c}l.s(V)&&l.s(V)(z,l,e),this.fire("data",V,z,l);var Y,q=m.part;return"body"!==q&&(Y=l.s(q+".image")||l.s("shape3d."+q+".image")),Y||(Y=l.s("all.image")||l.s("shape3d.image")),Y?(s="object"==typeof Y?s[Y.uuid]:s[Y],s&&s.bodyInfo?(c.part="body",c.interactiveInfo=s,c.point=this._convertUVToPoint(m.uv,s),c.image=Y,c.hits=this.handleImage("body",Y,V,z,l,c.point,s.bodyInfo),c):c):c}},_handleLeaveOrMissing:function(B,J,S){var m="leave"===B?this.currentInfo:this.downInfo;if(m){var f=m.interactiveInfo||m.ui.interactiveInfo;if(f){var X,p,D=m.data;if(this._is2d){if(p=this.gv.lp(J),"body"===m.part&&f.bodyInfo)X="body","leave"===B?this.handleLeaveImage(S,X,this.gv.getImage(D),J,D,p,f.bodyInfo):this.handleMissingUpImage(X,this.gv.getImage(D),J,D,p,f.bodyInfo);else if("icons"===m.part&&f._38o){var G=f._38o[m.name];G&&G[m.index]&&(X="icons|"+m.name+"|"+m.index,"leave"===B?this.handleLeaveImage(S,X,m.icon,J,D,p,G[m.index]):this.handleMissingUpImage(X,m.icon,J,D,p,G[m.index]))}}else{if(!f.bodyInfo)return;var W=this.gv.intersectObject(J,D);p=W&&W.uv?this._convertUVToPoint(W.uv,f):{x:1/0,y:1/0},"leave"===B?this.handleLeaveImage(S,"body",m.image,J,D,p,f.bodyInfo):this.handleMissingUpImage("body",m.image,J,D,p,f.bodyInfo)}}}},handleClick:function(O,m,F){var K=this,e=this.downInfo;if(e&&F){var k,G=F.interactiveInfo||F.ui.interactiveInfo,L=F.data,g=this.gv;if(L.s(m)&&L.s(m)(O,L,g),K.fire("data",m,O,L),G)if(this._is2d){if(e.part===F.part){var y=g.lp(O);"body"===F.part&&G.bodyInfo&&(k="body",this.handleClickImage(k,g.getImage(L),m,O,L,y,G.bodyInfo,F))}}else{if(!G.bodyInfo)return;var s=g.intersectObject(O,L);if(!s)return;y=this._convertUVToPoint(s.uv,G),this.handleClickImage("body",e.image,m,O,L,y,G.bodyInfo,F)}}},handleDownInfo:function(j,K){if(this.downInfo){var I=this.downInfo,s=this.gv,U=I.interactiveInfo||I.ui.interactiveInfo;if(U){var m,G=I.data;if(G.s(j)&&G.s(j)(K,G,s),this.fire("data",j,K,G),this._is2d){var x=s.lp(K);if("body"===I.part&&U.bodyInfo)m="body",this.handleDownInfoImage(m,s.getImage(G),j,K,G,x,U.bodyInfo);else if("icons"===I.part&&U._38o){var p=U._38o[I.name];p&&p[I.index]&&(m="icons|"+I.name+"|"+I.index,this.handleDownInfoImage(m,I.icon,j,K,G,x,p[I.index]))}}else{if(!U.bodyInfo)return;var v;if("onBeginDrag"===j?(v=s._raycaster.intersectObjectAndRecordTriangle(K,G),v&&(U.beginDragIntersectInfo=v.triangleInfo)):v=s.intersectObject(K,G),!v&&("onDrag"!==j&&"onEndDrag"!==j||!U.beginDragIntersectInfo||(v=s._raycaster.intersectLastTriangle(K,U.beginDragIntersectInfo)),!v))return;x=this._convertUVToPoint(v.uv,U),this.handleDownInfoImage("body",I.image,j,K,G,x,U.bodyInfo)}}}},fire:function(C,v,I,W,z,Z,O,y){this.gv.fi({kind:v,type:C,event:I,data:W,image:z,comp:Z,view:this.gv,point:O,width:y?y.width:_,height:y?y.height:_})},handleImage:function(I,E,z,h,y,n,C){var v={};if(E&&(E=Bj(E))){var j=this.gv,Z=C.rect,V=this.convertPoint(n,C);V.inRect&&(E[z]&&E[z](h,y,j,V,Z.width,Z.height),this.fire("image",z,h,y,E,_,V,Z),v[I+"|image"]={target:E,type:"image",image:E,data:y,event:h,point:V,width:Z.width,height:Z.height});for(var d,Q=C.compInfos,c=E,b=Q.length-1;b>=0;b--){var o=Q[b],r=o.comp;if(V=this.convertPoint(n,o,c,r,j,y),V.inRect){Z=o.rect;var P=y._interactPrefix=o.prefix,x=P&&y.a(P+z)||r[z];if(x&&(d=x.call(r,h,y,j,V,Z.width,Z.height)),this.fire("comp",z,h,y,E,r,V,Z),d!==!0&&(E=Z.image)&&(E[z]&&(d=E[z](h,y,j,V,Z.width,Z.height)),this.fire("image",z,h,y,E,_,V,Z)),y._interactPrefix=null,v[I+"|"+b]={target:r,type:"comp",comp:r,image:E,data:y,event:h,point:V,width:Z.width,height:Z.height,prefix:P},this.downComps&&this.downComps.push(r),E&&(v[I+"|"+b+"|image"]={target:E,type:"image",image:E,data:y,event:h,point:V,width:Z.width,height:Z.height,prefix:P}),d===!0)break}}}return v},handleLeave:function(u,f){return this._handleLeaveOrMissing("leave",u,f)},handleMissingUp:function(g){return this._handleLeaveOrMissing("missing",g)},handleLeaveImage:function(N,n,f,s,E,b,M){if(f&&(f=Bj(f))){var $=this.gv,e=M.rect,H=this.convertPoint(b,M);N===n+"|image"&&(f.onLeave&&f.onLeave(s,E,$,H,e.width,e.height),this.fire("image","onLeave",s,E,f,_,H,e));for(var r,L=M.compInfos,X=f,V=L.length-1;V>=0;V--){var o=L[V],T=o.comp;H=this.convertPoint(b,o,X,T,$,E),e=o.rect;var R=E._interactPrefix=o.prefix;if(N===n+"|"+V){var O=R&&E.a(R+"onLeave")||T.onLeave;O&&(r=O.call(T,s,E,$,H,e.width,e.height)),this.fire("comp","onLeave",s,E,f,T,H,e)}if(r!==!0&&(f=e.image)&&N===n+"|"+V+"|image"&&(f.onLeave&&(r=f.onLeave(s,E,$,H,e.width,e.height)),this.fire("image","onLeave",s,E,f,_,H,e)),E._interactPrefix=null,r===!0)break}}},handleMissingUpImage:function(r,w,y,W,F,f){var g="onUp",v=this.downInfo.hits;if(v&&w&&(w=Bj(w))){var E=this.gv,j=f.rect,c=this.convertPoint(F,f);!c.inRect&&v[r+"|image"]&&(w[g]&&w[g](y,W,E,c,j.width,j.height),this.fire("image",g,y,W,w,_,c,j));for(var m,e=f.compInfos,G=w,h=e.length-1;h>=0;h--){var Q=e[h],b=Q.comp;if(c=this.convertPoint(F,Q,G,b,E,W),!c.inRect){j=Q.rect;var C=W._interactPrefix=Q.prefix;if(v[r+"|"+h]){var T=C&&W.a(C+g)||b[g];T&&(m=T.call(b,y,W,E,c,j.width,j.height)),this.fire("comp",g,y,W,w,b,c,j)}if(m!==!0&&(w=j.image)&&v[r+"|"+h+"|image"]&&(w[g]&&(m=w[g](y,W,E,c,j.width,j.height)),this.fire("image",g,y,W,w,_,c,j)),W._interactPrefix=null,m===!0)break}}}},handleDownInfoImage:function(u,W,v,C,k,Y,I){var n=this.downInfo.hits;if(n&&W&&(W=Bj(W))){var f=this.gv,P=I.rect,m=this.convertPoint(Y,I);n[u+"|image"]&&(W[v]&&W[v](C,k,f,m,P.width,P.height),this.fire("image",v,C,k,W,_,m,P));for(var F,Q=I.compInfos,B=W,i=Q.length-1;i>=0;i--){var t=Q[i],S=t.comp;m=this.convertPoint(Y,t,B,S,f,k),P=t.rect;var x=k._interactPrefix=t.prefix,K=["onDrag","onEndDrag"].indexOf(v)>=0;if(!K&&n[u+"|"+i]||K&&this.downComps&&this.downComps.indexOf(S)>=0){var b=x&&k.a(x+v)||S[v];b&&(F=b.call(S,C,k,f,m,P.width,P.height)),this.fire("comp",v,C,k,W,S,m,P)}if(F!==!0&&(W=P.image)&&n[u+"|"+i+"|image"]&&(W[v]&&(F=W[v](C,k,f,m,P.width,P.height)),this.fire("image",v,C,k,W,_,m,P)),k._interactPrefix=null,F===!0)break}}},handleClickImage:function(P,V,p,l,C,T,M,$){var U=this.downInfo.hits,x=$.hits;if(U&&V&&(V=Bj(V))){var E=this.gv,d=M.rect,f=this.convertPoint(T,M);U[P+"|image"]&&(V[p]&&V[p](l,C,E,f,d.width,d.height),this.fire("image",p,l,C,V,_,f,d));for(var r,n=M.compInfos,j=V,H=n.length-1;H>=0;H--){var J=n[H],h=J.comp;f=this.convertPoint(T,J,j,h,E,C),d=J.rect;var O=C._interactPrefix=J.prefix;if(U[P+"|"+H]&&x[P+"|"+H]){var u=O&&C.a(O+p)||h[p];u&&(r=u.call(h,l,C,E,f,d.width,d.height)),this.fire("comp",p,l,C,V,h,f,d)}if(r!==!0&&(V=d.image)&&U[P+"|"+H+"|image"]&&(V[p]&&(r=V[p](l,C,E,f,d.width,d.height)),this.fire("image",p,l,C,V,_,f,d)),C._interactPrefix=null,r===!0)break}}},initImageResource:function(){C.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(O,M){if(!O)return{x:1/0,y:1/0};var $=M.bodyInfo.rect,y=O.clone(),n=O.multiply({x:$.width,y:$.height});return n.local=y,n},convertPoint:function(T,g,z,d,u,A){var E=g.rect,M=g.matrix.applyInverse(T).sub(E),q=M.x>=0&&M.y>=0&&M.x<=E.width&&M.y<=E.height;if(!q)return M;if(d&&yk(d.pixelPerfect,A,u)){var E,S=1;this._is2d?(S=u.getZoom(),E=Hq(T.x,T.y,_,S)):E=Hq(T.x,T.y);var y=!1,L=E.x,X=E.y,U=E.width,s=E.height,O=C.hitMaxArea,p=U*s*S*S;if(p>O){var N=Math.sqrt(O/p);S*=N}U*=S,s*=S,2>U&&(U=2),2>s&&(s=2),L*=S,X*=S;var e=gl(U,s),I=new je(0,-L,-X,S,S);I.append(g.matrix),u._drawForChecking=!0,d.transform=I;var i=z.fitSize;g.refRect&&g.refRect.fitSize?(d.refRect=g.refRect,z.fitSize=!0):z.fitSize=!1;var w=z.comps;z.comps=[d],Bs(e,z,0,0,U,s,A,self),z.comps=w,z.fitSize=i,delete d.refRect,delete d.unionRect,delete d.transform,u._drawForChecking=!1;try{for(var n=0,F=e.getImageData(0,0,U,s).data;n<F.length;n+=4)if(0!==F[n+3]){y=!0;break}e.restore()}catch(Y){Qk=Q,y=!1}M.inRect=y}else M.inRect=!0;return M}});var xl=sl.DefaultInteractor=function(f){rd(xl,this,[f])};Go("DefaultInteractor",vc,{handle_mousedown:function(z){zq(z);var v=this,$=v.gv,w=$.getDataAt(z);if($.setFocus(z)&&!$._editing&&!$._scrolling){Mq(z)?$.handleDoubleClick(z,w):$.handleClick(z,w);var A=iq(z);!Uq()&&!A&&w&&($.isMovable(w)||$._39Q(w))||!$.isPannable()||!Do(z)&&!A||Kp(z)||(v._tx=$.tx(),v._ty=$.ty(),v.startDragging(z))}},handleWindowMouseUp:function(W){var B=this,y=B.gv;y._panning&&(delete y._panning,y.onPanEnded(),B.fi({kind:"endPan",event:W})),delete B._tx,delete B._ty,B.clearDragging()},handle_mousemove:function(F){var i=this,g=i.gv;i._hoverTimer&&(qs(i._hoverTimer),delete i._hoverTimer),i._hoverTimer=Eg(function(){i.fi({kind:"hover",event:F}),qs(i._hoverTimer),delete i._hoverTimer},g.getHoverDelay()||C.hoverDelay)},handle_mouseleave:function(){var i=this;i._hoverTimer&&(qs(i._hoverTimer),delete i._hoverTimer)},handleWindowMouseMove:function(L){var a=this,s=a.gv;a.fi({kind:s._panning?"betweenPan":"beginPan",event:L}),s._panning=1;var Z=cp(s,L,a._lastClientPoint);s.setTranslate(a._tx+Z.x,a._ty+Z.y)},handle_mousewheel:function(x){this.gv.handleScroll(x,x.wheelDelta)},handle_DOMMouseScroll:function(m){2===m.axis&&this.gv.handleScroll(m,-m.detail)},handle_keydown:function(m){this.gv.handleKeyDown(m)}});var qd=sl.SelectInteractor=function(e){rd(qd,this,[e])};Go("SelectInteractor",vc,{_42:function(){var M=this,b=M.gv,v=b.getZoom(),E=M.mark,W=M.div;W||(W=M.div=jc(),zk(M.getView(),W));var B={};B.x=E.x*v+b.tx(),B.y=E.y*v+b.ty(),B.width=E.width*v,B.height=E.height*v,xg(W,B),this.intersects()?(W.style.border="",W.style.background=b.getRectSelectBackground()):(W.style.background="",W.style.border="1px solid "+b.getRectSelectBorderColor())},handle_mousedown:function(v){var I=this,X=I.gv;if(I._57I=Q,I.pendingClickThrough=Q,!(X._editing||X._scrolling||Uq()||iq(v))){var t=X.getDataAt(v),O=X.sm();t?Kp(v)?O.co(t)?O.rs(t):O.as(t):O.co(t)?t instanceof Ri&&t.isClickThroughEnabled()&&Do(v)&&(I.pendingClickThrough=Hf(v)):O.ss(t):Kp(v)||!X.isPannable()?Do(v)&&(Kp(v)||O.cs(),X.isRectSelectable()&&(I.startDragging(v),X._77O=1)):Do(v)&&(I._57I=Hf(v))}},handle_mouseup:function(p){var V=this,o=V.gv,Y=V._57I;if(Y&&(Ki(Y,Hf(p))<=1&&o.sm().cs(),V._57I=Q),V.pendingClickThrough){if(Ki(V.pendingClickThrough,Hf(p))<=1){var I=o.getDataAt(p);if(I instanceof Ri&&I.isClickThroughEnabled()){var S=o.getDataAt(p,function(O){var n=O.getParent()===I&&o.isSelectable(O,!0);return n});S&&(p.clickThrough=!0,o.sm().ss(S))}}V.pendingClickThrough=Q}},handleWindowMouseUp:function(Q){this.clear(Q)},handleWindowMouseMove:function(V){var x=this,B=x.gv;x._logicalPoint=B.lp(V),x.mark?(x.fi({kind:"betweenRectSelect",event:V}),B.isPannable()&&x.autoScroll(V),x.redraw()):x.fi({kind:"beginRectSelect",event:V}),x.mark=Tl(x._lastLogicalPoint,x._logicalPoint),x.redraw()},intersects:function(){var Y=this,V=Y._lastLogicalPoint,z=Y._logicalPoint;return V.x>z.x||V.y>z.y},clear:function(d){var i=this,L=i.gv,S=i.mark;if(i._57I=Q,i.pendingClickThrough=Q,i._lastLogicalPoint){if(S){if(0!==S.width&&0!==S.height){var J=L.getDatasInRect(S,i.intersects());if(!J.isEmpty()){var T=L.sm(),f=T.toSelection(),P=Xf(d),W=d.altKey;J.each(function(E){T.co(E)?(!P||P&&W)&&f.remove(E):(!W||P&&W)&&f.add(E)}),T.ss(f)}}hg(i.div),delete i.div,delete i.mark,i.redraw(),i.fi({kind:"endRectSelect",event:d}),L.onRectSelectEnded()}i.clearDragging(),delete L._77O}},redraw:function(){var m=this;m._draw||(m._draw=1,Eg(function(){m.mark&&m._42(),delete m._draw},16))}});var _r=sl.MoveInteractor=function(G){rd(_r,this,[G])};Go("MoveInteractor",vc,{handle_mousedown:function(E){var h=this,j=h.gv;if(Do(E)&&!j._editing&&!j._scrolling&&!Uq()){var b=j.getSelectedDataAt(E);!b||j._39Q(b)&&!j.isMovable(b)?j._focusData=Q:(h._data=b,j.handleMouseDown&&j.handleMouseDown(E,b),h.startDragging(E),j.isMovable(b)&&(j._moving=1))}},handleWindowMouseUp:function(l){var G=this,B=G.gv;B.handleMouseUp&&B.handleMouseUp(l,G._data),G.clear(l)},handleWindowMouseMove:function(n){var f=this,t=f._data,x=f.gv;if((!x._93O||!x._93O(n,t))&&x._moving){f._logicalPoint||f.fi({kind:"prepareMove",event:n});var Y=f._logicalPoint?"betweenMove":"beginMove",s={kind:Y,event:n},S=f._logicalPoint=x.lp(n);"beginMove"!==Y||f._alreadyBeginTransaction||(f._alreadyBeginTransaction=!0,x.getDataModel().beginTransaction());var y=f._calcShift(Y,n),l=y.x,B=y.y,Z=f.gv.getMoveMode(n,t);Z&&("x"===Z?B=0:"y"===Z?l=0:"xy"!==Z&&(l=B=0)),x.moveSelection(l,B),f._lastLogicalPoint=S,f.autoScroll(n),f.fi(s)}},_calcShift:function(){var X=this,s=X._logicalPoint,h=X._lastLogicalPoint,O=s.x-h.x,G=s.y-h.y;return{x:O,y:G}},clear:function(a){var Y=this,x=Y.gv;Y._lastLogicalPoint&&(Y._lastLogicalPoint=Y._data=x._moving=Q,Y._logicalPoint&&(Y.fi({kind:"endMove",event:a}),x.onMoveEnded()),Y.clearDragging()),Y._alreadyBeginTransaction&&(Y._alreadyBeginTransaction=!1,x.getDataModel().endTransaction())}});var Eb=sl.TextEditInteractor=function(c){rd(Eb,this,[c]),this.init()};Go("TextEditInteractor",vc,{init:function(){var o=this,$=this.input=L.createElement("input"),g=$.style;$.text="text",g.border="1px solid #d8d8d8",g.position="absolute",g.padding="2px 3px",g.outline="none",g.marginLeft="-90px",g.marginTop="-16px",g.backgroundColor="rgba(255,255,255, 0.9)",g.fontSize="14px",g.width="180px",g.height="32px",g.boxShadow="0 0 13px rgba(16,142,233, 0.5)",g.textAlign="center",g.boxSizing="border-box",W($,"keyup",function(s){Ud(s)&&o.endTextEdit()}),W($,"focus",function(){$.select()});var Z=this.textarea=L.createElement("textarea"),e=this.wrap=L.createElement("div");e.appendChild(Z),g=Z.style,g.margin=0,g.padding="4px",g.overflow="hidden",g.boxSizing="border-box",g.position="absolute",g.outline="none",g.backgroundColor="transparent",g.resize="none",g.textAlign="center",g.fontSize="14px",g.border="none",g.borderWidth=0,g.width="100%",g.top="50%",g=e.style,g.boxSizing="border-box",g.margin=0,g.padding=0,g.position="absolute",g.boxShadow="0 0 13px rgba(16,142,233, 0.5)",g.border="1px solid #d8d8d8",g.backgroundColor="rgba(255,255,255, 0.9)",g.width="180px",g.marginLeft="-90px",W(Z,"keydown",function(n){return(Xf()||Kp())&&Ud(n)?(o.endTextEdit(),void 0):(o.calculateTextareaHeight(String.fromCharCode(n.keyCode)),void 0)}),W(Z,"focus",function(){Z.select()});var v=function(d){d.stopPropagation()};W($,"mousedown",v),W($,"touchstart",v),W(Z,"mousedown",v),W(Z,"touchstart",v),o.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],o.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",o.handleWindowClick=function(d){var q=o._editingDOM;
if(q){var h=q.getBoundingClientRect(),e=Hf(d);Om(h,e)||o.endTextEdit()}}},handle_mousedown:function(V){var Y=this,L=Y.gv;if(Mq(V)&&!L._editing){var k=L.getDataAt(V);if(k){var E=L.getTextEditInfo(k);E&&(this._editInfo=E,this._editTarget=k,L._editing=!0,E.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var j=this,$=j.gv,v=j._editTarget,f=j.getTargetValue(),O=j.textarea,F=j.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===f||f===_)&&(f=""),O.value=f,j._editingDOM=O,$.getView().appendChild(F),this.layoutHTML(F,v),this.calculateTextareaHeight(),Eg(function(){O.focus(),W(B,"mousedown",j.handleWindowClick),W(B,"touchstart",j.handleWindowClick)},10)},handleTextEdit:function(){var k=this,C=k.gv,c=k._editTarget,S=k.getTargetValue(),r=k.input;(null===S||S===_)&&(S=""),r.value=S,k._editingDOM=r,C.getView().appendChild(r),this.layoutHTML(r,c),Eg(function(){r.focus(),W(B,"mousedown",k.handleWindowClick),W(B,"touchstart",k.handleWindowClick)},10)},layoutHTML:function(p,y){var w=this.gv,i=w.getZoom();if(y instanceof b.Node){var n=y.getRect(),u=Math.min(Math.max(100,n.width*i),800);p.style.left=(n.x+n.width/2)*i+w.tx()+"px",p.style.top=(n.y+n.height/2)*i+w.ty()+"px",p.style.width=u+"px",p.style.marginLeft=-u/2+"px"}else if(y instanceof b.Edge){var I=w.getDataUI(y),n=I._6I;p.style.left=(n.x+n.width/2)*i+w.tx()+"px",p.style.top=(n.y+n.height/2)*i+w.ty()+"px"}},endTextEdit:function(){var f=this,t=f._editInfo.isMultiline?f.wrap:f.input,g=f._editInfo.isMultiline?f.textarea:f.input;f.setTargetValue(g.value),f.gv.getView().removeChild(t),f.gv._editing=!1,delete f._editingDOM,R(B,"mousedown",f.handlelick),R(B,"touchstart",f.handleWindowClick)},setTargetValue:function(i){var S=this,T=S._editTarget,$=S._editInfo,w=$.accessType,y=$.name;if(y&&w||(w="p",y="name"),"p"===w){var K=b.Default.setter(y);T[K](i)}else"a"===w?T.a(y,i):T.s(y,i)},getTargetValue:function(){var K=this,Z=K._editTarget,v=K._editInfo,d=v.accessType,I=v.name;if(I&&d||(d="p",I="name"),"p"===d){var T=b.Default.getter(I);return Z[T]()}return"a"===d?Z.a(I):Z.s(I)},createHiddenTextarea:function(){this.hiddenTextarea=L.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(X,P){if(P&&this.computedStyleCache)return this.computedStyleCache;var a=this,C=B.getComputedStyle(X),T=C.getPropertyValue("box-sizing")||C.getPropertyValue("-moz-box-sizing")||C.getPropertyValue("-webkit-box-sizing"),y=parseFloat(C.getPropertyValue("padding-bottom"))+parseFloat(C.getPropertyValue("padding-top")),D=parseFloat(C.getPropertyValue("border-bottom-width"))+parseFloat(C.getPropertyValue("border-top-width")),z=a.SIZING_STYLE.map(function(B){return B+":"+C.getPropertyValue(B)}).join(";"),G={sizingStyle:z,paddingSize:y,borderSize:D,boxSizing:T};return P&&(this.computedStyleCache=G),G},calculateTextareaHeight:function(u){u=u||"";var F=this,Y=F.textarea,z=F.hiddenTextarea,j=F.wrap,O=32,o=F.calculateHTMLStyle(Y,!1),p=o.paddingSize,V=o.borderSize,M=o.boxSizing,g=o.sizingStyle;z.setAttribute("style",g+";"+F.HIDDEN_TEXTAREA_STYLE),z.value=Y.value+u;var i=z.scrollHeight;"border-box"===M?i+=V:"content-box"===M&&(i-=p),Y.style.height=i+"px",Y.style.marginTop=0-.5*i+"px",j.style.height=Math.max(i,O)+"px",j.style.marginTop=i*-.5+"px"}});var gq=sl.ScrollBarInteractor=function(X){rd(gq,this,[X])};Go("ScrollBarInteractor",vc,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(F){var Q=this.gv.getViewRect();return this._41o()&&(Q.x+Q.width-this.gv.lp(F).x)*this.gv.getZoom()<oc},isH:function(R){var Z=this.gv.getViewRect();return this._40o()&&(Z.y+Z.height-this.gv.lp(R).y)*this.gv.getZoom()<oc},handle_mousemove:function(e){this.handle_touchmove(e)},handle_touchmove:function(H){if(!xf&&Do(H)&&this.gv.isScrollBarVisible()){var u=this,r=u.isV(H),z=u.isH(H);(r||z)&&u.gv.showScrollBar(),u.gv._scrolling=r||z}},handleWindowMouseUp:function(U){this.handleWindowTouchEnd(U)},handleWindowTouchEnd:function(_){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=Q,this.fi({kind:"endScroll",event:_})},handle_mousedown:function(s){this.handle_touchstart(s)},handle_touchstart:function(Z){var w=this;if(w.gv.setFocus(Z),zq(Z),w.handle_touchmove(Z),!(xm(Z)>1)&&w.gv._scrolling&&w.gv.isScrollBarVisible()){w._cp=Hf(Z),w._tx=w.gv.tx(),w._ty=w.gv.ty();var s=w.isV(Z);w._state=s?"vScroll":"hScroll",Td(w,Z),w.fi({kind:"beginScroll",event:Z})}},handleWindowMouseMove:function(Y){this.handleWindowTouchMove(Y)},handleWindowTouchMove:function(e){var N=Hf(e),F=this.gv.getViewRect(),E=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-N.y)*E.height/F.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-N.x)*E.width/F.width),this.fi({kind:"betweenScroll",event:e})}});var db=sl.TouchInteractor=function(O,z){z=z||{},z.selectable===_&&(z.selectable=!0),z.movable===_&&(z.movable=!0),z.pannable===_&&(z.pannable=!0),z.pinchable===_&&(z.pinchable=!0),z.editable===_&&(z.editable=!0),this.params=z,rd(db,this,[O])};Go("TouchInteractor",vc,{ms_edit:1,setUp:function(){var O=this;db.superClass.setUp.call(O),Ap&&O.params.editable&&O.gv.setEditInteractor(O)},tearDown:function(){var P=this;db.superClass.tearDown.call(P),Ap&&P.params.editable&&P.gv.setEditInteractor(Q)},clear:function(S){var i=this,G=i.gv;G._moving&&(i.fi({kind:"endMove",event:S}),delete G._moving,G.onMoveEnded(),G.dm().endTransaction()),G._panning&&(i.fi({kind:"endPan",event:S}),delete G._panning,G.onPanEnded()),G._pinching&&(i.fi({kind:"endPinch",event:S}),delete G._pinching,G.onPinchEnded()),G._editing&&(i._46O(S),i._77I=i._node=i._edge=i._shape=i._rect=i._89I=i._index=G._editing=Q),i.pendingClickThrough=i._moving=i._panning=i._pinching=i._editing=i._57I=i._data=i._beginHistory=Q,i.clearDragging()},handle_touchstart:function(O){var G=this;if(!G.gv._editing){zq(O),G._57I=Q,G.pendingClickThrough=Q;var N=G.params,t=G.gv,J=t.sm(),S=t.getDataAt(O),f=xm(O);if(1===f){if(Mq(O))return t.handleDoubleClick(O,S),void 0;t.handleClick(O,S),S&&(t.handleMouseDown&&t.handleMouseDown(O,S),G._data=S),N.selectable||(S=Q),S&&(J.co(S)?S instanceof Ri&&S.isClickThroughEnabled()&&(G.pendingClickThrough=Hf(O)):J.ss(S),N.editable&&t.isEditable(S)&&G._79I(O,S,!0)?(G._editing=1,G.startDragging(O)):N.movable&&t.isMovable(S)&&(G._moving=1,G.startDragging(O))),S&&(t.isMovable(S)||t._39Q(S))||(G._57I=Hf(O),N.pannable&&t.isPannable()&&(G._panning=1,G.startDragging(O),G._translate={x:t.tx(),y:t.ty()}))}else if(N.pinchable&&2===f){if(!t.getEditInteractor()&&S){var M=Bj(t.getImage(S));if(M&&yk(M.scrollable,S,this))return}G._pinching=1,G.startDragging(O);var e=t.getView(),j=t.getZoom(),q=e.getBoundingClientRect(),p=O.touches[0],$=O.touches[1],b={x:(p.clientX+$.clientX)/2-q.left,y:(p.clientY+$.clientY)/2-q.top};b.x-=t.tx(),b.y-=t.ty(),b.x/=j,b.y/=j,G._p=b,G._d=Ti(O)}}},handle_touchend:function(U){var R=this,j=R.gv,K=R._57I,c=R._data;if(K&&(Ki(K,Hf(U))<=1&&!j.getDataAt(U)&&j.sm().cs(),R._57I=Q),c&&j.handleMouseUp&&j.handleMouseUp(U,c),R.pendingClickThrough){if(Ki(R.pendingClickThrough,Hf(U))<=1){var c=j.getDataAt(U);if(c instanceof Ri&&c.isClickThroughEnabled()){var Z=j.getDataAt(U,function(t){var B=t.getParent()===c&&j.isSelectable(t,!0);return B});Z&&(U.clickThrough=!0,j.sm().ss(Z))}}R.pendingClickThrough=Q}},handleWindowTouchEnd:function(R){this.clear(R)},handleWindowTouchMove:function($){var d=this,t=d.gv,T=xm($);if(1===T){var W=Hf($),u=cp(t,W,d._lastClientPoint),n=Ki({x:0,y:0},u);if(d._editing&&(d._beginHistory||(d._beginHistory=1,t.dm().beginTransaction()),t._editing=1,d._78I($)),d._moving){if(!t._moving&&n<C.touchMoveThreshold)return;d._beginHistory||(d._beginHistory=1,t.dm().beginTransaction()),d.handleMove($)}else if(d._panning){if(!t._panning&&n<C.touchMoveThreshold)return;t.setTranslate(d._translate.x+u.x,d._translate.y+u.y),d.fi({kind:t._panning?"betweenPan":"beginPan",event:$}),t._panning=1}}else if(2===T&&d._pinching){var D=Ti($);t.handlePinch(d._p,D,d._d),d._d=D,d.fi({kind:t._pinching?"betweenPinch":"beginPinch",event:$}),t._pinching=1}},handleMove:function(V){var M=this,I=M.gv,g=I.lp(V);I._93O&&I._93O(V,M._data)||(I.moveSelection(g.x-M._lastLogicalPoint.x,g.y-M._lastLogicalPoint.y),M._lastLogicalPoint=g,M.autoScroll(V),M.fi({kind:I._moving?"betweenMove":"beginMove",event:V}),I._moving=1)}});var b=B.ht,Ng=b.graph._editor={Math:b.Math,Guide:{}};Ng.getStyle=function(j){var w,L=Ng.StyleMap;return L&&(w=L[j],w!==_)?w:Ng.DefaultStyleMap[j]},Ng.setStyle=function(D,T){var Q=Ng.StyleMap;Q||(Q=Ng.StyleMap={}),Q[D]=T},Ng.inEdit=function(o){return o._inXEdit===!0},Ng.startEdit=function(_){_._inXEdit=!0,Ng.Inject.doInject(_)},Ng._46O=function(X){X._inXEdit=!1,Ng.Inject.undoInject(X)},Ng.toScreenPosition=function(m,W){var q=m.tx(),R=m.ty(),g=m._zoom;return new Ng.Math.Vector2(W.x*g+q,W.y*g+R)},Ng.checkHit=function(N,n,v){return N.distanceTo(n)<v?!0:!1},Ng.toWorldPosition=function(j,d){var G=j.tx(),V=j.ty(),N=j._zoom;return{x:(d.x-G)/N,y:(d.y-V)/N}},Ng.setAntialias=function(H,B){for(var O,s=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],g=0,a=s.length;a>g&&(O=s[g],!(O in H));g++);H[O],H[O]=B},Ng.getTargetCornersOnScreen=function(W,r){if(!r)return null;var A,X=[];if(md(r,W)){var C=Zl(W,r);A=[{x:C.x,y:C.y},{x:C.x+C.width,y:C.y},{x:C.x+C.width,y:C.y+C.height},{x:C.x,y:C.y+C.height}]}else{if(!r.getCorners)return null;A=r.getCorners()}return A.forEach(function(f){var C=Ng.toScreenPosition(W,f);X.push(C.x,C.y)}),X},Ng.log=function(){};var $b=Ng.Inject={_modules:[]};$b.registAsModule=function(T,m){var u={},x={};for(var I in T){var e=m.prototype[I];u[I]=e}T.getBackup=function(l){return u[l]},T.getBackups=function(){return u},x.doInject=function(){for(var P in T)"getBackup"!==P&&(m.prototype[P]=T[P])},x.undoInject=function(){for(var l in T)"getBackup"!==l&&(m.prototype[l]=u[l])},$b._modules.push(x)},$b.doInject=function(O){for(var C,o=$b._modules,R=0,U=o.length;U>R;R++)C=o[R],C.doInject(O)},$b.undoInject=function(H){for(var y,B=$b._modules,g=0,d=B.length;d>g;g++)y=B[g],y.undoInject(H)};var vc=b.graph.EditInteractor=function(B){var f=this,Z=L.createElement("canvas");Z.className="editCanvas",Z.style.position="absolute",f._uuid=b.Math.generateUUID(),f._styleMap={},f._canvas=Z,f._context=Z.getContext("2d"),vc.superClass.constructor.call(f,B),this._editDetail=!1,Ng.setAntialias(f._context,!1),f._subModules=[new Ng.Anchor(f),new Ng.RotateX(f),new Ng.MoveDummy(f),new Ng.Rect(f),new Ng.Curve(f),new Ng.MoveHelper(f)],f._gridGuide=new Ng.Guide.Grid(f),f._rectGuide=new Ng.Guide.Rect(f),f._hoverGuide=new Ng.Guide.Hover(f)},Zb=vc;b.Default.def(vc,b.graph.Interactor,{ms_edit:1,ms_fire:1}),x.defineProperties(vc.prototype,{editDetail:{get:function(){var g=!!this._editDetail;return g},set:function(V){var B=this,L=B._editDetail;L!==V&&(B._editDetail=V,B.gv._editing=V,B.fp("editDetail",L,V),B.fp("pointsEditingMode",L,V),B.fi({kind:V?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function($){(!this._editDetail||$)&&(this.gv._editing=$,$||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function($){this._editing=$,this.gvEditing=$}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(w){var c=this;c.editDetail!==w&&(w?c._tryEnterEditDetailMode():c._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var J=this._gridEnabled;if(!J)return!1;var V=this.gv;return V?!0:!0},set:function(D){D!==this._gridEnabled&&(this._gridEnabled=D,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(Z){Z!==this._agEnabled&&(this._agEnabled=Z,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),vc.prototype.getSubModule=function(R){var E,j,S,m=this._subModules;for(j=0,S=m.length;S>j;j++)if(E=m[j],E.catalog===R)return E},vc.prototype.invokeSubModule=function(e,t){for(var z,n,N,P=this,p=P._subModules,D=Array.prototype.slice.call(arguments,2),E=0,O=p.length;O>E;E++)if(z=p[E],n=z[e],n&&(N=n.apply(z,D),N!=_&&t))return z},vc.prototype.invokeSubModuleInverse=function(H,J){var F=this,u=F._subModules;if(u)for(var t,g,B,o=Array.prototype.slice.call(arguments,2),Y=u.length-1;Y>=0;Y--)if(t=u[Y],g=t[H],g&&(B=g.apply(t,o),B!=_&&J))return t},vc.prototype.setUp=function(){Ng.log("setUp");var _=this,B=_.gv,g=B.getView(),b=_._canvas;vc.superClass.setUp.call(_),B.setEditInteractor(_),B._79O?g.insertBefore(b,B._79O):g.appendChild(b),Ng.startEdit(B),_.invokeSubModule("setUp"),B.dm().mm(_._onDataModelChanged,_),B.dm().md(_._onDataPropertyChanged,_)},vc.prototype.tearDown=function(){Ng.log("tearDown");var P=this,C=P.gv,I=C.getView();P._resetCustomCursorStyle(),vc.superClass.tearDown.call(P),C.dm().umm(P._onDataModelChanged,P),C.dm().umd(P._onDataPropertyChanged,P),C.setEditInteractor(null),I.removeChild(P._canvas),P._drawTimer&&(qs(P._drawTimer),P._drawTimer=null),Ng._46O(C),P.invokeSubModule("tearDown")},vc.prototype._onDataModelChanged=function(i){var e=this;("clear"===i.kind||"remove"===i.kind&&e.editDetail&&i.data===e.getSubModule("Curve").target)&&(e.editDetail=!1,e._42())},vc.prototype._onDataPropertyChanged=function(R){var d=this;if(d.editDetail){var D=d.getSubModule("Curve"),I=R.data;I===D.target&&(I._writing||D._handleDataChanged(R))}},vc.prototype.clear=function(){Ng.log("clear")},vc.prototype.redraw=function(){this._42()},vc.prototype._42=function(){var y=this;y._drawTimer||(y._drawTimer=Eg(function(){y._drawTimer=null,y.drawImpl()},0))},vc.prototype.drawImpl=function(){var j;for(j in{_42:!0})break;return function(){var Q=this,W=Q._canvas,I=Q.gv,c=I.getWidth(),J=I.getHeight(),Y=Q._context,k=b.Default.getInternal(),q=C.devicePixelRatio;(W.width!==c||W.height!==J)&&k.setCanvas(W,c,J,q),Y.clearRect(0,0,W.width,W.height);var K=Q._getValidSelection();Y.save(),Y.scale(q,q),Q._gridGuide._42(),Q.invokeSubModuleInverse(j,!1,Y,I,K),Q._rectGuide._42(),Q._hoverGuide._42(),Y.restore()}}(),vc.prototype._getValidSelection=function(){var R=this,Z=R.gv,X=Z.sm().getSelection(),h=[];return X.each(function(t){Z.isVisible(t)&&Z.isEditable(t)&&h.push(t)}),h},vc.prototype.handle_touchmove=function(p){return this.handle_mousemove(p)},vc.prototype.handle_mousemove=function(M){if(!b.Default.isDragging()){var i=this;if((i.editDetail||!Uq()&&!iq(M))&&!i.gv._externalEditing)if(i.gvEditing=!1,i._checkEdit(M))i.gvEditing=!0;else{if(!i.getStyle("hoverGuideVisible"))return;i.hoverData=i.gv.getDataAt(M),i._42()}}},vc.prototype.handle_touchstart=function(t){return this.handle_mousedown(t)},vc.prototype.handle_mousedown=function(g){zq(g);var E=this;if((E.editDetail||!Uq()&&!iq(g))&&!E.gv._externalEditing){if(Mq(g)&&!g.clickThrough){if(E.editDetail){if(E._tryQuitEditDetailMode(g))return}else if(E._tryEnterEditDetailMode())return;E.gv.dm().beginTransaction();var U=E.invokeSubModule("handleDoubleClick",!0,g);if(E.gv.dm().endTransaction(),U)return}var H=E._checkEdit(g);H&&(E._downPosition=E._getLogicalPoint(g),E.gv.dm().beginTransaction(),H.startEdit(E,g),E.editing=!0)}},vc.prototype._checkEdit=function(r){var M=this,v=M.gv,J=M._getLogicalPoint(r),X=M.invokeSubModule("check",!0,v,r,J)||null;return M._editMod=X,X},vc.prototype.handleWindowTouchMove=function(m){return this.handleWindowMouseMove(m)},vc.prototype.handleWindowMouseMove=function(G){var L=this,h=L._downPosition;if(h){var g=L._getLogicalPoint(G);if(g.distanceTo(h)<L.getStyle("moveSensitivity"))return;delete L._downPosition}var I=L._editMod;I&&I.handleEdit(L.gv,G)},vc.prototype._getLogicalPoint=function(L){var K=this,T=b.Default.getLogicalPoint(L,K._canvas);return new Ng.Math.Vector2(T)},vc.prototype.handleWindowTouchEnd=function(_){return this.handleWindowMouseUp(_)},vc.prototype.handleWindowMouseUp=function(){var J;for(J in{_46O:!0})break;return function(_){var e=this;e.editing=!1,e.setCursor("default"),e.invokeSubModule(J,!1,_),e._42(),e.gv.dm().endTransaction()}}(),vc.prototype.handle_mousewheel=function(B){var O=this;zq(B),O.invokeSubModule("preHandleScroll",!0)||O.gv.handleScroll(B,B.wheelDelta)},vc.prototype.handleDelete=function(){var B=this;if(!B.editDetail){B.gv.dm().beginTransaction();var O=B.invokeSubModule("handleNormalStateDelete",!0);return B.gv.dm().endTransaction(),O||B.gv.removeSelection(),void 0}B.gv.dm().beginTransaction(),B.invokeSubModule("handleDelete",!0),B.gv.dm().endTransaction(),B._42()},vc.prototype.handle_keydown=function($){var e=this;if(($.metaKey||$.ctrlKey)&&e._42(),Uq($)&&!e.editing)return e.gvEditing=!1,e.setCursor("default"),e._42(),void 0;var y=Ud($);return e.editDetail?((y||ol($))&&(e.editDetail=!1,e._42()),e.gv.dm().beginTransaction(),e.invokeSubModule("handle_keydown",!0,$),e.gv.dm().endTransaction(),void 0):(e.gv.dm().beginTransaction(),e.invokeSubModule("handleNormalStateKeyDown",!0,$),e.gv.dm().endTransaction(),y&&e._tryEnterEditDetailMode(),void 0)},vc.prototype.handle_keyup=function(N){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,N),this.gv.dm().endTransaction()},vc.prototype._tryEnterEditDetailMode=function(){var q=this;return!q.editDetail&&q.invokeSubModule("canEnterEditDetailMode",!0)&&1===q._getValidSelection().length?(q.editDetail=!0,q._42(),!0):void 0},vc.prototype._tryQuitEditDetailMode=function(n){var _=this;return _.editDetail?!n||_.invokeSubModule("canQuitEditDetailMode",!0,n)?(_.editDetail=!1,_._42(),!0):!1:!1},vc.prototype.setStyle=function(T,d,q){var E=this;q?Ng.setStyle(T,d):E._styleMap[T]=d,"baseColor"===T&&(Hb=d),E.fp("styleChanged",null,{key:T,value:d,base:q}),E._42()},vc.prototype.getStyle=function(V){var h=this,F=h._styleMap[V];return F!==_?F:Ng.getStyle(V)},vc.prototype.setCursor=function(X){this._resetCustomCursorStyle(),b.graph.EditInteractor.superClass.setCursor.call(this,X)},vc.prototype._drawHostGuide=function(n){var B=this,e=B._context,q=B.gv;Ng.Icons.DrawIcon(B,e,Ng.Icons.NodeHoverGuide,n.corners);var b=n.host;if(b){var D=q.getAttachPoints(b);if(D&&D.length)for(var c=0,M=D.length;M>c;c++){var g=D[c],j=Lp(q,b,0,g.offsetX||0,g.offsetY||0,g.x,g.y);j=Ng.toScreenPosition(q,j),j.isAttach=n.attach===c,Ng.Icons.DrawIcon(B,e,Ng.Icons.AttachPoint,j)}}},vc.prototype._resetCustomCursorStyle=function(){var j=this;if(j._customStyle){var e=this.gv.getView();e.classList&&e.classList.remove&&e.classList.remove(j._customStyle),j._customStyle=null}},vc.prototype._setRotateCursor=function(n){var t=this,S=t._cursorFactory;S||(S=t._cursorFactory=new Ng.CursorFactory(t));var F=S.getRotateCursor(n),c=t.gv.getView();t._resetCustomCursorStyle(),t._customStyle=F,c.classList&&c.classList.add&&c.classList.add(F)};var nj=Ng.Group=function(D){var P=this;P._entities=D,P._64O=0,P._position={x:0,y:0},P._scale={x:1,y:1},P._anchor={x:.5,y:.5},P._anchor2={x:.5,y:.5}};nj.prototype={},nj.prototype.constructor=nj;var tl=null,ip=null;nj.findOrCreateGroup=function(W,c){if(ip===c&&tl&&tl.checkIsMe(W))return tl;ip=c;var P=new Ng.Group(W);return P.getKeyOb()?(tl=P,P):void 0},nj.prototype.checkIsMe=function(c){var B=this._entities;if(B.length!==c.length)return!1;var C,X={},e=c.length;for(C=0;e>C;C++)X[c[C]._id]=!0;for(C=0;e>C;C++)if(!X[B[C]._id])return!1;return!0},nj.prototype.getRotation=function(){return this._64O},nj.prototype.getPosition=function(){return this._position},nj.prototype.getAnchor=function(){return this._anchor},nj.prototype.getWidth=function(){return this._width},nj.prototype.getScale=function(){return this._scale},nj.prototype.getSize=function(){return{width:this._width,height:this._height}},nj.prototype.getHeight=function(){return this._height},nj.prototype.getKeyOb=function(){for(var $=this._entities,z=$.length-1;z>=0;z--){var D=$[z];if(this.isNode(D))return D}},nj.prototype.getAnchor2=function(){var r=this,e=r.rotateCenter;if(e)return e;var h=r.getKeyOb();if(!h)return r._anchor;var o=r._anchor2,i=h.getMatrix();return i.tf({x:h.getWidth()*(o.x-h.getAnchor().x),y:h.getHeight()*(o.y-h.getAnchor().y)})},nj.prototype.setAnchor2=function(v,i){var O=this,k=O.getKeyOb();if(k){var d,B=k.getMatrix();d="number"==typeof v?{x:v,y:i}:v;var t=B.tfi(d);O._anchor2={x:k.getAnchor().x+t.x/k.getWidth(),y:k.getAnchor().y+t.y/k.getHeight()}}},nj.prototype.setRotation=function(){},nj.prototype.beginRotate=function(e){this.rotateCenter=e.pos,this.rotateMode=e.groupRotateMode},nj.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},nj.prototype.addRotation=function(q,P,D){return"batch"===P?this._addRotationInBatchMode(q,D):"block"===P?this._addRotationInBlockMode(q,D):void 0},nj.prototype._addRotationInBlockMode=function(S,X){var e=this,j=e.rotateCenter||e.getPosition();e._entities.forEach(function(c){if(e.isNode(c)&&(!X||X(c))){var p=c.getMatrix();p.translate(-j.x,-j.y),p.rotate(S),p.translate(j.x,j.y);var d=Math.sign(c.getScale().x);c.setRotation(mf(p.b*d,p.a*d)),c.setPosition(p.tx,p.ty)}})},nj.prototype._addRotationInBatchMode=function(I,h){var K=this,J=K._anchor2;K._entities.forEach(function(z){if(K.isNode(z)&&(!h||h(z))){var X=z.getAnchor(),_=z.getMatrix(),j=_.tf({x:z.getWidth()*(J.x-X.x),y:z.getHeight()*(J.y-X.y)}),n=new Ng.Math.Matrix2d;n.set(_.a,_.b,_.c,_.d,_.tx,_.ty),n.translate(-j.x,-j.y),n.rotate(I),n.translate(j.x,j.y);var q=Math.sign(z.getScale().x);z.setRotation(mf(n.b*q,n.a*q)),z.setPosition(n.tx,n.ty)}})},nj.prototype.setPosition=function(O){var Y,C,R,P,Z=this,y=Z._position,m=O.x-y.x,K=O.y-y.y,D=Z._entities;for(C=0,R=D.length;R>C;C++)Y=D[C],Je(Y)&&(P=Y.getPosition(),Y.setPosition(P.x+m,P.y+K));Z._position=O},nj.prototype.setScale=function(O,I){var U=this,r=O/U._scale.x,B=I/U._scale.y;U._adjustChildScaleOrSize(r,B,"size"),U._scale={x:O,y:I}},nj.prototype.getRect=function(){var Z=this,m=Z._position,e=Z._width,F=Z._height;return{x:m.x-e/2,y:m.y-F/2,width:e,height:F}},nj.prototype.setSize=function(c,$){var p=this,c=Math.max(1,c),$=Math.max(1,$),Q=c/p._width,E=$/p._height;p._adjustChildScaleOrSize(Q,E,"size"),p._width=c,p._height=$},nj.prototype._adjustChildScaleOrSize=function(V,Y,K){var U,r,d,P,e,b,g,Z,N,i,m,L,z,w,a=this,J=a._position,B=a._entities,D=new Ng.Math.Matrix2d;for(r=0,d=B.length;d>r;r++)if(U=B[r],a.isNode(U)){if(P=U.getPosition(),e=U.getRotation(),b=U.getWidth(),g=U.getHeight(),Z=U.getScale(),m=Z.x*b,L=Z.y*g,D.identity().scale(m,L).rotate(e).translate(P.x,P.y).translate(-J.x,-J.y).rotate(-a._64O),e=mf(D.b*Math.sign(m),D.a*Math.sign(m)),D.scale(V,Y),N=Math.cos(e),i=Math.sin(e),Math.abs(N)<.001?(z=D.b/i,w=-D.c/i):(z=D.a/N,w=D.d/N),"scale"===K)U.setScale(z/b,w/g);else if("size"===K){var k=z/Z.x,s=w/Z.y;U.setScale(Qg(z)*Math.abs(Z.x),Qg(w)*Math.abs(Z.y)),U.setSize(Math.max(.1,Math.abs(k)),Math.max(.1,Math.abs(s)))}D.rotate(a._64O).translate(J.x,J.y),U.setPosition(D.tx,D.ty)}},nj.prototype.getMatrix=function(){var F=this,Q=F._position,i=b.Default.getInternal(),h=F._scale;return new i.Mat(F._64O,Q.x,Q.y,h.x,h.y)},nj.prototype.toGlobal=function(K){return this.getMatrix().tf(K)},nj.prototype.getCorners=function(){var M=this,i=M._width,o=M._height,p=M._anchor,$=-i*p.x,y=-o*p.y,T=M.getMatrix();return[T.tf($,y),T.tf($,y+o),T.tf($+i,y+o),T.tf($+i,y)]},nj.prototype.calcInfo=function(){var Q,h,f,o,T,v,q=this,p=[],O=q._entities,H=q._64O;for(o=0,T=O.length;T>o;o++)v=O[o],q.isNode(v)&&v.getCorners&&p.push.apply(p,v.getCorners());if(p.length){var x=Math.cos(-H),n=Math.sin(-H),N=1/0,$=-1/0,j=1/0,S=-1/0;for(o=0,T=p.length;T>o;o++)f=p[o],Q=f.x,h=f.y,f.x=x*Q-n*h,f.y=n*Q+x*h,N=Math.min(N,f.x),$=Math.max($,f.x),j=Math.min(j,f.y),S=Math.max(S,f.y);q._width=($-N)/q._scale.x,q._height=(S-j)/q._scale.y,x=Math.cos(H),n=Math.sin(H);var w=q._anchor;Q=N+($-N)*w.x,h=j+(S-j)*w.y,q._position={x:x*Q-n*h,y:n*Q+x*h}}},nj.prototype.isNode=function(M){return Je(M)?md(M)?M.size()?!1:!0:!0:!1},nj.prototype._42=function(Y,v,Z){var w,f,e,H,R,u,O,D,S=this,I=S._entities,C=S.rotateMode;for("batch"===C&&(D=S.getKeyOb()),w=0,f=I.length;f>w;w++)e=I[w],S.isNode(e)&&(u=e.getRect(),H=Ng.toScreenPosition(Z,{x:u.x,y:u.y}),R=Ng.toScreenPosition(Z,{x:u.x+u.width,y:u.y+u.height}),O={min:H,max:R},e===D&&(O.isKeyOb=!0),Ng.Icons.DrawIcon(Y,v,Ng.Icons.GroupSubEntityRect,O))};var lc=Ng.CurveActiving=function(o,M){this._curve=o,this._interactor=o._interactor,this.silent=!0;for(var v in M)this[v]=M[v];delete this.silent};lc.prototype={},lc.prototype.constructor=lc,x.defineProperties(lc.prototype,{point:{get:function(){return this._point},set:function(c){var B=this;B._point=c,B.editingCtrl||B.silent||B._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(J){var f=this;f._pairs=J,f.editingCtrl&&!f.silent&&f._firePointChange()}}}),lc.prototype._firePointChange=function(){var E=this,X=E.getCurrentEditingPoint(),v=E._interactor;if(!X)return v.fi({kind:"selectPoint"}),void 0;var S=this._curve.target;if(S){var k=Ng.getDataMatrix(S).invert(),$=X.e;X=k.apply(Ng.toWorldPosition(v.gv,X)),X.e=$;var r=E._lastFirePoint;r&&Math.abs(X.x-r.x)<1e-5&&Math.abs(X.y-r.y)<1e-5&&(X.e==_&&r.e==_||Math.abs(X.e-r.e)<1e-5)||(E._lastFirePoint=X,v.fi({kind:"selectPoint",x:X.x,y:X.y,e:X.e}))}},lc.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},lc.prototype.getCurrentEditingPoint=function(){var o=this,m=o.editingCtrl;if(m){var J=o.pairs;if(J){var b=J[m.pairId];if(b){var B=b[m.type];if(B)return B}}}return o._point};var fm=Ng.CursorFactory=function(V){var M=this;M._interactor=V,M._rotateCursorStyles={}};fm.prototype={},fm.prototype.constructor=fm,fm.prototype.getRotateCursor=function(f){var I=this;0>f&&(f+=2*Math.PI);var a=I._interactor,P=a.getStyle("rotateCursorSize"),R=a.getStyle("rotateCursorRound"),t=Math.round(180*(f/Math.PI)/R);t*R>=360&&(t=0);var o=I._rotateCursorStyles,Z="htCustomRotateStyle_"+P+"_"+R+"_"+t;return o[Z]||(I._produceRotateCursor(Z,P,R,t),o[Z]=!0),Z},fm.prototype._produceRotateCursor=function(b,N,I,A){var i=this;i._interactor;var W=i._canvas;W||(W=i._canvas=L.createElement("canvas"));var P=C.devicePixelRatio;W.width=W.height=N*P,W.style.width=W.style.height=N+" px";var n=W.getContext("2d");Ng.setAntialias(n,!1),n.scale(P,P);var u,T,O,H,f,y=Math.round(N/2),R=""+y+" "+y+",auto !important;",M=4;u=Math.PI/180*A*I,n.clearRect(0,0,N,N),n.save(),n.scale(N/32,N/32),n.translate(16,15),n.rotate(u+Math.PI/2),n.beginPath(),n.moveTo(-8,0),n.lineTo(-8,M),n.lineTo(-8+M,M),n.moveTo(8,0),n.lineTo(8,M),n.lineTo(8-M,M),n.moveTo(-8,M),n.quadraticCurveTo(0,-6,8,M),n.restore(),n.lineCap="round",n.lineJoin="miter",n.strokeStyle="white",n.lineWidth=4,n.stroke(),n.strokeStyle="black",n.lineWidth=2,n.stroke(),T=JSON.stringify(W.toDataURL()),H="cursor:url("+T+")"+R,1!==P&&(O='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+N+'px" height="'+N+'px"><image xlink:href='+T+' width="'+N+'" height="'+N+'"/></svg>',H+="cursor:url(data:image/svg+xml;base64,"+btoa(O)+")"+R,H+="cursor:-webkit-image-set(url("+T+")"+P+"x,url("+T+")1x)"+R),f=L.createElement("style"),f.textContent="body."+b+" *, ."+b+"{"+H+"}",L.head.appendChild(f)};var tr=Ng.Guide.Grid=function(F){var M=this;M._interactor=F,M._alignmentGuideId=0,M._xAlignmentGuide=[],M._yAlignmentGuide=[]};tr.prototype={},tr.prototype.constructor=tr,x.defineProperties(tr.prototype,{gridBlockSize:{get:function(){var G=this;return G._gridBlockSize||G._interactor.getStyle("gridBlockSize")},set:function(S){this._gridBlockSize=S,this._interactor._42()}},gridThickLinesEvery:{get:function(){var P=this;return P._gridThickLinesEvery||P._interactor.getStyle("gridThickLinesEvery")},set:function(V){this._gridThickLinesEvery=V,this._interactor._42()}},gridEnabled:{get:function(){var Q=this,H=Q._interactor;return H.gridEnabled&&Q.isValidGrid()}}}),tr.prototype._42=function(){var k=this,I=k._interactor;k.gridEnabled&&k.drawGrid(),I.alignmentGuideEnabled&&k.drawAlignmentGuide()},tr.prototype.makeMatrix=function(){var i=this,F=i._interactor.getStyle("gridAngle"),U=i._interactor.getStyle("gridRotation"),T=new Ng.Math.Matrix2d,H=Math.sin(F),t=Math.cos(F);return T.set(1,0,t,H,0,0),T.rotate(U),T},tr.prototype.isValidGrid=function(){var m=this,P=Math.PI,y=m._interactor,b=y.gv;if(b._zoom<y.getStyle("gridZoomThreshold"))return!1;var X=y.getStyle("gridAngle"),t=Math.abs(180*(X%P/P)),B=1-1e-8;return B>t||t>180-B?!1:!0},tr.prototype.drawAlignmentGuide=function(){var g=this,h=g._interactor,c=h.gv,s=h._canvas,G=h._context,o=s.width,K=s.height,L=c.tx(),T=c.ty(),b=c._zoom;G.beginPath(),G.strokeStyle=h.getStyle("gridAlignmentGuideColor"),G.lineWidth=1,g._xAlignmentGuide.forEach(function(R){var B=R.p*b+L;G.moveTo(B,0),G.lineTo(B,K)}),g._yAlignmentGuide.forEach(function(A){var M=A.p*b+T;G.moveTo(0,M),G.lineTo(o,M)}),G.stroke()},tr.prototype.drawGrid=function(){function n(y,b,l,n){var k=Ng.toScreenPosition(O,B.apply({x:y,y:b})),w=Ng.toScreenPosition(O,B.apply({x:l,y:n}));t.moveTo(k.x,k.y),t.lineTo(w.x,w.y)}var J=this,m=J._interactor,Q=J.gridBlockSize,W=J.gridThickLinesEvery,P=m.getStyle("gridThickColor"),p=m.getStyle("gridLightColor"),O=m.gv,L=m._canvas,t=m._context,d=L.width,i=L.height,B=J.makeMatrix(),$=B.applyInverse(Ng.toWorldPosition(O,{x:0,y:0})),z=B.applyInverse(Ng.toWorldPosition(O,{x:d,y:0})),l=B.applyInverse(Ng.toWorldPosition(O,{x:0,y:i})),X=B.applyInverse(Ng.toWorldPosition(O,{x:d,y:i})),N=Math.min($.x,z.x,l.x,X.x),o=Math.max($.x,z.x,l.x,X.x),F=Math.min($.y,z.y,l.y,X.y),k=Math.max($.y,z.y,l.y,X.y);d=o-N,i=k-F;var s=Math.ceil(N/Q),b=Math.floor(o/Q),S=Math.ceil(F/Q),h=Math.floor(k/Q);O.tx(),O.ty(),O._zoom;var q,u,G;for(t.save(),t.lineWidth=1,t.beginPath(),t.strokeStyle=P,G=Math.ceil(s/W)*W;b>=G;G+=W)q=G*Q,n(q,F,q,k);for(G=Math.ceil(S/W)*W;h>=G;G+=W)u=G*Q,n(N,u,o,u);for(t.stroke(),t.beginPath(),t.strokeStyle=p,G=s;b>=G;G++)0!==G%W&&(q=G*Q,n(q,F,q,k));for(G=S;h>=G;G++)0!==G%W&&(u=G*Q,n(N,u,o,u));t.stroke(),t.restore()},tr.prototype.getAlignmentGuides=function(){var l=this;return{x:l._xAlignmentGuide,y:l._yAlignmentGuide}},tr.prototype.addAlignmentGuide=function(d,g,$){var s=this,i="x"===d?s._xAlignmentGuide:s._yAlignmentGuide,$=$?$:++s._alignmentGuideId,O={p:g,id:$};if(i.length){var F=s._findClosestAlignmentGuide(O.p,i);F.dis<0?i.splice(F.index+1,0,O):i.splice(F.index,0,O)}else i.push(O);return s._interactor._42(),$},tr.prototype.findClosest=function(w,a,C){var x=this,N=x._interactor,J=N.gv;C&&(w=Ng.toWorldPosition(J,w));var S,D,e,i=1/0,L=1/0,g=w.x,m=w.y;if(x.gridEnabled){var T=x.gridBlockSize,_=x.makeMatrix(),U=_.applyInverse(w);U=_.apply({x:Math.round(U.x/T)*T,y:Math.round(U.y/T)*T}),i=U.x-g,L=U.y-m,e=!0}if(N.alignmentGuideEnabled&&(S=x._findClosestAlignmentGuide(g,x._xAlignmentGuide).dis,D=x._findClosestAlignmentGuide(m,x._yAlignmentGuide).dis,Math.abs(S)<Math.abs(i)&&(i=S,e=!0),Math.abs(D)<Math.abs(L)&&(L=D,e=!0)),e){e=!1;var B=J._zoom,p=N.getStyle("smartGuideThreshold")/B,k={};if(Math.abs(i)<p&&"y"!==a&&(k.x=C?i*B:i,e=!0),Math.abs(L)<p&&"x"!==a&&(k.y=C?L*B:L,e=!0),e)return k}},tr.prototype._findClosestAlignmentGuide=function(B,n){if(!n.length)return{dis:1/0};for(var Q,r=0,h=n.length-1;h-r>1;)Q=Math.floor((r+h)/2),n[Q].p<B?r=Q:h=Q;var U=n[r].p-B,J=n[h].p-B;return Math.abs(U)<=Math.abs(J)?{line:n[r],dis:U,index:r}:{line:n[h],dis:J,index:h}},tr.prototype.removeAllAlignmentGuide=function(Q){var K=this;"y"!==Q&&(K._xAlignmentGuide=[]),"x"!==Q&&(K._yAlignmentGuide=[]),K._interactor._42()},tr.prototype.removeAlignmentGuide=function(l){for(var J,F,n,X=this,w=X._xAlignmentGuide,x=0;2>x;x++)for(w=0===x?X._xAlignmentGuide:X._yAlignmentGuide,J=0,F=w.length;F>J;J++)if(n=w[J],n.id===l)return w.splice(J,1),X._interactor._42(),{axis:0===x?"x":"y",position:n.p};return!1},tr.prototype.adjustAlignmentGuide=function(u,i){var g=this,h=g.removeAlignmentGuide(u);return h?(g.addAlignmentGuide(h.axis,i,u),!0):!1};var bh=Ng.Guide.Rect=function(i){var N=this;
N._interactor=i};bh.prototype={},bh.prototype.constructor=bh,bh.prototype.gatherRects=function(){var J,W,_,D,G=this,e=G._interactor.gv,$=[],H=[],a={x:$,y:H},M={},B=e.getDataModel(),F=B.a("width"),P=B.a("height");F&&P&&(J=0,W=0,_=F,D=P,$.push({node:B,type:0,p:J},{node:B,type:1,p:J+_/2},{node:B,type:2,p:J+_}),H.push({node:B,type:0,p:W},{node:B,type:1,p:W+D/2},{node:B,type:2,p:W+D}),M[B._id||0]={x:J,y:W,width:_,height:D}),B.each(function(k){if(Je(k)&&!e.isSelected(k)&&e.isVisible(k)&&e.isValidGuideLineSource(k)){var z=!1;if(e.sm().getSelection().each(function(u){z||(k.isHostOn(u)?z=!0:k.isDescendantOf(u)&&(z=!0))}),!z){var d=k.getRect();J=d.x,W=d.y,_=d.width,D=d.height,$.push({node:k,type:0,p:J},{node:k,type:1,p:J+_/2},{node:k,type:2,p:J+_}),H.push({node:k,type:0,p:W},{node:k,type:1,p:W+D/2},{node:k,type:2,p:W+D}),M[k._id]=d}}}),$.sort(function(x,l){return x.p-l.p}),H.sort(function(w,K){return w.p-K.p}),G._grid=a,G._87I=M},bh.prototype.gatherLines=function(M,w,E){var W,a,T,d,Q,P,K,i,k,n,C,O,X=this,L=[X.findClosest({x:M.x,y:M.y},w),X.findClosest({x:M.x+M.w/2,y:M.y+M.h/2},w),X.findClosest({x:M.x+M.w,y:M.y+M.h},w)],F={},m=X._87I;E=E||255;var h,H;for(X._guideLine=[],W=0;2>W;W++)for(F={},0===W?(d="y",i=M.x,k=i+M.w):(d="x",i=M.y,k=i+M.h),a=0;3>a;a++)Q=L[a],Q&&isFinite(Q[d])&&(h=1<<3*W+a,E&h&&(P=Q[d+"Line"],K=P.node,H=K._id||0,F[H]||(F[H]=!0,O=m[H],"y"===d?(n=O.x,C=O.x+O.width):(n=O.y,C=O.y+O.height),T=P.p,X._guideLine.push({type:d,a:i,b:k,c:n,d:C,p:T,center:1===P.type}))))},bh.prototype._binarySearchClosest=function(u,h){if(!h.length)return{dis:1/0};for(var y,V=0,N=h.length-1;N-V>1;)y=Math.floor((V+N)/2),h[y].p<u?V=y:N=y;var Y=h[V].p-u,A=h[N].p-u;return Math.abs(Y)<=Math.abs(A)?{line:h[V],dis:Y}:{line:h[N],dis:A}},bh.prototype.findClosest=function(k,x,O){var f=this,c=f._interactor,X=c.gv,Q=f._grid;O&&(k=Ng.toWorldPosition(X,k));var h,W=f._binarySearchClosest(k.x,Q.x),G=f._binarySearchClosest(k.y,Q.y),y=W.dis,N=G.dis,w=X._zoom,I=c.getStyle("smartGuideThreshold")/w,p={};return Math.abs(y)<I&&"y"!==x&&(p.x=O?y*w:y,p.xLine=W.line,h=!0),Math.abs(N)<I&&"x"!==x&&(p.y=O?N*w:N,p.yLine=G.line,h=!0),h?p:void 0},bh.prototype._42=function(){var f=this,O=f._guideLine;if(O&&!b.Default.isCtrlDown()){var j=f._interactor;if(j.getStyle("guideLineVisible")){var J,$,h,U,c,V,a,S,M,E,t,_,l,K,q,x,B,L=j.gv,C=j._context,G=L.tx(),H=L.ty(),e=L._zoom,A=j.getStyle("guideLineTextSpacing");for(J=0,$=O.length;$>J;J++)h=O[J],S=h.type,M=h.p,E=h.a,t=h.b,_=h.c,l=h.d,K=Math.min(E,_),q=Math.max(t,l),"x"===S?(U=M*e+G,c=K*e+H,V=U,a=q*e+H):(U=K*e+G,c=M*e+H,V=q*e+G,a=c),Ng.Icons.DrawIcon(j,C,Ng.Icons.MoveLineGuide,{rect:[U,c,V,a],center:h.center}),l>=E&&t>=_||(K=E>l?l:t,q=E>l?E:_,B=q-K,"x"===S?(h.center2center||(U-=A,V=U),c=K*e+H,a=q*e+H,x=Ng.Icons.MoveLineGuideDistanceV):"y"===S&&(h.center2center||(c-=A,a=c),U=K*e+G,V=q*e+G,x=Ng.Icons.MoveLineGuideDistanceH),Ng.Icons.DrawIcon(j,C,x,{x0:U,y0:c,x1:V,y1:a,dis:B}))}}},bh.prototype.clear=function(){this._guideLine=null};var Ic=Ng.Guide.Hover=function(o){var c=this;c._interactor=o};Ic.prototype={},Ic.prototype.constructor=Ic,x.defineProperties(Ic.prototype,{}),Ic.prototype._42=function(){var k=this._interactor;if(k.getStyle("hoverGuideVisible")&&!k.gvEditing){var l=k.hoverData,h=k.gv;if(!Je(l)||h.isSelected(l))return k.hoverData=null,void 0;var z=Zl(h,l),V=Ng.toScreenPosition(h,{x:z.x,y:z.y}),$=Ng.toScreenPosition(h,{x:z.x+z.width,y:z.y+z.height});Ng.Icons.DrawIcon(k,k._context,Ng.Icons.HoverDataRect,{min:V,max:$,color:k.getStyle("hoverGuideColor")||k.getStyle("baseColor"),borderWidth:k.getStyle("hoverGuideBorderWidth")||1,borderPattern:k.getStyle("hoverGuideBorderPattern")||[1,4]})}},Ng.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Dl=Ng.Icons={},Rq=1e4,dq=null,Hb=Ng.DefaultStyleMap.baseColor,cc="rgb(183,232,135)",Np="rgb(255,204,153)",pj=6;b.Default.setImage("Icons.RectPoint",{width:pj,height:pj,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Hb}},rect:[0,0,pj,pj]}]}),Dl.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var M=Dl.GroupSubEntityRect.data;if(!M)return[];var r=M.min,n=M.max;return[r.x,r.y,r.x,n.y,n.x,n.y,n.x,r.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Dl.GroupSubEntityRect.data.isKeyOb?Hb:Hb}}}]};var hl=4;Dl.HoverDataRect={comps:[{type:"shape",points:{func:function(){var h=Dl.HoverDataRect.data;if(!h)return[];var w=h.min,O=h.max,r=hl;return w.x-=r,w.y-=r,O.x+=r,O.y+=r,[w.x,w.y,w.x,O.y,O.x,O.y,O.x,w.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return Dl.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return Dl.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return Dl.HoverDataRect.data.borderPattern}}}]},Dl.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Dl.Line.data.P1.x,Dl.Line.data.P1.y],pj,pj]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Dl.Line.data.P2.x,Dl.Line.data.P2.y],pj,pj]}}}]},Dl.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Dl.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Dl.Rect={comps:[{type:"shape",points:{func:function(){var c=Dl.Rect.data;if(!c)return[];var w=c.LT,f=c.LB,v=c.RB,Z=c.RT;return[w.x,w.y,f.x,f.y,v.x,v.y,Z.x,Z.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Hb}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Dl.Rect.data.rotation}},rect:{func:function(){return[[Dl.Rect.data.LT.x,Dl.Rect.data.LT.y],pj,pj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Dl.Rect.data.rotation}},rect:{func:function(){return[[Dl.Rect.data.LB.x,Dl.Rect.data.LB.y],pj,pj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Dl.Rect.data.rotation}},rect:{func:function(){return[[Dl.Rect.data.RB.x,Dl.Rect.data.RB.y],pj,pj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Dl.Rect.data.rotation}},rect:{func:function(){return[[Dl.Rect.data.RT.x,Dl.Rect.data.RT.y],pj,pj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Dl.Rect.data.rotation}},visible:{func:function(){return Dl.Rect.data.L?!0:!1}},rect:{func:function(){return[[Dl.Rect.data.L.x,Dl.Rect.data.L.y],pj,pj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Dl.Rect.data.rotation}},visible:{func:function(){return Dl.Rect.data.R?!0:!1}},rect:{func:function(){return[[Dl.Rect.data.R.x,Dl.Rect.data.R.y],pj,pj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Dl.Rect.data.rotation}},visible:{func:function(){return Dl.Rect.data.T?!0:!1}},rect:{func:function(){return[[Dl.Rect.data.T.x,Dl.Rect.data.T.y],pj,pj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Dl.Rect.data.rotation}},visible:{func:function(){return Dl.Rect.data.B?!0:!1}},rect:{func:function(){return[[Dl.Rect.data.B.x,Dl.Rect.data.B.y],pj,pj]}}}]};var Qc=16;b.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Hb}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Hb}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Dl.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Dl.Anchor.data.POS.x,Dl.Anchor.data.POS.y],Qc,Qc]}}}]},Dl.TipShiftX=12,Dl.TipShiftY=12;var _l=[8,28];Dl.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Dl.TipHelper.data.helperPos.x,Dl.TipHelper.data.helperPos.y,_l[0]*Dl.TipHelper.data.size,_l[1]]}},background:{func:function(){return dq.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Dl.TipHelper.data.text}},rect:{func:function(){return[Dl.TipHelper.data.helperPos.x,Dl.TipHelper.data.helperPos.y,_l[0]*Dl.TipHelper.data.size,_l[1]]}},color:{func:function(){return dq.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var yi=7;Dl.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Dl.ShapePoint.data.dynamicVisible}},rect:{func:function(){var h=Dl.ShapePoint.data.point,L=Dl.ShapePoint.data.size||yi;return[h,L+10,L+10]}},background:{func:function(){var J=Date.now(),d=Dl.ShapePoint.data.dynamicPeriod||1500,q=Math.sin(J%d/d*Math.PI);return"rgba(27,124,22,"+.5*q+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var S=Dl.ShapePoint.data.point,r=Dl.ShapePoint.data.size||yi;return[S,r,r]}},background:{func:function(){var i=Dl.ShapePoint.data.isEnd;return i?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Dl.ShapePoint.data.color||Hb}}},{type:"rect",visible:{func:function(){return!!Dl.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Hb}},rect:{func:function(){var S=5;return[Dl.ShapePoint.data.point,S,S]}}}]},Dl.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Dl.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Dl.ShapeBgCurve.data.P}},segments:{func:function(){return Dl.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var M=Date.now(),Y=Dl.ShapeBgCurve.data.dynamicPeriod||1500,V=Math.sin(M%Y/Y*Math.PI);return"rgba(27,124,22,"+.3*V+")"}}},{type:"shape",points:{func:function(){return Dl.ShapeBgCurve.data.P}},segments:{func:function(){return Dl.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Dl.ShapeBgCurve.data.color||Hb}}}]};var _i=8;Dl.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var q=Dl.ShapeHighlighPoint.data;return[[q.x,q.y],_i,_i]}},background:{func:function(){return dq.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var ni=10;Dl.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var t=Dl.ShapeHighlighRealPoint.data;return[[t.x,t.y],ni,ni]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Hb}}}]};var nc=8;Dl.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var r=Dl.ShapeHighlighCtrlPoint.data,u=r.x,W=r.y,k=nc/2;return[u-k,W-k,u-k,W+k,u+k,W+k,u+k,W-k]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return dq.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return dq.getStyle("shapeCtrlPointBorderColor")||Hb}}}]};var Aq=3;Dl.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Dl.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Aq,borderColor:{func:function(){return dq.getStyle("curveHighlightColor")}}}]},Dl.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Dl.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Dl.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Dl.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Dl.MoveLineGuide.data.center?cc:Np}}}]};var Qr=5;Dl.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var k=Dl.MoveLineGuideDistanceH.data,M=k.x0,H=k.y0;return[M,H-Qr,M,H+Qr]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Np},{type:"shape",points:{func:function(){var c=Dl.MoveLineGuideDistanceH.data,q=c.x1,k=c.y1;return[q,k-Qr,q,k+Qr]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Np},{type:"text",text:{func:function(){return Math.round(Dl.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var L=Dl.MoveLineGuideDistanceH.data;return[[(L.x0+L.x1)/2,L.y0-10],20,20]}},color:Np,font:"12px Arial",align:"center"}]},Dl.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var B=Dl.MoveLineGuideDistanceV.data,P=B.x0,C=B.y0;return[P-Qr,C,P+Qr,C]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Np},{type:"shape",points:{func:function(){var B=Dl.MoveLineGuideDistanceV.data,h=B.x1,Q=B.y1;return[h-Qr,Q,h+Qr,Q]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Np},{type:"text",text:{func:function(){return Math.round(Dl.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var E=Dl.MoveLineGuideDistanceV.data;return[[E.x0-10,(E.y0+E.y1)/2],20,20]}},color:Np,font:"12px Arial",align:"center"}]},b.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Dl.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var o=Dl.EdgeElevationGuide.data,C=o.x,H=o.y,J=dq.getStyle("curveElevationIntersectSize"),I=dq.getStyle("curveElevationGuideShift");return C+=I[0],H+=I[1],[C-J,H-J,2*J,2*J]}}}]},b.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),b.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Dl.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Dl.ConnectGuide.data.rotation}},rect:{func:function(){var L=Dl.ConnectGuide.data.connect;L.x,L.y;var l=dq.getStyle("connectGuideIntersectSize");return[[L.x,L.y],2*l,2*l]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var Y=Dl.ConnectGuide.data.cursorPos||Dl.ConnectGuide.data.connect,d=dq.getStyle("connectGuideIntersectSize");return[[Y.x,Y.y],2*d-2,2*d-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var S=Dl.ConnectGuide.data.connect,E=Dl.ConnectGuide.data.cursorPos||S;return[S.x,S.y,S.x+.5*(E.x-S.x),S.y,E.x+.5*(S.x-E.x),E.y,E.x,E.y]}}}]},b.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),b.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Dl.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var z=Dl.ConnectGuideGarbage.data.hover;return z?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var L=Dl.ConnectGuideGarbage.data,v=dq.getStyle("connectGuideGarbageIntersectsize");return L.hover&&(v+=5),[[L.x,L.y],2*v,2*v]}}}]};var wc=6;Dl.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Dl.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var E=Dl.ShapeActivingCtrl.data;return[E.point.x,E.point.y,E.c1.x,E.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Hb}}},{type:"shape",visible:{func:function(){return Dl.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var A=Dl.ShapeActivingCtrl.data;return[A.point.x,A.point.y,A.c2.x,A.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Hb}}},{type:"shape",visible:{func:function(){return Dl.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var Y=Dl.ShapeActivingCtrl.data.c1,d=Y.x,H=Y.y,W=wc/2;return"c1"===Dl.ShapeActivingCtrl.data.hl&&(W+=.5),[d-W,H-W,d-W,H+W,d+W,H+W,d+W,H-W]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return dq.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Dl.ShapeActivingCtrl.data.hl?dq.getStyle("shapeCtrlPointHighlightBorder")||Hb:dq.getStyle("shapeCtrlPointBorderColor")||Hb}}},{type:"shape",visible:{func:function(){return Dl.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var t=Dl.ShapeActivingCtrl.data.c2,i=t.x,U=t.y,m=wc/2;return"c2"===Dl.ShapeActivingCtrl.data.hl&&(m+=.5),[i-m,U-m,i-m,U+m,i+m,U+m,i+m,U-m]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return dq.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Dl.ShapeActivingCtrl.data.hl?dq.getStyle("shapeCtrlPointHighlightBorder")||Hb:dq.getStyle("shapeCtrlPointBorderColor")||Hb}}}]},Dl.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Hb}},rect:{func:function(){return[[Dl.RoundPoint.data.x,Dl.RoundPoint.data.y],pj,pj]}}}]},Dl.AttachPoint={comps:[{type:"rect",background:{func:function(){return Dl.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Hb}},rect:{func:function(){var B=Dl.AttachPoint.data.isAttach?pj+4:pj;return[[Dl.AttachPoint.data.x,Dl.AttachPoint.data.y],B,B]}}}]},Dl.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Dl.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Dl.SimpleRect.data.color||Hb}},rect:{func:function(){var u=Dl.SimpleRect.data;return[u.x,u.y,u.width,u.height]}}}]},b.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Dl.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var F=Dl.MoveDummy.data;return[[F.pos.x,F.pos.y],2*F.size,2*F.size]}}}]},Ng.Icons.DrawIcon=function(U,Y,c,A){c.width=c.height=Rq,c.data=A,dq=U,b.Default.drawImage(Y,c,0,0,Rq,Rq),dq=_},Ng.Icons.MapPoints=function(L,G){for(var C=0,b=L.length;b>C;C++)L[C]/=G},Ng.roundTo=function(B,Q,h){var D=Math.abs(B%Q);return h>D||h>Q-D?Q*Math.round(B/Q):B},Ng.toFixed=function(O){return Math.round(100*O)/100},Ng.getDataMatrix=function(P){if(P instanceof b.Shape){var i=new b.Math.Matrix2d,Q=P.getPosition();return i.translate(-Q.x,-Q.y).scale(P.getScale().x,P.getScale().y).rotate(P.getRotation()).translate(Q.x,Q.y),i}return P.getMatrix?P.getMatrix():new b.Math.Matrix2d};var Dn=Ng.Math.Curve=function(){this._curves=[]};Dn.prototype={},Dn.prototype.constructor=Dn,Dn.prototype.createFromHtShape=function(G,t,y){t instanceof b.List&&(t=t.toArray());var X,r,C,R,l,S,V,j=this,x=null,H=null,p=0,g=Ng.Math.Vector2,T=Ng.Math.CubicBezier,D=function(o){return new g(G[o],G[o+1],y?y[o/2]:_)};for(r=0,C=t.length;C>r;r++){switch(R=t[r],l=null,R){case 1:H=D(p),x=H,p+=2;break;case 2:X=D(p),p+=2,l=new T(H,H.clone(),X.clone(),X),H=X;break;case 3:S=D(p),X=D(p+2),p+=4,l=new T(H,S.clone().sub(H).multiplyScalar(2/3).add(H),S.clone().sub(X).multiplyScalar(2/3).add(X),X),H=X;break;case 4:S=D(p),V=D(p+2),X=D(p+4),p+=6,l=new T(H,S,V,X),H=X;break;case 5:if(!x)break;l=new T(H,H.clone(),x.clone(),x),H=null,x=null}l&&(l._index=j._curves.length,j._curves.push(l))}},Dn.prototype.checkPoint=function(W,E){var g,m,N,U,P,J=this,X=J._curves;for(g=0,m=X.length;m>g;g++)if(U=X[g],P=U.intersectRect(W,E,E),P.length)return N=0,P.forEach(function(W){N+=W.t}),N/=P.length,W=U.getPointAt(N),W.t=N,{bezier:U,intersection:W}},Dn.prototype.insertKnot=function(C,M){var l=C.insertKnot(M),k=this,T=k._curves;T.splice(C._index,1,l[0],l[1])},Dn.prototype._isCloseEnough=function(p,L){return Math.abs(p.x-L.x)<1e-6&&Math.abs(p.y-L.y)<1e-6},Dn.prototype._isSamePoint=function(m,Q){return m===Q},Dn.prototype.moveRealPoint=function(q,z){var f=this,$=f._curves,V=z.clone().sub(q);$.forEach(function(s){var J=s._p1;s._p2,s._p3;var x=s._p4;f._isSamePoint(J,q)&&(s._p2.add(V),s._p1=z),f._isSamePoint(x,q)&&(s._p3.add(V),s._p4=z)})},Dn.prototype.moveCtrlDueToRealPointMovement=function(u,U){var g=this,n=g._curves,V=function(A){A.add(U),A.e&&U.e&&(A.e+=U.e)};n.forEach(function(c){var G=c._p1;c._p2,c._p3;var K=c._p4;g._isSamePoint(G,u)&&V(c._p2),g._isSamePoint(K,u)&&V(c._p3)})},Dn.prototype.moveCtrlPoint=function(D,t,C){var U=D[C];if(U){U.e!==_&&(t.e=U.e);var W=this,p=W._curves;t.clone().sub(U),p.forEach(function(V){var e;"c2"===C?e="_p2":"c1"===C&&(e="_p3"),W._isSamePoint(V[e],U)&&(V[e]=t)}),D[C]=t}},Dn.prototype.deleteRealPoint=function(x,n){var g,v,K,S,j,V,d,Q=this,w=Q._curves,P={},a=[],b=Ng.Math.CubicBezier;for(v=0,K=w.length;K>v;v++)g=w[v],S=g._p1,j=g._p2,V=g._p3,d=g._p4,(P[v]||!Q._isSamePoint(S,x))&&(Q._isSamePoint(d,x)?K>v+1&&Q._isSamePoint(w[v+1]._p1,x)&&(n||a.push(new b(S,j,w[v+1]._p3,w[v+1]._p4))):a.push(g));Q._curves=a},Dn.prototype.findPairs=function(U,D){var b,B,c,T,P,g,K,Y,O=this,x=O._curves,o={},z=[];for(B=0,c=x.length;c>B;B++)b=x[B],T=b._p1,P=b._p2,g=b._p3,K=b._p4,!o[B]&&O._isSamePoint(T,U)&&(D?z.push({point:T,r2:K}):z.push({point:T,c2:P})),O._isSamePoint(K,U)&&(Y=D?{point:K,r1:T}:{point:K,c1:g},c>B+1&&O._isSamePoint(x[B+1]._p1,U)&&(D?Y.r2=x[B+1]._p4:Y.c2=x[B+1]._p2,o[B+1]=!0),z.push(Y));return z},Dn.prototype.toHtShape=function(){var n=this,W=n._curves,r=[],z=[],k={x:1/0,y:1/0};return W.forEach(function(T){var c=T._p1,W=T._p2,K=T._p3,R=T._p4;return n._isCloseEnough(c,k)||(r.push(1),z.push(c.clone())),k=R,n._isCloseEnough(c,W)&&n._isCloseEnough(K,R)?(r.push(2),z.push(R.clone()),void 0):(r.push(4),z.push(W.clone(),K.clone(),R.clone()),void 0)}),{segments:r,points:z}};var Kd=Ng.Math.CubicBezier=function(G,w,U,C){var e=this;e._id=Ng.Math.CubicBezier._globalId++,e._p1=G,e._p2=w,e._p3=U,e._p4=C};Kd._globalId=1,Kd.prototype={},Kd.prototype.constructor=Kd,Kd.prototype.toString=function(){return this._id},Kd.prototype.intersectRect=function(m,L,$){var A=L/2,J=$/2,h=m.x,u=m.y,z=Ng.Math.Vector2,j=new z(-A+h,-J+u),O=new z(A+h,J+u),y=new z(O.x,j.y),n=new z(j.x,O.y),H=this,U=H.intersectLine(j,y),Q=H.intersectLine(y,O),I=H.intersectLine(O,n),M=H.intersectLine(n,j),p=U.concat(Q).concat(I).concat(M);return p},Kd.prototype.intersectLine=function(x,s){var Z,b,Y,z,c,W,I,X,e,C,T,m,D,Q=this,N=x.clone().min(s),l=x.clone().max(s);z=Q._p1,c=Q._p2,W=Q._p3,I=Q._p4,Z=z.clone().multiplyScalar(-1),b=c.clone().multiplyScalar(3),Y=W.clone().multiplyScalar(-3),T=Z.add(b).add(Y).add(I),Z=z.clone().multiplyScalar(3),b=c.clone().multiplyScalar(-6),Y=W.clone().multiplyScalar(3),C=Z.add(b).add(Y),Z=z.clone().multiplyScalar(-3),b=c.clone().multiplyScalar(3),e=Z.add(b),X=z.clone(),D=new Ng.Math.Vector2(x.y-s.y,s.x-x.x),m=x.x*s.y-s.x*x.y;for(var M=Q.getRoots(D.dot(T),D.dot(C),D.dot(e),D.dot(X)+m),o=new Array,r=0,L=M.length;L>r;r++){var V=M[r];if(!(0>V||V>1)){var q=Q.getPointAt(V);q.t=V,x.x==s.x?N.y<=q.y&&q.y<=l.y&&o.push(q):x.y==s.y?N.x<=q.x&&q.x<=l.x&&o.push(q):q.x>=N.x&&q.y>=N.y&&q.x<=l.x&&q.y<=l.y&&o.push(q)}}return o},Kd.prototype.solveTForPoint=function(p){var y,v,W,P,e=this;y=e._p1.x-p.x,v=e._p2.x-p.x,W=e._p3.x-p.x,P=e._p4.x-p.x;for(var m=e.getRoots(P-3*W+3*v-y,3*W-6*v+3*y,3*v-3*y,y),k=_,F=1/0,u=0,L=m.length;L>u;u++){var Z=m[u];if(!(0>Z||Z>1)){var G=e.getPointAt(Z);G.t=Z;var w=Math.abs(G.y-p.y);F>w&&(F=w,k=G)}}return k},Kd.prototype.getPointAt=function(N){var a=this,c=a._p1,S=a._p2,u=a._p3,w=a._p4,o=c.clone().lerp(S,N),z=S.clone().lerp(u,N),A=u.clone().lerp(w,N),M=o.lerp(z,N),h=z.lerp(A,N);return M.lerp(h,N)},Kd.prototype.getPointByPercentage=function(z){var I=this.length*z,g=this._cacheLength,w=g.length;if(0===I)return g[0].point;if(z>=1)return g[w-1].point;for(var Z=0;w>Z;Z++){var y=g[Z];if(!(y.len<I)){var d=g[Z-1];return y.point.clone().sub(d.point).setLength(I-d.len).add(d.point)}}},Kd.prototype.getTByPercentage=function(J){var C=this.length*J,h=this._cacheLength,K=h.length;if(0===C||0>=J)return h[0].t;if(J>=1)return h[K-1].t;for(var W=0;K>W;W++){var x=h[W];if(!(x.len<C)){var a=h[W-1];return(C-a.len)/(x.len-a.len)*(x.t-a.t)+a.t}}},Kd.prototype.getRoots=function(k,T,v,K){var H,t,q,u,z,h=new Array;if(Math.abs(k)<1e-6){var H=T,t=v/H,q=K/H,u=t*t-4*q;if(u>0){var z=Math.sqrt(u);h.push(.5*(-t+z)),h.push(.5*(-t-z))}else 0==u&&h.push(.5*-t)}T/=k,v/=k,K/=k,H=(3*v-T*T)/3,t=(2*T*T*T-9*v*T+27*K)/27;var b=T/3,Y=t*t/4+H*H*H/27,w=t/2;if(Math.abs(Y)<=1e-6&&(Y=0),Y>0){var _,n,z=Math.sqrt(Y);_=-w+z,n=_>=0?Math.pow(_,1/3):-Math.pow(-_,1/3),_=-w-z,_>=0?n+=Math.pow(_,1/3):n-=Math.pow(-_,1/3),h.push(n-b)}else if(0>Y){var I=Math.sqrt(-H/3),y=Math.atan2(Math.sqrt(-Y),-w)/3,g=Math.cos(y),A=Math.sin(y),s=Math.sqrt(3);h.push(2*I*g-b),h.push(-I*(g+s*A)-b),h.push(-I*(g-s*A)-b)}else{var _;_=w>=0?-Math.pow(w,1/3):Math.pow(-w,1/3),h.push(2*_-b),h.push(-_-b)}return h},Kd.prototype._70I=function(){var i=this;return i._p1.distanceToSquared(i._p2)<1e-10&&i._p3.distanceToSquared(i._p4)<1e-10},Kd.prototype.insertKnot=function(H){var c=this,v=c._p1,o=c._p2,E=c._p3,h=c._p4,q=v.clone().lerp(o,H),a=o.clone().lerp(E,H),L=E.clone().lerp(h,H),x=q.clone().lerp(a,H),w=a.clone().lerp(L,H),j=x.clone().lerp(w,H);return c._70I()?(v.clone().lerp(h,H),[new Ng.Math.CubicBezier(v,v.clone(),j.clone(),j),new Ng.Math.CubicBezier(j,j.clone(),h.clone(),h)]):[new Ng.Math.CubicBezier(v,q,x,j),new Ng.Math.CubicBezier(j,w,L,h)]},x.defineProperties(Kd.prototype,{length:{get:function(){var S=this._cacheLength;if(!S){S=this._cacheLength=[];for(var B=this._p1,c=0,E=0;1>=c;){var o=this.getPointAt(c+=.001);E+=o.clone().sub(B).length(),B=o,S.push({len:E,t:c,point:o.clone()})}}return S[S.length-1].len}},p1:{get:function(){return this._p1},set:function(u){this._p1=u,this._cacheLength=_}},p2:{get:function(){return this._p2},set:function(Z){this._p2=Z,this._cacheLength=_}},p3:{get:function(){return this._p3},set:function(K){this._p3=K,this._cacheLength=_}},p4:{get:function(){return this._p4},set:function(z){this._p4=z,this._cacheLength=_}}});var ws=b.Default.getInternal().ui().EdgeUI,ne={_47O:function(V){var G=this,Y=ne.getBackups()._47O;Ng.inEdit(G.gv)||Y.call(G,V)}};Ng.Inject.registAsModule(ne,ws);var no=b.Default.getInternal().ui().NodeUI,Pe={_47O:function(I){var t=this,u=Pe.getBackups()._47O;Ng.inEdit(t.gv)||u.call(t,I)
},getSelectWidth:function(){var K=this,u=K.gv,M=K._data;if(u.isEditable(M)&&Ng.inEdit(u))return 0;var D=Pe.getBackup("getSelectWidth");return D.call(K)}};Ng.Inject.registAsModule(Pe,no);var xk=b.graph.GraphView,Ni={_editPointSize:function(){var o=b.Default.isTouchable,Q=Ng.getStyle("pointSize");return Q[o?0:1]}(),isPointEditable:function(f){var p=this;if(Ng.inEdit(p))return p._pointEditableFunc?p._pointEditableFunc(f):!0;var T=Ni.getBackup("isPointEditable");T.call(p,f)},isEditable:function(p){var f,m=this,F=Ni.getBackup("isEditable");if(f=p instanceof Ng.Group?!0:F.call(m,p),!Ng.inEdit(m))return f;if(!(p instanceof b.Edge))return f;if(!p.s("2d.editable"))return!1;var I=m.getEditableFunc();return I?I(p):!0},_42:function(p,e){var R=this,j=Ni.getBackups()._42;if(j.call(R,p,e),Ng.inEdit(R)){var Z=R.getEditInteractor();Z.drawImpl()}}};Ng.Inject.registAsModule(Ni,xk);var dc=b.Default.getInternal().ui().ShapeUI,Yj={_47O:function(q){var v=this,U=Yj.getBackups()._47O;Ng.inEdit(v.gv)||U.call(v,q)}};Ng.Inject.registAsModule(Yj,dc);var xl=b.graph.DefaultInteractor,Bd={handle_mousewheel:function(j){var n=this,i=Bd.getBackup("handle_mousewheel");Ng.inEdit(n.gv)||i.call(n,j)}};Ng.Inject.registAsModule(Bd,xl);var _r=b.graph.MoveInteractor,Ip={_calcShift:function(t,G){var H=this,s=Ip.getBackup("_calcShift"),R=H.gv;if(!Ng.inEdit(R))return s.call(H,t,G);var T=R.getEditInteractor(),r=T.getSubModule("Move").calcShift(t,G,H);return r||s.call(H,t,G)},clear:function(i){var m=this,F=Ip.getBackup("clear");F.call(m,i);var E=m.gv;if(Ng.inEdit(E)){var S=E.getEditInteractor();S.getSubModule("Move").clear(i)}}};Ng.Inject.registAsModule(Ip,_r);var bh=Ng.Rect=function(G){this.catalog="Rect",this._interactor=G};bh.prototype={},bh.prototype.constructor=bh,bh.prototype.gatherInfo=function(T,j){var z=this;if(1===j.length){var y=j[0];return y instanceof b.Shape&&y._70I()?z.gatherLine(T,y):md(y,T)?!1:z.gatherSingleTarget(T,y)}return j.length>1?z.gatherMultiTargets(T,j):!1},bh.prototype.gatherSingleTarget=function(y,L){if(L.getCorners){var b,s=this,c=s.info;s.target=L,b=s.screenInfo={};var $=L.getCorners();c.LT=new Ng.Math.Vector2($[0]),c.LB=new Ng.Math.Vector2($[1]),c.RB=new Ng.Math.Vector2($[2]),c.RT=new Ng.Math.Vector2($[3]),c.T=c.LT.clone().add(c.RT).divideScalar(2),c.B=c.LB.clone().add(c.RB).divideScalar(2),c.L=c.LT.clone().add(c.LB).divideScalar(2),c.R=c.RT.clone().add(c.RB).divideScalar(2);for(var F in c)b[F]=Ng.toScreenPosition(y,c[F]);var D=s._interactor,K=D.getStyle("checkSize"),A=function(J,b,O){var P=b.clone().sub(J).setLength(-K),W=O.clone().sub(J).setLength(-K),T=P.add(W).add(J);return T};return b.rotLT=A(b.LT,b.RT,b.LB),b.rotLB=A(b.LB,b.LT,b.RB),b.rotRB=A(b.RB,b.LB,b.RT),b.rotRT=A(b.RT,b.LT,b.RB),b.rotT=b.rotLT.clone().add(b.rotRT).divideScalar(2),b.rotB=b.rotLB.clone().add(b.rotRB).divideScalar(2),b.rotL=b.rotLT.clone().add(b.rotLB).divideScalar(2),b.rotR=b.rotRT.clone().add(b.rotRB).divideScalar(2),b.rotation=L.getRotation(),s.gatherConnectInfo(),!0}},bh.prototype.gatherConnectInfo=function(){var D=this,H=D.target,P=D._interactor,E=D.screenInfo,M=P.gv;if(M.isConnectActionVisible(H)&&P.getStyle("connectGuideVisible")){var V;H.s&&(V=H.s("connectGuideShift")),V||(V=P.getStyle("connectGuideShift"));var W=H.getAnchor(),K=H.getSize(),O=H.toGlobal({x:K.width*(V[0]-W.x),y:K.height*(V[1]-W.y)});O=Ng.toScreenPosition(M,O),E.P1?O.add(E.P2.clone().sub(E.P1).setLength(V[2])):(O.add(E.RT.clone().sub(E.LT).setLength(V[2])),O.add(E.LB.clone().sub(E.LT).setLength(V[3]))),E.connect=O}},bh.prototype.gatherMultiTargets=function(A,L){var u=Ng.Group.findOrCreateGroup(L,this._interactor._uuid);if(!u)return!1;var Z=this;return Z.editing&&"rotate"!==Z.editing.mode||u.calcInfo(),Z.gatherSingleTarget(A,u)},bh.prototype.gatherLine=function(n,T){this.target=T;var s=this.screenInfo={},Y=T.getPoints(),U=Ng.getDataMatrix(T);return s.P1=Ng.toScreenPosition(n,U.apply(Y.get(0))),s.P2=Ng.toScreenPosition(n,U.apply(Y.get(1))),this.gatherConnectInfo(),!0},bh.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],bh.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],bh.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],bh.prototype.check=function(z,q,i){if(b.Default.isLeftButton(q)){var I=this;if(I.editing=null,I.tipInfo=null,I.screenInfo){var l=I.target,A=z.isEditable(l),Z=I.screenInfo;if(A&&Z.connect){var C=I._checkConnect(i);if(C)return C}if(Z.P1)return I._checkLine(i);var k,P,h,G=null,Y=I._interactor,x=Y.getStyle("checkSize");if(A&&z.isRectEditable(l))for(P=0;P<Ng.Rect.ResizeKeys.length;P++)if(h=Ng.Rect.ResizeKeys[P],Ng.checkHit(i,Z[h],x)){G=h,k="resize";break}if(!G&&A&&z.isRotationEditable(l)&&!Y.getStyle("rotateAsClock")){var M=Y.getStyle("rotateCheckSize");for(P=0;P<Ng.Rect.RotateKeys.length;P++)if(h=Ng.Rect.RotateKeys[P],Ng.checkHit(i,Z[h],M)){G=h,k="rotate";break}}if(!G)return Y.setCursor("default"),void 0;if("rotate"===k){var U,v=z.lp(q);if(l instanceof Ng.Group){var F=Y.getStyle("groupRotateModeKey");"string"==typeof F&&(F=[F]);for(var K=!1,R=0,g=F.length;g>R;R++)if(q[F[R]]){K=!0;break}var w=Y.getStyle("groupRotateModeDefault");U=K?"batch"===w?"block":"batch":w}var o="batch"===U?l.getAnchor2():l.getPosition(),e=Math.atan2(v.y-o.y,v.x-o.x);Y._setRotateCursor(e),I.editing={mode:k,key:G,pos:o,flipY:l.getScale().y<0,rotation:l.getRotation(),hitRot:e},U&&(I.editing.groupRotateMode=U)}else{var a=Ng.Rect.ResizeKeys.indexOf(G),V=Ng.Rect.ResizeDirection[a],E=Math.cos(l.getRotation()),p=Math.sin(l.getRotation()),f=V.x*Math.sign(l.getScale().x),c=V.y*Math.sign(l.getScale().y),d=Math.atan2(-p*f-E*c,E*f-p*c),Q=(Math.round(d/(Math.PI/4))+8)%8,X=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][Q];this._interactor.setCursor(X);var O=l.getWidth(),L=l.getHeight(),r=l.getAnchor();I.editing={mode:k,key:G,rect:{x:-O*r.x,y:-L*r.y,width:O,height:L},anchor:r,matrix:l.getMatrix()}}return G}}},bh.prototype._checkLine=function(G){var D=this;D.screenInfo;var a,y=D._interactor.getStyle("checkSize");if(Ng.checkHit(G,D.screenInfo.P1,y))a="P1";else{if(!Ng.checkHit(G,D.screenInfo.P2,y))return this._interactor.setCursor("default"),void 0;a="P2"}return D.editing={mode:"line",key:a},a},bh.prototype._checkConnect=function(n){var T=this,y=T.screenInfo,q=T._interactor,L=q.getStyle("connectGuideIntersectSize"),V=y.connect,Z=n.x,k=V.x;if(k>Z&&L>k-Z&&Math.abs(V.y-n.y)<L||Z>=k&&Ng.checkHit(n,V,L)){var O="connect",U=C.getConnectAction(q.gv);if(T.editing={mode:O},U&&U.delete)if(T.target instanceof Ng.Group){var o=!0;q.gv.sm().getSelection().each(function(v){U.delete.visible.call(null,q.gv,v)||(o=!1)}),T.editing.hasDeleteAction=o}else U.delete.visible.call(null,q.gv,T.target)&&(T.editing.hasDeleteAction=!0);return q.setCursor("default"),O}},bh.prototype._fireEditEvent=function(Q,J){var z=this._interactor,a=this.editing;if(a){var r=a.mode;r="rotate"===r?"Rotation":"connect"===r?"Connection":"resize"===r?"Rect":r[0].toUpperCase()+r.slice(1),z.fi({kind:Q+"Edit"+r,event:J})}},bh.prototype.startEdit=function(Z,y){Z.startDragging(y);var o=this;o._interactor.fi({kind:"prepareEdit",event:y});var k=o.editing,_=o.target;if(k){if(o._fireEditEvent("begin",y),k.started=!0,"rotate"===k.mode)return k.groupRotateMode&&_.beginRotate(k),Z._42(),void 0;if("connect"!==k.mode)("line"===k.mode||_&&0===_.getRotation())&&(o._inSmartGuide=!0,o._interactor.rectGuide.gatherRects());else if(k.hasDeleteAction){var R=Z.gv,t=o._interactor.getStyle("connectGuideGarbageShift");k.garbageInfo={x:R.getWidth()*t[0]+t[2],y:R.getHeight()*t[1]+t[3],size:o._interactor.getStyle("connectGuideGarbageIntersectsize")},Z._42()}}},bh.prototype._46O=function(L){var E,Y,J=this,q=J.editing,n=J.target;if(q){if("connect"===q.mode&&!q.canceled&&!q.deleted)try{q.garbageInfo&&q.garbageInfo.hover?C.doDeleteConnectionAction(J._interactor.gv,n):C.doConnectAction(J._interactor.gv,n,q.target)}catch(y){console.error(y)}Y=q.freezeFlag,E=J.editing.groupRotateMode,J._fireEditEvent("end",L),J.editing=null}J.tipInfo=null,J._inSmartGuide&&(J._interactor.rectGuide.clear(),J._inSmartGuide=!1),E&&n&&n.endRotate(),n instanceof b.Block&&(Y===_?delete n._freezeSyncFromChildren:n._freezeSyncFromChildren=Y,n.updateFromChildren())},bh.prototype.handleNormalStateDelete=function(){var d=this,g=d.editing;if(g&&"connect"===g.mode&&!g.canceled&&!g.deleted){if(g.garbageInfo){try{C.doDeleteConnectionAction(d._interactor.gv,d.target)}catch(i){console.error(i)}g.garbageInfo=null}return g.cursorPos=null,g.targetCorners=null,g.deleted=!0,d._interactor._42(),!0}},bh.prototype.handleNormalStateKeyDown=function(M){var g=this,c=g.editing;return!c||"connect"!==c.mode||c.canceled||c.deleted?void 0:b.Default.isEsc(M)?(c.cursorPos=null,c.targetCorners=null,c.canceled=!0,g._interactor._42(),!0):void 0},bh.prototype.handleEdit=function(G,Z){var W=this,o=W.editing;if(o){var m,F,k,s,c,Y=W.target,O=o.key,D=o.mode,V=G.lp(Z),H=W._interactor;if("connect"===D){if(o.canceled)return;if(o.deleted)return;o.cursorPos=H._getLogicalPoint(Z);var I=o.garbageInfo;return I&&Ng.checkHit(o.cursorPos,I,I.size)?(I.hover=!0,o.target=null,o.targetCorners=null):(I&&(I.hover=!1),o.target=G.getDataAt(V,function(e){return G.isSelectable(e)?Je(e)?!0:!1:!1})||null,o.targetCorners=Ng.getTargetCornersOnScreen(G,o.target)),H._42(),void 0}if("rotate"===D){var u,w,U=o.pos,v=Math.atan2(V.y-U.y,V.x-U.x);if(o.groupRotateMode?w=v-o.hitRot:(u=v-o.hitRot,w=o.rotation+u),w%=2*Math.PI,0>w&&(w+=2*Math.PI),!b.Default.isCtrlDown(Z)){var A,x;Xf(Z)?(A=H.getStyle("shiftRotateRound"),x=A/2):(A=H.getStyle("rotateRound"),x=H.getStyle("rotateSensitivity")),w=Ng.roundTo(w,A,x)}o.groupRotateMode?(u=w-(o.lastRotation||0),0!==u&&(Y.addRotation(u,o.groupRotateMode,function(u){return G.isRotationEditable(u)}),o.lastRotation=w)):Y.setRotation(w),H._setRotateCursor(v),w>Math.PI&&(w-=2*Math.PI);var R=180*(w/Math.PI);R=R.toFixed(2),m=""+R+""}else if("resize"===D){var E=o.rect;k=E.x,s=E.y;var B,Q=E.width,q=E.height,S=o.anchor,P=o.matrix,N=Y.s&&Y.s("keepAspectRatio")||H.getStyle("keepAspectRatio");Xf(Z)&&(N=!N);var a=W._unionPointMode1,C=W._unionPointMode2;if(W._inSmartGuide&&!b.Default.isCtrlDown(Z)&&!N){var i;"L"===O||"R"===O?i="x":("T"===O||"B"===O)&&(i="y"),W._adsorbedToClosest(V,i),c=!0}B=P.tfi(V);var t;"LT"===O?(E=a(B,{x:k+Q,y:s+q},Q,q,N),t=9):"T"===O?(E=C({x:k,y:B.y},{x:k+Q,y:s+q},Q,q,N,"v"),t=1):"RT"===O?(E=a(B,{x:k,y:s+q},Q,q,N),t=33):"L"===O?(E=C({x:B.x,y:s},{x:k+Q,y:s+q},Q,q,N,"h"),t=8):"R"===O?(E=C({x:k,y:s},{x:B.x,y:s+q},Q,q,N,"h"),t=32):"LB"===O?(E=a(B,{x:k+Q,y:s},Q,q,N),t=12):"B"===O?(E=C({x:k,y:s},{x:k+Q,y:B.y},Q,q,N,"v"),t=4):"RB"===O&&(E=a(B,{x:k,y:s},Q,q,N),t=36);var J=P.tf(E.x+E.width*S.x,E.y+E.height*S.y);Y instanceof b.Block&&(o.hasOwnProperty("freezeFlag")||(o.freezeFlag=Y._freezeSyncFromChildren,Y._freezeSyncFromChildren=!0)),Y.setPosition(J),Y.setSize(E.width,E.height),c&&(F=Y.getRect(),H.rectGuide.gatherLines({node:Y,x:F.x,y:F.y,w:F.width,h:F.height},i,t)),m=""+Math.round(E.width)+" * "+Math.round(E.height)}else if("line"===D){if(Xf(Z)){var n=Y.getPoints(),K="P1"===O?n.get(1):n.get(0),l={x:V.x-K.x,y:V.y-K.y},X=H.getStyle("shiftLineRotateRound"),z=W._shiftDirList;if(!z||W._shiftRotateRound!==X){W._shiftRotateRound=X,W._shiftDirList=z=[];for(var g=0;g<Math.PI;g+=X)z.push({x:h(g),y:j(g)})}for(var r,M=0,$=0,T=z.length;T>$;$++){var _=z[$],L=_.x*l.x+_.y*l.y;Math.abs(L)>Math.abs(M)&&(M=L,r=_)}V={x:K.x+r.x*M,y:K.y+r.y*M},H.rectGuide.clear()}else W._inSmartGuide&&!b.Default.isCtrlDown(Z)&&(W._adsorbedToClosest(V),c=!0);var e=Ng.getDataMatrix(Y).applyInverse(V);Y.setPoint("P1"===O?0:1,e,!0);var d=Y.getPoints(),p=d.get(0),f=d.get(1);k=p.x-f.x,s=p.y-f.y,m=" "+Math.round(Math.sqrt(k*k+s*s))+" ",c&&(F=Y.getRect(),H.rectGuide.gatherLines({node:Y,x:F.x,y:F.y,w:F.width,h:F.height}))}if(m){var y=b.Default.getLogicalPoint(Z,H._canvas);y.x+=Ng.Icons.TipShiftX,y.y+=Ng.Icons.TipShiftY,W.tipInfo={helperPos:y,text:m,size:m.length}}W._fireEditEvent("between",Z)}},bh.prototype._unionPointMode1=function(M,p,D,n,q){if(q&&D&&n){var $=M.x-p.x,L=M.y-p.y;Math.abs($*n)<Math.abs(L*D)?(L=Math.sign(L)*Math.abs($*n/D),M.y=p.y+L):($=Math.sign($)*Math.abs(L*D/n),M.x=p.x+$)}return b.Default.unionPoint(M,p)},bh.prototype._unionPointMode2=function(x,E,U,$,j,V){var i=b.Default.unionPoint(x,E);if(j&&U&&$){var n;"v"===V?(n=i.x+i.width/2,i.width=U*i.height/$,i.x=n-i.width/2):(n=i.y+i.height/2,i.height=$*i.width/U,i.y=n-i.height/2)}return i},bh.prototype._adsorbedToClosest=function(N,t){var q=this,w=q._interactor,Y=w.rectGuide.findClosest(N,t),r=w.gridGuide.findClosest(N,t),U=1/0,P=1/0;Y&&(isFinite(Y.x)&&(U=Y.x),isFinite(Y.y)&&(P=Y.y)),r&&(isFinite(r.x)&&Math.abs(r.x)<Math.abs(U)&&(U=r.x),isFinite(r.y)&&Math.abs(r.y)<Math.abs(P)&&(P=r.y)),isFinite(U)&&(N.x+=U),isFinite(P)&&(N.y+=P)},bh.prototype._42=function(l,N,V){var k=this;k.info={},k.screenInfo=null;var o=k._interactor;if(!o.editDetail&&k.gatherInfo(N,V)){var O=k.editing,E=O?O.groupRotateMode:null,R=k.screenInfo;if("block"!==E||!O||!O.started){if(R.P1?Ng.Icons.DrawIcon(o,l,Ng.Icons.Line,R):Ng.Icons.DrawIcon(o,l,Ng.Icons.Rect,R),R.connect&&(Ng.Icons.DrawIcon(o,l,Ng.Icons.ConnectGuide,{rotation:R.rotation,connect:R.connect,cursorPos:O?O.cursorPos:null}),O)){if(O.targetCorners){for(var M={x:1/0,y:1/0},C={x:-1/0,y:-1/0},H=0,L=O.targetCorners.length;L>H;H+=2)M.x=Math.min(M.x,O.targetCorners[H]),C.x=Math.max(C.x,O.targetCorners[H]),M.y=Math.min(M.y,O.targetCorners[H+1]),C.y=Math.max(C.y,O.targetCorners[H+1]);Ng.Icons.DrawIcon(o,l,Ng.Icons.HoverDataRect,{min:M,max:C,color:o.getStyle("hoverGuideColor")||o.getStyle("baseColor")})}O.garbageInfo&&Ng.Icons.DrawIcon(o,l,Ng.Icons.ConnectGuideGarbage,O.garbageInfo)}o.getStyle("rotateTipVisible")&&k.tipInfo&&Ng.Icons.DrawIcon(o,l,Ng.Icons.TipHelper,k.tipInfo)}k.target instanceof Ng.Group&&k.target._42(o,l,N)}};var Fq=Ng.Anchor=function(K){this.catalog="Anchor",this._interactor=K};Fq.prototype={},Fq.prototype.constructor=Fq,Fq.prototype.gatherInfo=function(j,p){var z=this;if(1===p.length){var t=p[0];if(!t.getAnchor)return;if(t instanceof b.Shape&&t._70I())return;if(md(t,j))return;return z.gatherSingleTarget(j,p[0])}return p.length>1?z.gatherMultiTargets(j,p):!1},Fq.prototype.gatherSingleTarget=function(r,j){var O=this;return O.info.POS=j.getPosition(),O.screenInfo.POS=Ng.toScreenPosition(r,O.info.POS),O.target=j,!0},Fq.prototype.gatherMultiTargets=function(b,M){var t=this,C=Ng.Group.findOrCreateGroup(M,this._interactor._uuid);return C?(t.screenInfo.POS=Ng.toScreenPosition(b,C.getAnchor2()),t.target=C,!0):!1},Fq.prototype.isVisible=function(){var L=this,P=L._interactor;if(P.getStyle("anchorVisible")===!1)return!1;var h=L.target;if(h){if(this.editing)return!0;var z=h.getAnchor(),a=P.getStyle("anchorOutsideVisibleThreshold");if(z.x<-a||z.x>1+a||z.y<-a||z.y>1+a)return!0;var p=h.getSize(),v=h.getScale(),Q=Math.min(Math.abs(p.width*v.x),Math.abs(p.height*v.y));if(Q*P.gv._zoom<P.getStyle("anchorHideThreshold"))return!1}return!0},Fq.prototype.check=function(w,e,I){if(b.Default.isLeftButton(e)){var n=this,W=n._interactor;if(n.isVisible()&&W.getStyle("anchorMovable")!==!1){n.editing=null,n.tipInfo=null;var G=n.target;if(G&&w.isAnchorEditable(G)&&w.isEditable(G)){var h;if(n.screenInfo&&(h=n.screenInfo.POS)&&Ng.checkHit(I,new Ng.Math.Vector2(h),W.getStyle("checkSize"))){if(G instanceof Ng.Group)return n.editing={},!0;var s=G.getWidth(),z=G.getHeight(),l=G.getAnchor();return n.editing={rect:{x:-s*l.x,y:-z*l.y,width:s,height:z},anchor:l,matrix:G.getMatrix()},!0}}}}},Fq.prototype.startEdit=function(E,o){E.startDragging(o),E.fi({kind:"beginEditAnchor",event:o})},Fq.prototype._46O=function(K){var e=this;e.editing&&(e.editing=null,e._interactor.fi({kind:"endEditAnchor",event:K})),e.tipInfo=null},Fq.prototype.handleEdit=function(Q,R){var V=this,t=V.target;if(t){var C=V.editing;if(C){var e=Q.lp(R),Z=V._interactor;if(t instanceof Ng.Group)return t.setAnchor2(e),Z._42(),void 0;var m=C.matrix,o=m.tfi(e),S=C.rect,i=(o.x-S.x)/S.width,P=(o.y-S.y)/S.height;if(!b.Default.isCtrlDown(R)){var s=Z.getStyle("anchorRound"),X=Z.getStyle("anchorSensitivity");i=Ng.roundTo(i,s,X),P=Ng.roundTo(P,s,X)}t.setAnchor(i,P,!0);var K=b.Default.getLogicalPoint(R,Z._canvas);K.x+=Ng.Icons.TipShiftX,K.y+=Ng.Icons.TipShiftY;var r=""+i.toFixed(2)+", "+P.toFixed(2);V.tipInfo={helperPos:K,text:r,size:r.length},Z.fi({kind:"betweenEditAnchor",event:R})}}},Fq.prototype._42=function(q,M,t){var D=this;D.info={},D.screenInfo={};var H=D._interactor;H.editDetail||D.gatherInfo(M,t)&&D.isVisible()&&(Ng.Icons.DrawIcon(H,q,Ng.Icons.Anchor,D.screenInfo),D.tipInfo&&Ng.Icons.DrawIcon(H,q,Ng.Icons.TipHelper,D.tipInfo))};var An=Ng.MoveDummy=function(Q){this.catalog="MoveDummy",this._interactor=Q};An.prototype={},An.prototype.constructor=An,An.prototype.gatherInfo=function(){var I=this,D=this._interactor.getSubModule("Rect");if(D){var G=D.screenInfo;if(G){var V=I._interactor,p=I.getMovableTarget(D.target);if(p){var Y=V.getStyle("moveDummyThreshold");if(Y!==!1){var P=G.LT||G.P1,m=G.RT||G.P2,q=G.LB||P;if(P){var x=G.P1,l=Math.min(P.distanceTo(q),P.distanceTo(m));if(!(Y!==!0&&l>Y)){var N=V.getStyle("moveDummyPosition"),w=m.clone().sub(P),L=q.clone().sub(P),o=N[2],b=N[3];if(x){var R=V.getStyle("moveDummyLineExtraShift");R&&(o+=R[0],b+=R[1])}var g=P.clone().add(w.clone().multiplyScalar(N[0])).add(w.setLength(o)).add(L.clone().multiplyScalar(N[1])).add(L.setLength(b));return I.screenInfo.pos=g,I.screenInfo.size=V.getStyle("moveDummySensitivity"),!0}}}}}}},An.prototype.getMovableTarget=function(F){var x=this._interactor.gv;if(Je(F)){if(x.isMovable(F))return F}else if(F instanceof Ng.Group)for(var K=F._entities,$=K.length-1;$>=0;$--){var U=K[$];if(Je(U)&&x.isMovable(U))return U}return null},An.prototype.getMoveInteractor=function(){for(var P,u,c,t=this._interactor.gv,J=t.getInteractors(),P=0,u=J.length;u>P;P++)if(c=J.get(P),c instanceof _r)return c},An.prototype.startEdit=function($,f){$.startDragging(f);var X=this.getMoveInteractor();if(X){var F=this.selectedTarget,l=$.gv;l._moving=1,X._data=F,l.handleMouseDown&&l.handleMouseDown(f,F)}},An.prototype._46O=function(f){var b=this,V=b.getMoveInteractor();V&&(V.handleWindowMouseUp(f),b.selectedTarget=null)},An.prototype.handleEdit=function(O,Q){var D=this.getMoveInteractor();D&&D.handleWindowMouseMove(Q)},An.prototype.check=function(s,j,Y){if(this.selectedTarget=null,b.Default.isLeftButton(j)&&!s._scrolling&&!Uq()){var A=this;if(A.screenInfo){var m=A.screenInfo.pos;if(m&&!(Y.distanceTo(m)>A.screenInfo.size)){var n=A._interactor;return A.selectedTarget=A.getMovableTarget(n.getSubModule("Rect").target),n.setCursor("default"),!0}}}},An.prototype._42=function(i,H,q){var y=this;y.screenInfo={};var A=y._interactor;A.editDetail||y.gatherInfo(H,q)&&(!A.editing||y.selectedTarget)&&Ng.Icons.DrawIcon(A,i,Ng.Icons.MoveDummy,y.screenInfo)};var Vj=Ng.RotateX=function(I){this.catalog="RotateX",this._interactor=I};Vj.prototype={},Vj.prototype.constructor=Vj,Vj.prototype.gatherInfo=function(T,f){var o=this;if(1===f.length){var k=f[0];return k instanceof b.Shape&&k._70I()||md(k,T)?!1:o.gatherSingleTarget(T,k)}return f.length>1?o.gatherMultiTargets(T,f):!1},Vj.prototype.gatherSingleTarget=function(){var j=new b.Math.Vector2,p=new b.Math.Vector2,i=new b.Math.Vector2,X=new b.Math.Vector2,O=function(M,Y){var j=M.x-Y.x,i=M.y-Y.y;return j*j+i*i};return function(x,E){if(E.getCorners){var J=this,P=E.getCorners(),W=15,L=E.getPosition();j.copy(P[0]),i.copy(P[1]),X.copy(P[3]),p.copy(j).add(X).divideScalar(2).add(j.sub(i).setLength(W/x.getZoom()));var D=Math.max(O(L,P[0]),O(L,P[1]),O(L,P[2]),O(L,P[3]));return J.info.POS=p.clone(),J.screenInfo.POS=Ng.toScreenPosition(x,J.info.POS),J.screenInfo.LEN=Math.sqrt(D)*x.getZoom()+W,J.screenInfo.CENTER=Ng.toScreenPosition(x,L),J.target=E,!0}}}(),Vj.prototype.gatherMultiTargets=function(g,J){var a=this,U=Ng.Group.findOrCreateGroup(J,this._interactor._uuid);if(!U)return!1;var a=this;return a.gatherSingleTarget(g,U)},Vj.prototype.isVisible=function(){var T=this._interactor;if(!T.getStyle("rotateAsClock"))return!1;var e=this.target;if(!e)return!0;var d=T.gv;return d.isEditable(e)&&d.isRotationEditable(e)?!0:!1},Vj.prototype.check=function(n,v,G){var $=this,m=$._checkImpl(n,v,G);return(m||$._clockPainted)&&$._interactor._42(),m},Vj.prototype._checkImpl=function(h,w,P){if(b.Default.isLeftButton(w)){var D=this;D.editing=null,D.tipInfo=null;var I;if(D.screenInfo&&(I=D.screenInfo.POS)&&D.isVisible()){var Q=D._interactor;if(Ng.checkHit(P,I,Q.getStyle("checkSize"))){var v=D.target,u=h.lp(w),T=v.getPosition(),c=Math.atan2(u.y-T.y,u.x-T.x);return Q._setRotateCursor(c),D.editing={pos:T,rotation:v.getRotation(),hitRot:c,groupRotateMode:"block",screenInfo:{CENTER:D.screenInfo.CENTER,LEN:D.screenInfo.LEN}},!0}}}},Vj.prototype.startEdit=function(D,y){D.startDragging(y),D.fi({kind:"beginEditRotation",event:y}),this.target instanceof Ng.Group&&this.target.beginRotate(this.editing)},Vj.prototype._46O=function(P){var V=this;V.editing&&(V.editing=null,V._interactor.fi({kind:"endEditRotation",event:P})),V.target instanceof Ng.Group&&V.target.endRotate(),V.tipInfo=null},Vj.prototype.handleEdit=function(H,r){var P=this,h=P.editing;if(h){var B,S,K=P.target,N=H.lp(r),k=P._interactor,R=h.pos,D=Math.atan2(N.y-R.y,N.x-R.x),m=K instanceof Ng.Group;if(m?S=D-h.hitRot:(B=D-h.hitRot,S=h.rotation+B),S%=2*Math.PI,0>S&&(S+=2*Math.PI),!b.Default.isCtrlDown(r)){var c,g;Xf(r)?(c=k.getStyle("shiftRotateRound"),g=c/2):(c=k.getStyle("rotateRound"),g=k.getStyle("rotateSensitivity")),S=Ng.roundTo(S,c,g)}m?(B=S-(h.lastRotation||0),0!==B&&(K.addRotation(B,h.groupRotateMode,function(f){return H.isRotationEditable(f)}),h.lastRotation=S)):K.setRotation(S),k._setRotateCursor(D),S>Math.PI&&(S-=2*Math.PI);var $=180*(S/Math.PI),T=""+$.toFixed(2)+"",_=b.Default.getLogicalPoint(r,k._canvas);_.x+=Ng.Icons.TipShiftX,_.y+=Ng.Icons.TipShiftY,P.tipInfo={helperPos:_,text:T,size:T.length},k.fi({kind:"betweenEditRotation",event:r})}},Vj.prototype._42=function(u,C,M){var S=this;S._clockPainted=!1,S.info={},S.screenInfo={};var Y=S._interactor;Y.editDetail||S.gatherInfo(C,M)&&S.isVisible()&&(Ng.Icons.DrawIcon(Y,u,Ng.Icons.RoundPoint,S.screenInfo.POS),Y.getStyle("rotateTipVisible")&&S.tipInfo&&Ng.Icons.DrawIcon(Y,u,Ng.Icons.TipHelper,S.tipInfo),S.editing&&S.drawClock(u))},Vj.prototype.drawClock=function(z){z.save();var S=this;S._clockPainted=!0;var c=S.editing||{},I=c.screenInfo||S.screenInfo,t=I.LEN,y=t+8,E=t+18;z.save(),z.translate(I.CENTER.x,I.CENTER.y),z.beginPath(),z.strokeStyle="rgb(150, 150, 150)";for(var L,F,w,e,$,d=0;360>d;d++)L=d*Math.PI/180,0===d%5&&(F=j(L)*t,w=h(L)*t,e=j(L)*y,$=h(L)*y,z.moveTo(F,w),z.lineTo(e,$)),0===d%45&&(F=j(L)*t,w=h(L)*t,e=j(L)*E,$=h(L)*E,z.moveTo(F,w),z.lineTo(e,$));z.stroke(),z.rotate(-Ej);var _=c.lastRotation||S.target.getRotation();z.beginPath(),z.fillStyle="rgba(255, 0, 0, 0.1)",z.strokeStyle="rgb(157, 157, 157)",z.moveTo(0,0),z.arc(0,0,E,0,_,!1),z.fill(),z.beginPath(),z.moveTo(0+E,0),z.arc(0,0,E,0,_,!1),z.stroke(),z.restore()};var Dn=Ng.Curve=function(N){this.catalog="Curve",this._interactor=N};Dn.prototype={},Dn.prototype.constructor=Dn,x.defineProperties(Dn.prototype,{activing:{get:function(){return this._activing},set:function(I){var B=this;if(I)B._activing=new Ng.CurveActiving(this,I),B._activing._firePointChange();else{var T=B._activing;T&&T.dispose(),B._activing=null}}}}),Dn.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Dn.prototype.setUp=function(){var z=this,X=z._interactor;X&&X.gv.mp(z._onGraphviewPropertyChanged,z)},Dn.prototype._onGraphviewPropertyChanged=function(M){("zoom"===M.property||"translateX"===M.property||"translateY"===M.property)&&this._handleDataChanged()},Dn.prototype.tearDown=function(){var r=this,f=r._interactor;f&&f.gv.ump(r._onGraphviewPropertyChanged,r)},Dn.prototype.canEnterEditDetailMode=function(){var e=Jd(this._interactor);return e?this.target=e:void 0},Dn.prototype.canQuitEditDetailMode=function(d){var h=this,e=h._interactor._getLogicalPoint(d);return h._checkEditRealPoint(e)?void 0:h._interactor.gv.getDataAt(d)!==h.target?!0:void 0},Dn.prototype.preHandleScroll=function(){var q=this.editing;return q&&q.inEdit?!0:void 0},Dn.prototype.getCurrentSelectintStatus=function(){var c=this;if(c.activing&&!c.activing.selections){if(c.activing.status!=_)return c.activing.status;var r=function(H){var V=c.activing.status;c.activing.status=H,c._interactor.fp("shapePointStatus",V,H)},j=Ng.Curve.PointType,V=c.activing.point,O=c.activing.pairs;if(!O||1!==O.length)return r(j.Mirrored);var s=O[0],m=s.c1&&s.c1.isNearEnough(V),N=s.c2&&s.c2.isNearEnough(V);if(!s.c1||!s.c2)return m||N?r(j.Straight):r(j.Disconnected);if(m&&N)return r(j.Straight);if(m||N)return r(j.Asymmetric);var w=s.c1.clone().sub(V),B=s.c2.clone().sub(V);return Math.abs(w.x*B.y-w.y*B.x)>1e-5||w.x*B.x>0?r(j.Disconnected):Math.abs(w.length()-B.length())>1e-5?r(j.Asymmetric):r(j.Mirrored)}},Dn.prototype.handle_keydown=function(Z){var C=this;if(C._interactor.editDetail){var q=Ng.Curve.PointType;"1"===Z.key?C._setCurrentSelectionStatus(q.Straight):"2"===Z.key?C._setCurrentSelectionStatus(q.Mirrored):"3"===Z.key?C._setCurrentSelectionStatus(q.Disconnected):"4"===Z.key&&C._setCurrentSelectionStatus(q.Asymmetric)}},Dn.prototype.setCurrentSelectionStatus=function(Y){var p=this,F=p._interactor;if(F){var b=F.gv;b.dm().beginTransaction(),this._setCurrentSelectionStatus(Y),b.dm().endTransaction()}},Dn.prototype._setCurrentSelectionStatus=function($){var V=this,y=V.activing;if(y){var g=V.getCurrentSelectintStatus();if(null!==g&&g!==$){y.status=$;var d=V.activing.point,K=V.activing.pairs;if(K&&1===K.length){var p=K[0],E=V.screenInfo.curve,G=Ng.Curve.PointType,l=V._interactor,h=function(){V._writeToHt(),l.fp("shapePointStatus",g,$),V.check(l.gv,null,new Ng.Math.Vector2(l._lastLogicalPoint))};if($===G.Straight)return E.moveCtrlPoint(p,d,"c1"),E.moveCtrlPoint(p,d,"c2"),h(),void 0;if(g===G.Straight){var P=E.findPairs(d,!0),M=P[0],S=M.r1||d,z=M.r2||d,c=z.clone().sub(S).multiplyScalar(.25);return E.moveCtrlPoint(p,d.clone().sub(c),"c1"),E.moveCtrlPoint(p,d.clone().add(c),"c2"),h(),void 0}var R=p.c1,x=p.c2;if(R&&x){if($===G.Mirrored)return E.moveCtrlPoint(p,d.clone().multiplyScalar(2).sub(x),"c1"),h(),void 0;if($===G.Asymmetric&&g===G.Disconnected){var W=R.clone().sub(d).length(),c=d.clone().sub(x).setLength(W).add(d);return E.moveCtrlPoint(p,c,"c1"),h(),void 0}}y._firePointChange(),l.fp("shapePointStatus",g,$),V.check(l.gv,null,new Ng.Math.Vector2(l._lastLogicalPoint))}}}},Dn.prototype._handleDataChanged=function(){var J="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(L){var s=this;if(s.screenInfo&&s.target){if(L&&J.indexOf(L.property)<0)return;var T=s._interactor;s.gatherSingleTarget(T.gv,s.target,!0),s.check(T.gv,null,new Ng.Math.Vector2(T._lastLogicalPoint)),T._42()}}}(),Dn.prototype.gatherSingleTarget=function(C,p,s){var g,O,d=this;d.screenInfo&&d.screenInfo.curve&&(O=d.screenInfo.curve._curves);var j=d.editing;g=j?d.screenInfo:d.screenInfo={};var Q,Y,y=p instanceof b.Edge;y?(Q=p.s("edge.segments"),Y=p.s("edge.points")||new b.List):(Q=p._58O,Y=p._59O),g.S=Q;var E,r=g.P=[],o=Ng.getDataMatrix(p);if(p instanceof b.Polyline||p instanceof b.Edge&&d._interactor.getStyle("edgeElevationEditable"))E=p.getElevation&&p.getElevation()||0,g.E=[];else{var J=!1;Y.each(function(h){h.e!==_&&(J=!0)}),J&&(g.E=[])}if(Y.each(function(F){g.E&&g.E.push(F.e!=_?F.e:E),F=o.apply(F);var Q=Ng.toScreenPosition(C,F);r.push(Q.x,Q.y)}),y){var H=r.length,l=Ng.toScreenPosition(C,p._lastSourcePoint||(H?{x:r[0],y:r[1]}:{x:0,y:0})),I=Ng.toScreenPosition(C,p._lastTargetPoint||(H?{x:r[H-2],y:r[H-1]}:{x:0,y:0}));if(r.splice(0,0,l.x,l.y),r.push(I.x,I.y),g.E){var x=p.getSourceAgent();x instanceof b.Edge?g.E.splice(0,0,p.s("edge.source.offset.elevation")):g.E.splice(0,0,((p.s("edge.source.anchor.elevation")||.5)-.5)*x.getTall()*x.getScaleTall()+x.getElevation()+p.s("edge.source.offset.elevation"));var k=p.getTargetAgent();k instanceof b.Edge?g.E.push(p.s("edge.target.offset.elevation")):g.E.push(((p.s("edge.target.anchor.elevation")||.5)-.5)*k.getTall()*k.getScaleTall()+k.getElevation()+p.s("edge.target.offset.elevation"))}}if(!g.S||!g.S.size()){g.S=new b.List,g.S.add(1);for(var $=0;$<r.length/2-1;$++)g.S.add(2)}if((!j||s)&&d.convertToCubicBezier(O),d.activing&&(s||!d.editing||"realPoint"===d.editing.type)){var w=g.curve.findPairs(d.activing.point);d.activing.pairs=w}},Dn.prototype._convertToNewPoint=function(L,i,N,u){var O,M,t;for(O=0,M=i.length;M>O;O++){if(t=i[O],t._p1.isNearEnough(L)&&(!u||u.indexOf(t._p1)<0))return t._p1;if(t._p4.isNearEnough(L)&&(!u||u.indexOf(t._p4)<0))return t._p4}if(N)for(O=0,M=Math.min(N.length,M);M>O;O++){if(t=N[O],t._p1===L&&(!u||u.indexOf(i[O]._p1)<0))return i[O]._p1;if(t._p4===L&&(!u||u.indexOf(i[O]._p4)<0))return i[O]._p4}},Dn.prototype.convertToCubicBezier=function(Z){var b,G,J=this,y=new Ng.Math.Curve,N=J.screenInfo;if(y.createFromHtShape(N.P,N.S,N.E),N.curve=y,J.activing){var e=y._curves;b=J.activing.point,G=J._convertToNewPoint(b,e,Z);var F=[];if(G&&(J.activing.point=G,F.push(G)),J.activing.selections){var V=-1,Y=J.activing.selections;Y.forEach(function(I){V++,G=J._convertToNewPoint(I,e,Z,F),G&&(Y[V]=G,F.push(G))})}}},Dn.prototype.check=function(h,P,T){if(!P||Do(P)||iq(P)){var k=this;if(k._interactor.setCursor("default"),k.editing=null,k.highlight=null,k.tipInfo=null,k.edgeEditResult=null,k.screenInfo){if(Uq()||P&&iq(P))return k._interactor._42(),!0;if(k._checkEditCtrlPoint(T))return k._interactor._42(),!0;if(k._checkEditRealPoint(T))return k._interactor._42(),!0;if(k._checkEditElevation(T))return k._interactor._42(),!0;var q=k.screenInfo.curve,M=q.checkPoint(T,k._interactor.getStyle("curveIntersectSize"));if(M){var m=k.highlight={};m.type="insertKnot",m.bezier=M.bezier,m.point=M.intersection}return k._interactor._42(),!0}}},Dn.prototype.getAdjacentBeziers=function(m){var J=this.screenInfo;if(J){var j,y,u,Y=J.curve._curves,C=[],a=_;for(j=0,y=Y.length;y>j;j++)if(u=Y[j],a===_){if(u._p4.isNearEnough(m)){C.push(u),a=j;continue}}else{if(u._p1.isNearEnough(m))return C.push(u),C;if(u._p4.isNearEnough(m)){C[0]=u,a=j;continue}}}},Dn.prototype.roundCorner=function(U){if(this.activing&&this.screenInfo){var s=this.screenInfo.curve,J=s._curves,W=this.getAdjacentBeziers(this.activing.point),D=W[1],n=D._index;D=D.insertKnot(D.getTByPercentage(U/D.length))[1],J[n]=D;var e=D.p1,c=W[0],F=c._index;c=c.insertKnot(c.getTByPercentage(1-U/c.length))[0],J[F]=c;var v=c.p4,T=this.activing.point,Z=new Ng.Math.CubicBezier(v,T.clone().sub(v).multiplyScalar(2/3).add(v),T.clone().sub(e).multiplyScalar(2/3).add(e),e);J.splice(n,0,Z),this._writeToHt(),this.activing=null,this._interactor._42()}},Dn.prototype._checkEditRealPoint=function(p){var T,v,F,g,P,z,G=this,K=G.screenInfo.curve._curves,V=G._interactor.getStyle("curvePointIntersectSize"),W=1/0;for(V*=V,F=0,g=K.length;g>F;F++)T=K[F],P=T._p1,z=p.distanceToSquared(P),W>z&&(W=z,v=P),P=T._p4,z=p.distanceToSquared(P),W>z&&(W=z,v=P);if(W>V)return!1;var k=G.highlight={};return k.type="changeRealPoint",k.point=v,G.editing={type:"realPoint",point:v,shiftGuide:{point:v.clone(),dir:"x",limit:0}},G._interactor.setCursor("crosshair"),!0},Dn.prototype._checkEditElevation=function(E){var $=this;if(!$._interactor.getStyle("curveElevationVisible"))return!1;var K=$.target;if(K instanceof b.Edge&&!$._interactor.getStyle("edgeElevationEditable"))return!1;var v=$.activing;if(!v)return!1;var N=v.getCurrentEditingPoint();if(!N)return!1;var Z=$._interactor,m=Z.getStyle("curveElevationGuideShift"),k=Z.getStyle("curveElevationIntersectSize"),G=E.distanceToSquared({x:N.x+m[0],y:N.y+m[1]});if(!(G>k*k)){var X=$.highlight={};X.type="elevation";var B=new Ng.Math.Vector2(E.x,E.y,N.e);return $.editing={type:"elevation",startPoint:B},$._interactor.setCursor("crosshair"),!0}},Dn.prototype._checkEditCtrlPoint=function(u){var f=this;if(f.activing&&!f.activing.selections){var X=f.getCurrentSelectintStatus();if(X!==Ng.Curve.PointType.Straight){var j=f.activing.pairs;if(j){var g=f._interactor.getStyle("curvePointIntersectSize");
g*=g;var T,F,h,p,G,s,B,H,x,e=1/0;for(B=0,x=j.length;x>B;B++)for(p=j[B],H=0;2>H;H++)G=0===H?"c1":"c2",p[G]&&(s=u.distanceToSquared(p[G]),e>s&&(e=s,T=p,F=B,h=G));if(e>g)return!1;f.activing.hlpair=T,f.activing.hltype=h;var n=f.highlight={};return n.type="changeCtrlPoint",n.point=T[h],f.editing={type:"ctrlPoint",pair:T,pairId:F,ctrlType:h,direction:T[h].clone().sub(f.activing.point).normalize()},f._interactor.setCursor("crosshair"),!0}}}},Dn.prototype.startEdit=function(q,F){q.startDragging(F);var N=this;N.highlight&&"insertKnot"===N.highlight.type&&(N.insertKnot(),N.gatherSingleTarget(N._interactor.gv,N.target),N.activing=null,N._checkEditRealPoint(N._interactor._getLogicalPoint(F)));var E=N._activing;if(E){var A=N.editing?N.editing.type:null;"ctrlPoint"===A?E.editingCtrl={pairId:N.editing.pairId,type:E.hltype}:"realPoint"===A&&(E.editingCtrl=!1)}var J=N.highlight,M=b.Default.isCtrlDown(F);if(!J||Uq()||iq(F)){var U=N._interactor.gv;if(!U.setFocus(F)||U._scrolling)return;return M?N._multiSelect={startPoint:U.lp(F)}:U.isPannable()&&(Do(F)||iq(F))&&(N._pan={tx:U.tx(),ty:U.ty()},q.fi({kind:"beginPan",event:F})),void 0}if("changeRealPoint"===J.type){var v,P=N.activing?N.activing.point:null,c=N.activing?N.activing.selections:null;if(M&&N.activing)P===J.point?(c?(N.activing={point:c[0]},c.length>1&&(c.splice(0,1),N.activing.selections=c)):N.activing=null,N.editing=null):c&&(v=c.indexOf(J.point))>=0?(c.length>1?c.splice(v,1):delete N.activing.selections,N.editing=null):c?(c.push(P),N.activing={point:J.point,selections:c}):N.activing={point:J.point,selections:[P]};else if(c)P===J.point||((v=c.indexOf(J.point))>=0?(c.splice(v,1,P),N.activing={point:J.point,selections:c}):N.activing={point:J.point});else{var z;P===J.point&&(z=N.activing.status),N.activing={point:J.point},z&&(N.activing.status=z)}q.fi({kind:"beginEditPoint",event:F})}},Dn.prototype.insertKnot=function(){var _=this,D=_.highlight,W=_.screenInfo.curve;W.insertKnot(D.bezier,D.point.t),_._writeToHt()},Dn.prototype._writeToHt=function(){var E,j,w=this,_=w.screenInfo.curve,P=_.toHtShape(),Z=P.points,I=[],W=P.segments,g=w._interactor.gv;g.dm().beginTransaction();var U,C,z=w.target,X=z instanceof b.Edge,h=Ng.getDataMatrix(z).invert();C=z instanceof b.Polyline||X&&w._interactor.getStyle("edgeElevationEditable"),C&&(U=z.getElevation&&z.getElevation()||0);for(var N=0,K=Z.length;K>N;N++)E=Z[N],j=Ng.toWorldPosition(g,E),j=h.apply(j),isFinite(E.e)&&E.e!==U&&(j.e=E.e),I.push(j);if(z._writing=!0,X){z.s("edge.type","points"),z.setStyle("edge.segments",W),z.setStyle("edge.points",I.slice(1,I.length-1)),z.setStyle("edge.source.offset.x",0),z.setStyle("edge.source.offset.y",0),z.setStyle("edge.target.offset.x",0),z.setStyle("edge.target.offset.y",0);var y=w._nextChangeEdgeHost;delete w._nextChangeEdgeHost,y&&("source"===y.type?z.setSource(y.host):z.setTarget(y.host)),w._writeEdgeHostAnchor("source",I[0]),w._writeEdgeHostAnchor("target",I[I.length-1])}else I.length?(z.setSegments(W),z.setPoints(I,!0)):z.removeFromDataModel();g.dm().endTransaction(),delete z._writing},Dn.prototype._writeEdgeHostAnchor=function(B,k){var d=this,m=d.target,l=d._calcHostAnchor(m,B,k);l.index!==_?(m.setStyle("edge."+B+".index",l.index),m.setStyle("edge."+B+".percent",_),m.setStyle("edge."+B+".anchor.x",_),m.setStyle("edge."+B+".anchor.y",_),m.setStyle("edge."+B+".anchor.elevation",_),m.setStyle("edge."+B+".offset.elevation",k.e)):l.percent!==_?(m.setStyle("edge."+B+".percent",l.percent),m.setStyle("edge."+B+".index",_),m.setStyle("edge."+B+".anchor.x",_),m.setStyle("edge."+B+".anchor.y",_),m.setStyle("edge."+B+".anchor.elevation",_),m.setStyle("edge."+B+".offset.elevation",k.e)):(m.s("edge."+B+".anchor.x",l.x),m.s("edge."+B+".anchor.y",l.y),m.s("edge."+B+".anchor.elevation",l.e),l.offsetX||l.offsetY||l.offsetElevation?(m.s("edge."+B+".offset.x",l.offsetX),m.s("edge."+B+".offset.y",l.offsetY),m.s("edge."+B+".offset.elevation",l.offsetElevation)):(m.s("edge."+B+".offset.x",0),m.s("edge."+B+".offset.y",0),m.s("edge."+B+".offset.elevation",0)))},Dn.prototype._calcHostAnchor=function(o,j,a,K){K||(K="source"===j?o.getSource():o.getTarget());var q=this._interactor.gv,M=q.calculateAttachPoint(K,a);if(M)return M.info;if(hn(K)){var n=q.calculateEdgePosition(K,a);return n}var S=K.getRotation(),u=K.getAnchor();md(K,q)&&(S=0);var k=K.getElevation(),g=K.getTall()*K.getScaleTall();k=((a.e||0)-o.s("edge."+j+".offset.elevation")-k)/g+.5;var B=K.getScale();if(S||B.x<0||B.y<0){var v=K.getMatrix(),J=v.tfi(a),E=K.getSize();return{x:J.x/E.width+u.x,y:J.y/E.height+u.y,e:k}}var _=Zl(q,K),G={x:(a.x-_.x)/_.width,y:(a.y-_.y)/_.height,e:k};return G},Dn.prototype._handlePanning=function(b){var t=this,u=t._pan;if(u){u.started=!0;var k=t._interactor,a=k.gv,E=k._lastClientPoint,i=Hf(b),r=cp(a,i,E);a.setTranslate(u.tx+r.x,u.ty+r.y),t.gatherSingleTarget(k.gv,t.target),k._42(),k.fi({kind:"betweenPan",event:b})}},Dn.prototype.handleEdit=function(P,m){var r=this,R=r.editing;if(r._pan)return r._handlePanning(m),void 0;if(r._multiSelect)return r._multiSelect.endPoint=P.lp(m),r._interactor.redraw(),void 0;if(R){R.inEdit=!0;var A,f,v,p=r._interactor._getLogicalPoint(m),c=b.Default.isCtrlDown(m),O=b.Default.isShiftDown(m),h=R.type,C=r.activing;if(r._guideInfo=null,"ctrlPoint"===h&&O){var W=r.editing.direction.clone();A=C.point;var l=W.dot(p.clone().sub(A));p=W.setLength(l).add(A)}else if("ctrlPoint"===h||"realPoint"===h){var W;if("realPoint"===h&&O){var V=r.editing.shiftGuide;f=V.point;var E=Math.abs(p.x-f.x),z=Math.abs(p.y-f.y);E>z&&E>V.limit&&"y"===V.dir&&(V.dir="x"),z>E&&z>V.limit&&"x"===V.dir&&(V.dir="y"),W=V.dir,"x"===W?(p.y=f.y,V.limit=Math.max(V.limit,E)):"y"===W&&(p.x=f.x,V.limit=Math.max(V.limit,z))}if(!c){var X,Y=r._isEditEdgeSourceTarget();Y&&(X=p.clone());var $=r._guidingToEdit(p,W),o="realPoint"===h?r._interactor.gridGuide.findClosest(p,W,!0):null,I=1/0,N=1/0;o&&(o.x&&(I=o.x),o.y&&(N=o.y));var q=!1;if($&&($.xList&&(Math.abs($.x)<=Math.abs(I)?(q=!0,I=$.x):delete $.xList),$.yList&&(Math.abs($.y)<=Math.abs(N)?(q=!0,N=$.y):delete $.yList),q&&(r._guideInfo=$)),isFinite(I)&&(p.x+=I),isFinite(N)&&(p.y+=N),q&&($.v=p),Y){var t=q?p.clone():null;p.copy(X);var u=r._editEdgeSourceTarget(Y,p,c,t);u&&(r.edgeEditResult=u,v=u.tipText,u.isFixed&&(r._guideInfo=null))}}}var g=r.screenInfo.curve;if("realPoint"===R.type){A=R.point,A.e!==_&&(p.e=A.e),g.moveRealPoint(A,p),R.point=p,r.highlight.point=p;var x=C.status,a=C.selections;if(r.activing={point:p,status:x},a){var F=p.clone().sub(A),n=0;a.forEach(function(G){var m=G.clone().add(F);g.moveRealPoint(G,m),a[n++]=m}),r.activing.selections=a}}else if("ctrlPoint"===R.type){var s=C.pairs,U=s[R.pairId];g.moveCtrlPoint(U,p,R.ctrlType);var G=C.status,i=Ng.Curve.PointType;if((G===i.Mirrored||G===i.Asymmetric)&&U.c1&&U.c2){var A=new Ng.Math.Vector2(C.point),Z="c1"===R.ctrlType?"c2":"c1";if(G===Ng.Curve.PointType.Mirrored)g.moveCtrlPoint(U,A.clone().multiplyScalar(2).sub(p),Z);else if(G===i.Asymmetric){var l=U[Z].clone().sub(A).length(),y=A.clone().sub(U[R.ctrlType]).setLength(l).add(A);isNaN(y.x)||g.moveCtrlPoint(U,y,Z)}}C._firePointChange()}else if("elevation"===R.type){f=R.startPoint;var e=f.e+(f.y-p.y)/P._zoom;r._setCurrentPointImpl("e",e),C._firePointChange(),v="E: "+Ng.toFixed(e)}var B=b.Default.getLogicalPoint(m,r._interactor._canvas);if(B.x+=Ng.Icons.TipShiftX,B.y+=Ng.Icons.TipShiftY,!v){var Q=Ng.toWorldPosition(P,p);v=""+Ng.toFixed(Q.x)+", "+Ng.toFixed(Q.y)}r.tipInfo={helperPos:B,text:v,size:v.length},r._writeToHt(),r._interactor.fi({kind:"betweenEditPoint",event:m})}},Dn.prototype._setCurrentPointImpl=function(V,k){var T=this,M=T._activing;if(!M)return!1;var v=T.target;if(!v)return!1;var W=M.getCurrentEditingPoint();if(!W)return!1;var A=M.editingCtrl;if(!A)var d=W.clone();if("e"===V)W.e=k;else{var n;if("x"===V||"y"===V){var R=M._lastFirePoint;n="x"===V?{x:k,y:R?R.y:0}:{x:R?R.x:0,y:k}}else"object"==typeof V?(n=V,V.e!==_&&(W.e=V.e)):(n={x:arguments[0],y:arguments[1]},arguments[2]!==_&&(W.e=arguments[2]));var l=Ng.getDataMatrix(v);n=Ng.toScreenPosition(T._interactor.gv,l.apply(n)),W.x=n.x,W.y=n.y}if(!A){var P=d.multiplyScalar(-1).add(W);Ho(W.e)&&Ho(d.e)&&(P.e=W.e-d.e);var f=T.screenInfo.curve;f.moveCtrlDueToRealPointMovement(W,P);var x=M.selections;if(x){var I=0;x.forEach(function(H){var y=H.clone().add(P);isFinite(P.e)&&(y.e=(isFinite(H.e)?H.e:v.getElevation()||0)+P.e),f.moveRealPoint(H,y),x[I++]=y}),M.selections=x}}return!0},Dn.prototype.setCurrentPoint=function(d,b){return this._setCurrentPointImpl(d,b)?(this._writeToHt(),!0):!1},Dn.prototype._isEditEdgeSourceTarget=function(){var y=this,K=y.target;if(!(K instanceof b.Edge))return!1;var a=y.editing.point,Q=y.screenInfo.curve._curves;return a===Q[0]._p1?"source":a===Q[Q.length-1]._p4?"target":!1},Dn.prototype._editEdgeSourceTarget=function($,T,U,A){var I,q=this,t=q.target;if(I="source"===$?t.getSource():t.getTarget()){var p,C=q._interactor.gv,Q=Ng.toWorldPosition(C,T),r=q._calcHostAnchor(t,$,Q,I);if(p=r.index!==_||r.percent!==_?r.distance*C.getZoom()>q._interactor.getStyle("edgeHostEdgeMaxDistance"):q._interactor.getStyle("edgeHostDetectPerFrame")?!0:r.x<0||r.x>1||r.y<0||r.y>1?!0:!1){var G=C.getDataAt(Q,function(X){return C.isSelectable(X)?C.isSourceTargetEditable(t,X,$)?t.canSetSourceTarget(X,$)?!0:!1:!1:!1});if(G){var j=q._calcHostAnchor(t,$,Q,G);I=G,q._nextChangeEdgeHost={type:$,host:G},r=j}}var w,V,m,s=!1;if(U||r.x===_)(r.percent!==_||r.index!==_)&&(s=!0,V=r.point);else{var c=q._interactor.getStyle("anchorRound"),u=q._interactor.getStyle("anchorSensitivity");w=C.calculateAttachPoint(I,Q),w?(r=w.info,s=!0):(A&&(r=q._calcHostAnchor(t,$,Ng.toWorldPosition(C,A),I)),r.x=Ng.roundTo(r.x,c,u),r.y=Ng.roundTo(r.y,c,u)),V=Lp(C,I,0,r.offsetX||0,r.offsetY||0,r.x,r.y)}V&&(m=Ng.toScreenPosition(C,V),T.x=m.x,T.y=m.y),q._edgeHostGuideInfo={corners:Ng.getTargetCornersOnScreen(C,I),attach:w?w.index:-1,host:I};var X;return r.percent!==_?X="percent: "+r.percent.toFixed(2):r.index!==_?X="index: "+r.index:(X=""+r.x.toFixed(2)+", "+r.y.toFixed(2),(r.offsetX||r.offsetY)&&(X+=" offset: "+r.offsetX.toFixed(2)+", "+r.offsetY.toFixed(2))),{host:I,anchor:r,tipText:X,isFixed:s}}},Dn.prototype._guidingToEdit=function(u,h){var k,m,I=this;if(k=I.screenInfo.curve){m=k._curves;var g,Z,n,j,J,w,C,V,B=1/0,s=1/0,q=[];for(I.editing&&"realPoint"===I.editing.type&&(V=I.editing.point),J=0,w=2*m.length;w>J;J++)C=m[Math.floor(J/2)][J%2?"_p4":"_p1"],q.indexOf(C)>=0||(q.push(C),V&&V===C||(n=C.x-u.x,j=C.y-u.y,Math.abs(n)<Math.abs(B)?(B=n,g=[C]):n===B&&g.push(C),Math.abs(j)<Math.abs(s)?(s=j,Z=[C]):j===s&&Z.push(C)));var W=I._interactor.getStyle("smartGuideThreshold");if((Math.abs(B)>W||"y"===h)&&(g=null),(Math.abs(s)>W||"x"===h)&&(Z=null),g||Z){var E=!1,P={};if(g&&(E=!0,P.xList=g,P.x=B),Z&&(E=!0,P.yList=Z,P.y=s),E)return P}}},Dn.prototype._46O=function(K){var c=this;c.editing&&(c.editing=null,c._interactor.fi({kind:"endEditPoint",event:K})),c._guideInfo=null,c._edgeHostGuideInfo=null,c._pan&&(c._pan=null,c._interactor.fi({kind:"endPan",event:K})),c._multiSelect&&(c._handleMultiSelect(c._multiSelect,K),c._multiSelect=null),c.tipInfo=null,c.edgeEditResult=null},Dn.prototype._handleMultiSelect=function(e,v){if(e.startPoint&&e.endPoint){var M,z,Q,p,D,f,G=this,A=G._interactor,P=A.gv,R=Ng.toScreenPosition(P,e.startPoint),H=Ng.toScreenPosition(P,e.endPoint),y=b.Default.unionPoint(R,H),O=G.screenInfo.curve._curves,C=[],r=function(D){D.x>=y.x&&D.y>=y.y&&D.x<=y.x+y.width&&D.y<=y.y+y.height&&C.indexOf(D)<0&&C.push(D)};for(M=0,z=O.length;z>M;M++)D=O[M],r(D._p1),r(D._p4);if(C.length){var m=G.activing||{},I=m.selections||[];m.point&&I.push(m.point);var Z=b.Default.isShiftDown(v),E=v.altKey;if(E&&!Z)for(f=C,C=[],M=0,z=f.length;z>M;M++)Q=f[M],p=I.indexOf(Q),p>=0&&C.push(Q);for(M=0,z=I.length;z>M;M++)Q=I[M],p=C.indexOf(Q),p>=0?(!Z||Z&&E)&&(C[p]=_):C.push(Q);for(f=C,C=[],M=0,z=f.length;z>M;M++)f[M]&&C.push(f[M]);z=C.length,0===z?G.activing=null:1===z?G.activing={point:C[0]}:(Q=C[z-1],G.activing={point:Q,selections:C.splice(0,z-1)}),A.redraw()}}},Dn.prototype._canDeletePoint=function(L,M){var W=this.target;if(!(W instanceof b.Edge))return!0;var k=L._curves[0],D=L._curves[L._curves.length-1];return k._p1===M||D._p4===M?!1:!0},Dn.prototype.handleDelete=function(){var Y=this;if(Y.activing&&Y.screenInfo){var j=b.Default.isShiftDown(),B=Y.screenInfo.curve;Y._canDeletePoint(B,Y.activing.point)&&B.deleteRealPoint(Y.activing.point,j),Y.activing.selections&&Y.activing.selections.forEach(function($){Y._canDeletePoint(B,$)&&B.deleteRealPoint($,j)}),Y.activing=null,delete Y.editing,delete Y.tipInfo,delete Y.edgeEditResult,delete Y._pan,delete Y._multiSelect,Y._writeToHt(),Y._interactor.fp("deleteShapePoint",!1,!0)}},Dn.prototype.handleDoubleClick=function(C){var E=this,l=E._interactor._getLogicalPoint(C);if(E.screenInfo&&E._checkEditRealPoint(l)){var S=E.getCurrentSelectintStatus(),h=Ng.Curve.PointType;return S=S===h.Mirrored?h.Straight:h.Mirrored,E._setCurrentSelectionStatus(S),E._interactor._42(),!0}},Dn.prototype._drawHighlight=function(T){var x=this,Q=x.highlight;if(Q){var f=Q.bezier,O=x._interactor;f&&Ng.Icons.DrawIcon(O,T,Ng.Icons.ShapeHighlightCurve,[f._p1.x,f._p1.y,f._p2.x,f._p2.y,f._p3.x,f._p3.y,f._p4.x,f._p4.y]);var m=Q.point;m&&"insertKnot"===Q.type&&Ng.Icons.DrawIcon(O,T,Ng.Icons.ShapeHighlighPoint,m)}},Dn.prototype._drawGuide=function(k){var s=this,b=s._guideInfo;if(b){var R,N,T,q,$=b.v;for(R=0;2>R;R++)if(q=0===R?b.xList:b.yList)for(N=0,T=q.length;T>N;N++)Ng.Icons.DrawIcon(s._interactor,k,Ng.Icons.ShapeGuideLine,[$.x,$.y,q[N].x,q[N].y])}},Dn.prototype._drawCurrentPoint=function(D){var d=this;if(d.activing){var j=d.activing,b=d.getCurrentSelectintStatus(),J=d._interactor;if(b!==Ng.Curve.PointType.Straight){var E=j.pairs;j.hlpair,j.hltype;var p=j.selections,t=j.editingCtrl;if(E&&!p){var B,T,c;for(T=0,c=E.length;c>T;T++)B=E[T],t&&T===t.pairId&&B[t.type]?Ng.Icons.DrawIcon(J,D,Ng.Icons.ShapeActivingCtrl,{point:B.point,c1:B.c1,c2:B.c2,hl:t.type}):Ng.Icons.DrawIcon(J,D,Ng.Icons.ShapeActivingCtrl,B)}}Ng.Icons.DrawIcon(J,D,Ng.Icons.ShapeHighlighRealPoint,d.activing.point),p&&p.forEach(function(e){Ng.Icons.DrawIcon(J,D,Ng.Icons.ShapeHighlighRealPoint,e)})}},Dn.prototype.clear=function(){var b=this;b.editing=null,b._guideInfo=null,b.activing=null,b.highlight=null},Dn.prototype._42=function(P){var y=this;y.info={},y.editing||(y.screenInfo=null);var h=y._interactor;if(!h.editDetail)return y.clear(),void 0;var X=h.gv;if(!y.target||!X.isSelected(y.target)||!X.isVisible(y.target))return h.editDetail=!1,y.clear(),void 0;if(y.gatherSingleTarget(X,y.target),Ng.Icons.DrawIcon(h,P,Ng.Icons.ShapeBgCurve,y.screenInfo),y._interactor.getStyle("curveElevationVisible")&&(y.target instanceof b.Polyline||y.target instanceof b.Edge&&y._interactor.getStyle("edgeElevationEditable"))&&y.activing){var A=y.activing.getCurrentEditingPoint();A&&"string"!=typeof A.e&&Ng.Icons.DrawIcon(h,P,Ng.Icons.EdgeElevationGuide,A)}if(y._drawHighlight(P),y._drawCurrentPoint(P),y._getRealPoint().forEach(function($){Ng.Icons.DrawIcon(h,P,Ng.Icons.ShapePoint,$)}),y._drawGuide(P),y.tipInfo&&y._interactor.getStyle("curveTipVisible")&&Ng.Icons.DrawIcon(h,P,Ng.Icons.TipHelper,y.tipInfo),y._edgeHostGuideInfo&&h._drawHostGuide(y._edgeHostGuideInfo),y.edgeEditResult&&y._drawEdgeHostHighlight(P,y.edgeEditResult.host,y.edgeEditResult.anchor),y._multiSelect&&y._multiSelect.endPoint){var e=b.Default.unionPoint(Ng.toScreenPosition(X,y._multiSelect.startPoint),Ng.toScreenPosition(X,y._multiSelect.endPoint));e.color=X.getRectSelectBorderColor(),P.save(),P.setTransform(1,0,0,1,0,0);var w=C.devicePixelRatio,z=e.borderWidth=Math.round(w);z/=2,e.x=Math.round(e.x*w)+z,e.y=Math.round(e.y*w)+z,e.width=Math.round(e.width*w),e.height=Math.round(e.height*w),Ng.Icons.DrawIcon(h,P,Ng.Icons.SimpleRect,e),P.restore()}},Dn.prototype._drawEdgeHostHighlight=function(t,u,H){this.drawEdgeHostHighlight(t,u,H),this._interactor.redraw()},Dn.prototype.drawEdgeHostHighlight=function(s,V,d){if(hn(V)){var T,P,C,y,n=this,O=n._interactor,u=O.gv,B=u.getDataUI(V),E=Ur(B),A=[];for(C=0,y=E.points.length;y>C;C++)P=Ng.toScreenPosition(u,E.points.get(C)),A.push(P.x,P.y);E.segments&&(T=E.segments.toArray());var w=O.getStyle("edgeHostHighlighPeriod"),M=O.getStyle("edgeHostEdgeHighlighColor");Ng.Icons.DrawIcon(O,s,Ng.Icons.ShapeBgCurve,{P:A,S:T,color:M,dynamicVisible:d.index===_,dynamicPeriod:w}),M=O.getStyle("edgeHostPointHighlighColor");var q=Ul(B);for(C=0,y=q.length;y>C;C++){var k=q[C],X=Ng.toScreenPosition(u,k);Ng.Icons.DrawIcon(O,s,Ng.Icons.ShapePoint,{point:{x:X.x,y:X.y},color:M,size:12,dynamicVisible:C===d.index,dynamicPeriod:w})}}},Dn.prototype._getRealPoint=function(){var r,p=this.screenInfo,h=p.P,R=p.S,v=-1,j=[],Q=-1,q=R.length;return R.each(function(V){Q++;var Z=1;if(3===V)Z=2;else if(4===V)Z=3;else if(5===V)return;v+=Z,r=Q+1>=q?!0:1===R.get(Q+1)?!0:!1,j.push({point:{x:h[2*v],y:h[2*v+1]},segmentIndex:Q,pointIndex:v,isEnd:r})}),j},Dn.prototype.getEditingPointsInfo=function(K){var F=this,P=F.activing;if(!P)return!1;var o=P.point;if(!o)return!1;var V=this._getRealPoint(),c=[{screen:o}];P.selections&&P.selections.forEach(function(W){c.push({screen:W})});var J,n,q=V.length;return c.forEach(function(i){for(J=0;q>J;J++)if(n=V[J],i.screen.isNearEnough(n.point)){i.segmentIndex=n.segmentIndex,i.pointIndex=n.pointIndex,i.point=F.target.getPoints().get(n.pointIndex);break}}),K&&c.sort(function(g,o){return g.segmentIndex-o.segmentIndex}),c};var Nb=Ng.MoveHelper=function(p){var l=this;l.catalog="Move",l._interactor=p};Nb.prototype={},Nb.prototype.constructor=Nb,Nb.prototype.calcShift=function(F,O,q){var d,f,S=this,E=S._interactor.gv,$=E.lp(O);if("beginMove"===F&&S._gatherGridInfo(q._lastLogicalPoint||$),d=S._target){var D=d.downPosition;if(D){var G=S._interactor.getStyle("moveSensitivity")/E._zoom;if(D.distanceTo($)<G)return{x:0,y:0};delete d.downPosition}var k;f=b.Default.isShiftDown(O),f&&($=S._dealShiftDown($),k=d.shiftGuide.dir);var M,Z=d.rawPos={x:d.pos.x+$.x-d.lp.x,y:d.pos.y+$.y-d.lp.y};if(b.Default.isCtrlDown(O)){if(M=S._calcShiftByAddon(),S._target.node instanceof Ng.Group){var W=S._target.node;W._position.x+=M.x,W._position.y+=M.y}return M}var N=S._interactor.rectGuide;if(d.node instanceof b.Data&&d.node.s("2d.attachable")){var w=S._calcAttachNodeShift(d.node,Z);if(N.clear(),w)return w}for(var s,Y=d.x+Z.x,u=d.y+Z.y,o={x:Y,y:u},V={x:Y+d.w/2,y:u+d.h/2},v={x:Y+d.w,y:u+d.h},a=S._interactor.gridGuide,U=[N.findClosest(o,k),N.findClosest(V,k),N.findClosest(v,k),a.findClosest(o,k),a.findClosest(V,k),a.findClosest(v,k)],h=1/0,J=1/0,B=0,l=U.length;l>B;B++)s=U[B],s&&(Y=s.x,u=s.y,isFinite(Y)&&Math.abs(Y)<Math.abs(h)&&(h=Y),isFinite(u)&&Math.abs(u)<Math.abs(J)&&(J=u));if(isFinite(h)||(h=0),isFinite(J)||(J=0),M=S._calcShiftByAddon(h,J),S._target.node instanceof Ng.Group){var W=S._target.node;W._position.x+=M.x,W._position.y+=M.y}var Q=d.node;if(!md(Q,E)){var e=Z.x+h,x=Z.y+J;S._interactor.rectGuide.gatherLines({node:Q,x:d.x+e,y:d.y+x,w:d.w,h:d.h},k)}return M}},Nb.prototype._calcShiftByAddon=function(o,R){var B=this._target,g=B.rawPos,E=B.node.getPosition();return o=o||0,R=R||0,{x:g.x-E.x+o,y:g.y-E.y+R}},Nb.prototype._dealShiftDown=function(d){var X=this,Z=X._target.shiftGuide,c=X._target.lp,G=Math.abs(d.x-c.x),i=Math.abs(d.y-c.y);G>i&&G>Z.limit&&"y"===Z.dir&&(Z.dir="x"),i>G&&i>Z.limit&&"x"===Z.dir&&(Z.dir="y");var g=Z.dir;return"x"===g?(d.y=c.y,Z.limit=Math.max(Z.limit,G)):"y"===g&&(d.x=c.x,Z.limit=Math.max(Z.limit,i)),d},Nb.prototype._isAttachableLineShape=function(q){if(!q.getSegments)return!1;var N=q.getSegments();if(!N)return!0;N instanceof b.List&&(N=N.getArray());for(var O=1,U=N.length;U>O;O++)if(2!==N[O])return!1;return!0},Nb.prototype._calcAttachNodeShift=function(){var r=new jj,E=new jj,_=new jj,k=new jj;return function(K,b){var B=this._interactor.gv,Y=K.getHost(),G=B.getDataAt(b,function(u){return u.s("2d.hostable")?!0:!1});if(G&&Y!==G&&K.setHost(G),!G)return this._edgeHostGuideInfo=null,K.setHost(null);var F=this._edgeHostGuideInfo={corners:Ng.getTargetCornersOnScreen(B,G),host:G,attach:-1};if(this._isAttachableLineShape(G)){for(var c,Z,g,J,x,C,D=G.getPoints(),W=D.size(),U=G.getPointsMatrix2d(),Q=1/0,O=0;W>O&&(O!==W-1||G.isClosePath());O++)0!==O?E.copy(_):U.apply(D.get(O),E),U.apply(O===W-1?D.get(0):D.get(O+1),_),r.copy(b).sub(E),k.copy(_).sub(E),c=k.length(),k.divideScalar(c),Z=r.dot(k),0>Z?Z=0:Z>c&&(Z=c),k.multiplyScalar(Z).add(E),g=r.copy(b).sub(k).lengthSq(),Q>g&&(Q=g,C=O,J=Z,x=c);return Math.sqrt(Q)*B.getZoom()>this._interactor.getStyle("attachThreshold")?(K.s({"attach.index":-1}),K.setHost(null),void 0):(K.s("attach.offset.opposite")&&(J=x-J),K.s({"attach.index":C,"attach.offset":K.s("attach.offset.relative")?J/x:J}),{x:0,y:0})}var V=B.calculateAttachPoint(G,b);if(V){var f=V.point;return F.attach=V.index,this._calcShiftByAddon(f.x-b.x,f.y-b.y)}}}(),Nb.prototype._gatherGridInfo=function(k){var Y,V=this,w=V._interactor,X=w._getValidSelection();if(X.length){if(1===X.length){if(Y=X[0],!Y.getRect)return V._target=null,void 0}else if(Y=Ng.Group.findOrCreateGroup(X,w._uuid),!Y)return V._target=null,void 0}else{var X=w.gv.sm().getSelection();if(X.length&&(Y=X.get(0),!Y.getRect))return V._target=null,void 0}if(Y){var z=Y.getPosition(),M=Y.getRect();V._target={node:Y,x:M.x-z.x,y:M.y-z.y,w:M.width,h:M.height,lp:{x:k.x,y:k.y},pos:{x:z.x,y:z.y},shiftGuide:{dir:"x",limit:0},downPosition:new Ng.Math.Vector2(k)},w.rectGuide.gatherRects()}},Nb.prototype.clear=function(){var l=this;l._edgeHostGuideInfo=null,l._interactor.rectGuide.clear(),l._interactor._42()},Nb.prototype._42=function(){var D=this._edgeHostGuideInfo;D&&this._interactor._drawHostGuide(D)};var Di=x.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),Up=function(){function M(O,H){var Y=_;
return function(){return Y||(Y=O.getExtension(H)),Y}}function F(V,Y){Y==_&&(Y={}),Y.version=R&&(V instanceof WebGL2RenderingContext||x.prototype.toString.call(V)===J)?2:1,Y.extensions=function(){for(var d={},S=V.getSupportedExtensions(),e=S.length;e--;)d[name]=M(V,S[e]);return d}();for(var P=x.keys(o),m=0,r=P.length;r>m;++m){var W=P[m];Y[W]=V.getParameter(o[W])}if(Y.version>1){P=x.keys(O);for(var m=0,r=P.length;r>m;++m){var W=P[m];Y[W]=V.getParameter(O[W])}}return Y}var R="undefined"!=typeof WebGL2RenderingContext,J="[object WebGL2RenderingContext]",o={aliasedLineWidthRange:Di.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:Di.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:Di.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:Di.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:Di.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:Di.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:Di.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:Di.MAX_TEXTURE_SIZE,maxVaryingVectors:Di.MAX_VARYING_VECTORS,maxVertexAttribs:Di.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:Di.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:Di.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:Di.MAX_VIEWPORT_DIMS},O={max3DTextureSize:Di.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:Di.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:Di.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:Di.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:Di.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:Di.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:Di.MAX_DRAW_BUFFERS,maxElementIndex:Di.MAX_ELEMENT_INDEX,maxElementsIndices:Di.MAX_ELEMENTS_INDICES,maxElementsVertices:Di.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:Di.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:Di.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:Di.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:Di.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:Di.MAX_SAMPLES,maxTextureLODBias:Di.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:Di.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:Di.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:Di.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:Di.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:Di.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:Di.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:Di.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:Di.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:Di.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:Di.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(q){var O=q._info;return O||(q._info=O=F(q,O)),O}}}(),Uc=function(){function V(c,u,F){return{def:c,getter:F?function(r){var D=Up.for(r);return D.version>1?r.getParameter(u):c}:function(X){return X.getParameter(u)},setter:F?function(Q,q){var j=Up.for(Q);j.version>1&&Q.pixelStorei(u,q)}:function(D,R){D.pixelStorei(u,R)}}}function g(J){return"string"==typeof J?bc(J):J.r!==_?(N[0]=J.r,N[1]=J.g,N[2]=J.b,N[3]=J.a,N):J.red!==_?(N[0]=J.red,N[1]=J.green,N[2]=J.blue,N[3]=J.alpha,N):J}function v(a){return K(a)?Array.prototype.slice.call(a,0):a}function y(M,d,t){this.gl=d,this._record=t||{},this._branches={},this._leafSync={},this._struct=M;for(var K=M.children,p=K.length;p--;){var U=K[p],A=U.name;U.isLeaf?(this._leafSync[A]=!1,this._record[A]=v(U.desc.def)):this._record[A]={}}}function $(H){function t(K,x){y.call(this,H,K,x);for(var q=U.length;q--;){var N=U[q];this._branches[N._name]=new N._type(K,this._record[N._name])}}function v(C,y){function d(U,P){for(var h=s,l=!1;h--;)U[h]!==P[h]&&(U[h]=P[h],l=!0);return l}var H=C.name,S=K(C.desc.def),s=S&&C.desc.def.length;if(C.isLeaf){var J=C.desc.setter,v=C.desc.parse;x.defineProperty(y,H,{configurable:!1,enumerable:!0,get:function(){return this._record[H]},set:S?function(l){v&&(l=v(l)),(d(this._record[H],l)||!this._leafSync[H])&&(J(this.gl,this._record[H]),this._leafSync[H]=!0)}:function(T){this._record[H]===T&&this._leafSync[H]||(J(this.gl,T),this._record[H]=T,this._leafSync[H]=!0)}})}else U.push({_name:H,_type:$(C)}),x.defineProperty(y,H,{configurable:!1,enumerable:!0,get:function(){return this._branches[H]},set:function(p){this._branches[H].apply(p)}})}var U=[];return s(t,y),H.forEach(v,t.prototype),t}var N="undefined"!=typeof Float32Array&&new Float32Array(4),o={viewport:{def:[0,0,0/0,0/0],getter:function(j){return j.getParameter(j.VIEWPORT)},setter:function(E,R){var l=R[2]!==R[2]?E.drawingBufferWidth-R[0]:R[2],k=R[3]!==R[3]?E.drawingBufferHeight-R[1]:R[3];E.viewport(R[0],R[1],l,k)}},dither:{def:!1,getter:function(V){return V.isEnabled(V.DITHER)},setter:function(V,m){m?V.enable(V.DITHER):V.disable(V.DITHER)}},rasterizerDiscard:{def:!1,getter:function(A){var L=Up.for(A);return L.version>1&&A.isEnabled(A.RASTERIZER_DISCARD)},setter:function(z,W){var $=Up.for(z);1!==$.version&&(W?z.enable(z.RASTERIZER_DISCARD):z.disable(z.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(P){return P.lineWidth?P.getParameter(P.LINE_WIDTH):1},setter:function(l,u){l.lineWidth&&l.lineWidth(u)}},color:{clear:{def:[0,0,0,0],getter:function(s){return s.getParameter(s.COLOR_CLEAR_VALUE)},setter:function(w,C){w.clearColor(C[0],C[1],C[2],C[3])},parse:g},mask:{def:[!0,!0,!0,!0],getter:function(x){return x.getParameter(x.COLOR_WRITEMASK)},setter:function(E,T){E.colorMask(T[0],T[1],T[2],T[3])}}},blend:{enabled:{def:!1,getter:function(u){return u.isEnabled(u.BLEND)},setter:function(y,z){z?y.enable(y.BLEND):y.disable(y.BLEND)}},color:{def:[0,0,0,0],getter:function(d){return d.getParameter(d.BLEND_COLOR)},setter:function(q,L){q.blendColor(L[0],L[1],L[2],L[3])},parse:g},equation:{def:[Di.FUNC_ADD,Di.FUNC_ADD],getter:function(v){return[v.getParameter(v.BLEND_EQUATION_RGB),v.getParameter(v.BLEND_EQUATION_ALPHA)]},setter:function(E,n){E.blendEquationSeparate(n[0],n[1])},parse:function(K){var W=K.length;return W>1?K:1===W?(N[1]=N[0]=K[0],N):(N[1]=N[0]=K,N)}},func:{def:[Di.ONE,Di.ZERO,Di.ONE,Di.ZERO],getter:function(z){return[z.getParameter(z.BLEND_SRC_RGB),z.getParameter(z.BLEND_DST_RGB),z.getParameter(z.BLEND_SRC_ALPHA),z.getParameter(z.BLEND_DST_ALPHA)]},setter:function(z,n){z.blendFuncSeparate(n[0],n[1],n[2],n[3])},parse:function(d){var A=d.length;return A>3?d:(N[2]=N[0]=d[0],N[3]=N[1]=d[1],N)}}},cullFace:{enabled:{def:!1,getter:function(i){return i.isEnabled(i.CULL_FACE)},setter:function(X,L){L?X.enable(X.CULL_FACE):X.disable(X.CULL_FACE)}},mode:{def:Di.BACK,getter:function(D){return D.getParameter(D.CULL_FACE_MODE)},setter:function(u,m){u.cullFace(m)}},frontFace:{def:Di.CCW,getter:function(d){return d.getParameter(d.FRONT_FACE)},setter:function(K,w){K.frontFace(w)}}},scissor:{enabled:{def:!1,getter:function(G){return G.isEnabled(G.SCISSOR_TEST)},setter:function(_,O){O?_.enable(_.SCISSOR_TEST):_.disable(_.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(V){return V.getParameter(V.SCISSOR_BOX)},setter:function(Y,T){var F=T[2]!==T[2]?Y.drawingBufferWidth-T[0]:T[2],X=T[3]!==T[3]?Y.drawingBufferHeight-T[1]:T[3];Y.scissor(T[0],T[1],F,X)}}},depth:{enabled:{def:!1,getter:function(t){return t.isEnabled(t.DEPTH_TEST)},setter:function(m,d){d?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST)}},clear:{def:1,getter:function(d){return d.getParameter(d.DEPTH_CLEAR_VALUE)},setter:function(K,F){K.clearDepth(F)}},mask:{def:!0,getter:function(d){return d.getParameter(d.DEPTH_WRITEMASK)},setter:function(Y,j){Y.depthMask(j)}},range:{def:[-1,1],getter:function(D){return D.getParameter(D.DEPTH_RANGE)},setter:function(f,d){f.depthRange(d[0],d[1])}},func:{def:Di.LESS,getter:function(W){return W.getParameter(W.DEPTH_FUNC)},setter:function(g,h){g.depthFunc(h)}}},stencil:{enabled:{def:!1,getter:function(K){return K.isEnabled(K.STENCIL_TEST)},setter:function(O,L){L?O.enable(O.STENCIL_TEST):O.disable(O.STENCIL_TEST)}},clear:{def:0,getter:function(r){return r.getParameter(r.STENCIL_CLEAR_VALUE)},setter:function(B,K){B.clearStencil(K)}},frontMask:{def:255,getter:function(y){return y.getParameter(y.STENCIL_WRITEMASK)},setter:function(f,N){f.stencilMaskSeparate(f.FRONT,N)}},frontOp:{def:[Di.KEEP,Di.KEEP,Di.KEEP],getter:function(Q){return[Q.getParameter(Q.STENCIL_FAIL),Q.getParameter(Q.STENCIL_PASS_DEPTH_FAIL),Q.getParameter(Q.STENCIL_PASS_DEPTH_PASS)]},setter:function(R,c){R.stencilOpSeparate(R.FRONT,c[0],c[1],c[2])}},frontFunc:{def:[Di.ALWAYS,0,255],getter:function(l){return[l.getParameter(l.STENCIL_FUNC),l.getParameter(l.STENCIL_REF),l.getParameter(l.STENCIL_VALUE_MASK)]},setter:function(Q,p){Q.stencilFuncSeparate(Q.FRONT,p[0],p[1],p[2])}},backMask:{def:255,getter:function(t){return t.getParameter(t.STENCIL_BACK_WRITEMASK)},setter:function(l,N){l.stencilMaskSeparate(l.BACK,N)}},backOp:{def:[Di.KEEP,Di.KEEP,Di.KEEP],getter:function(P){return[P.getParameter(P.STENCIL_BACK_FAIL),P.getParameter(P.STENCIL_BACK_PASS_DEPTH_FAIL),P.getParameter(P.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(P,k){P.stencilOpSeparate(P.BACK,k[0],k[1],k[2])}},backFunc:{def:[Di.ALWAYS,0,255],getter:function(w){return[w.getParameter(w.STENCIL_BACK_FUNC),w.getParameter(w.STENCIL_BACK_REF),w.getParameter(w.STENCIL_BACK_VALUE_MASK)]},setter:function(E,W){E.stencilFuncSeparate(E.BACK,W[0],W[1],W[2])}}},hint:{generateMipmap:{def:Di.DONT_CARE,getter:function(c){return c.getParameter(c.GENERATE_MIPMAP_HINT)},setter:function(z,O){z.hint(z.GENERATE_MIPMAP_HINT,O)}},fragmentShaderDerivative:{def:Di.DONT_CARE,getter:function(Y){var J=Up.for(Y);return 1!==J.version||J.extensions.OES_standard_derivatives?Y.getParameter(Di.FRAGMENT_SHADER_DERIVATIVE_HINT):Di.DONT_CARE},setter:function(X,$){var l=Up.for(X);return l.version>1||l.extensions.OES_standard_derivatives?(X.hint(Di.FRAGMENT_SHADER_DERIVATIVE_HINT,$),void 0):void 0}}},pixelStore:{packAlignment:V(4,Di.PACK_ALIGNMENT,!1),unpackAlignment:V(4,Di.UNPACK_ALIGNMENT,!1),unpackFlipY:V(!1,Di.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:V(!1,Di.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:V(Di.BROWSER_DEFAULT_WEBGL,Di.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:V(0,Di.PACK_ROW_LENGTH,!0),packSkipPixels:V(0,Di.PACK_SKIP_PIXELS,!0),packSkipRows:V(0,Di.PACK_SKIP_ROWS,!0),unpackRowLength:V(0,Di.UNPACK_ROW_LENGTH,!0),unpackImageHeight:V(0,Di.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:V(0,Di.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:V(0,Di.UNPACK_SKIP_ROWS,!0),unpackSkipImages:V(0,Di.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(N){return N.isEnabled(N.POLYGON_OFFSET_FILL)},setter:function(p,H){H?p.enable(p.POLYGON_OFFSET_FILL):p.disable(p.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(R){return[R.getParameter(R.POLYGON_OFFSET_FACTOR),R.getParameter(R.POLYGON_OFFSET_UNITS)]},setter:function(_,e){_.polygonOffset(e[0],e[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(J){return J.isEnabled(J.SAMPLE_COVERAGE)},setter:function(_,o){o?_.enable(_.SAMPLE_COVERAGE):_.disable(_.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(G){return G.isEnabled(G.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(H,V){V?H.enable(H.SAMPLE_ALPHA_TO_COVERAGE):H.disable(H.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(e){return[e.getParameter(e.SAMPLE_COVERAGE_VALUE),e.getParameter(e.SAMPLE_COVERAGE_INVERT)]},setter:function(L,h){L.sampleCoverage(h[0],h[1])}}}},R=Jb.create(o,function(i){return"def"in i});y.prototype.reset=function(){for(var Y=this._struct.children,z=Y.length;z--;){var M=Y[z],i=M.name;M.isLeaf?this[i]=M.desc.def:this._branches[i].reset()}},y.prototype.save=function(F){F==_&&(F={});for(var D=this._struct.children,t=D.length;t--;){var l=D[t],z=l.name;if(l.isLeaf)F[z]=v(this._record[z]);else{var f=F[z];f==_&&(F[z]=f={}),this._branches[z].save(f)}}return F},y.prototype.sync=function(N,e){for(var G=this._struct.children,O=G.length;O--;){var K=G[O],k=K.name;K.isLeaf?(e||!this._leafSync[k])&&(N?(this._record[k]=K.desc.getter(this.gl),this._leafSync[k]=!0):(K.desc.setter(this.gl,this._record[k]),this._leafSync[k]=!0)):this._branches[k].sync(N,e)}},y.prototype.syncLoss=function(){for(var K=this._struct.children,e=K.length;e--;){var j=K[e];j.isLeaf?this._leafSync[j.name]=!1:this._branches[j.name].syncLoss()}},y.prototype.apply=function(h){for(var E=this._struct.children,O=E.length;O--;){var A=E[O],c=A.name;c in h&&(A.isLeaf?this[c]=h[c]:this._branches[c].apply(h[c]))}},y.prototype.append=function(h){var M=this._struct.childMap;for(var a in h){var n=M[a];n&&(n.isLeaf?this[a]=h[a]:this._branches[a].append(h[a]))}};var h=$(R);return function(Y){var t=Y._state;return t||(Y._state=t=new h(Y)),t}}(),Zf=function(){function l(W,r,u,a){if(W){var H=W.length;if(H!=_)for(var R=0;a>R;++R)r[u+R]=W[R];else W.toArray&&W.toArray(r,u)}else for(var R=0;a>R;++R)r[u+R]=0}function V(W,k,R){var C=W[0];if(0>=C||C>0)return W;var q=k*R,M=f[q];if(M==_&&(f[q]=M=new Float32Array(q)),0!==k){l(C,M,0,R);for(var O=1,L=0;O!==k;++O)L+=R,l(W[O],M,L,R)}return M}function w(I,W){I.uniform1f(this.addr,W)}function m(T,n){T.uniform1fv(this.addr,n)}function N(i,n){if(n.x!=_)i.uniform2f(this.addr,n.x,n.y);else{var T=f[2];T.set(n,0),i.uniform2fv(this.addr,T)}}function u(D,s){D.uniform2fv(this.addr,V(s,this.size,2))}function z(e,J){if(J.x!=_)e.uniform3f(this.addr,J.x,J.y,J.z);else if(J.r!=_)e.uniform3f(this.addr,J.r,J.g,J.b);else if(J.red!=_)e.uniform3f(this.addr,J.red,J.green,J.blue);else{var G=f[3];G.set(J,0),e.uniform3fv(this.addr,G)}}function R(I,x){I.uniform3fv(this.addr,V(x,this.size,3))}function T(E,O){if("string"==typeof O&&(O=bc(O)),O.x!=_)E.uniform4f(this.addr,O.x,O.y,O.z,O.w);else if(O.r!=_)E.uniform4f(this.addr,O.r,O.g,O.b,O.a);else if(O.red!=_)E.uniform4f(this.addr,O.red,O.green,O.blue,O.alpha);else{var L=f[4];L.set(O,0),E.uniform4fv(this.addr,L)}}function t(f,Z){f.uniform4fv(this.addr,V(Z,this.size,4))}function A(q,C){q.uniform1i(this.addr,C)}function j(N,p){N.uniform1iv(this.addr,p)}function O($,b){$.uniform2iv(this.addr,b)}function b(l,a){l.uniform3iv(this.addr,a)}function B(H,E){H.uniform4iv(this.addr,E)}function Y(a,Q){a.uniform1i(this.addr,L[Q?1:0])}function $(R,I){var J=f[4];J.set(I,0),R.uniformMatrix2fv(this.addr,!1,J)}function g(C,e){C.uniformMatrix2fv(this.addr,!1,V(e,this.size,4))}function P(_,b){var P=f[9];P.set(b,0),_.uniformMatrix3fv(this.addr,!1,P)}function o(z,X){z.uniformMatrix3fv(this.addr,!1,V(X,this.size,9))}function I(T,P){var l=f[16];l.set(P,0),T.uniformMatrix4fv(this.addr,!1,l)}function Q(F,M){F.uniformMatrix4fv(this.addr,!1,V(M,this.size,16))}function F(F,y){F.uniform1i(this.addr,this.slots[0]),F.activeTexture(F.TEXTURE0+this.slots[0]),F.bindTexture(F.TEXTURE_2D,y||F._emptyTexture)}function M(l,a){l.uniform1iv(this.addr,this.slots);for(var t=this.slots.length;t--;)l.activeTexture(l.TEXTURE0+this.slots[t]),l.bindTexture(l.TEXTURE_2D,a[t]||l._emptyTexture)}function i(F,Z){F.uniform1i(this.addr,this.slots[0]),F.activeTexture(F.TEXTURE0+this.slots[0]),F.bindTexture(F.TEXTURE_CUBE_MAP,Z||F._emptyCubeTexture)}function a(h,c){h.uniform1iv(this.addr,this.slots);for(var N=this.slots.length;N--;)h.activeTexture(h.TEXTURE0+this.slots[N]),h.bindTexture(h.TEXTURE_CUBE_MAP,c[N]||h._emptyCubeTexture)}function q(U,Y,n){C[U]=[Y,n]}function n(M,R,e){switch(M.type){case 35678:case 35680:if("uSampler"===e)return[0];if("uBlendSampler"===e)return[1];for(var E=M.size,B=new Int32Array(E),Y=0;E>Y;++Y)B[Y]=R.usedTextureSlot++;return B}return _}function d(j,x,I,H,U){this.name=j,this.addr=x,this.size=H?I.size:0,this.activeInfo=I,this.setter=C[I.type][H?1:0],this.slots=n(I,U,j),ts(this)}function Z(o,w,r,U){var B=o.name,L=B.length;for(e.lastIndex=0;;){var u=e.exec(B),v=e.lastIndex,n=u[1],W="]"===u[2],R=u[3];if(W&&(n=0|n),R===_||"["===R&&v+2===L){r[n]=new d(n,w,o,R!==_,U);break}var b=r[n];b==_&&(r[n]=b={}),r=b}}function h(Y,i,$){this.gl=i,this._program=$,this._leaves={},this._branches={},this._struct=Y}function r(v){function X(p,M){h.call(this,v,p,M);for(var k=F.length;k--;){var c=F[k];this._branches[c._name]=new c._type(p,M)}this.uuid=$m.generateUUID()}function U(a,m){var H=a.name;if(a.isLeaf){var K=p("d.setter(this.gl, v);",["v"],["d"],[a.desc]);x.defineProperty(m,H,{configurable:!1,enumerable:!0,get:function(){return K},set:K})}else F.push({_name:H,_type:r(a)}),x.defineProperty(m,H,{configurable:!1,enumerable:!0,get:function(){return this._branches[H]},set:function(E){this._branches[H].apply(E)}})}var F=[];return s(X,h),v.forEach(U,X.prototype),X}function H(u,v){for(var $=u.getProgramParameter(v,u.ACTIVE_UNIFORMS),C={},S={usedTextureSlot:2};$--;){var Q=u.getActiveUniform(v,$),d=Q.name,w=u.getUniformLocation(v,d);Z(Q,w,C,S)}var t=Jb.create(C,function(h){return"addr"in h}),l=r(t);return x.defineProperty(l.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:S.usedTextureSlot}),new l(u,v)}var f=[];if("function"==typeof Float32Array)for(var D=1;17>D;++D)f[D]=new Float32Array(D);var L=[0,1],C=[];q(Di.FLOAT,w,m),q(Di.FLOAT_VEC2,N,u),q(Di.FLOAT_VEC3,z,R),q(Di.FLOAT_VEC4,T,t),q(Di.INT,A,j),q(Di.INT_VEC2,O,O),q(Di.INT_VEC3,b,b),q(Di.INT_VEC4,B,B),q(Di.BOOL,Y,j),q(Di.BOOL_VEC2,O,O),q(Di.BOOL_VEC3,b,b),q(Di.BOOL_VEC4,B,B),q(Di.FLOAT_MAT2,$,g),q(Di.FLOAT_MAT3,P,o),q(Di.FLOAT_MAT4,I,Q),q(Di.SAMPLER_2D,F,M),q(Di.SAMPLER_CUBE,i,a);var e=/([\w\d_]+)(\])?(\[|\.)?/g;return h.prototype.apply=function(D){for(var T=this._struct.children,t=T.length;t--;){var Q=T[t],W=Q.name;W in D&&(Q.isLeaf?this[W]=D[W]:this._branches[W].apply(D[W]))}},h.prototype.append=function(M){var O=this._struct.childMap;for(var a in M){var C=O[a];C&&(C.isLeaf?this[a]=M[a]:this._branches[a].append(M[a]))}},function(W,U){var t=U._uniforms;return t||(U._uniforms=t=H(W,U)),t}}(),Fi=function(){function m(j,f,d){f.vertexAttrib1f(j.addr,d)}function B(p,T,n){if(n.x!=_)T.vertexAttrib2f(p.addr,n.x,n.y);else{var w=k[2];w.set(n,0),T.vertexAttrib2fv(p.addr,w)}}function E(P,h,t){if(t.x!=_)h.vertexAttrib3f(P.addr,t.x,t.y,t.z);else if(t.r!=_)h.vertexAttrib3f(P.addr,t.r,t.g,t.b);else if(t.red!=_)h.vertexAttrib3f(P.addr,t.red,t.green,t.blue);else{var c=k[3];c.set(t,0),h.vertexAttrib3fv(P.addr,c)}}function o(d,s,Q){if("string"==typeof Q&&(Q=bc(Q)),Q.x!=_)s.vertexAttrib4f(d.addr,Q.x,Q.y,Q.z,Q.w);else if(Q.r!=_)s.vertexAttrib4f(d.addr,Q.r,Q.g,Q.b,Q.a);else if(Q.red!=_)s.vertexAttrib4f(d.addr,Q.red,Q.green,Q.blue,Q.alpha);else{var o=k[4];o.set(Q,0),s.vertexAttrib4fv(d.addr,o)}}function t(s,E,b){b=b.el||b;for(var z=0,Z=0;2>z;++z)E.vertexAttrib2f(s.addr,b[Z++],b[Z++])}function r(F,r,U){U=U.el||U;for(var z=0,I=0;3>z;++z)r.vertexAttrib3f(F.addr,U[I++],U[I++],U[I++])}function O(K,J,T){T=T.el||T;for(var p=0,c=0;4>p;++p)J.vertexAttrib4f(K.addr,T[c++],T[c++],T[c++],T[c++])}function J(o,D,L,U,P,E,e){D.bindBuffer(D.ARRAY_BUFFER,L),D.vertexAttribPointer(o.addr,1,U||D.FLOAT,!!P,E||0,e||0),D.bindBuffer(D.ARRAY_BUFFER,null)}function h(S,p,t,N,$,P,w){p.bindBuffer(p.ARRAY_BUFFER,t),p.vertexAttribPointer(S.addr,2,N||p.FLOAT,!!$,P||0,w||0),p.bindBuffer(p.ARRAY_BUFFER,null)}function q(Y,R,A,v,_,D,s){R.bindBuffer(R.ARRAY_BUFFER,A),R.vertexAttribPointer(Y.addr,3,v||R.FLOAT,!!_,D||0,s||0),R.bindBuffer(R.ARRAY_BUFFER,null)}function T(n,L,J,o,O,C,I){L.bindBuffer(L.ARRAY_BUFFER,J),L.vertexAttribPointer(n.addr,4,o||L.FLOAT,!!O,C||0,I||0),L.bindBuffer(L.ARRAY_BUFFER,null)}function y(X,z,O,j,S,i,W){var i=i||4,W=W||0;z.bindBuffer(z.ARRAY_BUFFER,O),z.vertexAttribPointer(X.addr,2,j||z.FLOAT,!!S,i,W),z.vertexAttribPointer(X.addr+1,2,j||z.FLOAT,!!S,i,W+2),z.bindBuffer(z.ARRAY_BUFFER,null)}function C(H,B,W,p,$,w,O){var w=w||9,O=O||0;B.bindBuffer(B.ARRAY_BUFFER,W),B.vertexAttribPointer(H.addr,3,p||B.FLOAT,!!$,w,O),B.vertexAttribPointer(H.addr+1,3,p||B.FLOAT,!!$,w,O+3),B.vertexAttribPointer(H.addr+2,3,p||B.FLOAT,!!$,w,O+6),B.bindBuffer(B.ARRAY_BUFFER,null)}function R(M,S,k,n,T,d,u){var d=d||16,u=u||0;S.bindBuffer(S.ARRAY_BUFFER,k),S.vertexAttribPointer(M.addr,4,n||S.FLOAT,!!T,d,u),S.vertexAttribPointer(M.addr+1,4,n||S.FLOAT,!!T,d,u+4),S.vertexAttribPointer(M.addr+2,4,n||S.FLOAT,!!T,d,u+8),S.vertexAttribPointer(M.addr+3,4,n||S.FLOAT,!!T,d,u+12),S.bindBuffer(S.ARRAY_BUFFER,null)}function j(r,H,e){M[r]=function(r,$,g,Z,f,D){this.addr==_||this.addr<0||($==_||$===!1?r.disableVertexAttribArray(this.addr):fg($)===d?(r.enableVertexAttribArray(this.addr),e(this,r,$,g,Z,f,D)):(r.disableVertexAttribArray(this.addr),H(this,r,$)))}}function n(Z,l,R){this.name=Z,this.addr=l,this.activeInfo=R,this.setter=M[R.type],ts(this)}function a(F,J,Y){this.gl=J,this.program=Y,this._branches={},this._struct=F}function X(f){function w(Q,L){a.call(this,f,Q,L);for(var J=$.length;J--;){var X=$[J];this._branches[X._name]=new X._type(Q,L)}}function A(R,Y){var k=R.name;if(R.isLeaf){var v=p("d.setter(this.gl, v);",["v"],["d"],[R.desc]);x.defineProperty(Y,k,{configurable:!1,enumerable:!0,get:function(){return v},set:v})}else $.push({_name:k,_type:X(R)}),x.defineProperty(Y,k,{configurable:!1,enumerable:!0,get:function(){return this._branches[k]},set:function(w){this._branches[k].apply(w)}})}var $=[];return s(w,a),f.forEach(A,w.prototype),w}function w(L,y){for(var z=L.getProgramParameter(y,L.ACTIVE_ATTRIBUTES),T={};z--;){var p=L.getActiveAttrib(y,z),e=p.name,V=L.getAttribLocation(y,e);T[e]=new n(e,V,p)}var c=Jb.create(T,function(i){return"addr"in i}),i=X(c);return new i(L,y)}for(var k=[],W=1;17>W;++W)k[W]=new Ac(W);var M=[],d="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return j(Di.FLOAT,m,J),j(Di.FLOAT_VEC2,B,h),j(Di.FLOAT_VEC3,E,q),j(Di.FLOAT_VEC4,o,T),j(Di.FLOAT_MAT2,t,y),j(Di.FLOAT_MAT3,r,C),j(Di.FLOAT_MAT4,O,R),a.prototype.disable=function(){for(var R=this._struct.children,T=R.length;T--;){var S=R[T],j=S.name;S.isLeaf?this.gl.disableVertexAttribArray(S.desc.addr):this._branches[j].disable()}},a.prototype.apply=function(s){for(var a=this._struct.children,X=a.length;X--;){var m=a[X],E=m.name;E in s&&(m.isLeaf?this[E]=s[E]:this._branches[E].apply(s[E]))}},a.prototype.append=function(w){var H=this._struct.childMap;for(var T in w){var M=H[T];M&&(M.isLeaf?this[T]=w[T]:this._branches[T].append(w[T]))}},function(k,h){var j=h._attribs;return j||(h._attribs=j=w(k,h)),j}}(),Of=function(q){var Z=this;x.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:q,writable:!1},glState:{configurable:!1,enumerable:!1,value:Uc(q),writable:!1}}),Z._currProgram=_,Z._currUniforms=_,Z._currAttribs=_,Z._sync=!0};x.defineProperties(Of.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(S){var K=this;K._sync&&S===K._currProgram||(K.gl.useProgram(S),K._currProgram=S,K._currUniforms=Zf(K.gl,S),K._currAttribs=Fi(K.gl,S),K._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var N=this;return N._currProgram&&!N._sync&&(N.gl.useProgram(N._currProgram),N._sync=!0),N._currUniforms},set:function(W){var o=this;o._currUniforms&&(o._currProgram&&!o._sync&&(o.gl.useProgram(o._currProgram),this._sync=!0),o._currUniforms.apply(W))}},attribs:{configurable:!1,enumerable:!1,get:function(){var q=this;return q._currProgram&&!q._sync&&(q.gl.useProgram(q._currProgram),q._sync=!0),q._currAttribs},set:function(J){var q=this;q._currUniforms&&(q._currProgram&&!q._sync&&(q.gl.useProgram(q._currProgram),this._sync=!0),q._currAttribs.apply(J))}}}),Of.prototype.useProgram=function(h){var K=this;K._sync&&h===K._currProgram||(K.gl.useProgram(h),K._currProgram=h,K._currUniforms=Zf(K.gl,h),K._currAttribs=Fi(K.gl,h),K._sync=!0)},Of.prototype.directState=function(){return this.glState},Of.prototype.directUniforms=function(){return this._currUniforms},Of.prototype.directAttribs=function(){return this._currAttribs},Of.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},Of.for=function(D){var G=D._renderState;return G||(D._renderState=G=new Of(D)),G};var pb="directional",Wd="point",cj="spot",Sm="light.color",zg=4294967295,Jr=0,wd={},Ib=[],ck=0,nh=function(I,R){am(R)&&Gk.test(R)?bp(I,R):vp(R)&&R.modelType?Mc(I,R):R===_?delete Ko[I]:Ko[I]=R},lk=function(p){return p},Lc=function(x){x=C.convertShape3dModelName(x);var g;if(vp(x)){if(x.modelType){if(x.uuid){if(g=Ko[x.uuid])return g}else x.uuid=b.Math.generateUUID();return g===_&&(kb&&kb[x.uuid]||Mc(x.uuid,x)),_}return x}return g=Ko[x],x&&g===_&&Gk.test(x)&&(kb&&kb[x]||bp(x,x)),g},Kl=function(h,w){h.frameStack?h.frameStack.push(w):h.frameStack=[w],h.bindFramebuffer(h.FRAMEBUFFER,w)},ml=function($){var C=$.frameStack;if(C){if(C.pop(),C.length)return $.bindFramebuffer($.FRAMEBUFFER,C[C.length-1]),void 0;$.frameStack=null}$.bindFramebuffer($.FRAMEBUFFER,null)};nd(C,{graph3dViewAttributes:Q,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:e/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:il,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:e,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:e/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:nh,getShape3dModel:Lc,convertShape3dModelName:lk,getShape3dModelMap:function(){return Ko},getCachedShape3dModelMap:function(){return ak},createMatrix:function(Y,T){oi(Y)||(Y=[Y]);for(var i=Y.length-1;i>=0;i--){var g=Y[i];T=qh(g.mat,g.s3,g.r3,g.rotationMode,g.t3,T)}return T},transformVec:function(s,F){return ao(s,F)},glBindFrame:Kl,glUnbindFrame:ml,createBoxModel:function(){return{vs:tq,ns:Uo,uv:Gm,is:hi}},createRoundRectModel:function(p,L){return Oe.roundRect(p,L)},createStarModel:function(x,J){return Oe.star(x,J)},createRectModel:function(x,u){return Oe.rect(x,u)},createTriangleModel:function(H,q){return Oe.triangle(H,q)},createRightTriangleModel:function(w,$){return Oe.rightTriangle(w,$)},createParallelogramModel:function(Q,Z){return Oe.parallelogram(Q,Z)},createTrapezoidModel:function(j,z){return Oe.trapezoid(j,z)},createSmoothSphereModel:function(S,B,e,Q,l,s,j){return di(new Qm(S,B,e,Q,l,s,j))},createSphereModel:function(y,V,T,B,m,K,O){return y?xc(y,V,T,B,m,K,O):C.createSmoothSphereModel()},createSmoothConeModel:function(o,H,g,Z,S){return Xe(o,H,g,Z,S)},createConeModel:function(c,H,w,K,v,F,Q,q){return c?Bi(c,H,w,K,v,F,Q,q):Xe(F)},createSmoothCylinderModel:function(E,v,b,c,M,W,n,R){return di(new ro(E,v,b,c,M,W,n,R))},createCylinderModel:function(o,p,F,P,Y,h,I,U){return o?_n(o,p,F,P,Y,h,I,U):bj(h,I)},createSmoothTorusModel:function(j,n,w,Y,f,P){return di(new Jj(j,n,w,Y,f,P))},createTorusModel:function(_,z,V,J,R,M,Y,l){return _?fn(_,z,V,J,R,M,Y,l):ks(M,Y)},createExtrusionModel:function(t,j,A,M,u,T,k,l){return Qj(t,j,A,M,u,T,k,l)},createSmoothRingModel:function(p,w,y,x,B,d){for(var P=[],e=0;e<p.length-1;e+=2)P.push({x:p[e],y:p[e+1]});for(p=Mr(P,w,y)[0],P=[],e=0;e<p.length;e++){var M=p[e];P.push(new yp(M.x,0,M.y))}return di(new ps(P,d,x,B))},createTextGeometry:function(n,R){return di(new om(n,R))},loadFontFace:function(R,v){C.xhrLoad(R,function(x){if(!x)return v();var u;try{u=JSON.parse(x)}catch(J){u=JSON.parse(x.substring(65,x.length-2))}th.loadFace(u),v&&v(u.familyName.toLowerCase())},v?null:{sync:!0})},getShaderErrorLog:function(){return Ib.join("\n")},createRingModel:function(F,w,P,H,B,f,S,k,Y,s){for(var N=[],e=0;e<F.length-1;e+=2)N.push({x:F[e],y:F[e+1]});f=f||C.shapeSide,S=S||0,k=k||f;var J,O,v,D,a,d,W,i,b,V,e,Z,T,g,G,r,n,t,M=[],E=[],I=Y?[]:Q,K=Y?[]:Q,o=s?[]:Q,m=s?[]:Q,u=H?[]:Q,U=H?[]:Q,L=B?[]:Q,X=B?[]:Q,F=Mr(N,w,P),q=xh(F),y=0,z=2*Math.PI/f;return F.forEach(function(_){if(v=_.length,v>1){if(D=_[0],H)for(d=D.x,i=D.y,e=S;k>e;e++)Z=e+1,T=e*z,g=Z*z,G=j(T),r=h(T),n=j(g),t=h(g),u.push(G*d,i,-r*d,n*d,i,-t*d,0,i,0),U.push(.5-.5*G,.5-.5*r,.5-.5*n,.5-.5*t,.5,.5);for(V=0;v>V;V++){for(a=_[V],d=D.x,W=a.x,i=D.y,b=a.y,J=y/q,y+=Ki(D,a),O=y/q,e=S;k>e;e++)Z=e+1,T=e*z,g=Z*z,G=j(T),r=h(T),n=j(g),t=h(g),M.push(G*W,b,-r*W,n*W,b,-t*W,G*d,i,-r*d,n*W,b,-t*W,n*d,i,-t*d,G*d,i,-r*d),E.push(e/f,O,Z/f,O,e/f,J,Z/f,O,Z/f,J,e/f,J),Y&&e===S&&(I.push(0,i,0,0,b,0,G*W,b,-r*W,G*W,b,-r*W,G*d,i,-r*d,0,i,0),K.push(0,.5-i,0,.5-b,2*W,.5-b,2*W,.5-b,2*d,.5-i,0,.5-i)),s&&Z===k&&(o.push(0,i,0,n*W,b,-t*W,0,b,0,n*W,b,-t*W,0,i,0,n*d,i,-t*d),m.push(1,.5-i,1-2*W,.5-b,1,.5-b,1-2*W,.5-b,1,.5-i,1-2*d,.5-i));D=a}if(B)for(d=D.x,i=D.y,e=S;k>e;e++)Z=e+1,T=e*z,g=Z*z,G=j(T),r=h(T),n=j(g),t=h(g),L.push(n*d,i,-t*d,G*d,i,-r*d,0,i,0),X.push(.5-.5*n,.5+.5*t,.5-.5*G,.5+.5*r,.5,.5)}}),{vs:M,uv:E,bottom_vs:L,bottom_uv:X,top_vs:u,top_uv:U,from_vs:I,from_uv:K,to_vs:o,to_uv:m}}},!0),nd(X,{"3d.move.mode":_,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":_,"edge.gradient.color":_,"edge.source.t3":_,"edge.target.t3":_,"light.type":Wd,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":e/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":zg,"headlight.ambientIntensity":_,"wf.visible":!1,"wf.width":1,"wf.color":Hc,"wf.short":!1,"wf.mat":_,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:_,"transparent.mask":!1,brightness:_,"select.brightness":.7,"repeat.uv.length":_,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":_,"3d.clipbox.mask":zg,"3d.clipbox.group":0,"effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.intensity":1,"effect.flow.blend":_,"effect.flow.mask":zg,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":_,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":fb,"label.t3":_,"label.r3":_,"label.texture.scale":2,"label.rotationMode":hj,"label.light":!1,"label.blend":_,"label.reverse.flip":!1,"label.reverse.color":Ak,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":fb,"label2.t3":_,"label2.r3":_,"label2.texture.scale":2,"label2.rotationMode":hj,"label2.light":!1,"label2.blend":_,"label2.reverse.flip":!1,"label2.reverse.color":Ak,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":fb,"note.t3":_,"note.r3":_,"note.texture.scale":2,"note.rotationMode":hj,"note.light":!1,"note.blend":_,"note.reverse.flip":!1,"note.reverse.color":Ak,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":fb,"note2.t3":_,"note2.r3":_,"note2.texture.scale":2,"note2.rotationMode":hj,"note2.light":!1,"note2.blend":_,"note2.reverse.flip":!1,"note2.reverse.color":Ak,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:_,"shape3d.color":yo,"shape3d.top.color":_,"shape3d.bottom.color":_,"shape3d.from.color":_,"shape3d.to.color":_,"shape3d.image":_,"shape3d.image.projection":_,"shape3d.top.image":_,"shape3d.bottom.image":_,"shape3d.from.image":_,"shape3d.to.image":_,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":_,"shape3d.side.to":_,"shape3d.smooth":_,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":_,"shape3d.opacity":_,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Ak,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":_,"shape3d.uv.scale":_,"shape3d.uv.rotation":_,"shape3d.top.uv.offset":_,"shape3d.top.uv.scale":_,"shape3d.top.uv.rotation":_,"shape3d.bottom.uv.offset":_,"shape3d.bottom.uv.scale":_,"shape3d.bottom.uv.rotation":_,"shape3d.from.uv.offset":_,"shape3d.from.uv.scale":_,"shape3d.from.uv.rotation":_,"shape3d.to.uv.offset":_,"shape3d.to.uv.scale":_,"shape3d.to.uv.rotation":_,"shape3d.top.cap":_,"shape3d.bottom.cap":_,"shape3d.start.angle":0,"shape3d.sweep.angle":Z,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":_,"camera.ortho.width":_,"camera.near":_,"camera.far":_,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":_,"texture.filter":_,"texture.filter.min":_,"texture.filter.mag":_,"texture.wrap":_,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":yo,"all.image":_,"all.blend":_,"all.opacity":_,"all.reverse.flip":!1,"all.reverse.color":Ak,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":_,"all.uv.offset":_,"all.uv.scale":_,"all.uv.rotation":_,"all.discard.selectable":!0,mat:_,"left.mat":_,"right.mat":_,"top.mat":_,"bottom.mat":_,"front.mat":_,"back.mat":_,"edge.source.anchor.elevation":_,"edge.target.anchor.elevation":_,"edge.source.offset.elevation":0,"edge.target.offset.elevation":0},!0);
var ym,On=!1,Ml=[0,0,0,0],co=function(q){return q instanceof Mf},kh=function(M){return[M.x,M.e||0,M.y]},If=function(C,g,E){for(var g=bc(g||0),T=g[0],U=g[1],s=g[2];E--;)C.push(T,U,s)},Ik=function(_,W,I){for(var W=bc(W||0),g=W[0],i=W[1],B=W[2],J=W[3];I--;)_.push(g,i,B,J)},sc=function(q,E,l){if(E)for(var M,B,n,S=E[0],h=E[1],s=E[2],a=E[4],t=E[5],F=E[6],i=E[8],o=E[9],r=E[10],O=E[12],U=E[13],k=E[14],u=l.length,g=0,g=0;u>g;g+=3)M=l[g],B=l[g+1],n=l[g+2],q.push(S*M+a*B+i*n+O,h*M+t*B+o*n+U,s*M+F*B+r*n+k);else ir(q,l)},Jc=function(c,i,v){var X=i.s("light.intensity"),R=bc(i.s(Sm)),l=R[0],n=R[1],V=R[2];1!==X&&(l*=X,n*=X,V*=X);var Y=i.s("light.disabled");c.push(l,n,V,Y?1:0),v.c.push(l,n,V),v.g.push(Y?-1:i.s("light.group")),v.e.push(Y?1:0)},Ub=function(A,E){var P=Of.for(E),h=P.directUniforms(),d=A._lastLightUploadInfo={c:[],g:[],e:[]};h.uHeadlightRange=A._headlightRange;var t=h.uHeadlightAmbientIntensity=A._headlightAmbientIntensity,Z=A._headlightIntensity,G=bc(A._headlightColor);1!==Z&&(G=[G[0]*Z,G[1]*Z,G[2]*Z]);var U;h.uHeadlightColor=[G[0],G[1],G[2],(U=A._headlightDisabled)?1:0],d.c.push(G[0],G[1],G[2]),d.g.push(U?-1:A._headlightGroup),d.e.push(U?1:0);var r=A._59O,q=A._spots,_=A._dirs;if(r.length){var R=[],Y=[],k=[];r.forEach(function(p){Jc(R,p,d),ir(Y,A._transformPointToViewSpace(p.p3())),k.push(p.s("light.range"))}),h.uPointColor=R,h.uPointRange=k,h.uPointPosition=Y}if(q.length){var l=[],D=[],e=[],p=[],c=[],M=[];q.forEach(function(u){Jc(l,u,d),ir(D,A._transformPointToViewSpace(u.p3())),ir(c,A._transformDirectionToViewSpace(u.p3(),u.s("light.center"))),e.push(u.s("light.range")),p.push(j(u.s("light.angle")/2)),M.push(u.s("light.exponent"))}),h.uSpotColor=l,h.uSpotRange=e,h.uSpotAngle=p,h.uSpotExponent=M,h.uSpotPosition=D,h.uSpotDirection=c}if(_.length){var F=[],b=[];_.forEach(function(w){Jc(F,w,d),ir(b,A._transformDirectionToViewSpace(w.p3()))}),h.uDirColor=F,h.uDirDirection=b}A._lastLightMask=zg,A._lastHeadlightAmbientIntensity=t},Xd=function(e,p,g,C){if(C===_&&(C=e._headlightAmbientIntensity),C!==e._lastHeadlightAmbientIntensity&&(p.uHeadlightAmbientIntensity=e._lastHeadlightAmbientIntensity=C),g!==e._lastLightMask){e._lastLightMask=g;var $=e._lastLightUploadInfo;if($){var V,r,d,U=$.g,H=$.e,S=U.length,n=new Array(S),X=!1;for(r=0;S>r;r++)V=U[r],d=0>V||V>=32?1:g&1<<V?0:1,n[r]=d,d!==H[r]&&(X=!0);if(X){$.e=H=n;var W=$.c;p.uHeadlightColor=[W[0],W[1],W[2],H[0]];var Q,Y=e._59O,Z=e._spots,A=e._dirs,m=3,T=1;if(S=Y.length){for(r=0,Q=[];S>r;r++)Q.push(W[m++],W[m++],W[m++],H[T++]);p.uPointColor=Q}if(S=Z.length){for(r=0,Q=[];S>r;r++)Q.push(W[m++],W[m++],W[m++],H[T++]);p.uSpotColor=Q}if(S=A.length){for(r=0,Q=[];S>r;r++)Q.push(W[m++],W[m++],W[m++],H[T++]);p.uDirColor=Q}}}}},Fm=function(y,R){return Math.max(y.getRotateMinPhi()+tk,Math.min(y.getRotateMaxPhi()-tk,R))},Be=function(){return.05+Ch()/2},$o=function(e,q,P,L){var F,y=e.getEye();return e.isOrtho()?(F=Yb(e.getCenter(),y),F[0]+=L[0],F[1]+=L[1],F[2]+=L[2]):F=y,Tj(q,P,L,F)},Tj=function(G,k,u,C){var o=kd(G,k),R=Yb(C,u,!0),W=kd(R,k);if(D(W)<tk)return Q;var $=(o-kd(u,k))/W;return[u[0]+R[0]*$,u[1]+R[1]*$,u[2]+R[2]*$]},Gj=function(n,m){return{x:2*n.x-m.x,y:2*n.y-m.y}},vm=function(w,g,R,G){var y,Y;if(!w)return y=mf(g.y-R.y,R.x-g.x),{x:g.x+G*h(y),y:g.y+G*j(y)};if(!R)return y=mf(w.y-g.y,g.x-w.x),{x:g.x+G*h(y),y:g.y+G*j(y)};var m=Yb([w.x,w.y,0],[g.x,g.y,0],!0),F=Yb([R.x,R.y,0],[g.x,g.y,0],!0),N=-(m[0]+F[0])/2,q=-(m[1]+F[1])/2,D=z(N*N+q*q);if(tk>D)return y=mf(w.y-g.y,g.x-w.x),{x:g.x+G*h(y),y:g.y+G*j(y)};var M=w.x-g.x,p=w.y-g.y,a=R.x-g.x,v=R.y-g.y,B=z(M*M+p*p),o=z(a*a+v*v);y=S(kd(m,F))/2,Y=m[1]*F[0]-m[0]*F[1]>0?-1:1,N/=D,q/=D;var V=G/h(y),A=f(B,o)/j(y);D=Math.min(V,A);var E={x:g.x+Y*D*N,y:g.y+Y*D*q};return R.b&&V>o/j(y)&&(E.adjust=!0),E},Xl=function(L){var u=L[1],U=L[2],R=L[3],E=L[6],M=L[7],N=L[11];L[1]=L[4],L[2]=L[8],L[3]=L[12],L[4]=u,L[6]=L[9],L[7]=L[13],L[8]=U,L[9]=E,L[11]=L[14],L[12]=R,L[13]=M,L[14]=N},Sg=function(U){var r=U[0],D=U[1],L=U[2],l=U[3],T=U[4],O=U[5],f=U[6],W=U[7],N=U[8],u=U[9],z=U[10],x=U[11],R=U[12],h=U[13],s=U[14],I=U[15],P=r*O-D*T,i=r*f-L*T,e=r*W-l*T,S=D*f-L*O,c=D*W-l*O,d=L*W-l*f,y=N*h-u*R,q=N*s-z*R,v=N*I-x*R,b=u*s-z*h,C=u*I-x*h,K=z*I-x*s,g=P*K-i*C+e*b+S*v-c*q+d*y;return g?(g=1/g,U[0]=(O*K-f*C+W*b)*g,U[1]=(L*C-D*K-l*b)*g,U[2]=(h*d-s*c+I*S)*g,U[3]=(z*c-u*d-x*S)*g,U[4]=(f*v-T*K-W*q)*g,U[5]=(r*K-L*v+l*q)*g,U[6]=(s*e-R*d-I*i)*g,U[7]=(N*d-z*e+x*i)*g,U[8]=(T*C-O*v+W*y)*g,U[9]=(D*v-r*C-l*y)*g,U[10]=(R*c-h*e+I*P)*g,U[11]=(u*e-N*c-x*P)*g,U[12]=(O*q-T*b-f*y)*g,U[13]=(r*b-D*q+L*y)*g,U[14]=(h*i-R*S-s*P)*g,U[15]=(N*S-u*i+z*P)*g,void 0):Q},ah=function(V,T){if(T){var K=T[0],q=T[1],C=T[2];V[12]=V[0]*K+V[4]*q+V[8]*C+V[12],V[13]=V[1]*K+V[5]*q+V[9]*C+V[13],V[14]=V[2]*K+V[6]*q+V[10]*C+V[14],V[15]=V[3]*K+V[7]*q+V[11]*C+V[15]}},ok=function(E,a){if(a){var e=a[0],R=a[1],K=a[2];E[0]=E[0]*e,E[1]=E[1]*e,E[2]=E[2]*e,E[3]=E[3]*e,E[4]=E[4]*R,E[5]=E[5]*R,E[6]=E[6]*R,E[7]=E[7]*R,E[8]=E[8]*K,E[9]=E[9]*K,E[10]=E[10]*K,E[11]=E[11]*K}},We=function(O,w,f){var R=w[0],v=w[1],K=w[2],s=w[3],B=w[4],J=w[5],H=w[6],x=w[7],Q=w[8],$=w[9],X=w[10],k=w[11],A=w[12],C=w[13],r=w[14],p=w[15],F=f[0],S=f[1],j=f[2],U=f[3];return O[0]=F*R+S*B+j*Q+U*A,O[1]=F*v+S*J+j*$+U*C,O[2]=F*K+S*H+j*X+U*r,O[3]=F*s+S*x+j*k+U*p,F=f[4],S=f[5],j=f[6],U=f[7],O[4]=F*R+S*B+j*Q+U*A,O[5]=F*v+S*J+j*$+U*C,O[6]=F*K+S*H+j*X+U*r,O[7]=F*s+S*x+j*k+U*p,F=f[8],S=f[9],j=f[10],U=f[11],O[8]=F*R+S*B+j*Q+U*A,O[9]=F*v+S*J+j*$+U*C,O[10]=F*K+S*H+j*X+U*r,O[11]=F*s+S*x+j*k+U*p,F=f[12],S=f[13],j=f[14],U=f[15],O[12]=F*R+S*B+j*Q+U*A,O[13]=F*v+S*J+j*$+U*C,O[14]=F*K+S*H+j*X+U*r,O[15]=F*s+S*x+j*k+U*p,O},Hh=function(o,O,E,T){var R,x,f,e,Q,N,h,P,s,B,H=O[0],U=O[1],u=O[2],v=T[0],y=T[1],Y=T[2],M=E[0],t=E[1],S=E[2];return D(H-M)<tk&&D(U-t)<tk&&D(u-S)<tk?Co(o):(h=H-M,P=U-t,s=u-S,B=1/z(h*h+P*P+s*s),h*=B,P*=B,s*=B,R=y*s-Y*P,x=Y*h-v*s,f=v*P-y*h,B=z(R*R+x*x+f*f),B?(B=1/B,R*=B,x*=B,f*=B):(R=0,x=0,f=0),e=P*f-s*x,Q=s*R-h*f,N=h*x-P*R,B=z(e*e+Q*Q+N*N),B?(B=1/B,e*=B,Q*=B,N*=B):(e=0,Q=0,N=0),o[0]=R,o[1]=e,o[2]=h,o[3]=0,o[4]=x,o[5]=Q,o[6]=P,o[7]=0,o[8]=f,o[9]=N,o[10]=s,o[11]=0,o[12]=-(R*H+x*U+f*u),o[13]=-(e*H+Q*U+N*u),o[14]=-(h*H+P*U+s*u),o[15]=1,o)},zj=function(E,l,K,f,o){var F=1/is(l/2),i=1/(f-o);return E[0]=F/K,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=F,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=(o+f)*i,E[11]=-1,E[12]=0,E[13]=0,E[14]=2*o*f*i,E[15]=0,E},ms=function(J,K,y,L,U,V,T){var A=1/(K-y),j=1/(L-U),C=1/(V-T);return J[0]=-2*A,J[1]=0,J[2]=0,J[3]=0,J[4]=0,J[5]=-2*j,J[6]=0,J[7]=0,J[8]=0,J[9]=0,J[10]=2*C,J[11]=0,J[12]=(K+y)*A,J[13]=(U+L)*j,J[14]=(T+V)*C,J[15]=1,J},Fc=function(a,t){var r=t[0],d=t[1],x=t[2],R=t[3],i=r*r+d*d+x*x+R*R,D=i?1/i:0;return a[0]=-r*D,a[1]=-d*D,a[2]=-x*D,a[3]=R*D,a},Qn=function(J,M){var c=M[0]+M[5]+M[10],B=0;return c>0?(B=2*Math.sqrt(c+1),J[3]=.25*B,J[0]=(M[6]-M[9])/B,J[1]=(M[8]-M[2])/B,J[2]=(M[1]-M[4])/B):M[0]>M[5]&M[0]>M[10]?(B=2*Math.sqrt(1+M[0]-M[5]-M[10]),J[3]=(M[6]-M[9])/B,J[0]=.25*B,J[1]=(M[1]+M[4])/B,J[2]=(M[8]+M[2])/B):M[5]>M[10]?(B=2*Math.sqrt(1+M[5]-M[0]-M[10]),J[3]=(M[8]-M[2])/B,J[0]=(M[1]+M[4])/B,J[1]=.25*B,J[2]=(M[6]+M[9])/B):(B=2*Math.sqrt(1+M[10]-M[0]-M[5]),J[3]=(M[1]-M[4])/B,J[0]=(M[8]+M[2])/B,J[1]=(M[6]+M[9])/B,J[2]=.25*B),J},Hp=function(h,b,f){var w=b[0],v=b[1],L=b[2],M=b[3],z=w+w,R=v+v,D=L+L,r=w*z,I=w*R,s=w*D,B=v*R,F=v*D,t=L*D,c=M*z,P=M*R,d=M*D;return h[0]=1-(B+t),h[1]=I+d,h[2]=s-P,h[3]=0,h[4]=I-d,h[5]=1-(r+t),h[6]=F+c,h[7]=0,h[8]=s+P,h[9]=F-c,h[10]=1-(r+B),h[11]=0,h[12]=f[0],h[13]=f[1],h[14]=f[2],h[15]=1,h},xq=function(d,N){if(d.isVREnabled()){var L=d.vr.getViewMatrix(N);if(L)return L}return d._camera?d._camera.getViewMatrix(N):Hh(N?N:ph(),d._eye,d._center,d._up)},qg=function(T,F){if(T.isVREnabled()){var v=T.vr.getProjectMatrix();if(v)return v}if(T._camera)return T._camera.getProjectMatrix();if(!F&&T._computedProjectMatrix)return Vg(T._computedProjectMatrix);var e=T.getAspect(),w=T._near,y=T._far,J=ph();if(T._ortho){var U=T._orthoWidth/2,H=U/e;ms(J,-U,U,-H,H,w,y)}else zj(J,T._fovy,e,w,y);return J},xi=function(T,i){if(!T)return Q;var R=0,y=1,F=2,D=[],C=0,b=T.length,r=b/3;if(i){for(;b>C;C++)D[C]=0;for(C=0;C<i.length;C+=3){var k=[],J=[],M=[];k[R]=T[3*i[C+1]+R]-T[3*i[C]+R],k[y]=T[3*i[C+1]+y]-T[3*i[C]+y],k[F]=T[3*i[C+1]+F]-T[3*i[C]+F],J[R]=T[3*i[C+2]+R]-T[3*i[C+1]+R],J[y]=T[3*i[C+2]+y]-T[3*i[C+1]+y],J[F]=T[3*i[C+2]+F]-T[3*i[C+1]+F],M[R]=k[y]*J[F]-k[F]*J[y],M[y]=k[F]*J[R]-k[R]*J[F],M[F]=k[R]*J[y]-k[y]*J[R];for(var P=0;3>P;P++)D[3*i[C+P]+R]+=M[R],D[3*i[C+P]+y]+=M[y],D[3*i[C+P]+F]+=M[F]}}else for(C=0;r>C;C+=3){var k=[],J=[],M=[];k[R]=T[3*(C+1)+R]-T[3*C+R],k[y]=T[3*(C+1)+y]-T[3*C+y],k[F]=T[3*(C+1)+F]-T[3*C+F],J[R]=T[3*(C+2)+R]-T[3*(C+1)+R],J[y]=T[3*(C+2)+y]-T[3*(C+1)+y],J[F]=T[3*(C+2)+F]-T[3*(C+1)+F],M[R]=k[y]*J[F]-k[F]*J[y],M[y]=k[F]*J[R]-k[R]*J[F],M[F]=k[R]*J[y]-k[y]*J[R];for(var P=0;3>P;P++)D[3*(C+P)+R]=M[R],D[3*(C+P)+y]=M[y],D[3*(C+P)+F]=M[F]}for(C=0;b>C;C+=3){var w=[];w[R]=D[C+R],w[y]=D[C+y],w[F]=D[C+F];var h=z(w[R]*w[R]+w[y]*w[y]+w[F]*w[F]);0===h&&(h=tk),w[R]=w[R]/h,w[y]=w[y]/h,w[F]=w[F]/h,D[C+R]=w[R],D[C+y]=w[y],D[C+F]=w[F]}return new Ac(D)},Gp=function(l,C,X,P){if(X||(X=l.createTexture()),C){var o=l.TEXTURE_2D,f=l.REPEAT,v=l.CLAMP_TO_EDGE,r=l.TEXTURE_MIN_FILTER;P=P||Ep;var B=P.minFilter||P.filter||l.LINEAR,A=P.magFilter||P.filter||l.LINEAR;l.activeTexture(l.TEXTURE0),$r(l,X),l.texImage2D(o,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,C),Zr(l,l.TEXTURE_MAG_FILTER,A);var J=C.naturalWidth||C.width,U=C.naturalHeight||C.height;$m.isPOT(J)&&$m.isPOT(U)&&!P.clampToEdge&&!C.clampToEdge?(Zr(l,l.TEXTURE_WRAP_S,f),Zr(l,l.TEXTURE_WRAP_T,f),Zr(l,r,B===l.NEAREST?l.NEAREST_MIPMAP_NEAREST:l.LINEAR_MIPMAP_LINEAR),P.mipmapMaxLevel!==_&&Zr(l,l.TEXTURE_MAX_LEVEL,P.mipmapMaxLevel),l.generateMipmap(o)):(Zr(l,l.TEXTURE_WRAP_S,v),Zr(l,l.TEXTURE_WRAP_T,v),Zr(l,r,B)),$r(l,Q)}return X},li=function(E,c,w){var u=new Uint8Array(w||4);return c=c||E.createTexture(),E.activeTexture(E.TEXTURE0),$r(E,c),Zr(E,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texImage2D(E.TEXTURE_2D,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,u),c},Ld=function(B,r,Z){var H=new Uint8Array(Z||4);return r=r||B.createTexture(),B.activeTexture(B.TEXTURE0),B.bindTexture(B.TEXTURE_CUBE_MAP,r),B.texParameteri(B.TEXTURE_CUBE_MAP,B.TEXTURE_MAG_FILTER,B.LINEAR),B.texParameteri(B.TEXTURE_CUBE_MAP,B.TEXTURE_MIN_FILTER,B.LINEAR),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,H),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,H),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,H),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,H),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,H),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,H),r},_d=function(U){U._26I&&U._prg&&(U._26I.deleteProgram(U._prg),U._prg=Q)},wo=function(){function C(P){if(P.match(O))return pm(P);var $=F[P];if($)return $;var m=new RegExp("#define\\s+"+P+"\\s+(\\d+)"),B=S.match(m);return F[P]=B?pm(B[1]):0}function M(I){F={},S=I;var Z=I.replace(r,i).replace(m,L);return S=null,F=null,Z}function i(l,A,p){p=C(p);for(var e="",Q=0;p>Q;Q++)e+=A+Q+";";return e}function L(S,Y,b,w){for(var M="",L=C(Y);L<C(b);L++)M+=w.replace(/\[\s*i\s*\]/g,"["+L+"]").replace(/\[\s*I\s*\]/g,L);return M}var F,S,r=/(uniform\s+sampler2D\s+\w+)\[([\S\d]+)\];/g,m=/#UNROLL_LOOP_START\s+for\s*\(\s*int\s+i\s*=\s*([\S\d]+)\s*;\s*i\s*<\s*([\S\d]+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#UNROLL_LOOP_END/g,O=/^\d+$/;return function(i){return M(i)}}(),od=function(U,B,A,V){var T=U.createShader(A);return U.shaderSource(T,wo(V)),U.compileShader(T),U.attachShader(B,T),T},gk=function(J){return J.createBuffer()},$r=function(Z,k){Z.bindTexture(Z.TEXTURE_2D,k||Z._emptyTexture)},Zr=function(F,b,J){F.texParameteri(F.TEXTURE_2D,b,J)},ie=function($,I){var K=Of.for($).directState();K.polygonOffset.enabled=!0,K.polygonOffset.value=I},bf=function(F){var B=Of.for(F).directState();B.polygonOffset.enabled=!1},wj=function(u,t){if(t){var p=Of.for(u).directState();p.color.clear=bc(t)}},nf=function(l,u,A){if(A!==u._lastClipboxEnabled){var b=l._boxClipperGroups,G=b?b.length:0,q=new Array(G);if(A)for(var v=0;G>v;v++)A&1<<b[v]&&(q[v]=!0);u._lastClipboxEnabled=A,u.uEnableBoxClip=q}},gs=nf,pl=function(E){var w=Of.for(E),Q=w.directUniforms(),t=w.directAttribs();Q.uFix=!0,t.aNormal=!1},kq=function(F){var $=Of.for(F),X=$.directUniforms();$.directAttribs(),X.uFix=!1},Rg=function(M,b,U,I,g,t,j,f){var i=Of.for(M),u=i.directState(),n=i.directUniforms();M._picking||(U?(n.uBlend=!0,n.uBlendColor=U):n.uBlend=!1,n.uLight=I==Q?!0:I,Ho(g)&&1!==g&&(n.uPartOpacity=g),n.uReverseFlip=t==Q?!1:t,n.uFixPickReverseColor=j||Ak),u.cullFace.enabled=f?!0:!1},Wl=function(r){if(!r._picking){var s=Of.for(r),A=s.directUniforms();A.uPartOpacity=1}},wh=function(){var q=new b.Math.Matrix2d,F=[1,0,0,0,1,0,0,0,0];return function(s,p,z,l,O,y,E,i,k,P){var e=Of.for(s),v=e.directUniforms(),D=e.directAttribs();return z?(v.uTexture=!0,v.uDiscardSelectable=wb(l)?l:!0,D.aUv=Bg(s,O,y,Q,2),P?(v.uBlendTexture=!0,v.uBlendSampler=P):(v.uBlendTexture=!1,v.uBlendSampler=s._emptyBlendTexture),v.uSampler=z,v.uUvMatrix=E||i||k?Jo(k,E,i,q).toArray9():F,void 0):(v.uSampler=s._emptyTexture,v.uBlendSampler=s._emptyBlendTexture,void 0)}}(),wn=function(V,w,f){var l=Of.for(V),L=l.directUniforms(),A=l.directAttribs();V.activeTexture(V.TEXTURE0),$r(V,Q),V.activeTexture(V.TEXTURE1),$r(V,Q),f&&(A.aUv=!1,L.uTexture=!1,L.uSampler=V._emptyTexture,L.uBlendTexture=!1,L.uBlendSampler=V._emptyBlendTexture)},Ob=function(T,D,U,w,A,e){var S=Of.for(T),s=S.directUniforms(),E=S.directAttribs();!U||nm||Kb||T.lineWidth(U),w&&!T._picking&&(s.uFixPickReverseColor=w),A&&(E.aPosition=Bg(T,A,e,Q))},Lj=function(q,r,f,y){ym&&(y=q[ym]),q.drawArrays(y==Q?q.TRIANGLES:y,r,f);var v=q._renderInfo;v&&(v.calls++,v.vertices+=f,(y==Q||y===q.TRIANGLES)&&(v.faces+=f/3),y===q.LINES&&(v.lines+=f/2),y===q.POINTS&&(v.points+=f))},jk=function(T,d,l,M,n){ym&&(M=T[ym]),T.drawElements(M==Q?T.TRIANGLES:M,l,n==Q?T.UNSIGNED_SHORT:n,d==Q?0:2*d);var P=T._renderInfo;P&&(P.calls++,P.vertices+=l,(M==Q||M===T.TRIANGLES)&&(P.faces+=l/3),M===T.LINES&&(P.lines+=l/2),M===T.POINTS&&(P.points+=l))},wg=function(u,I,h){var F=u.ARRAY_BUFFER;return u.bindBuffer(F,I),h&&u.bufferData(F,h,u.STATIC_DRAW),I},Bg=function(X,w,q,e,K){return q?wi(X,X.ARRAY_BUFFER,w,q):wg(X,w,q,e,K)},Ll=function(E,x,F){var J=E.ELEMENT_ARRAY_BUFFER;E.bindBuffer(J,x),F&&E.bufferData(J,F,E.STATIC_DRAW)},_c=function(u,M,h){wi(u,u.ELEMENT_ARRAY_BUFFER,M,h)},wi=function(p,j,u,E){var c=E._bufId;c||(c=E._bufId=b.Math.generateIncreasingID());var u,G=p._bufPool;return(u=G[c])&&u._buf?p.bindBuffer(j,u._buf):(u=G[c]={_buf:gk(p)},p.bindBuffer(j,u._buf),p.bufferData(j,E,p.STATIC_DRAW)),u._fid=p._renderInfo.frame,u._buf},pq=function(b,V){V!=Q&&V>=0&&b.enableVertexAttribArray(V)},dd=function(U,X){X!=Q&&X>=0&&U.disableVertexAttribArray(X)},im=function(e,D){var k=e.getGL(),u=Of.for(k),z=u.directUniforms();e._7O=e._8O.pop(),D&&(z.uMVMatrix=e._7O,e._6O=D,z.uNMatrix=D)},rc=function($,X){return X||(X=ph()),sn(X,$),Sg(X),Xl(X),X},Sk=function(E,b){var e=E.getGL(),x=E._7O,R=Of.for(e),J=R.directUniforms();b?(E._8O.push(Vg(x)),J.uMMatrix=b,We(x,x,b),E._7O=x):J.uMMatrix=ri,J.uMVMatrix=x,J.uNMatrix=rc(x,E._6O)},lg={body:0,label:1,label2:2,note:3,note2:4,symbol:5},gc=10,Fp=function(y,K,b,i,G,O){var q;if(b){var h=i._pickId;h||(h=i._pickId=K._pickIdUsed,K._pickIdUsed+=gc);var X,t=lg[G];if(null!=t)X=h+t;else{var Q=i._pickExtraPartMap;Q||(Q=i._pickExtraPartMap={}),(X=Q[G])||(X=Q[G]=K._pickIdUsed++)}K[X]||(K[X]={data:i,part:G}),q=Gs(X)}else q=Ml;if(!O){var a=Of.for(y),$=a.directUniforms();$.uFixPickReverseColor=q}return q},kk=Fp,Lo=function(M,K,k){"target"!==k&&(k="source");var h="target"===k?K.getTargetAgent():K.getSourceAgent(),t="edge."+k+".";if(Je(h)){var l=K.s(t+"anchor.x"),G=K.s(t+"anchor.elevation"),B=K.s(t+"anchor.y"),H=pc(h,M.getMat(h)),u=h.getAnchor3d(),$=ao([(l===_?.5:l)-u.x,(G===_?.5:G)-u.y,(B===_?.5:B)-u.z],H);return $[1]+=K.s(t+"offset.elevation"),$}var T=K.s(t+"index"),g=M.getData3dUI(h);if(!g.info||!g.info.list)return!1;if(T>=0){var d,b,N,m,f,O=g.info._lastPointsSegments,U=O.points,r=O.segments,z=-1,w=-1;for(N=0,m=r?r.length:U.length;m>N;N++){if(b=r?r.get(N):1,3===b)f=2;else if(4===b)f=3;else{if(5===b)continue;f=1}if(z+=f,w++,w===T){d=U.get(z);break}}return d||(d=U.get(U.length-1)),[d.x,(d.e||0)+K.s(t+"offset.elevation"),d.y]}var x=K.s(t+"percent")||.5;if(x=Math.max(0,Math.min(x,1)),!g||!g.getCache)return!1;var X=g.getCache(),m=X[X.length-1].length,O=M.getLineOffset(h,x*m),$=O.point;return[$.x,$.y+K.s(t+"offset.elevation"),$.z]},Sc=function(){var r={center:function(I,h,n,H,f){var x=-h[1]/2,e={x:-h[0]/2,y:x,width:h[0],height:h[1]},l=$l(I,e,n);return[l.x+H,-l.y-f,C.getPosition3dGap()]},front:function(P,l,x,E,h){var g=-l[1]/2,K={x:-l[0]/2,y:g,width:l[0],height:l[1]},Q=$l(P,K,x);return[Q.x+E,-Q.y-h,l[2]/2+C.getPosition3dGap()]},back:function(G,d,y,s,U){var c=-d[0]/2,w=-d[1]/2,b={x:c,y:w,width:d[0],height:d[1]},E=$l(G,b,y);return[-E.x-s,-E.y-U,-d[2]/2-C.getPosition3dGap()]},left:function(I,D,k,B,c){var l=-D[1]/2,J={x:-D[2]/2,y:l,width:D[2],height:D[1]},S=$l(I,J,k);return[-D[0]/2-C.getPosition3dGap(),-S.y-c,S.x+B]},right:function(f,q,D,p,y){var i=-q[2]/2,A=-q[1]/2,G={x:i,y:A,width:q[2],height:q[1]},s=$l(f,G,D);return[q[0]/2+C.getPosition3dGap(),-s.y-y,-s.x-p]},top:function(s,Q,e,f,w){var O={x:-Q[0]/2,y:-Q[2]/2,width:Q[0],height:Q[2]},Z=$l(s,O,e);return[Z.x+f,Q[1]/2+C.getPosition3dGap(),Z.y+w]},bottom:function(b,d,X,Y,k){var z=-d[2]/2,o={x:-d[0]/2,y:z,width:d[0],height:d[2]},c=$l(b,o,X);return[c.x+Y,-d[1]/2-C.getPosition3dGap(),-c.y-k]}};return function(m,L,C,k,O,H){return r[k](m,L,C,O||0,H||0)}}(),Zn=function(D,z,k,$,X,y,b,M,o,j){if(X&&(z[0]+=X[0],z[1]+=X[1],z[2]+=X[2]),ah(D,k),M){var R=ph();if($e(R,o,j),ao(z,R),ah(D,z),D.auto=M,D.pos=ao([0,0,0],D),y){var l=D.mat2=ph();$e(l,y,b)}}else $e(D,o,j),ah(D,z),$===Mh?Pl(D,-Ej):$===Xi?Pl(D,Ej):$===Ui?Ao(D,-Ej):$===nl?Ao(D,Ej):$===ge&&Pl(D,e),$e(D,y,b);return D},go=function(c,J){var j=J.auto,i=J.mat2,P=c.gv;if(j){var O,y=ph(),l=[0,0,0,0];O="string"==typeof j?[j.indexOf("x")<0?P._eye[0]:P._center[0],j.indexOf("y")<0?P._eye[1]:P._center[1],j.indexOf("z")<0?P._eye[2]:P._center[2]]:P._eye,Qn(l,Hh(ph(),O,P._center,P._up)),Hp(y,Fc(l,l),J.pos),i&&We(y,y,i),Sk(P,y)}else Sk(P,J)},hm=function(w,y,I,p,j){var D=w.s,e=w.gv,_=e.getGL(),h=e._prg,k=e._buffer,G=e._1O,Z=Of.for(_),q=Z.directAttribs();Gp(_,Qk,G),go(w,I),Rg(_,h,D(y+".blend"),D(y+".light"),D(y+".opacity"),D(y+".reverse.flip"),D(y+".reverse.color"),D(y+".reverse.cull")),wh(_,h,G,j,k.uv,br),q.aPosition=Bg(_,k.vs,p,Q),q.aNormal=Bg(_,k.ns,lh,Q),_c(_,k.is,Lq),jk(_,0,Lq.length),wn(_,h,G),Wl(_,h),im(e)},Cl=function(m,D,$){var v=m.gv,V=m.data,f=m[D]={blend:v.getBodyColor(V)||v.getFaceBlend(V,D),light:v.getFaceLight(V,D),color:v.getFaceColor(V,D),opacity:v.getFaceOpacity(V,D),transparent:v.getFaceTransparent(V,D),reverseFlip:v.getFaceReverseFlip(V,D),reverseColor:v.getFaceReverseColor(V,D),reverseCull:v.getFaceReverseCull(V,D),texture:v.getFaceImage(V,D),blendTexture:v.getFaceBlendImage(V,D),discardSelectable:v.getFaceDiscardSelectable(V,D)};if("csg"!==D){f.uv=v.getFaceUv(V,D)||$&&$[D+"Uv"],f.uvScale=v.getFaceUvScale(V,D)||$&&$[D+"UvScale"],f.uvOffset=v.getFaceUvOffset(V,D)||$&&$[D+"UvOffset"],f.uvRotation=v.getFaceUvRotation(V,D)||$&&$[D+"uvRotation"];var L=v.getFaceMat(V,D);if(L){var J=pc(V,L);V.appendAnchorMatrix3d(J),f.mat=J}}return f},nq=function(d,o,s,R,L){var h=d[R];if(h){if(!L(h.transparent))return;var P=d.data,V=d.gv,F=V._buffer,B=V.getTexture(h.texture,P,R),T=V.getTexture(h.blendTexture,P),N=Of.for(o),k=N.directUniforms(),p=N.directAttribs();wh(o,s,B,h.discardSelectable,F.uv,h.tuv,h.uvOffset,h.uvScale,h.uvRotation,T),Rg(o,s,h.blend,h.light,h.opacity,h.reverseFlip,h.reverseColor,h.reverseCull),h.cs&&!V._batchColorDisabled?(k.uBatchColor=!0,p.aBatchColor=Bg(o,F.batchColor,h.cs,s.aBatchColor,4)):k.uDiffuse=h.color||X["color.empty"],p.aPosition=Bg(o,F.vs,h.vs,Q),p.aNormal=Bg(o,F.ns,h.ns,Q),Lj(o,0,h.vs.length/3),h.cs&&!V._batchColorDisabled&&(k.uBatchColor=!1,dd(o,s.aBatchColor)),Wl(o,s),wn(o,s,B)}},pg=function(U,g,j){oi(U)?U.forEach(function(O){pg(O,g,j)}):am(U)?pg(sh(g,U),g,j):vp(U)?U.shape3d?pg(U.shape3d,g,j):j.push(U):j.push(U)},Sh=function(){for(var Z=50,b=arguments.length,A=[],z=0;b>z;z++)A[z]=arguments[z];Ib[ck]="Time : "+(new Date).toLocaleString()+", Info :"+A.join(", "),ck=(ck+1)%Z,console.error("Failed to create shader.")},Jo=function(){var f=new $m.Matrix2d;return function(C,B,_,Z){Z||(Z=f);var r,j,l,A;return B?(r=B[0],j=B[1]):r=j=0,_?(l=_[0],A=_[1]):l=A=1,Z.setFromTransform(C||0,r,j,l,A)}}(),uc=function(i,k,z,X,S,K){var R,s,n,U,x,b,F,M,T,c,f,V=[X-k,S-z],q=i?i.length:0;for(n=0;q>n;n++){for(U=2,R=i[n],x=R[0],b=R[1];U+1<R.length;){if(F=R[U],M=R[U+1],s=mq(k,z,X,S,x,b,F,M,!0)){T=[F-x,M-b],c=Ki(T),T[0]/=c,T[1]/=c,c=kd(V,T),c=c>0?K:-K,f=[T[0]*c,T[1]*c];break}x=F,b=M,U+=2}if(f)break}if(f)for(X=k+f[0],S=z+f[1],n=0;q>n;n++)for(U=2,R=i[n],x=R[0],b=R[1];U+1<R.length;){if(F=R[U],M=R[U+1],s=mq(k,z,X,S,x,b,F,M,!0))return[0,0];x=F,b=M,U+=2}return f?f:[X-k,S-z]},cs=function(D){return"nearest"===D?Di.NEAREST:"linear"===D?Di.LINEAR:D},cl=b.graph3d={WebGLConstants:Di},Ok=function(P,k,b){eq(v+".graph3d."+P,k,b)},lq="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg<{zy/**1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)spg<mbdpMwVxpmg!4dfw1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!gjeof$!|*ldjQva!%%!yjGva)gj!1!>>!SFQQJMD`YPC`YBN!gj$!<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Vn="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!!EOF`QPPM`MMPSOV$!~<chs/*^j]wVxpmg!-^J]fsvuyfUxpmg)E3fsvuyfu!!>,!chs/eJ!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)!spg!USBUT`QPPM`MMPSOV$!!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj!gjeof$!~~!<osvufs!<esbdtje!|!****ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv!%%!^j]qjmDypCfmcboFv)!gj<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1>j!uoj)spg<mbdpMw!4dfw!1!?!SFQQJMD`YPC`YBN!gj$!~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!!gjeof$!!gjeof$!!~~<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw|!ftmf!~<*1/2!-1spmpd)5dfw!osvufs|!*1/1!>>!Gqjn)!gj<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw<*qjn)sppmg!>!uoJqjn!ubpmg<*qjn)udbsg!>!Gqjn!ubpmg<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~<qjn!osvufs~<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn|!ftmf!~<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn|!*7s!>?!ttfoihvps)!gj!ftmf!~<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn|!*6s!>?!ttfoihvps)!gj!ftmf!~<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn|!*5s!>?!ttfoihvps)!gj!ftmf!~<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn|!*2s!>?!ttfoihvps)!gj<1/1!>!qjn!ubpmg|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~<*z/g!-nc!-nu)yjn!osvufs<*y/g!-sc!-mc)yjn!>!nc!4dfw<*y/g!-su!-mu)yjn!>!nu!4dfw<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw<f{jTmfyfu!>.!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw<f{jTmfyfu!>,!z/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw<f{jTmfyfu!>,!y/wv<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw<f{jTmfyfu!>+!wv<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv~<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj<f{jTfdbg!+!fdbg!>,!y/wv~<1/4!>.!fdbg<f{jTfdbg!>,!z/wv|!*1/3!?!fdbg)!gj<g!.!6/1!>,!wv<*wv)udbsg!>!g!3dfw<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg<*opjudfsje)fdbGufh!>!fdbg!ubpmg|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~<*1/2!,!wv)!+!6/1!osvufs~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv|!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/5!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv|!*1/4!>>!fdbg)!gj!ftmf!~<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv|!*1/3!>>!fdbg)!gj!ftmf!~<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv|!*1/2!>>!fdbg)!gj!ftmf!~<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv|!*1/1!>>!fdbg)!gj<wv!3dfw|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~<fdbg!osvufs~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj|!ftmf!~<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj<1/2!.!>!fdbg!ubpmg<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*z/w)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*y/w)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*1/1!?!{/w)!gj!!!!!!!!!!!!!!!!|!*foPutpnmb!>?!{/Wtcb)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*w)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!!!!!!!!!!!!<*1/:!0!1/2)!+!*!!!!!!!!!!!!!!!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!!!!!!!!!!!!|!*utfUnvutvsg)!gj!!!!!!!!!!!!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*y/g!-c!-b)yjn!>!d!ubpmg!!!!!!!!!!!!<*z/g!-us!-cs)yjn!>!c!ubpmg!!!!!!!!!!!!<*z/g!-um!-cm)yjn!>!b!ubpmg!!!!!!!!!!!!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!!!!!!!!!!!!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!!!!!!!!!!!!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*tspudbGldbqoV!-w)upe!osvufs|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*/763!!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov<^SFQQJMD`YPC`YBN]qjmDypCfmcboFv!mppc!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
nd(C,{setBatchInfo:function(h,v){Tn[h]=v},getBatchInfo:function(l){return Tn[l]},getBatchInfoMap:function(){return Tn},setBatchInfoMap:function(z){Tn=z}},!0);var wf=[1,1,1],dg=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Pg=[1,0,0,0,0,1,0,1,1,1,1,0],Md=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],yr=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Pb=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Um=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],yh=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Se=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],ar=function(o,k){var E=o._40Q;E.each(function(y){y.ivBatch(k)})},Iq=function(P,X,p){var i=p._id,v=X[i];if(v){var n=v.batch,m=P[n],L=m.ds,Y=v.index;if(m.invalidate=!0,delete X[i],L.splice(Y,1),Hg(L))return delete P[n],void 0;for(var R=v.begin,e=v.size,T=3*R,b=3*e,a=4*R,t=4*e,z=m.vs,c=m.ps,_=m.uv,q=m.cs,I=m.bs,x=m.rs,E=m.ns,U=m.ls;Y<L.length;Y++)v=X[L[Y]._id],v.index--,v.begin-=e;z.splice(T,b),c.splice(a,t),_&&_.splice(2*R,2*e),q&&q.splice(a,t),I&&I.splice(T,b),x&&x.splice(R,e),E&&E.splice(T,b),U&&U.splice(R,e)}},Wc=function(S,r,J,u,f){if(!u)return Q;var n=r[u];if(!n){var Y=f.getBatchInfo(u)||Ep,P=Y.image?[]:Q;n=r[u]={vs:[],ns:[],uv:P,cs:P?Q:Y.color?Q:[],bs:Y.blend?[]:Q,ps:[],rs:Y.brightness?[]:Q,ds:[]}}return n.invalidate=!0,S[J._id]={index:n.ds.length,begin:n.vs.length/3,batch:u},n.ds.push(J),n},Ae=function(X,Z){return Z!=Q&&1!==Z?[X[0]*Z,X[1]*Z,X[2]*Z,X[3]]:X},Fe=function(l){var w=l.shapeModel;w||(w=sh(l)),w&&(w._ctlineModel=[],w._lineModel=_)},Pf=function(){var P;return function(k,s,A){var R=k.getData3dUI(s),h=R.shapeModel;if(h||(h=sh(R)),h||!R.shapeName){var Y,H=s.s("wf.combineTriangle");if(A.geometry){if(!h&&(s instanceof b.Node&&!(s instanceof b.Shape)?(P||(P={vs:tq,is:hi,uv:Gm}),h=P):h=[R.left,R.front,R.right,R.back,R.top,R.bottom],!h))return _;if(H){var O=s.s("wf.normEpsilon");isNaN(O)&&(O=2),H=0|Math.min(3,Math.max(1,isNaN(H)?1:H)),Y=$d[H-1](h,R,180/(Math.PI*O))}else Y=an(h,R);if(!Y||0===Y.length)return}else Y=A.short?hf:Zp;var z,S=k.getBrightness(s),G=s.s("bloom"),N=s.s("3d.reflectable"),X=bc(A.color||"white"),M=X[3]<1,C=Math.ceil(A.width)||1,E=s.s("3d.clipbox")?Jr:s.s("3d.clipbox.mask"),n=s.getRenderLayer(),U=k._40Q.get(n),K=U.wireframeIndexMap,l=U.wireframeModelMap,B=s.s("batch");z=B?(M?"T":"O")+B:(M?"T":"O")+(G?"_1":"_0")+(N?"1_":"0_")+E+"_"+C;var F=l[z];F||(F=l[z]={vs:[],cs:[],ps:[],ds:[],T:M,B:G,clipboxMask:E,reflectable:!!N,W:C,batch:B}),F.invalidate=!0;var t=F.vs,T=F.cs,g=F.ds,c=K[s._id]={index:g.length,begin:t.length/3,batch:z};g.push(s);var m=R.mat;s instanceof b.Edge||!(!m||!A.geometry&&s instanceof b.Shape)||(m=pc(s,A.mat),s.appendAnchorMatrix3d(m)),sc(t,m,Y);var r=c.size=t.length/3-c.begin;Ik(T,Ae(X,S),r)}}}(),Gl=function(f,I,o,e,v,X,x,F,O){var k=f.getBrightness(I);k==Q&&(k=1);var i=Ae(bc(e),k),h=i[3]<1;X=Math.ceil(X)||1;var T=(h?"T":"O")+X;if(x){var b=x[0],g=(x[1]||b)+b;T+="-"+b+"-"+g,O&&(T+="-"+uq(O)+"-"+k,O=Ae(bc(O),k))}var H=I.getRenderLayer(),d=f._40Q.get(H),c=d.polylineIndexMap,N=d.polylineModelMap,L=N[T];L||(L=N[T]={vs:[],cs:[],ps:[],ds:[],ls:x?[]:Q,T:h,W:X},x&&(L.D=b,L.G=g,L.A=O)),L.invalidate=!0;var m,$=L.vs,s=L.cs,t=L.ds,A=L.ls,j=c[I._id]={index:t.length,begin:$.length/3,batch:T};t.push(I),ir($,o);var z,V=j.size=$.length/3-j.begin,J=o.length,_=0,B=[];if(x||v)for(m=0;J>m;m+=6)z=Ki([o[m],o[m+1],o[m+2]],[o[m+3],o[m+4],o[m+5]]),B.push(z),_+=z;if(_&&v){var p,Y=Ae(bc(v),k),y=[Y[0]-i[0],Y[1]-i[1],Y[2]-i[2],Y[3]-i[3]],M=0;for(m=0;J>m;m+=6)p=M/_,Ik(s,[i[0]+y[0]*p,i[1]+y[1]*p,i[2]+y[2]*p,i[3]+y[3]*p],1),M+=B[m/6],p=M/_,Ik(s,[i[0]+y[0]*p,i[1]+y[1]*p,i[2]+y[2]*p,i[3]+y[3]*p],1)}else Ik(s,i,V);if(x)for(M=F||0,m=0;J>m;m+=6)A.push(M),M+=B[m/6],A.push(M)},og=function(z,K,k){if(K){var u=4*K.begin,L=k[K.batch].ps;if(L[u]!==z[0]||L[u+1]!==z[1]||L[u+2]!==z[2]||L[u+3]!==z[3]){for(var v=0;v<K.size;v++)L[u++]=z[0],L[u++]=z[1],L[u++]=z[2],L[u++]=z[3];L._invalidateThisFrame=!0}}},Zm=function(){var q=new b.Math.Vector3,M=new b.Math.Vector3;return function(R,k){var g=k+["32"],G=R[k],N=R[g];if(G){if(C.extractBatchTranslation&&"vs"===k){M.set(0,0,0);for(var t=G.length,z=0;t>z;z+=3)M.add(q.fromArray(G,z));M.divideScalar(t/3);for(var n=M.x,$=M.y,d=M.z,f=new Array(t),z=0;t>z;z+=3)f[z]=G[z]-n,f[z+1]=G[z+1]-$,f[z+2]=G[z+2]-d;G=f,R.translate=[n,$,d]}N&&N.length===G.length?(N.set(G),N._bufId=null):R[g]=new Ac(G)}else delete R[g]}}(),Rd=function(q,M,E,T,C,P,l,h){if(oi(E))E.forEach(function(A){Rd(q,M,A,T,C,P,l,h)});else if(am(E))Rd(q,M,sh(T,E),T,C,P,l,h);else if(vp(E)){var Z,a=yk(E.mat,M,q),f=yk(E.s3,M,q),x=yk(E.t3,M,q),k=yk(E.r3,M,q);if((f||k||x||a)&&(Z=qh(a,f,k,yk(E.rotationMode,M,q),x),P.push(Z)),E.shape3d)Rd(q,M,E.shape3d,T,C,P,l,E);else{var V=T.s;h=h||Ep;var s=P[0],F=P.length,A=V("shape3d.color",E.color,h.color);if(C||(C=V("shape3d.blend",E.blend,h.blend)),F>1){s=Vg(s);for(var O=1;F>O;O++)We(s,s,P[O])}var u=s?rc(s):Q;E.vs&&V(Cm,E.visible,h.visible)&&tg(s,l,E.vs,E.uv,E.is,E.ns,u,C,A),E.top_vs&&V($c,E.topVisible,h.topVisible)&&tg(s,l,E.top_vs,E.top_uv,E.top_is,E.top_ns,u,C,V("shape3d.top.color",E.topColor,h.topColor)||A),E.bottom_vs&&V(Tg,E.bottomVisible,h.bottomVisible)&&tg(s,l,E.bottom_vs,E.bottom_uv,E.bottom_is,E.bottom_ns,u,C,V("shape3d.bottom.color",E.bottomColor,h.bottomColor)||A),E.from_vs&&V(Xo,E.fromVisible,h.fromVisible)&&tg(s,l,E.from_vs,E.from_uv,E.from_is,E.from_ns,u,C,V("shape3d.from.color",E.fromColor,h.fromColor)||A),E.to_vs&&V(vl,E.toVisible,h.toVisible)&&tg(s,l,E.to_vs,E.to_uv,E.to_is,E.to_ns,u,C,V("shape3d.to.color",E.toColor,h.toColor)||A)}Z&&P.pop()}},tg=function(u,c,e,N,$,O,x,U,q){var m,h=c.cs,k=c.uv,B=c.bs,y=c.ns,t=c.vs;if(O&&0!==O.length||(O=xi(e,$)),$){m=$.length;for(var Y=0;m>Y;Y++){var n=$[Y],l=3*n;sc(t,u,[e[l],e[l+1],e[l+2]]),sc(y,x,[O[l],O[l+1],O[l+2]]),k&&ir(k,[N[2*n],N[2*n+1]])}}else m=e.length/3,sc(t,u,e),sc(y,x,O),k&&ir(k,N);h&&Ik(h,q,m),B&&(U?If(B,U,m):ir(B,wf,m))},Gh=function($,F,M,N){N?Rd($.gv,$.data,N,$,$.getBodyColor(),[F],M):(Ff($,Mh,F,M),Ff($,Xi,F,M),Ff($,fb,F,M),Ff($,ge,F,M),Ff($,Ui,F,M),Ff($,nl,F,M),Ff($,"csg",F,M))},Ff=function(p,G,k,_){var P=p[G];if(P){var J=P.tuv;if(J){var h=P.uvScale,F=P.uvOffset,m=P.uvRotation;if(h||F||m){var a,Z,S,Y=Jo(m,F,h),s=Y.a,n=Y.b,w=Y.c,r=Y.d,D=Y.tx,H=Y.ty,R=J.length;for(S=0;R>S;S+=2)a=J[S],Z=J[S+1],J[S]=s*a+w*Z+D,J[S+1]=n*a+r*Z+H}}tg(k,_,P.vs,J,Q,Q,k?rc(k):Q,P.blend,P.color)}},rf=function(k,u,Y,A,O,F,G,S){var v,$=Y.cs,f=Y.uv,B=Y.bs,q=Y.vs,X=Y.ns,y=xi(S);if(k.getFaceVisible(u,G)){var H=k.getFaceMat(u,G);if(H&&(O=pc(u,H),F=rc(O)),sc(q,O,S),sc(X,F,y),$&&Ik($,k.getFaceColor(u,G),6),f){var x=k.getFaceUv(u,G)||A[G+"Uv"],D=k.getFaceUvScale(u,G)||A[G+"UvScale"],j=k.getFaceUvOffset(u,G)||A[G+"UvOffset"],l=k.getFaceUvRotation(u,G)||A[G+"UvRotation"];x=x?[x[6],x[7],x[0],x[1],x[2],x[3],x[2],x[3],x[4],x[5],x[6],x[7]]:Pg;var w=x[0],J=x[1],E=x[2],t=x[3],b=x[4],i=x[5],C=x[6],z=x[7],T=x[8],s=x[9],h=x[10],n=x[11];if(D||j||l){var P=Jo(l,j,D),L=P.a,R=P.b,Z=P.c,Q=P.d,W=P.tx,d=P.ty;w=L*w+Z*J+W,J=R*w+Q*J+d,E=L*E+Z*t+W,t=R*E+Q*t+d,b=L*b+Z*i+W,i=R*b+Q*i+d,C=L*C+Z*z+W,z=R*C+Q*z+d,T=L*T+Z*s+W,s=R*T+Q*s+d,h=L*h+Z*n+W,n=R*h+Q*n+d}f.push(w,J,E,t,b,i,C,z,T,s,h,n)}B&&(v=k.getBodyColor(u)||k.getFaceBlend(u,G),v?If(B,v,6):ir(B,wf,6))}},Fn=function(i,G,l,n){var l=i._picking?i.pickColorMap:null,w=i.getGL(),E=i._prg,A=i._buffer;if(!vo(G)){Sk(i,dg),pl(w,E);for(var Y in G){var K,T,h,$,z=G[Y];if(z.batch){var m=i.getBatchInfo(z.batch)||Ep;K=m.wfBloom===_?m.bloom:m.wfBloom,T=m.wfReflectable===_?m.reflectable:m.wfReflectable,h=m.wfClipboxMask===_?m.clipboxMask:m.wfClipboxMask,$=m.width}else K=z.B,T=z.reflectable,h=z.clipboxMask,$=z.W;if(!(n&&!z.T||!n&&z.T||i.isReflecting(w)&&T===!1)){z.invalidate?(z.invalidate=!1,Zm(z,"vs"),Zm(z,"cs"),Zm(z,"ls"),Zm(z,"ps")):l&&z.ps&&z.ps._invalidateThisFrame&&(z.ps._invalidateThisFrame=!1,Zm(z,"ps"));var V=z.translate;V&&Sk(i,[1,0,0,0,0,1,0,0,0,0,1,0,V[0],V[1],V[2],1]);var J=z.vs32,k=l?z.ps32:z.cs32;Ob(w,E,$,Q,A.vs,J);var S=Of.for(w),e=S.directUniforms(),d=S.directAttribs(),L=z.D,p=!i._dashDisabled&&L;e.uAlphaTest=X.alphaTest,w._blooming&&!K&&(e.blackout=!0),gs(i,e,h===_?zg:h),p&&(e.uDash=!0,e.uDashDistance=L,e.uDashGapDistance=z.G,e.uDiffuse=z.A||X["color.empty"],d.aLineDistance=Bg(w,A.lineDistance,z.ls32,Q,1));var H=!i._batchColorDisabled;H&&k.length?(e.uBatchColor=!0,d.aBatchColor=Bg(w,A.batchColor,k,Q,4)):(e.uBatchColor=!1,d.aBatchColor=!1),wh(w),Lj(w,0,J.length/3,w.LINES),wn(w),H&&(e.uBatchColor=!1,d.aBatchColor=!1),p&&(e.uDash=!1,d.aLineDistance=!1),w._blooming&&!K&&(e.blackout=!1),V&&im(i)}}kq(w,E),im(i)}},Uj=function(n){n.invalidate=!1,Zm(n,"vs"),Zm(n,"ns"),Zm(n,"cs"),Zm(n,"rs"),Zm(n,"ps"),Zm(n,"bs"),Zm(n,"uv")},Er=function(U,L,m,N,a){var u,P,O,$,D,c,e,R,C,K,r,g,m=U._picking?U.pickColorMap:null,B=U.getGL(),k=U._prg,A=Of.for(B),l=A.directUniforms(),n=A.directAttribs(),d=U._buffer;if(!vo(L)&&!U.drawFilter){Sk(U,dg);for(u in L)if(P=U.getBatchInfo(u)||Ep,P.visible!==!1&&!(N&&!P.transparent||!N&&P.transparent||U.isReflecting(B)&&P.reflectable===!1)){var T=P.renderLayerMask;if(T==Q&&(T=Ee),a==Q&&(a=Ee),yf(a,T)&&(O=L[u],m||!P.transparentMask)){var V=N&&P.autoSort===!0&&(U._33Q||O.invalidate);if(O.invalidate?Uj(O):m&&O.ps&&O.ps._invalidateThisFrame&&(O.ps._invalidateThisFrame=!1,Zm(O,"ps")),D=O.vs32,c=m?O.ps32:O.cs32,C=O.uv32,e=O.bs32,R=O.rs32,r=D.length/3,V){var x=Kq(D,U.getEye(),U);x?(O.is=x.is,O.elementTypeUint=x.useUint32):(O.is=null,O.elementTypeUint=null)}if(r){g=O.translate,g&&Sk(U,[1,0,0,0,0,1,0,0,0,0,1,0,g[0],g[1],g[2],1]),$=P.light,K=U.getTexture(P.image),Rg(B,k,Q,P.light,P.opacity,P.reverseFlip,P.reverseColor,P.reverseCull),c?U._batchColorDisabled?(l.uBatchColor=!1,n.aBatchColor=!1):(l.uBatchColor=!0,n.aBatchColor=Bg(B,d.batchColor,c,Q,4)):(l.uBatchColor=!1,l.uDiffuse=P.color||X["color.empty"]);var w=P.alphaTest;l.uAlphaTest=w===_?X.alphaTest:w,l.shadowReceive=!m&&P.shadowReceive!==!1,gs(U,l,P.clipboxMask===_?zg:P.clipboxMask),Xd(U,l,P.lightMask===_?zg:P.lightMask,P.headlightAmbientIntensity),B._blooming&&!P.bloom&&(l.blackout=!0),P.envmap!==_?(l.uUseEnvMap=!0,l.uReflectivity=P.envmap,l.roughness=P.roughness||0,U._setEnvmapByProbeId(l,P.envmapProbe||0)):(l.uUseEnvMap=!1,l.uReflectivity=0);var t=e&&!U._batchBlendDisabled;t&&(l.uBatchBlend=!0,n.aBatchBlend=Bg(B,d.batchBlend,e,Q));var E=R&&!U._batchBrightnessDisabled;E&&(l.uBatchBrightness=!0,n.aBatchBrightness=Bg(B,d.batchBrightness,R,Q,1)),C?wh(B,k,K,P.discardSelectable,d.uv,C,P.uvOffset,P.uvScale,P.uvRotation):wh(B),n.aPosition=Bg(B,d.vs,D,Q),n.aNormal=Bg(B,d.ns,O.ns32,Q),O.is?(Ll(B,d.is,O.is),jk(B,0,r,null,O.elementTypeUint?B.UNSIGNED_INT:null)):Lj(B,0,r),C?wn(B,k,K):wn(B),c&&!U._batchColorDisabled&&(l.uBatchColor=!1,n.aBatchColor=!1),t&&(l.uBatchBlend=!1,n.aBatchBlend=!1),E&&(l.uBatchBrightness=!1,n.aBatchBrightness=!1),B._blooming&&!P.bloom&&(l.blackout=!1),Wl(B,k),g&&im(U)}}}im(U)}},Kq=function(c,E,G){var u=c.length/3,h=u>65535,z=G._glCapabilities.elementTypeUint&&h;if(!z&&h)return null;for(var w=new Array(u),P=u/3,k=new Array(P),M=0;P>M;M++)k[M]=M;k.sort(function(l,v){var m=9*l,V=[(c[m]+c[m+3]+2*c[m+6])/4,(c[m+1]+c[m+4]+2*c[m+7])/4,(c[m+2]+c[m+5]+2*c[m+8])/4];m=9*v;var B=[(c[m]+c[m+3]+2*c[m+6])/4,(c[m+1]+c[m+4]+2*c[m+7])/4,(c[m+2]+c[m+5]+2*c[m+8])/4],e=Ki(E,V)-Ki(E,B);return e>0?-1:0>e?1:0});for(var M=0;P>M;M++){var s=3*M,_=3*k[M];w[s]=_,w[s+1]=_+1,w[s+2]=_+2}return{useUint32:z,is:z?new Uint32Array(w):new Vf(w)}},ab={obj:function(j,R){var e={mat:j.mat,s3:j.s3,r3:j.r3,rotationMode:j.rotationMode,t3:j.t3,cube:j.cube==Q?!0:j.cube,center:j.center==Q?!0:j.center,ignoreMtls:j.ignoreMtls,ignoreTransparent:j.ignoreTransparent,ignoreColor:j.ignoreColor,ignoreImage:j.ignoreImage,ignoreNormal:j.ignoreNormal,prefix:j.prefix,flipY:j.flipY,flipFace:j.flipFace,reverseFlipMtls:j.reverseFlipMtls,finishFunc:function(D,i){if(D){var i=[];for(var k in D){var L=D[k];i.rawS3=L.rawS3,L.center&&(i.center=L.center),i.push(L),j.eachModel&&j.eachModel(k,L)}i.json=j,R(i)}else R()}};C.loadObj(j.obj,j.mtl,e)},bin:function(u,o){var F={finishFunc:function(l){l?o(l):o()}};C.loadBin(u.url,F)}};C.getModelTypeHandlers=function(){return ab},C.setModelTypeHandler=function(W,z){ab[W]=z},C.getModelTypeHandler=function(i){return ab[i]},C.handleModelLoaded=function(){},C.handleUnfoundModel=function(){};var kb=Q,ll=Q,$q=function(x){kb&&!x._loadingModelView_&&(ll||(ll={}),ll[x._loadingModelView_=Tb()]=x)},bp=function(t,j){kb||(kb={});var $=kb[t];if($){if($.url===j)return;$.request.onload=ss,$.request.onerror=ss}if(j.indexOf(".bin")===j.length-4)return Mc(t,{modelType:"bin",url:j},j);if(j=C.beforeLoadURL(j),j.data){var b=C.parse(j.data);Mc(t,b,j)}else{var E=new rn;kb[t]={request:E,url:j},E.onload=function(){if(200===this.status||0===this.status){delete kb[t];var Z=C.parse(E.getResponseText());Mc(t,Z,j)}else un(t,C.handleUnfoundModel(t,j)||Q)},E.onerror=function(){un(t,C.handleUnfoundModel(t,j)||Q)};var N={};N.url=encodeURI(j),N.sync=!1,E.send(N)}},Mc=function(O,A,S){var U=A.modelType;if(!U)return un(O,A),C.handleModelLoaded(O,A),void 0;var $=C.getModelTypeHandler(U);if($){if(kb||(kb={}),kb[O])return;kb[O]=!0;var l=function($){$?(un(O,$),C.handleModelLoaded(O,$)):un(O,C.handleUnfoundModel(O,S,A)||Q)};$(A,l)}else un(O,C.handleUnfoundModel(O,S,A)||Q)},un=function(U,u){if(delete kb[U],am(u)&&Gk.test(u))return bp(U,u),void 0;if(Ko[U]=u,vo(kb)&&(kb=Q,ll)){for(var D in ll){var Y=ll[D];Y.invalidateAll&&Y.invalidateAll(_,"modelLoaded",U),Y.redraw&&Y.redraw(),Y.iv(),delete Y._loadingModelView_}ll=Q}if(u&&ll)for(var D in ll){var Y=ll[D];Y.invalidateAll&&Y.invalidateAll(_,"modelLoading",U),Y.redraw&&Y.redraw(),Y.iv()}},br=new Ac([0,0,0,1,1,1,1,0]),lh=new Ac([0,0,1,0,0,1,0,0,1,0,0,1]),Lq=new Vf([0,1,2,2,3,0]),tq=new Ac([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),hi=new Vf([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Gm=new Ac([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Uo=xi(tq,hi),sf=(new Ac([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Vf([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Mh,fb,Xi,ge,Ui,nl]),Zp=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],hf=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],xc=function(I,L,O,R,S,f,F){f=f||16,I=I||16,L=L||0,O=O||I;var Q,M,w,H,B,s,p,c,l,u=.5,$=[],K=[],N=Z/I,G=e/f;for(Q=0;f>Q;Q++)for(s=Q+1,H=Q*G,l=s*G,M=L;O>M;M++)p=M+1,w=M*N,c=p*N,$.push(u*h(H)*j(w),u*j(H),-u*h(H)*h(w),u*h(l)*j(c),u*j(l),-u*h(l)*h(c),u*h(H)*j(c),u*j(H),-u*h(H)*h(c),u*h(H)*j(w),u*j(H),-u*h(H)*h(w),u*h(l)*j(w),u*j(l),-u*h(l)*h(w),u*h(l)*j(c),u*j(l),-u*h(l)*h(c)),K.push(M/I,Q/f,p/I,s/f,p/I,Q/f,M/I,Q/f,M/I,s/f,p/I,s/f);if(F){var r=[];for(Q=0,B=$.length;B>Q;Q+=3)r.push(2*$[Q],2*$[Q+1],2*$[Q+2])}if(R){var x=[],U=[];for(w=L*N,Q=0;f>Q;Q++)s=Q+1,H=Q*G,l=s*G,x.push(0,0,0,u*h(l)*j(w),u*j(l),-u*h(l)*h(w),u*h(H)*j(w),u*j(H),-u*h(H)*h(w)),U.push(0,.5,L/I,s/f,L/I,Q/f)}if(S){var z=[],P=[];for(w=O*N,Q=0;f>Q;Q++)s=Q+1,H=Q*G,l=s*G,z.push(0,0,0,u*h(H)*j(w),u*j(H),-u*h(H)*h(w),u*h(l)*j(w),u*j(l),-u*h(l)*h(w)),P.push(1,.5,O/I,Q/f,O/I,s/f)}var Y={vs:$,uv:K,from_vs:x,from_uv:U,to_vs:z,to_uv:P};return F&&(Y.ns=r),Y},ks=function(b,G,t){b=b||.17,G=G||12,t=t||18,0>b?b=0:b>.25&&(b=.25);var y,U,n,Y,i,g,S,o=.5,u=[],M=[],v=[],T=Z/t,x=Z/G,p=o-b;for(U=0;G>=U;U++)for(Y=-e+U*x,g=j(Y),i=h(Y),y=0;t>=y;y++)n=y*T,S=p+b*g,u.push(j(n)*S,i*b,-h(n)*S),M.push(y/t,1-U/G);for(U=0;G>U;U++){var m=U*(t+1),D=(U+1)*(t+1);for(y=0;t>y;y++)v.push(m+y,D+y+1,D+y,m+y,m+y+1,D+y+1)}return{vs:u,uv:M,is:v}},fn=function(s,U,d,y,r,n,q,A){q=q||12,s=s||18,U=U||0,d=d||s,n=n||.17,0>n?n=0:n>.25&&(n=.25);var k,u,I,V,l,G,v,Q,m,R,x=.5,K=[],P=[],b=Z/s,c=Z/q,Y=x-n,T=A?[]:_;for(I=0;q>I;I++)for(V=I+1,v=-e+I*c,Q=-e+V*c,k=U;d>k;k++)u=k+1,l=k*b,G=u*b,m=Y+n*j(v),R=Y+n*j(Q),K.push(j(l)*m,h(v)*n,-h(l)*m,j(G)*m,h(v)*n,-h(G)*m,j(G)*R,h(Q)*n,-h(G)*R,j(l)*m,h(v)*n,-h(l)*m,j(G)*R,h(Q)*n,-h(G)*R,j(l)*R,h(Q)*n,-h(l)*R),P.push(k/s,1-I/q,u/s,1-I/q,u/s,1-V/q,k/s,1-I/q,u/s,1-V/q,k/s,1-V/q),A&&T.push(j(l)*j(v),h(v),-h(l)*j(v),j(G)*j(v),h(v),-h(G)*j(v),j(G)*j(Q),h(Q),-h(G)*j(Q),j(l)*j(v),h(v),-h(l)*j(v),j(G)*j(Q),h(Q),-h(G)*j(Q),j(l)*j(Q),h(Q),-h(l)*j(Q));if(y){var $=[],z=[];for(I=0;q>I;I++)V=I+1,v=-e+I*c,Q=-e+V*c,l=U*b,m=Y+n*j(v),R=Y+n*j(Q),$.push(j(l)*m,h(v)*n,-h(l)*m,j(l)*R,h(Q)*n,-h(l)*R,j(l)*Y,0,-h(l)*Y),z.push(.5+.5*j(v),.5-.5*h(v),.5+.5*j(Q),.5-.5*h(Q),.5,.5)}if(r){var w=[],B=[];for(I=0;q>I;I++)V=I+1,v=-e+I*c,Q=-e+V*c,l=d*b,m=Y+n*j(v),R=Y+n*j(Q),w.push(j(l)*m,h(v)*n,-h(l)*m,j(l)*Y,0,-h(l)*Y,j(l)*R,h(Q)*n,-h(l)*R),B.push(.5-.5*j(v),.5-.5*h(v),.5,.5,.5-.5*j(Q),.5-.5*h(Q))}var H={vs:K,uv:P,from_vs:$,from_uv:z,to_vs:w,to_uv:B};return A&&(H.ns=T),H},bj=function(c,z){for(var W,G,n,e,s,N=.5,$=16,H=[],b=[],x=[],X=[],P=Z/$,M=0;$>=M;M++)W=M*P,G=j(W),e=G*N,n=h(W),s=n*N,H.push(e,-N,s,e,N,s),x.push(G,0,n,G,0,n),b.push(1-M/$,1,1-M/$,0);for(M=0;$>M;M++)X.push(2*M,2*M+1,2*M+3,2*M,2*M+3,2*M+2);if(z){var i=[],L=[],l=[];for(i.push(0,-N,0),L.push(.5,.5),M=0;$>=M;M++)W=M*P,G=j(W),n=h(W),i.push(G*N,-N,-n*N),L.push(.5+.5*G,.5+.5*n);for(M=0;$>M;M++)l.push(0,M+2,M+1)}if(c){var O=[],d=[],J=[];for(O.push(0,N,0),d.push(.5,.5),M=0;$>=M;M++)W=M*P,G=j(W),n=h(W),O.push(G*N,N,-n*N),d.push(.5+.5*G,.5-.5*n);for(M=0;$>M;M++)J.push(0,M+1,M+2)}return{vs:H,uv:b,is:X,ns:x,bottom_vs:i,bottom_uv:L,bottom_is:l,top_vs:O,top_uv:d,top_is:J}},_n=function(k,Y,A,I,E,v,r,B){k=k||12,Y=Y||0,A=A||k;for(var m,D,e,d,O,s,i,o,G,J=.5,L=[],$=[],M=Z/k,t=Y;A>t;t++)m=t+1,D=t*M,e=m*M,d=j(D)*J,O=h(D)*J,s=j(e)*J,i=h(e)*J,L.push(d,-J,-O,s,-J,-i,d,J,-O,s,-J,-i,s,J,-i,d,J,-O),$.push(t/k,1,m/k,1,t/k,0,m/k,1,m/k,0,t/k,0);if(B){var c=[];for(t=0,G=L.length;G>t;t+=3)c.push(2*L[t],0,2*L[t+2])}if(r){var y=[],W=[];for(t=Y;A>t;t++)D=M*t,e=M*(t+1),d=j(D),O=h(D),s=j(e),i=h(e),y.push(d*J,-J,-O*J,0,-J,0,s*J,-J,-i*J),W.push(.5+.5*d,.5+.5*O,.5,.5,.5+.5*s,.5+.5*i)}if(v){var g=[],n=[];for(t=Y;A>t;t++)D=M*t,e=M*(t+1),d=j(D),O=h(D),s=j(e),i=h(e),g.push(d*J,J,-O*J,s*J,J,-i*J,0,J,0),n.push(.5+.5*d,.5-.5*O,.5+.5*s,.5-.5*i,.5,.5)}if(I){var C=[],T=[];D=M*Y,d=j(D)*J,O=h(D)*J,o=Y/k,C.push(0,J,0,0,-J,0,d,-J,-O,d,-J,-O,d,J,-O,0,J,0),T.push(0,0,0,1,o,1,o,1,o,0,0,0)}if(E){var z=[],_=[];D=M*A,d=j(D)*J,O=h(D)*J,o=A/k,z.push(0,-J,0,0,J,0,d,J,-O,d,J,-O,d,-J,-O,0,-J,0),_.push(1,1,1,0,o,0,o,0,o,1,1,1)}var R={vs:L,uv:$,bottom_vs:y,bottom_uv:W,top_vs:g,top_uv:n,from_vs:C,from_uv:T,to_vs:z,to_uv:_};return B&&(R.ns=c),R},Xe=function(C,p,l,w,V){p=p||18,l=l||0,w=w==Q?Z:w,V=V==Q?.5:V;for(var J,_,G,q,a,Y,r=[0,.5,.75,.875,.9375],o=[],m=[],i=[],k=w/p,f=0;f<r.length;f++){var d=0===f%2?0:.5;for(J=0;p>=J;J++)_=(J+d)*k+l,G=1-r[f],o.push(j(_)*V*G,-V+2*r[f]*V,-h(_)*V*G),m.push((J+d)/p,G)}for(f=0;f<r.length-1;f++){var K=f*(p+1),R=(f+1)*(p+1);for(J=0;p>J;J++)i.push(K+J,R+J+1,R+J,K+J,K+J+1,R+J+1)}for(Y=o.length/3-(p+1),J=0;p>J;J++)o.push(0,V,0),m.push((J+.5)/p,0);for(J=0;p>J;J++)i.push(Y+J,Y+J+1,Y+(p+1)+J);if(C){var A=[],B=[],U=[];for(A.push(0,-V,0),B.push(.5,.5),J=0;p>=J;J++)_=J*k+l,q=j(_),a=h(_),A.push(q*V,-V,-a*V),B.push(.5+.5*q,.5+.5*a);for(J=0;p>J;J++)U.push(0,J+2,J+1)}return{vs:o,uv:m,is:i,bottom_vs:A,bottom_uv:B,bottom_is:U}},Bi=function(O,J,G,Y,f,F,l,r){O=O||16,J=J||0,G=G||O,l=l||1;var w,C,H,i,p,t,x,U=.5,v=[],k=[],s=Z/O,d=J,X=1/l,C=new id,H=new id,c=new id,b=new id,u=new id,P=new id,z=new id;for(r&&(w=[],p=new id,t=new id,x=new id);G>d;d++){var D=d+1,E=s*d,K=s*D;for(C.set(j(E)*U,-U,-h(E)*U),H.set(j(K)*U,-U,-h(K)*U),c.set(0,U,0),r&&(p.set(j(E),.5,-h(E)).normalize(),t.set(j(K),.5,-h(K)).normalize(),x.copy(p).add(t).normalize()),b.lerpVectors(c,C,X),u.lerpVectors(c,H,X),v.push(b.x,b.y,b.z,u.x,u.y,u.z,c.x,c.y,c.z),k.push(d/O,X,D/O,X,(d+D)/2/O,0),r&&w.push(p.x,p.y,p.z,t.x,t.y,t.z,x.x,x.y,x.z),i=1;l>i;i++)b.lerpVectors(c,C,X*(i+1)),u.lerpVectors(c,H,X*(i+1)),P.lerpVectors(c,C,X*i),z.lerpVectors(c,H,X*i),v.push(b.x,b.y,b.z,u.x,u.y,u.z,P.x,P.y,P.z,P.x,P.y,P.z,u.x,u.y,u.z,z.x,z.y,z.z),k.push(d/O,X*(i+1),D/O,X*(i+1),d/O,X*i,d/O,X*i,D/O,X*(i+1),D/O,X*i),r&&w.push(p.x,p.y,p.z,t.x,t.y,t.z,p.x,p.y,p.z,p.x,p.y,p.z,t.x,t.y,t.z,t.x,t.y,t.z)}if(F){var I=[],N=[];for(d=J;G>d;d++){E=s*d,K=s*(d+1);var e=j(E),A=h(E),q=j(K),S=h(K);I.push(e*U,-U,-A*U,0,-U,0,q*U,-U,-S*U),N.push(.5+.5*e,.5+.5*A,.5,.5,.5+.5*q,.5+.5*S)}}if(Y){var R=[],M=[];E=s*J,R.push(0,U,0,0,-U,0,j(E)*U,-U,-h(E)*U),M.push(0,0,0,1,J/O,1)}if(f){var T=[],y=[];E=s*G,T.push(0,-U,0,0,U,0,j(E)*U,-U,-h(E)*U),y.push(1,1,1,0,G/O,1)}var L={vs:v,uv:k,bottom_vs:I,bottom_uv:N,from_vs:R,from_uv:M,to_vs:T,to_uv:y};return r&&(L.ns=w),L},Qj=function(p,m,d,n,s,e,G,T){for(var L=[],h=0;h<p.length-1;h+=2)L.push({x:p[h],y:p[h+1]});return ib(L,m,d,n,s,e,G,T,!1)},Oe={roundRect:function(z,s){return Qj([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],z,s,3)},star:function(l,z){return Qj([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],l,z)},rect:function(S,T){return Qj([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],S,T)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(p,y){return Qj([0,-.5,.5,.5,-.5,.5],[1,2,2,5],p,y)},rightTriangle:function(k,X){return Qj([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],k,X)},parallelogram:function(T,U){return Qj([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],T,U)},trapezoid:function(I,X){return Qj([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],I,X)}},Id={sphere:1,cylinder:1,cone:1,torus:1},De={torus:1,sphere:1,cone:1},sm=nd(be(Oe),{cylinder:1}),tn=nd(be(Oe),{cylinder:1,cone:1}),Vh=function(e,s,y){var B,c=yk(e.anchor3d,y,s),R=yk(e.mat,y,s),t=yk(e.s3,y,s),W=yk(e.t3,y,s),p=yk(e.r3,y,s),i=t||p||W||R;if(c||i){B=Vg(s._6O);var x=i?qh(R,t,p,yk(e.rotationMode,y,s),W):ph();c&&ah(x,[.5-c[0],.5-c[1],.5-c[2]]),Sk(s,x)}return B},Cp=function(c,U,b,R,N,O,f){if(oi(b))b.forEach(function(S){Cp(c,U,S,R,N,O,f)});else if(am(b))Cp(c,U,sh(R,b),R,N,O,f);else if(vp(b))if(b.shape3d){var x=Vh(b,c,U);Cp(c,U,b.shape3d,R,N,O,b),x&&im(c,x)}else bl(c,U,b,R.s,N,O,f)},bl=function(T,z,I,l,J,X,v){if(v=v||Ep,!X||X(l("shape3d.transparent",I.transparent,v.transparent))){var L=Vh(I,T,z);if(bk(I)){var e=T.getData3dUI(z);e.dispatchBoundingBoxChanged()}var V=T._26I,i=T._prg,c=T._buffer,n=l("shape3d.color",I.color,v.color);J||(J=l("shape3d.blend",I.blend,v.blend));var C,Y=I.opacity==Q?v.opacity:I.opacity,D=l("shape3d.opacity");C=D!=Q&&Y!=Q?Y*D:Y!=Q?Y:D,Rg(V,i,J,l("shape3d.light",I.light,v.light),C,l("shape3d.reverse.flip",I.reverseFlip,v.reverseFlip),l("shape3d.reverse.color",I.reverseColor,v.reverseColor),l("shape3d.reverse.cull",I.reverseCull,v.reverseCull));var u=l("polygonOffset",I.polygonOffset,v.polygonOffset);I.vs&&l(Cm,I.visible,v.visible)&&Fd(V,i,c,n,T.getTexture(l("shape3d.image",I.image,v.image),z),l("shape3d.discard.selectable",I.discardSelectable,v.discardSelectable),I.vs,I.uv,I.ns,I.is,l("shape3d.uv.offset",I.uvOffset,v.uvOffset),l("shape3d.uv.scale",I.uvScale,v.uvScale),l("shape3d.uv.rotation",I.uvRotation,v.uvRotation),u),I.top_vs&&l($c,I.topVisible,v.topVisible)&&Fd(V,i,c,l("shape3d.top.color",I.topColor,v.topColor)||n,T.getTexture(l("shape3d.top.image",I.topImage,v.topImage),z,"top"),l("shape3d.top.discard.selectable",I.topDiscardSelectable,v.topDiscardSelectable),I.top_vs,I.top_uv,I.top_ns,I.top_is,l("shape3d.top.uv.offset",I.topUvOffset,v.topUvOffset),l("shape3d.top.uv.scale",I.topUvScale,v.topUvScale),l("shape3d.top.uv.rotation",I.topUvRotation,v.topUvRotation),u),I.bottom_vs&&l(Tg,I.bottomVisible,v.bottomVisible)&&Fd(V,i,c,l("shape3d.bottom.color",I.bottomColor,v.bottomColor)||n,T.getTexture(l("shape3d.bottom.image",I.bottomImage,v.bottomImage),z,"bottom"),l("shape3d.bottom.discard.selectable",I.bottomDiscardSelectable,v.bottomDiscardSelectable),I.bottom_vs,I.bottom_uv,I.bottom_ns,I.bottom_is,l("shape3d.bottom.uv.offset",I.bottomUvOffset,v.bottomUvOffset),l("shape3d.bottom.uv.scale",I.bottomUvScale,v.bottomUvScale),l("shape3d.bottom.uv.rotation",I.bottomUvRotation,v.bottomUvRotation),u),I.from_vs&&l(Xo,I.fromVisible,v.fromVisible)&&Fd(V,i,c,l("shape3d.from.color",I.fromColor,v.fromColor)||n,T.getTexture(l("shape3d.from.image",I.fromImage,v.fromImage),z,"from"),l("shape3d.from.discard.selectable",I.fromDiscardSelectable,v.fromDiscardSelectable),I.from_vs,I.from_uv,I.from_ns,I.from_is,l("shape3d.from.uv.offset",I.fromUvOffset,v.fromUvOffset),l("shape3d.from.uv.scale",I.fromUvScale,v.fromUvScale),l("shape3d.from.uv.rotation",I.fromUvRotation,v.fromUvRotation),u),I.to_vs&&l(vl,I.toVisible,v.toVisible)&&Fd(V,i,c,l("shape3d.to.color",I.toColor,v.toColor)||n,T.getTexture(l("shape3d.to.image",I.toImage,v.toImage),z,"to"),l("shape3d.to.discard.selectable",I.toDiscardSelectable,v.toDiscardSelectable),I.to_vs,I.to_uv,I.to_ns,I.to_is,l("shape3d.to.uv.offset",I.toUvOffset,v.toUvOffset),l("shape3d.to.uv.scale",I.toUvScale,v.toUvScale),l("shape3d.to.uv.rotation",I.toUvRotation,v.toUvRotation),u),Wl(V,i),L&&im(T,L)}},Fd=function(T,i,c,D,k,Z,g,z,x,K,d,I,u,s){if(g){s&&ie(T,s);var N=Of.for(T),a=N.directUniforms(),L=N.directAttribs();a.uDiffuse=D||X["color.empty"],z?wh(T,i,k,Z,c.uv,z,d,I,u):wh(T),L.aPosition=Bg(T,c.vs,g,Q),L.aNormal=Bg(T,c.ns,x,Q),K?(_c(T,c.is,K),jk(T,0,K.length,null,K instanceof Uint32Array?T.UNSIGNED_INT:null)):Lj(T,0,g.length/3),z?wn(T,i,k):wn(T),s&&bf(T)}},sh=function(J,Z){var U=J.s;if(Z||(Z=U(Sl)),!Z)return Q;var H=Lc(Z);if(H)return H;if("text"===Z){var e={amount:U("shape3d.text.amount"),size:U("shape3d.text.size"),font:U("shape3d.text.font"),style:U("shape3d.text.style"),weight:U("shape3d.text.weight"),fill:U("shape3d.text.fill"),curveSegments:U("shape3d.text.curveSegments"),spacing:U("shape3d.text.spacing")},$=J.gv.getShape3dText(J.data),n=$;for(var c in e)n+="_"+(e[c]===_?"U":e[c]);return J._cachedTextKey===n?J._cachedTextGeometry:(J._cachedTextKey=n,J._cachedTextGeometry=C.createTextGeometry($,e))}var c=Z;if(Id[Z]){var K=U("shape3d.side"),d=U("shape3d.side.from"),T=U("shape3d.side.to"),w=U(Xo),R=U(vl);3>K?(K=0,d=0,T=0,w=!1,R=!1):((d==Q||0>d)&&(d=0),(T==Q||T>K)&&(T=K),0===d&&T===K&&(w=!1,R=!1));var o=U("shape3d.smooth");c+="-"+K+"-"+d+"-"+T+"-"+w+"-"+R+(o?1:0)}if(sm[Z]){var f=U($c);c+="-"+f}if(tn[Z]){var r=U(Tg);c+="-"+r}if("torus"===Z){var M=U("shape3d.torus.radius");0>M?M=0:M>.25&&(M=.25),c+="-"+M}if(De[Z]){var x=U(jh);c+="-"+x}return H=ak[c],H||("box"===Z?H=C.createBoxModel():Oe[Z]?H=Oe[Z](f,r):"sphere"===Z?H=C.createSphereModel(K,d,T,w,R,x,o):Z===ui?H=C.createCylinderModel(K,d,T,w,R,f,r,o):"cone"===Z?H=C.createConeModel(K,d,T,w,R,r,x,o):"torus"===Z&&(H=C.createTorusModel(K,d,T,w,R,M,x,o)),ak[c]=H),H},bk=function(){var K=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],h=["is","top_is","bottom_is","from_is","to_is"];return w=mk(lq.substr(lq.indexOf("^#")+2)),qq(C[$h(Gr+K[15]+"n"+K[16])]())&&hs()?function(t){return t&&!t._complete_?(t._complete_=!0,t.vs&&Hg(t.ns)&&(t.ns=xi(t.vs,t.is),t.boundingBox=_),t.top_vs&&Hg(t.top_ns)&&(t.top_ns=xi(t.top_vs,t.top_is),t.top_boundingBox=_),t.bottom_vs&&Hg(t.bottom_ns)&&(t.bottom_ns=xi(t.bottom_vs,t.bottom_is),t.bottom_boundingBox=_),t.from_vs&&Hg(t.from_ns)&&(t.from_ns=xi(t.from_vs,t.from_is),t.from_boundingBox=_),t.to_vs&&Hg(t.to_ns)&&(t.to_ns=xi(t.to_vs,t.to_is),t.to_boundingBox=_),K.forEach(function(B){var m=t[B];oi(m)&&(t[B]=new Ac(m))}),h.forEach(function(E){var X=t[E];oi(X)&&(t[E]=new Vf(X))}),!0):!1}:void 0}(),Af=function(B,b){var N=B[b];oi(N)&&(B[b]=new Ac(N))};nd(Im,{_25Q:function(P){P._16O=function(X,y,i,v,G,R,s,Y,Z){var f=this.info;if(f){var N,J,q,M,L,E,B=ph();if(xe[y]?(N=f.p3,J=f.c1,q=f.c2):Ir[y]?(J=f.s1||f.c1,q=f.s2||f.c2):(J=f.t1||f.c1,q=f.t2||f.c2),N)E=Sc(y,Em,i,v,Y,Z);else{var V=Yb(q,J),j=Ki(J,q);M=[0,-mf(V[2],V[0]),A(V[1]/j)],L="zyx",N=[(J[0]+q[0])/2,(J[1]+q[1])/2,(J[2]+q[2])/2],E=Sc(y,[j,0,0],i,v,Y,Z)}return Zn(B,E,N,v,G,R,s,X,M,L)}return ri},P._80o=function(L,c,D){var K=this,b=K.shapeModel;if(b){var $=K.gv;Sk($),Cp($,K.data,b,K,K.getBodyColor(),D)}},P.createLineModel=function(r,v,Z,W,m){var F=this,_=F.s,f=Pk(r,v,_(jh)),I=_(W+".color");if(I){for(var n=[],h=0;h<f.length;h++){var s=f[h],G=s.length;if(G>1){var y=s[0];n.push(y.x,y.y,y.z);for(var w=1;G-1>w;w++)y=s[w],n.push(y.x,y.y,y.z),n.push(y.x,y.y,y.z);y=s[G-1],n.push(y.x,y.y,y.z)}}var d,U,P,k=_(m),B=0;k&&(U=_(m+".color"),d=_(m+".pattern"),B=_(m+".offset"),P=I),Gl(F.gv,F.data,n,U||I,P?Q:_(W+".gradient.color"),Z,d||_(W+".pattern"),B,P)}return f},P.createTubeModel=function(L,e,C,h){for(var r=this,$=r.s,G=$("shape3d.side")||Ci,K=$("shape3d.start.angle"),z=$("shape3d.sweep.angle"),c=$($c)?$("shape3d.top.cap"):Q,k=$(Tg)?$("shape3d.bottom.cap"):Q,S="flat"===c,o="flat"===k,F=S&&(h?h.uv:$("shape3d.top.image")),b=o&&(h?h.uv:$("shape3d.bottom.image")),n=h?h.uv:$("shape3d.image"),x=$("shape3d.smooth"),T={vs:[],uv:n?[]:Q,ns:x?[]:Q,top_vs:S?[]:Q,top_uv:F?[]:Q,bottom_vs:o?[]:Q,bottom_uv:b?[]:Q},y=Pk(L,e,$(jh),C),O=0,X=y.length;X>O;O++)of(T,y[O],$(jb),C,G,K,z,c,k);return h?Rd(r.gv,r.data,T,r,r.getBodyColor(),r.mat?[r.mat]:[],h):r.shapeModel=T,r.lineShapeModel=T,y},P.getCache=function(){var J=this.info;if(J){var g=J.list;if(g){var a=J.cache;return a||(a=J.cache=mn(g)),a}}return Q}}});var Dp=function(r,L){for(var I,U=0,v=r.length,n=0,M=v-1;M>=n;)if(U=E(n+(M-n)/2),I=r[U].length-L,0>I)n=U+1;else{if(!(I>0)){M=U;break}M=U-1}U=M;var t=r[U],h=t.point;return U===v-1||t.length===L||(h=(new yp).subVectors(r[U+1].point,h).normalize().multiplyScalar(L-t.length).add(h)),{point:h,tangent:t.tangent}},mn=function(W){for(var Y,B,l=[],d=0,_=0;_<W.length;_++){for(var x=W[_],y=0;y<x.length;y++){Y=x[y],B&&(d+=B.distanceTo(Y));var w=new yp,u=x[y+1];u?w.subVectors(u,Y):B?w.subVectors(Y,B):w.x=1,w.normalize(),l.push({point:Y,length:d,tangent:w}),B=Y}B=null}return l},Pk=function(C,Y,H,Z){H=H||zh;for(var S=[],b=0,X=C.size();X>b;b++){var G=C.get(b);S.push(new yp(G.x,G.e||0,G.y))}Y&&(Wh(Y)&&(Y=Y._as),Y.length||(Y=null));for(var t,K,J,c,e,z=[],D=[],y=0,O=0,U=Y?Y.length:X;U>O;O++){if(e=Y?Y[O]:0===O?1:2,1===e)z.push(J=[]),J.push(S[y++]);else if(2===e||5===e)if(c=2===e?S[y++]:J[0],Z){var L=Y?Y[O+1]:U>O+1?2:Q;if(2===L||5===L){var N=J[J.length-1],k=2===L?S[y]:J[0],u=(new yp).subVectors(N,c),i=(new yp).subVectors(k,c),r=u.length(),P=i.length();if(r&&P)if(Z>r/2&&Z>P/2)J.push(c);else for(u.multiplyScalar(F(Z,r/2)/r).add(c),i.multiplyScalar(F(Z,P/2)/P).add(c),t=new Bl(u,c,i).getPoints(H),K=0;H>=K;K++)J.push(t[K])}else J.push(c)}else J.push(c);else if(3===e)for(t=new Bl(J[J.length-1],S[y++],S[y++]).getPoints(H),K=1;H>=K;K++)J.push(t[K]);else if(4===e)for(t=new qe(J[J.length-1],S[y++],S[y++],S[y++]).getPoints(H),K=1;H>=K;K++)J.push(t[K]);D.push(z.length,J.length)}return z.indexMark=D,z},Rp=function(P){for(var D,Y,E=new yp,i=[],k=[],M=[],B=0,K=P.length;K>B;B++)D=P[B],Y=P[B+1],Y?E.subVectors(Y,D):E.subVectors(D,P[B-1]),i.push(E.normalize().clone());var m,A=new yp,Q=new yp,W=new El,z=1e-4,u=i[0],b=k[0]=new yp,t=M[0]=new yp;
for(Math.abs(Math.abs(u.y)-1)<z?A.set(1,0,0):A.set(0,1,0),Q.crossVectors(u,A).normalize(),b.crossVectors(u,Q),t.crossVectors(u,b),B=1;K>B;B++)k[B]=k[B-1].clone(),M[B]=M[B-1].clone(),Q.crossVectors(i[B-1],i[B]),Q.length()>z&&(Q.normalize(),m=S(cd(i[B-1].dot(i[B]),-1,1)),k[B].applyMatrix4(W.makeRotationAxis(Q,m))),M[B].crossVectors(i[B],k[B]);return{B:M,T:i,N:k}},of=function(){var b=function(o){for(var s=1;s<arguments.length;s++){var J=arguments[s];o.push(J.x,J.y,J.z)}},m=function(y){for(var W=1;W<arguments.length;W++){var L=arguments[W].uv;y.push(L[0],L[1])}},$=function(o){for(var X=1;X<arguments.length;X++){var v=arguments[X].ns;o.push(v[0],v[1],v[2])}},u=function(r,l,k,t,w){var o=-t*j(w),y=t*h(w);return new yp(r.x+o*k.x+y*l.x,r.y+o*k.y+y*l.y,r.z+o*k.z+y*l.z)},M=function(b,q,T,r,z,f,M,n,F){M=M||Z;for(var y,V=[],w=M/z,y=F?new id:Q,l=0;z>=l;l++){var S=u(b,q,T,r,l*w+f);V.push(S),n!=Q&&(S.uv=[n,1-l/z]),F&&(S.ns=y.subVectors(S,b).normalize().toArray())}return V},v=function(g,f,l,D,s,v,R,p,H){H=H||Z;var L=f?g.top_vs:g.bottom_vs;if(L)for(var i=f?g.top_uv:g.bottom_uv,k=H/R,B=0;R>B;B++){var e,V;f?(e=B*k+p,V=(B+1)*k+p):(V=B*k+p,e=(B+1)*k+p),b(L,u(l,D,s,v,e),u(l,D,s,v,V),l),i&&i.push(.5-.5*j(e),.5-.5*h(e),.5-.5*j(V),.5-.5*h(V),.5,.5)}};return function(G,R,h,t,O,u,A,E,L){var U=R.length;if(U>1){var V,W,x,n,w,Y,k,g=Rp(R),B=g.T,i=g.N,q=g.B;"flat"===E&&v(G,!0,R[0],q[0],i[0],t,O,u,A),"flat"===L&&v(G,!1,R[U-1],q[U-1],i[U-1],t,O,u,A);var D,I,T=[],j=J(O/2),X="round"===E,s="round"===L,Z=R[0],y=B[0],F=q[0],C=i[0],e=R[U-1],o=B[U-1],H=q[U-1],l=i[U-1];if(X){for(x=1;j>=x;x++)i.splice(0,0,C),q.splice(0,0,F),B.splice(0,0,y),I=-x/j*t,R.splice(0,0,y.clone().multiplyScalar(I).add(Z)),T[j-x]=z(t*t-I*I);U+=j}if(s){for(x=1;j>=x;x++)i.push(l),q.push(H),B.push(o),I=x/j*t,R.push(o.clone().multiplyScalar(I).add(e)),T[R.length-1]=z(t*t-I*I);U+=j}if(G.uv){var S=0,p=0,a=[];for(h&&(S=h),w=R[0],a[0]=0,x=1;U>x;x++)n=R[x],a[x]=w.distanceTo(n),w=n,h||(S+=a[x]);for(D=[],x=0;U>x;x++)p+=a[x],D[x]=S?p/S:0}var c=G.ns?!0:!1;for(x=0;U>x;x++){if(n=R[x],Y=q[x],k=i[x],V=M(n,Y,k,T[x]===_?t:T[x],O,u,A,D?D[x]:Q,c),W)for(var K=0;O>K;K++){var r=W[K],N=W[K+1]||W[0],f=V[K],P=V[K+1]||V[0];b(G.vs,N,r,f,f,P,N),G.uv&&m(G.uv,N,r,f,f,P,N),c&&$(G.ns,N,r,f,f,P,N)}W=V}}}}();nd(C,{getLineLength:function(i){return i[i.length-1].length},getLineOffset:function(Z,w){return Dp(Z,w)},getLineCacheInfo:function(j,$,p,L){return mn(Pk(j,$,p,L))}});var Yg=b.graph3d.RenderLite={},Oh=new Array(0),Ne=Yg.Buffer=function(s,q,J,N){this.gl=s,this.buffer=s.createBuffer(),this.type=q||s.ARRAY_BUFFER,this.drawType=N||s.STATIC_DRAW,this.data=Oh,J&&this.upload(J)};Ne.prototype.upload=function(Q,C,f){f||this.bind();var o=this.gl;Q=Q||this.data,C=C||0,this.data.byteLength>=Q.byteLength?o.bufferSubData(this.type,C,Q):o.bufferData(this.type,Q,this.drawType),this.data=Q},Ne.prototype.bind=function(){var I=this.gl;I.bindBuffer(this.type,this.buffer)},Ne.createVertexBuffer=function(h,F,U){return new Ne(h,h.ARRAY_BUFFER,F,U)},Ne.createIndexBuffer=function(B,T,E){return new Ne(B,B.ELEMENT_ARRAY_BUFFER,T,E)},Ne.create=function(M,$,t,A){return new Ne(M,$,A)},Ne.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var ti=Yg.Shader=function(o,N,u){this.gl=o,this.program=Nj(o,N,u),this.attributes=rg(o,this.program);var K=zs(o,this.program);this.uniforms=Eq(o,K)};ti.prototype.bind=function(){this.gl.useProgram(this.program)},ti.prototype.destroy=function(){this.gl};var Nj=function(P,l,n){var c=Sn(P,P.VERTEX_SHADER,l),D=Sn(P,P.FRAGMENT_SHADER,n),z=P.createProgram();return P.attachShader(z,c),P.attachShader(z,D),P.linkProgram(z),P.getProgramParameter(z,P.LINK_STATUS)||(Sh("LINK","LITE",P.getProgramParameter(z,P.VALIDATE_STATUS),P.getError(),P.getProgramInfoLog(z)),P.deleteProgram(z),z=null),P.deleteShader(c),P.deleteShader(D),z},Sn=function(N,M,Y){var m=N.createShader(M);return N.shaderSource(m,Y),N.compileShader(m),N.getShaderParameter(m,N.COMPILE_STATUS)?m:(Sh("COMPILE","LITE",M,N.getError(),N.getShaderInfoLog(m)),null)},zs=function(O,d){for(var r={},h=O.getProgramParameter(d,O.ACTIVE_UNIFORMS),v=0;h>v;v++){var A=O.getActiveUniform(d,v),N=A.name.replace(/\[.*?\]/,""),a=Hj(O,A.type);r[N]={type:a,size:A.size,location:O.getUniformLocation(d,N),value:Mg(a,A.size)}}return r},rg=function(K,N){for(var $={},Q=K.getProgramParameter(N,K.ACTIVE_ATTRIBUTES),p=0;Q>p;p++){var S=K.getActiveAttrib(N,p),c=Hj(K,S.type);$[S.name]={type:c,size:fk(c),gl:K,location:K.getAttribLocation(N,S.name),pointer:_h}}return $},_h=function(t,I,m,E,e){var J=this.gl;J.enableVertexAttribArray(this.location),t instanceof Yg.Buffer||(t=Yg.Buffer.createVertexBuffer(J,t)),J.bindBuffer(t.type,t.buffer),J.vertexAttribPointer(this.location,this.size,I||J.FLOAT,m||!1,E||0,e||0)},fk=function(n){return fj[n]},fj={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Hj=function(g,m){if(!pn){var Y=x.keys(sj);pn={};for(var T=0;T<Y.length;++T){var h=Y[T];pn[g[h]]=sj[h]}}return pn[m]},pn=null,sj={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Mg=function(X,q){switch(X){case"float":return 0;case"vec2":return new Float32Array(2*q);case"vec3":return new Float32Array(3*q);case"vec4":return new Float32Array(4*q);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*q);case"ivec3":return new Int32Array(3*q);case"ivec4":return new Int32Array(4*q);case"bool":return!1;case"bvec2":return Ie(2*q);case"bvec3":return Ie(3*q);case"bvec4":return Ie(4*q);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Ie=function(F){for(var R=new Array(F),x=0;x<R.length;x++)R[x]=!1;return R},Eq=function(N,D){var a={data:{}};a.gl=N;for(var h=x.keys(D),O=0;O<h.length;O++){var v=h[O],C=v.split("."),B=C[C.length-1],l=lb(C,a),L=D[v];l.data[B]=L,l.gl=N,x.defineProperty(l,B,{get:Wg(B),set:Eo(B,L)})}return a},Wg=function(d){var x=Yk.replace("%%",d);return new Function(x)},Eo=function(S,k){var b,$=Jn.replace(/%%/g,S);return b=1===k.size?pp[k.type]:qb[k.type],b&&($+="\nthis.gl."+b+";"),new Function("value",$)},lb=function(P,s){for(var Y=s,j=0;j<P.length-1;j++){var H=Y[P[j]]||{data:{}};Y[P[j]]=H,Y=H}return Y},Yk=["return this.data.%%.value;"].join("\n"),Jn=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),pp={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},qb={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Ug=function(r){function P(Z){if("string"!=typeof Z)return 0|Z;switch(Z){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var u=this;u.enable=!1;var g,U,w,h,D=C.graph3dViewShadowType,M=C.graph3dViewShadowIntensity,I=C.graph3dViewShadowBias,X=C.graph3dViewShadowQuality,V=C.graph3dViewShadowRadius,q=C.graph3dViewShadowDegreeX,A=C.graph3dViewShadowDegreeZ,T=1,o=P(X),N=!1,i=new b.Math.Matrix4,e=new b.Math.Matrix4,E=u.pvMatrix=new b.Math.Matrix4,F=0;u.render=function(){if(!r._picking&&u.enable){var v=r.getGL();if(v){if(N&&u.setupShadowCamera(),r._glCapabilities&&(o=Math.min(o,r._glCapabilities.maxTextureSize)),h=r.isReflecting(v)){if(F===v._renderInfo.frame)return;F=v._renderInfo.frame}var I=h?"mapForReflector":"map";if((g=u[I])?g.setSize(o,o):g=u[I]=new sk(r,r.getGL(),0,0,{samples:1,minFilter:Di.NEAREST,magFilter:Di.NEAREST,width:o,height:o}),!v._shadowShader){var V="#define MAX_BOX_CLIPPER "+r._boxClippers.length;v._shadowShader=new Yg.Shader(v,Ug.shaderSrc.vs.replace("$DEFINE",V),Ug.shaderSrc.fs.replace("$DEFINE",V))}var n=r._frameState,w=n.renderState.glState;w.blend.enabled=!1,w.depth.enabled=!0,w.depth.mask=!0;var Q=w.color.clear.slice(0);wj(v,[1,1,1,1]),n.renderState.useProgram(v._shadowShader.program),s(),wj(v,Q)}}},u.deleteShadowProgram=function(){var w=r.getGL();w&&w._shadowShader&&(w.deleteProgram(w._shadowShader.program),w._shadowShader=null)},u.getShadow=function(){var i={degreeX:q,degreeZ:A,intensity:M,quality:X,type:D,radius:V,bias:I};return 1!==T&&(i.boundExtend=T),i},u.setShadow=function(O,R){O=!!O;var C=u.enable!==O;u.enable=O,"object"==typeof R&&(R.intensity!==_&&(M=R.intensity),R.bias!==_&&(I=R.bias),R.radius!==_&&(V=R.radius),R.degreeX!==_&&(q=R.degreeX),R.degreeZ!==_&&(A=R.degreeZ),R.quality!==_&&(X=R.quality),R.type!==_&&D!==R.type&&(D=R.type,C=!0),o=P(X),R.boundExtend!==_&&(T=R.boundExtend)),O&&u.setupShadowCamera(),C&&_d(r),r.iv()},u.refresh=function(){this.enable&&(this.setupShadowCamera(),r.iv())},u.tryUpdateBounding=function(b){var L=this.boundingSphere;if(L){var H=(new El).fromArray(pc(b,r.getMat(b))),E=b.getAnchor3d(),M=new id;L.containsPoint(M.set(0-E.x,0-E.y,0-E.z).applyMatrix4(H))&&L.containsPoint(M.set(0-E.x,0-E.y,1-E.z).applyMatrix4(H))&&L.containsPoint(M.set(0-E.x,1-E.y,0-E.z).applyMatrix4(H))&&L.containsPoint(M.set(0-E.x,1-E.y,1-E.z).applyMatrix4(H))&&L.containsPoint(M.set(1-E.x,0-E.y,0-E.z).applyMatrix4(H))&&L.containsPoint(M.set(1-E.x,0-E.y,1-E.z).applyMatrix4(H))&&L.containsPoint(M.set(1-E.x,1-E.y,0-E.z).applyMatrix4(H))&&L.containsPoint(M.set(1-E.x,1-E.y,1-E.z).applyMatrix4(H))||u.setupShadowCamera()}},u.createShadow=function(h){if(h||(h=r._frameState.renderState.directUniforms()),h.shadowMatrix=E.toArray(),r._getFrameRenderOptions("renderShadow")===!1){var m,d=r.getGL();(m=d._emptyShadowTexture)||(m=d._emptyShadowTexture=li(d,null,[255,255,255,255])),h.shadowMap=m}else{var e=r._getFrameRenderOptions("useReflectorSelfShadowMap")&&u.mapForReflector;h.shadowMap=e?u.mapForReflector.texture:u.map.texture}h.shadowSize=[g.width,g.height],h.shadowIntensity=M,h.shadowBias=I,h.shadowRadius=V},u.genShaderDefine=function(){var z="#define USE_SHADOWMAP\n";return"hard"===D?z+="#define SHADOWMAP_TYPE_PCF\n":"soft"===D&&(z+=r.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),z};var K;u.setupShadowCamera=function(){U||(U=u.boundingSphere=new b.Math.Sphere),N=!1;var g,S,P=r.getBoundingBox(r.dm().toDatas(function(n){return n.s("shadow.cast")&&r.isVisible(n)}));P?(g=new id(P.min),S=new id(P.max)):(g=new id(-256,-256,-256),S=new id(256,256,256),N=!0),U.set(g.clone().add(S).multiplyScalar(.5),.5*g.distanceTo(S)*T);var l,t=U.radius,z=r.getBoundingBox(r.dm().toDatas(function(z){return(z.s("shadow.cast")||z.s("shadow.receive"))&&r.isVisible(z)}));if(z){g.copy(z.min),S.copy(z.max);var G=.5*g.distanceTo(S);l=G+Math.min(G,t+U.center.distanceTo(g.add(S).multiplyScalar(.5)))}else l=2*t;K=ms(ph(),-t,t,-t,t,l/1e3,l),E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),E.multiply(i.fromArray(K));var X=Math.tan(-q*Math.PI/180),k=Math.tan(-A*Math.PI/180),$=t/Math.sqrt(X*X+k*k+1),n=new id($*X,$,$*k);i.lookAt(n,new id(0,0,0),new id(0,1,0)).setPosition(n.add(U.center)),i.getInverse(i),E.multiply(i)};var s=function(){var _=r.getGL(),a=o,M=o;g.setSize(_,a,M),g.bind(_),_.clear(Di.COLOR_BUFFER_BIT|Di.DEPTH_BUFFER_BIT);var U=r._frameState,B=U.renderState,d=B.directUniforms(),b=B.directAttribs(),Z=B.directState();d.projectionMatrix=K,(w=r._boxClippers.length>0)&&(gs(r,d,Jr),d.uClipperMatrix=r._boxClipperMatrixes,d.uClipperClipInner=r._boxClipperClipInner);var f=r._viewport;r.setViewport(_,0,0,a,M);var t,F,G,x;for(t=0,F=Tc.length;F>t;t++)if(G=Tc[t],!xd[G].ignore&&(x=r._40Q.get(G))){var n=x.batchIndexMap;u.renderItems(_,d,b,Z,x.opaque,n),u.renderItems(_,d,b,Z,x.transparent,n),u.renderBatch(_,d,b,Z,x.batchModelMap,n)}g.unbind(_),r.setViewport(_,f[0],f[1],f[2],f[3])};u._renderDirect=function(n,g,M,D){M&&M.length&&(g.position=Bg(n,r._buffer.vs,M,Q),D?(_c(n,r._buffer.is,D),jk(n,0,D.length,null,D instanceof Uint32Array?n.UNSIGNED_INT:null)):Lj(n,0,M.length/3))},u.renderShapeModel=function(r,y,D,E){var O,w,l;if(oi(D))for(w=0,l=D.length;l>w;w++)O=D[w],O&&u.renderShapeModel(r,y,O,E);else am(D)?u.renderShapeModel(r,y,sh(E,D),E):vp(D)&&(D.shape3d?u.renderShapeModel(r,y,D.shape3d,E):u.renderShapeModelImpl(r,y,D))},u.renderShapeModelImpl=function(W,C,G){bk(G),u._renderDirect(W,C,G.vs,G.is),u._renderDirect(W,C,G.top_vs,G.top_is),u._renderDirect(W,C,G.bottom_vs,G.bottom_is),u._renderDirect(W,C,G.from_vs,G.from_is),u._renderDirect(W,C,G.to_vs,G.to_is)},u.renderBatch=function(E,o,L,p,X){if(!vo(X)&&!r.drawFilter){o.modelViewMatrix=e.identity().premultiply(i).toArray();var G,W,c;for(G in X)c=r.getBatchInfo(G)||Ep,c.visible!==!1&&c.shadowCast!==!1&&(h&&c.reflectable===!1||(W=X[G],W.invalidate&&Uj(W),w&&(o.modelMatrix=dg,gs(r,o,c.clipboxMask===_?zg:c.clipboxMask)),u._renderDirect(E,L,W.vs32,W.is)))}},u.renderItems=function(M,k,Q,Y,B,U){var n,$,N,V,z,d,A=B.length;for(n=0;A>n;n++)if($=B[n],V=$.ui,N=$.data,!(co(N)||!N.s("shadow.cast")||N instanceof os||N.s("effect.flow")||!r.isVisible(N)||U[N._id]||h&&N.s("3d.reflectable")===!1)){var R=V.s("3d.clip.direction");if(R){var f=V.s("3d.clip.percentage");if(0===f)continue;var Z=V._formatClipUniforms(R,f,N);k.uClipPercent=Z[1],k.uClipDirection=Z[0]}else k.uClipDirection=0;z=V.shapeModel||sh(V),z||(z=N instanceof b.Node&&!(N instanceof b.Shape)?{vs:tq,is:hi}:[V.left,V.front,V.right,V.back,V.top,V.bottom]),d=V.mat?e.fromArray(V.mat):e.identity(),w&&(k.modelMatrix=d.toArray(),gs(r,k,N.s("3d.clipbox")?Jr:N.s("3d.clipbox.mask"))),k.modelViewMatrix=d.premultiply(i).toArray(),Y.cullFace.enabled=!!N.s("shape3d.reverse.cull"),u.renderShapeModel(M,Q,z,V)}}};Ug.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * vec4(transformed, 1.0));","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform bool uEnableBoxClip[MAX_BOX_CLIPPER];","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uEnableBoxClip[i] && uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin)))) { discard; return; }","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},Ug.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var vj=function(e){function C(m,O,V,C,A){var v=e.getData3dUI(V),x=v.s("shape3d");if("billboard"===x||"plane"===x){var U;(U=H[O])||(U=H[O]=new sk(e));var w=V.s("effect.flow.size"),l=V.s("effect.flow.uvshape");U.setSize(m,w,w),U.bind(m);var q=e.getViewport(m);e.setViewport(m,0,0,w,w),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT);var N,v=e.getData3dUI(V),P=sh(v,x);if(!P)return!1;!P.ns&&P.length&&(P=P[0]),bk(P),N=P.vs;var E,K=V.s("effect.flow.gradient");if(K){if(E="Flow3d.Cached."+K,!b.Default.getImageMap()[E]){var Y=100;b.Default.setImage(E,b.Default.toCanvas({width:Y,height:Y,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:K,rect:[0,0,Y,Y]}]},Y,Y))}}else E=V.s("shape3d.image");C.useXZ="plane"===x,C.image=e.getTexture(E,V),C.blend=V.s("effect.flow.blend")||u,C.uvMatrix=Jo(v.s("shape3d.uv.rotation"),v.s("shape3d.uv.offset"),v.s("shape3d.uv.scale"),j).toArray9(),C.intensity=V.s("effect.flow.intensity");var y=D.indexOf(l);-1===y&&0===l.indexOf("polygon")&&(y=Wo(1*l.substring(7),3,1024)-1),C.shape=y,A.position=Bg(m,null,N,Q,3),Lj(m,0,N.length/3),U.unbind(m),e.setViewport(m,q[0],q[1],q[2],q[3]);var R=V.getMatrix4();R.getInverse(R);var $=R.getElements();"plane"===x?$[1]=$[5]=$[9]=$[13]=0:$[2]=$[6]=$[10]=$[14]=0,_[O]={matrix:R,group:V.s("effect.flow.group")}}}var j,c=this,H=this.renderTargetPool=[],_=[],D=["rect","circle","polygon"];c.render=function(){if(!e._picking){var w=e._flowObjects;if(w.length){var b=e.getGL();if(b){var d;(d=b._flowShader)||(d=b._flowShader=new Yg.Shader(b,vj.shaderSrc.vs,vj.shaderSrc.fs));var W=e._frameState.renderState,K=W.glState;K.blend.enabled=!1,K.depth.enabled=!1,K.cullFace.enabled=!1;var p=K.color.clear.slice(0);wj(b,[0,0,0,1]),W.useProgram(d.program);var l,I,o=W.directUniforms(),P=W.directAttribs();for(l=0,I=w.length;I>l;l++)C(b,l,w[l],o,P);wj(b,p),H.length!==I&&H.splice(I,H.length-I)}}}},c.createFlow=function(F){var q;if(q=H.length){F||(F=e._frameState.renderState.directUniforms());for(var B=[],$=[],U=[],W=0;q>W;W++)B[W]=_[W].matrix.toArray(),$[W]=H[W].texture,U[W]=!1;F.flowMatrix=B;for(var W=0;q>W;W++)F["flowTexture"+W]=$[W];F.flowEnabled=U}},c.disableFlow=function(O){var Y;if(Y=H.length){O||(O=e._frameState.renderState.directUniforms());for(var p=[],k=0;Y>k;k++)p[k]=!1;O.flowEnabled=p}},c.resetDataFlowEnabld=function($,D){var N=$.s("effect.flow.mask"),c=H.length,m=new Array(c);if(N)for(var h=0;c>h;h++)N&1<<_[h].group&&(m[h]=!0);D.flowEnabled=m};var u="white"};vj.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","uniform vec4 blend;","uniform float intensity;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","vec4 color = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy)) * blend;","gl_FragColor = color * color.a * intensity;","}"].join("\n")};var ai=function(z){this.gv=z,this.onMouseOver=this.onMouseOver.bind(this),this.mode=ai.Mode.Style,this.type=X["highlight.type"],this.color=X["highlight.color"],this.width=X["highlight.width"],this.glow=X["highlight.glow"],this.strength=X["highlight.strength"]};ai.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Im.ms_highlight=function(j){j.setHighlightMode=function(G){var c;c="selection"===G||"selected"===G?ai.Mode.Selection:"mouseover"===G||"hover"===G?ai.Mode.MouseOver:"style"===G?ai.Mode.Style:ai.Mode.Disable;var W=this.getHighlightMode();this._highlightHelper.mode=c,this.firePropertyChange("highlightMode",W,G)},j.getHighlightMode=function(){var f=this._highlightHelper.mode;return f===ai.Mode.Selection?"selected":f===ai.Mode.MouseOver?"hover":f===ai.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(w){var u=w.replace(/(^|\.)[a-z]/g,function(d){return d[d.length-1].toUpperCase()});j["getHighlight"+u]=function(){return this._highlightHelper[w]},j["setHighlight"+u]=function(x){var $=this._highlightHelper,J=$[w];x!==J&&($[w]=x,this.firePropertyChange("highlight"+u,J,x))}})},eq(ai,x,{onMouseOver:function(V){C.preventDefault(V);var r=this.gv;if(!r._48Q){var x=r.getDataAt(V);x!==this.mouseOverData&&(this.mouseOverData=x,r.iv())}},setFetchTargetFunc:function(x){this.fetchTargetFunc=x},_42:function(K,R){var A,I,T=this,w=T._mode,$=T.gv;if(!K._renderInfo.reflectDepth&&w!==ai.Mode.Disable){if(w===ai.Mode.Selection?A=$.sm().getSelection().toArray(function(y){return y.s("highlight.visible")}):w===ai.Mode.MouseOver&&T.mouseOverData&&T.mouseOverData.s("highlight.visible")&&(A=[T.mouseOverData]),T.fetchTargetFunc&&(A=T.fetchTargetFunc(A)),w===ai.Mode.Style)A=A||[],I=function(e){if(A.indexOf(e)>=0)return!1;var _=$.getDataHighlightMode(e);return _===!1?!0:_===!0?!1:"selected"===_?$.isSelected(e)?!1:!0:"hover"===_?e===T.mouseOverData?!1:!0:!0};else{if(!A||!A.length)return;I=function(v){return A.indexOf(v)<0?!0:void 0}}var j=$.isVRPresenting(),s=$.getWidth();if(j){var E=$.getWidth;s/=2,$.getWidth=function(){return s};var G=$.getViewport()}var X,B=$.getDevicePixelRatio(),_=Math.floor(s*B),o=Math.floor($.getHeight()*B);(X=T._renderTarget)?X.setSize(K,_,o):T._renderTarget=X=new cl.RenderTarget($,K,_,o);var l="soft"===T.type;if(X.bind(K),l){var p=K.getParameter(K.COLOR_CLEAR_VALUE);wj(K,[1,1,1,1]),K.clear(K.COLOR_BUFFER_BIT),wj(K,p)}else K.clear(K.COLOR_BUFFER_BIT);$.setViewport(K,0,0,_,o),$.drawFilter=I,Fp=function(c,R,M,g,d,j){var W=[M?0:1,1,1,1];return j||(Of.for(c).directUniforms().uFixPickReverseColor=W),W},$.renderPickScene(),Fp=kk,$.drawFilter=null,X.unbind(K),nm&&dd(K,R.aPosition),dd(K,R.aNormal),j&&($.getWidth=E,$.setViewport(K,G[0],G[1],G[2],G[3]));var M=$.getHighlightColor();if(T._lastHighlightColor!==M){var e=uq(T._lastHighlightColor=M);T._highlightColorData=[e[0]/255,e[1]/255,e[2]/255,e[3]/255]}return l?T.renderSoftOutline(K,_,o):T.renderHardOutline(K,_,o),K.useProgram(R=$._prg),nm&&pq(K,R.aPosition),!0}},_assureShader:function(t,n){var P=t._compiledShader[n];return P||(P=t._compiledShader[n]=new Yg.Shader(t,ai.CommonShaderVs,ai[n].fs)),P},renderHardOutline:function(t,h,s){var e=this,U=e.gv,b=U._postProcessing,n=Of.for(t),j=n.directState();j.blend.enabled=!0,j.depth.enabled=!1,b.blitScreen(null,e._renderTarget.texture,e._assureShader(t,"HighlightHard"),{textureSize:[h,s],edgeWidth:U.getHighlightWidth(),edgeColor:e._highlightColorData},{clear:!1}),j.blend.enabled=!1,j.depth.enabled=!0},renderSoftOutline:function(z,u,w){var Y,p,e,g,f,c=this,D=c.gv,Z=D._postProcessing,r=Math.floor(u/2),M=Math.floor(w/2),h=Math.floor(u/4),K=Math.floor(w/4),G=c._downSampleRenderTarget;G?(Y=c._edgeDetectionRenderTarget,p=c._blurV2,e=c._blurH2,g=c._blurV4,f=c._blurH4,(G.width!==r||G.height!==M)&&(G.setSize(r,M),Y.setSize(r,M),p.setSize(r,M),e.setSize(r,M),g.setSize(h,K),f.setSize(h,K))):(G=c._downSampleRenderTarget=new cl.RenderTarget(D,z,r,M),Y=c._edgeDetectionRenderTarget=new cl.RenderTarget(D,z,r,M),p=c._blurV2=new cl.RenderTarget(D,z,r,M),e=c._blurH2=new cl.RenderTarget(D,z,r,M),g=c._blurV4=new cl.RenderTarget(D,z,h,K),f=c._blurH4=new cl.RenderTarget(D,z,h,K));var P=z.getParameter(z.COLOR_CLEAR_VALUE),s=D.getViewport(),W=c.width,T=c.strength,l=c.glow,x=Of.for(z).glState,L=x.depth,V=x.blend,U=L.enabled;wj(z,[1,1,1,1]),L.enabled=!1,V.apply({func:[z.SRC_ALPHA,z.ONE]}),Z.blitScreen(G,c._renderTarget.texture),Z.blitScreen(Y,G.texture,c._assureShader(z,"EdgeDetection"),{texSize:[r,M],color:c._highlightColorData}),Z.blitScreen(e,Y.texture,c._assureShader(z,"Blur"),{direction:[1,0],texSize:[r,M],radius:W}),Z.blitScreen(p,e.texture,c._assureShader(z,"Blur"),{direction:[0,1],texSize:[r,M],radius:W}),Z.blitScreen(f,p.texture,c._assureShader(z,"Blur"),{direction:[1,0],texSize:[h,K],radius:W}),Z.blitScreen(g,f.texture,c._assureShader(z,"Blur"),{direction:[0,1],texSize:[h,K],radius:W}),V.apply({enabled:!0}),D.setViewport(z,s[0],s[1],s[2],s[3]),Z.blitScreen(null,c._renderTarget.texture,c._assureShader(z,"BlendTogether"),{edgeTexture1:p.texture,edgeTexture2:g.texture,edgeStrength:T*W,edgeGlow:l},{clear:!1}),V.apply({func:[z.SRC_ALPHA,z.ONE_MINUS_SRC_ALPHA,z.ONE,z.ONE_MINUS_SRC_ALPHA]}),L.enabled=U,wj(z,P)}}),x.defineProperties(ai.prototype,{mode:{get:function(){return this._mode},set:function(j){var f=this._mode;if(j!==f){this._mode=j;var N=f===ai.Mode.MouseOver||f===ai.Mode.Style,A=j===ai.Mode.MouseOver||j===ai.Mode.Style;A&&N||(N&&R(this.gv.getView(),"mousemove",this.onMouseOver),A&&W(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),ai.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),ai.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},ai.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},ai.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},ai.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var Mf=b.Light=function(){rd(Mf,this),this.s(Sm,X[Sm]),this.s(Sl,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Xq("Light",ud,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(W,X,Z){Mf.superClass.onStyleChanged.apply(this,arguments),W===Sm&&this.s("shape3d.color",Z)}});var Am=cl.FrameState=function(G,v){this.renderState=Of.for(v),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=_,this.projectMatrix=_,this.viewMatrix=_,this.view=G,this.defaultProgram=_,this.pickColorMap=_,this._pvStack=[],this._renderStateStack=[]};Am.prototype.savePV=function(){var k=this.view;this._pvStack.push([Vg(this.projectMatrix),Vg(this.viewMatrix),k._18Q,Vg(k._7O)])},Am.prototype.restorePV=function(){var T=this._pvStack.pop();if(T){var f=this.view;this.projectMatrix=f._projectMatrix=T[0],this.viewMatrix=f._viewMatrix=T[1],f._18Q=T[2],f._7O=T[3]}},Am.prototype.setPV=function(h,R){var k=this.view,Z=!1;if(h&&(this.projectMatrix=k._projectMatrix=h,Z=!0),R&&(this.viewMatrix=k._viewMatrix=R,k._7O=Vg(R),Z=!0),Z){var n=k.getWidth(),E=k.getHeight(),M=Vg(this.projectMatrix);k._18Q=We(M,M,R),k._18Q._wh=n/E}},Am.prototype.syncEnv=function(n){var k=this,Z=k.view;k.envmapReflectivity=Z._envmapReflectivity||.5,k.cameraPosition=Z.getEye(),k.projectMatrix=Z._projectMatrix,k.viewMatrix=Z._viewMatrix,k.pickColorMap=n,k.picking=Z.getGL()._picking},Am.prototype.setGLState=function(){var Q=[0,0,0,0],n=[!0,!0,!0,!0],q=[-1,1],e=[Di.FUNC_ADD,Di.FUNC_ADD],S=[Di.SRC_ALPHA,Di.ONE_MINUS_SRC_ALPHA,Di.ONE,Di.ONE_MINUS_SRC_ALPHA];return function(N,M){var C=this,o=C.renderState.gl,l=C.renderState.glState;l.dither=!1,M?l.color.mask=n:l.color.reset(),l.pixelStore.reset(),l.blend.color=Q,l.blend.equation=e,l.blend.func=S,l.cullFace.enabled=!1,l.scissor.enabled=!1,l.depth.enabled=!0,l.depth.clear=1,l.depth.func=o.LEQUAL,l.depth.range=q,l.stencil.enabled=!1,l.polygonOffset.enabled=!1,N?(l.depth.mask=!1,l.blend.enabled=!0):(l.depth.mask=!0,l.blend.enabled=!1)}}(),Am.prototype.setUniforms=function(t){var c=this,D=c.view,l=c.renderState,F=l.gl,G=l.uniforms;G.uBrightness=1,G.uOpacity=1,G.uPartOpacity=1,G.uPick=c.picking,G.uTexture=!1,G.uBlendTexture=!1,G.uAlphaTest=X.alphaTest,G.uTransparent=!!t,G.uFix=!1,G.uBatchColor=!1,G.uBatchBlend=!1,G.uBatchBrightness=!1,G.uReflectivity=c.envmapReflectivity||.5,G.uCameraPosition=c.cameraPosition,G.uPMatrix=c.projectMatrix,G.uViewMatrix=c.viewMatrix,G.uEnvMap=null,gs(D,G,Jr),G.uClipperMatrix=D._boxClipperMatrixes,G.uClipperClipInner=D._boxClipperClipInner,D._envmapRenderer.resetUniformCache(),c.picking||(Ub(D,F,_),D._fogDisabled||(G.uFogColor=D._fogColor,G.uFogDensity=D._fogDensity,G.uFogNear=D._fogNear,G.uFogFar=D._fogFar))},Am.prototype.drawLayer=function(n){return this.view.renderLayers(n,!0)},Am.prototype.drawData=function(L,$,D){var T=this.view;if(T.isVisible(L)){var v=this.renderState,S=v.uniforms,g=T.getData3dUI(L);if(g){var r=v.gl,e=r._picking,F=T._picking,N=L._pickId;D&&(L._pickId=D),S.uPick=r._picking=T._picking=!!D,S.uTransparent=!!$,g._42(v.gl,v.program,$?a:Y),S.uPick=r._picking=e,T._picking=F,L._pickId=N
}}};var _p=cl.Graph3dView=function(p,y){var x=this;x._webGLVersion=1,x._attributes=y||C.graph3dViewAttributes,x._25I={},x._view=Si(1,x);var F=x._canvas=Yp(x._view);W(F,"webglcontextlost",function(e){e.preventDefault(),_d(x),x._26I&&x._doBufferGC(x._26I,!0),x._26I=Q,x._1o.onContextLost(),x._35O=!0}),W(F,"webglcontextrestored",function(){x._35O=!1,x.iv()}),x._40Q=new Kf,x._43Q={},x._44Q=-1,x._batchIndexMap={},x._batchModelMap={},x._wireframeIndexMap={},x._wireframeModelMap={},x._wireframeIndexMapSwap={},x._wireframeModelMapSwap={},x._polylineIndexMap={},x._polylineIndexMap={},x._polylineIndexMapSwap={},x._polylineIndexMapSwap={},x._8O=[],x._7O=ph(),x._6O=ph(),x._1o=new Hs(x),x._30O=new Ks(x),x._31O=new Is(x),x._32O=new Js(x),x._raycaster=new Vs(x),x._highlightHelper=new ai(x),x._postProcessing=new dt(x),x._41Q=[],x._42Q=0,x._frameRenderOptionStack=[],cl.VR?(x.vr=new cl.VR(x),x.isVREnabled=function(){return this.vr.enable},x.isVRPresenting=function(){return this.vr.isPresenting()}):(x.vr={enable:!1,isPresenting:d},x.isVREnabled=d,x.isVRPresenting=d),x.shadowMap=new Ug(x),x.flowMap=new vj(x),x._33Q=!0,x._eye=be(C.graph3dViewEye),x._center=be(C.graph3dViewCenter),x._up=be(C.graph3dViewUp),x._lightChanged=!1,x._59O=[],x._spots=[],x._dirs=[],x._boxClippers=[],x._flowObjects=[],x._frameId=0,x._picking=!1,x._batchInfoMap={},x.overlappingBox=new Cd(x),x.dm(p?p:new Zi),x._coreInteractor=new Cn(this),x._envmapRenderer=new cl.EnvmapRenderer(this),x.setInteractors([new mp(x)]),x._initView()},to={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Ag=0;Ok("Graph3dView",x,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Mb,yc,"firstPersonMode",Re,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",fr,Nc,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:C.graph3dViewSortable,_editHelperDisabled:C.graph3dViewEditHelperDisabled,_blockSelectable:C.graph3dViewBlockSelectable,_devicePixelRatio:_,_boundaries:_,_moveStep:C.graph3dViewMoveStep,_rotateStep:C.graph3dViewRotateStep,_rotateMinPhi:C.graph3dViewMinPhi===_?C.graph3dViewRotateMinPhi:C.graph3dViewMinPhi,_rotateMaxPhi:C.graph3dViewMaxPhi===_?C.graph3dViewRotateMaxPhi:C.graph3dViewMaxPhi,_pannable:C.graph3dViewPannable,_rotatable:C.graph3dViewRotatable,_walkable:C.graph3dViewWalkable,_resettable:C.graph3dViewResettable,_zoomable:C.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:C.graph3dViewFirstPersonMode,_mouseRoamable:C.graph3dViewMouseRoamable,_gridVisible:C.graph3dViewGridVisible,_gridSize:C.graph3dViewGridSize,_gridGap:C.graph3dViewGridGap,_gridColor:C.graph3dViewGridColor,_originAxisVisible:C.graph3dViewOriginAxisVisible,_centerAxisVisible:C.graph3dViewCenterAxisVisible,_axisXColor:C.graph3dViewAxisXColor,_axisYColor:C.graph3dViewAxisYColor,_axisZColor:C.graph3dViewAxisZColor,_ortho:C.graph3dViewOrtho,_orthoWidth:C.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:C.graph3dViewSyncEyeWithOrthoWidth,_fovy:C.graph3dViewFovy,_near:C.graph3dViewNear,_far:C.graph3dViewFar,_headlightColor:C.graph3dViewHeadlightColor,_headlightIntensity:C.graph3dViewHeadlightIntensity,_headlightRange:C.graph3dViewHeadlightRange,_headlightGroup:C.graph3dViewHeadlightGroup,_headlightAmbientIntensity:C.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:C.graph3dViewHeadlightDisabled,_rectSelectable:C.graph3dViewRectSelectable,_rectSelectBackground:C.graph3dViewRectSelectBackground,_editSizeColor:C.graph3dViewEditSizeColor,_autoMakeVisible:Cj,_fogDisabled:C.graph3dViewFogDisabled,_fogMode:C.graph3dViewFogMode,_fogDensity:C.graph3dViewFogDensity,_fogColor:C.graph3dViewFogColor,_fogNear:C.graph3dViewFogNear,_fogFar:C.graph3dViewFogFar,_pickerResolution:C.graph3dViewPickerResolution,_dashDisabled:C.graph3dViewDashDisabled,_batchColorDisabled:C.graph3dViewBatchColorDisabled,_batchBlendDisabled:C.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:C.graph3dViewBatchBrightnessDisabled,addCamera:function(U){var a=this,H=x.freeze({id:a._42Q++,priority:U.priority||0,ignoreInPick:!!U.ignoreInPick,render:U.render});U.switch3DStatus&&(a._43Q[H.id]=!0),a._41Q.push(H),a._41Q.sort(function(y,H){return y.priority!==H.priority?y.priority-H.priority:y.id-H.id})},setEye:function(f,i,F){1===arguments.length&&(i=f[1],F=f[2],f=f[0]);var D=this._eye;D[0]=f,D[1]=i,D[2]=F,this.fp(fr,Q,D)},setCenter:function(e,A,N){1===arguments.length&&(A=e[1],N=e[2],e=e[0]);var l=this._center;l[0]=e,l[1]=A,l[2]=N,this.fp(Nc,Q,l)},setUp:function(s,M,w){1===arguments.length&&(M=s[1],w=s[2],s=s[0]);var N=this._up;N[0]=s,N[1]=M,N[2]=w,this.fp("up",Q,N)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||rh},isTransparentMask:function(A){return A.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var v=this,B=v._aspect;return B?B:(B=v.getWidth()/v.getHeight(),B||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(x){var P=this,S=P._dataModel,Y=P._selectionModel;S!==x&&(S&&(S.ump(P.handleDataModelPropertyChange,P),S.umm(P.handleDataModelChange,P),S.umd(P.handleDataPropertyChange,P),Y||S.sm().ums(P.handleSelectionChange,P)),P._dataModel=x,x.mp(P.handleDataModelPropertyChange,P),x.mm(P.handleDataModelChange,P),x.md(P.handleDataPropertyChange,P),Y?Y._21I(x):x.sm().ms(P.handleSelectionChange,P),P._postProcessing.handleDataModleChange(S,x),P._tryInvalidateEnvmap(),P.invalidateAll(!0),P.invalidateLight(),P.invalidateboxClipper(),P.invalidateFlowObjects(),P._49Q(),P.fp(Ei,S,x),P._canvas.style.background=x.getBackground()||"")},handleDataModelPropertyChange:function(d){var c=d.property;if("background"===c){var v=this._canvas.style.background,i=d.newValue||"";this._canvas.style.background=i,this.fp("canvasBackground",v,i)}else"envmapType"===c?this._tryInvalidateEnvmap():"envmap"===c&&this.iv()},handleDataPropertyChange:function(l){var F=l.data;this.invalidateData(F);var w=l.property;co(F)&&"s:light.type"===w?this.invalidateLight():"s:3d.clipbox"===w?this.invalidateboxClipper(F,!0):"s:effect.flow"===w?this.invalidateFlowObjects(F,!0):"s:shadow.cast"===w?this.shadowMap.tryUpdateBounding(F):"s:3d.visible"===w&&this.invalidateQuickVisible(F)},invalidateboxClipper:function(f,t){var P=this._boxClippers,A=P.length;if(f){var b=!!f.s("3d.clipbox");if(t=!!t,b===t)P.indexOf(f)<0&&P.push(f);else{var D=P.indexOf(f);D>=0&&P.splice(D,1)}}else P=this._boxClippers=[],this.dm().each(function($){$.s("3d.clipbox")&&P.push($)});var k=P.length;A!==k&&(_d(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix(),gs=k?nf:ss),this.iv()},_updateBoxClipperMatrix:function(){for(var p,e,D=this._boxClippers,V=this._boxClipperMatrixes=[],M=this._boxClipperClipInner=[],f=this._boxClipperGroups=[],J=new El,Z=0,L=D.length;L>Z;Z++)p=D[Z],p.appendAnchorMatrix3d(e=pc(p,this.getMat(p))),V.push(J.getInverse(J.fromArray(e)).toArray()),M.push("inner"===p.s("3d.clipbox")),f.push(p.s("3d.clipbox.group"))},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<C.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(D,J){var v=this._flowObjects,F=v.length;if(D){var x=!!D.s("effect.flow");if(J=!!J,x===J)v.indexOf(D)<0&&v.push(D);else{var B=v.indexOf(D);B>=0&&v.splice(B,1)}}else v=this._flowObjects=[],this.dm().each(function(i){i.s("effect.flow")&&v.push(i)});F!==v.length&&_d(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(h){var U=this,p=h.property;U.iv(),U._18Q=Q,"eye"===p?U._33Q=!0:"devicePixelRatio"===p?U._42(U.getDevicePixelRatio()):to[p]&&_d(U)},_5O:function(w){var G=w._22Q();return G?new G(this,w):Q},getData3dUI:function(P){var w=this._25I[P._id];return w===_&&(w=this._5O(P),this._25I[P._id]=w),w},invalidateAll:function(k){var i=this;if(k){for(var h in i._25I){var j=i._25I[h];j&&j.dispose()}i._25I={},i.iv(),ar(i)}else ar(i),i.dm().each(function(H){i.invalidateData(H)})},invalidateSelection:function(){var O=this;O.sm().each(function(R){O.invalidateData(R)})},invalidateData:function(I){var r=this,$=r.getData3dUI(I);$&&($.iv(),r.iv()),ar(r,I)},getShape3dText:function(V){return V.getStyle("shape3d.text")||this.getLabel(V)},invalidateBatch:function(_){var O=this,W=O._40Q;W.each(function(H){O._invalidateBatch(_,H.batchModelMap,H.batchIndexMap),O._invalidateBatch("T"+_,H.wireframeModelMap,H.wireframeIndexMap),O._invalidateBatch("O"+_,H.wireframeModelMap,H.wireframeIndexMap),H.markBatchInvalid()}),O.iv()},_invalidateBatch:function(D,i,J){var R=this,U=i[D];U&&(U.ds.forEach(function(M){var j=R.getData3dUI(M);j&&j.iv(),delete J[M._id]}),delete i[D])},handleDataModelChange:function(J){var g=this,$=J.kind,x=J.data;if("add"===$)g.invalidateData(x),hn(x)&&x.getEdgeGroup()&&x.getEdgeGroup().eachSiblingEdge(g.invalidateData,g),co(x)&&g.invalidateLight(),x.s("3d.clipbox")&&g.invalidateboxClipper(x,!0),x.s("effect.flow")&&g.invalidateFlowObjects(x,!0),g._49Q();else if($===vi){var C=x._id,K=g._25I[C];K&&(K.dispose(),delete g._25I[C],g.iv()),x===g._currentSubGraph&&g.setCurrentSubGraph(Q),ar(g,x),co(x)&&g.invalidateLight(),x.s("3d.clipbox")&&g.invalidateboxClipper(x,!1),x.s("effect.flow")&&g.invalidateFlowObjects(x,!1)}else $===gg&&(g.invalidateAll(!0),g.setCurrentSubGraph(Q),ar(g),g.invalidateLight(),g.invalidateboxClipper(),g.invalidateFlowObjects())},toCanvas:function(r,Z,b){var G=this,L=G.getGL();if(G.validate(),r){var Y=L.getParameter(L.COLOR_CLEAR_VALUE);wj(L,r)}G._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var s=G.getWidth()||1,p=G.getHeight()||1,B=new Uint8Array(4*s*p),l=Yp(),f=l.getContext("2d");L.readPixels(0,0,s,p,L.RGBA,L.UNSIGNED_BYTE,B),$f(l,s,p,1);for(var w=f.getImageData(0,0,s,p),R=w.data,W=0;W<R.length;W+=4){var d=W/4,N=E(d/s),e=d-N*s;d=4*((p-1-N)*s+e),R[d]=B[W],R[d+1]=B[W+1],R[d+2]=B[W+2],R[d+3]=B[W+3]}if(f.putImageData(w,0,0),r&&wj(L,Y),G._42(G.getDevicePixelRatio()),Z&&b){var X=Yp(),I=X.getContext("2d");return $f(X,Z,b,1),C.drawImage(I,l,0,0,Z,b),X}return l},toDataURL:function(z,J){var f=this,g=f.getGL();if(f.validate(),z){var V=g.getParameter(g.COLOR_CLEAR_VALUE);wj(g,z)}f._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var k=f._canvas.toDataURL(J||"image/png",1);return z&&wj(g,V),f._42(f.getDevicePixelRatio()),k},isWebGL2:function(){return 2===this._webGLVersion},getGL:function(){var i=this._26I;if(i)return this.acquireProgram(),i;if(!this._35O){var w=this,O=w._canvas,q=w._attributes;if(!q||q.requestWebGL2!==!1)try{i=O.getContext("webgl2",q)||O.getContext("experimental-webgl2",q),i&&(w._webGLVersion=2,w._26I=i)}catch(Z){}if(!i)try{i=O.getContext("webgl",q)||O.getContext("experimental-webgl",q)}catch(Z){throw new Error("WebGL not supported")}if(!i)throw new Error("WebGL not supported");w._26I=i;var a=w._frameState=new Am(this,i);w._glExtensions=new m(i),w._glCapabilities=new I(i,w._glExtensions),w._2O={},i._emptyCubeTexture=Ld(i),i._compiledShader={},i._emptyTexture=li(i),i._emptyBlendTexture=li(i),i._bufPool={},i._id=++Ag,a.setGLState(),w._buffer={vs:gk(i),ns:gk(i),is:gk(i),uv:gk(i),batchColor:gk(i),batchBlend:gk(i),batchBrightness:gk(i),lineDistance:gk(i)},w._1O=Gp(i);var C=w._cube={vs:gk(i),ns:gk(i),is:gk(i),uv:gk(i)};return wg(i,C.vs,tq),wg(i,C.ns,Uo),wg(i,C.uv,Gm),Ll(i,C.is,hi),w.acquireProgram(),i._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},i}},getGLCapabilities:function(){var c=this.getGL();return c?this._glCapabilities:void 0},getGLExtensions:function(){var x=this.getGL();return x?this._glExtensions:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<C.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var B,r=this.dm();return r&&(B=r.getEnvmapType()),B||"legacy"},invalidateEnvmap:function(_){return this._envmapRenderer.invalidateEnvmap(_)},_setEnvmapByProbeId:function(N,R){return this._envmapRenderer.setEnvmapByProbeId(N,R)},_tryInvalidateEnvmap:function(){var V=this.getEnvmapType();V!==this._lastProgramEnvmapType&&(_d(this),this.iv())},acquireProgram:function(){var O=this,l=O._26I;if(l&&!O._prg){var w=O._prg=l.createProgram();if(!w)return Q;var K=O._dirs.length,h=O._spots.length,W=O._59O.length,u=O._boxClippers.length,R=O._flowObjects.length,e=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];K&&e.push("uDirColor","uDirDirection"),h&&e.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),W&&e.push("uPointColor","uPointRange","uPointPosition"),On||(lq=mk(lq.substring(0,lq.indexOf("^#"))),Vn=mk(Vn),On=!0);var T=O.getEnvmapType(),$=["#define MAX_DIR "+K,"#define MAX_SPOT "+h,"#define MAX_POINT "+W,"#define MAX_BOX_CLIPPER "+u,"#define MAX_FLOW_OBJECT "+R,O._fogDisabled?"":"#define FOG","exp2"===O.getFogMode()?"#define FOG_EXP2":"",O._dashDisabled?"":"#define DASH","#define USE_ENVMAP","legacy"!==T?"#define ENVMAP_TYPE_CUBE_UV":"",O.isOrtho()?"#define ORTHOGRAPHIC":"",O._batchColorDisabled?"":"#define BATCHCOLOR",O._batchBlendDisabled?"":"#define BATCHBLEND",O._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",O.shadowMap.enable?O.shadowMap.genShaderDefine():"",""].join("\n"),V=od(l,w,l.VERTEX_SHADER,lq.replace("PREFIX",$));l.getShaderParameter(V,l.COMPILE_STATUS)||Sh("COMPILE",l.VERTEX_SHADER,l.getError(),l.getShaderInfoLog(V));var F=od(l,w,l.FRAGMENT_SHADER,Vn.replace("PREFIX",$));if(l.getShaderParameter(F,l.COMPILE_STATUS)||Sh("COMPILE",l.FRAGMENT_SHADER,l.getError(),l.getShaderInfoLog(F)),nm?e.push("aPosition"):(w.aPosition=0,l.bindAttribLocation(w,0,"aPosition")),l.linkProgram(w),!l.getProgramParameter(w,l.LINK_STATUS)){var L=l.getProgramInfoLog(w);return O._prg=Q,L.indexOf("maximum temp register")>=0&&!O._glTempRegisterLimited?(O._glTempRegisterLimited=!0,l.deleteProgram(w),O.acquireProgram()):(Sh("LINK",l.getProgramParameter(w,l.VALIDATE_STATUS),l.getError(),L),l.deleteProgram(w),Q)}e.forEach(function(z){w[z]=/^u/.test(z)?l.getUniformLocation(w,z):l.getAttribLocation(w,z)});var o=O._frameState;o.renderState.program=o.defaultProgram=w,O._envmapRenderer.changeEnvmapType(O._lastProgramEnvmapType=T),l.deleteShader(V),l.deleteShader(F)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(u){var F=u.s("brightness"),B=this.isSelected(u)?u.s("select.brightness"):Q;return F==Q?B:B==Q?F:F*B},getDataHighlightMode:function(t){return t.s("highlight.mode")},getWireframe:function(x){var b=x.s("wf.visible"),h=x.s("wf.width");return b===!0||h>0&&"selected"===b&&this.isSelected(x)?{color:x.s("wf.color"),width:h,"short":x.s("wf.short"),mat:x.s("wf.mat")}:void 0},_transformPointToViewSpace:function(r){var l=[r[0],r[1],r[2]];return ao(l,this._viewMatrix),l},_transformDirectionToViewSpace:function(S,H){var R=[S[0],S[1],S[2]];ao(R,this._viewMatrix);var q=H?[H[0],H[1],H[2]]:[0,0,0];ao(q,this._viewMatrix);var M=q[0]-R[0],w=q[1]-R[1],F=q[2]-R[2],E=Math.sqrt(M*M+w*w+F*F);return E?[M/E,w/E,F/E]:[M,w,F]},getWireframeGeometry:function(O){return O.s("wf.geometry")?{color:O.s("wf.color"),width:O.s("wf.width"),mat:O.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(k){return k.s("body.color")},getMat:function(l){return l.getMat?l.getMat():l.s("mat")},getFaceMat:function(G,C){return G.getFaceMat?G.getFaceMat(C):G.s(C+".mat")},getFaceBlend:function(k,x){return k.s(x+".blend")||k.s("all.blend")},getFaceColor:function(Y,n){return Y.s(n+".color")||Y.s("all.color")},getFaceImage:function(q,A){return q.s(A+".image")||q.s("all.image")},getFaceBlendImage:function(a,S){return a.s(S+".blend.image")||a.s("all.blend.image")},getFaceDiscardSelectable:function(q,V){var n=q.s(V+".discard.selectable");return n==Q?q.s("all.discard.selectable"):n},getFaceUv:function(S,s){return S.s(s+".uv")||S.s("all.uv")},getFaceUvOffset:function(H,Q){return H.s(Q+".uv.offset")||H.s("all.uv.offset")},getFaceUvScale:function(Z,N){return Z.s(N+".uv.scale")||Z.s("all.uv.scale")},getFaceUvRotation:function(q,W){return q.s(W+".uv.rotation")||q.s("all.uv.rotation")},getFaceLight:function(f,K){var C=f.s(K+".light");return C==Q?f.s("all.light"):C},getFaceVisible:function(n,b){var J=n.s(b+".visible");return J==Q?n.s("all.visible"):J},getFaceOpacity:function(O,D){var b=O.s(D+".opacity");return b==Q?O.s("all.opacity"):b},getFaceTransparent:function(w,D){var m=w.s(D+".transparent");return m==Q?w.s("all.transparent"):m},getFaceReverseColor:function(P,M){return P.s(M+".reverse.color")||P.s("all.reverse.color")},getFaceReverseFlip:function(w,S){var H=w.s(S+".reverse.flip");return H==Q?w.s("all.reverse.flip"):H},getFaceReverseCull:function(U,J){var g=U.s(J+".reverse.cull");return g==Q?U.s("all.reverse.cull"):g},getTextureMap:function(){return this._2O},_2Oi:function(j,f,B){B=B||"";var r;(r=this._2O[j])||(r=this._2O[j]={}),r[B]=f},deleteTexture:function(w){var l=this,F=l._2O[w];if(F){delete l._2O[w];var V=l.getGL();for(var Z in F)V.deleteTexture(F[Z])}},renderPickScene:function(){var M=this.getGL();this.syncRenderState(),this._picking=M._picking=!0,this.renderScene(),this._picking=M._picking=!1},invalidateCachedTexture:function(K){var Q=this.getData3dUI(K);Q.invalidateCachedTexture(this.getGL()),this.invalidateData(K)},invalidateShape3dCachedImage:function(h){this.invalidateCachedTexture(h)},invalidateCachedGeometry:function($){var J=this.getData3dUI($);J.invalidateCachedGeometry(),this.invalidateData($)},isInteractive:function(I){return I.s("interactive")},getTexture:function($,Y,V,A){if(!$)return Q;var m,R,E=this,q=E.getGL(),g=E._2O[$];if(g&&(Y&&(R=Y.s("texture.mipmap.max")),m=g[R||""]||g.default),!m){var Z=Bj($);if(A||(A={}),!Z)return q._emptyTexture;if(Y){A.mipmapMaxLevel=R=Y.s("texture.mipmap.max");var z=Y.s("texture.wrap");A.clampToEdge="clampToEdge"===z?!0:"repeat"===z?!1:_}if(Z.uuid||(Z.uuid=b.Math.generateUUID()),Z.tagName){if(Z.dynamic)return Gp(q,Z,E._1O,A);m=Gp(q,Z,_,A),E._2Oi($,m,R)}else{var i,w=Y&&(Y.s("texture.cache")||Y.s("shape3d.image.cache")||Z.textureCache),U=E.isVRPresenting();if(U&&(Y._textureUpdateFrame===q._renderInfo.frame?w=!0:Y._textureUpdateFrame=q._renderInfo.frame),w&&(i=E.getData3dUI(Y),m=i.getCachedTexture(V),m&&i.interactiveInfo&&m.interactiveInfo&&(i.interactiveInfo[m.interactiveInfo.key]=m.interactiveInfo.info)),!m){var v=q._renderInfo.textureCache;if(w){if(v.time>C.graph3dMaxVectorCacheTime)return E.redraw(),q._emptyTexture;if(!cm(Z,Y))return q._emptyTexture}var J;Y&&(1!==Y.s("texture.scale")?J=Y.s("texture.scale"):1!==Y.s("shape3d.texture.scale")&&(J=Y.s("shape3d.texture.scale"))),J||(J=1);var X=Y&&(Y.s("fixSizeOnScreen")||Y.s("shape3d.fixSizeOnScreen")),t=X?q.NEAREST:q.LINEAR;X?"number"==typeof X&&(J*=0>X?1:X):Y&&(Y.s("vector.dynamic")||Y.s("shape3d.vector.dynamic"))&&(i||(i=E.getData3dUI(Y)),X=i.getVectorDynamicSize());var o,y,S,H=Y&&Y.s("shape3d");"billboard"===H?S=Y.getTall()/Y.getWidth():"plane"===H&&(S=Y.getHeight()/Y.getWidth());var x=ld(Z,Y);if(X){var I;I=w?E._devicePixelRatio||rh:E.getDevicePixelRatio(),o=X[0]>0?X[0]*I:J*x*I,y=X[1]>0?X[1]*I:J*(S?Sr(Z,Y,E,Math.min(4096,x*S)):Sr(Z,Y))*I}else o=J*x,y=J*(S?Sr(Z,Y,E,Math.min(4096,x*S)):Sr(Z,Y));if(o>=1&&y>=1){var B=0;(w||U)&&(B=Date.now());var e=E._glCapabilities.maxTextureSize;o=Math.min(o,e),y=Math.min(y,e);var K=gl(o,y);if(!i&&Y&&(i=E.getData3dUI(Y)),i&&i.interactiveInfo){var n=$;"object"==typeof n&&(n=n.uuid||(n.uuid=b.Math.generateUUID()));var c=i.interactiveInfo[n]={};K.interactiveInfo=c.bodyInfo={compInfos:[],matrix:new je,rect:{x:0,y:0,width:o,height:y}}}Bs(K,Z,0,0,o,y,Y,E),K.interactiveInfo&&(K.interactiveInfo=null),K.restore(),v.count++,v.pixels+=o*y,Y?(A.minFilter=cs(Y.s("texture.filter.min")||Y.s("texture.filter"))||t,A.magFilter=cs(Y.s("texture.filter.mag")||Y.s("texture.filter"))||t):A.minFilter=A.magFilter=t,w||U?(m=Gp(q,Qk,null,A),i.setCachedTexture(m,V),v.time+=Date.now()-B,c&&(m.interactiveInfo={key:n,info:c}),Qk=null):m=Gp(q,Qk,E._1O,A)}}}}return m},redraw:function(){this.iv()},validateImpl:function(){var c=this;if(c._lightChanged){c._lightChanged=!1;var X=[],p=[],$=[];c.dm().each(function(A){if(co(A)){var U=A.s("light.type");U===Wd?X.push(A):U===cj?p.push(A):U===pb&&$.push(A)}}),(X.length!==c._59O.length||p.length!==c._spots.length||$.length!==c._dirs.length)&&_d(c),c._59O=X,c._spots=p,c._dirs=$}var G=c.getAspect();G!==c.__cachedAspect__&&(c._updateSkybox({property:"asceptChanged"}),c.__cachedAspect__=G),c._42(),c._1o.iv()},getRenderInfo:function(){var U=this.getGL();return U?U._renderInfo:void 0},getDebugTip:function(){var i=this,m=i.getRenderInfo();if(m){var R=i.getGL()._validBufCount||0,J="Draw Calls: "+m.calls+"<br/>"+"Vertices: "+m.vertices+"<br/>"+"Faces: "+m.faces+"<br/>"+"Lines: "+m.lines+"<br/>"+(m.points?"Points: "+m.points+"<br/>":"")+"Buffers: "+R+"<br/>"+"Cache Models: "+x.keys(ak).length+"<br/>"+"Shape3d Models: "+x.keys(Ko).length;if(i.isVRPresenting()&&(J+="<br/>VR fps: "+i.vr.getFps()),m.textureCache){var D=m.textureCache.count;if(J+="<br/>2D Dynamic Textures: "+m.textureCache.count,D>0){var c,X=m.textureCache.pixels;c=X>1e6?Math.round(X/1e6)+"M":X>1e3?Math.round(X/1e3)+"K":Math.round(X),J+="<br/>2D Dynamic pixels: "+c}}return J}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var W=new b.Math.Box3,_=new b.Math.Matrix4;return function(l){var $=l;if($ instanceof b.Data&&($=this.getData3dUI($)),!$.mat)return!0;var H=$.getBoundingBox();W.copy(H).applyMatrix4(_.fromArray($.mat));var z=this.getFrustum();return z.intersectsBox(W)}}(),updateScene:function(){var p=this;p._81O=Q,p.overlappingBox.clear();var V=p._40Q;V.init();var x=p.getGL(),e=p.dm();if(e.isHierarchicalRendering())e.eachByHierarchical(function(X){var t=p.getData3dUI(X);t&&t.update(p,x,V)});else{var n,i,f,t=e.getDatas().getArray(),h=t.length;for(n=0;h>n;n++)i=t[n],f=p.getData3dUI(i),f&&f.update(p,x,V)}this._updateBoxClipperMatrix(),V.onUpdated()},_pushFrameRenderOptions:function(l){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=l},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(J){var I=this._currentFrameRenderOptions;return I&&I[J]},getRenderLists:function(){return this._40Q},renderScene:function(d){function U(t,F){m.setGLState(t,F),m.setUniforms(t),m.renderState.attribs.disable(),p=i.directUniforms(),O=i.directAttribs(),O.disable()}function t(r){for(;X>A;A++){var k=n[A];if(!c||!k.ignoreInPick){if(k.priority>=r)break;(!M._43Q[M._44Q=k.id]||Wf[xj.length])&&(k.render(F,M,m),U())}}}var M=this;M._pushFrameRenderOptions(d),M._getFrameRenderOptions("createShadowMap")!==!1&&M.shadowMap.render(),M.flowMap.render();var F=M.getGL();M._envmapRenderer.onBeforeRender(F),M._44Q=-1;var p,O,m=M._frameState,i=m.renderState,N=i.glState,e=M._prg;M._projectMatrix=qg(M),xq(M,M._7O),M._viewMatrix=Vg(M._7O),M.isReflecting(F)||We(M._projScreenMatrix=ph(),M._projectMatrix,M._viewMatrix),m.syncEnv(this._picking?this.pickColorMap:_),i.useProgram(e),U(!1,!0),F.clear(F.DEPTH_BUFFER_BIT);var c=M._picking,n=this._41Q,A=0,X=n.length;if(t(C.cameraPriority.skybox),c){var v=N.color.clear.slice(0);wj(F,[0,0,0,0])}else wj(F,[0,0,0,0]),N.blend.enabled=!1,N.depth.enabled=!1,N.depth.mask=!1,M._camera&&M._camera.s("camera.renderSky")===!1||M.drawSky(F,e),M._getFrameRenderOptions("renderReflector")!==!1&&M.drawReflectors(F)&&(M._projectMatrix=qg(M),xq(M,M._7O),M._viewMatrix=Vg(M._7O),m.syncEnv(),U()),N.blend.enabled=!1,N.depth.enabled=!0,N.depth.mask=!0,p.uTransparent=!1,M._getFrameRenderOptions("renderGrid")!==!1&&M._31O._42(F,e);if(!F.textureBatch||Wf[(ONE_FRAME_TIME-6)/2]){c||(M.shadowMap.enable&&M.shadowMap.createShadow(p),M.flowMap.createFlow(p));for(var W=0,H=Tc.length;H>W;W++){var G=Tc[W],Y=xd[G];if(!(!M._camera&&Y.ignore||M._camera&&!M._camera.isLayerVisible(G))){var I=Y.priority;t(I),this.renderLayer(G)}}t(C.cameraPriority.infinity),c||M.flowMap.disableFlow(p),Xd(M,p,0,C.graph3dViewHeadlightAmbientIntensity),p.uHeadlightColor=[1,1,1,0],p.uUseEnvMap=!1,N.depth.enabled=!1,p.uTransparent=!1,p.shadowReceive=!1,gs(M,p,Jr),c?M.drawFilter||M._30O._42(F,e):(M._highlightHelper._42(F,e),this._renderAxisAndEditHelper(M._getFrameRenderOptions("renderAxis")!==!1,M._getFrameRenderOptions("renderEdit")!==!1),N.blend.enabled=!1,N.depth.mask=!0),N.depth.enabled=!0,c&&wj(F,v),wg(F,Q),Ll(F,Q),M._44Q=-1,M._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(v,P){if(v||P){var B=this,D=B.getGL(),E=B._prg,Y=B._frameState,G=Y.renderState,j=G.glState,_=G.directUniforms();Y.renderState.attribs.disable(),j.depth.enabled=!1,_.uTransparent=!1,_.shadowReceive=!1,j.blend.enabled=!1,j.depth.mask=!0,_.uPick=B._picking,v&&B._32O._42(D,E),P&&B._30O._42(D,E),wg(D,Q),Ll(D,Q)}},renderLayers:function(O,r){r&&(O=zl(O));for(var V=0,N=O.length;N>V;V++)this.renderLayer(O[V])},renderSky:function(){var h=this,c=h._frameState,O=c.renderState,q=O.glState,a=h.getGL(),F=h._prg;h._projectMatrix=qg(h),xq(h,h._7O),h._viewMatrix=Vg(h._7O),We(h._projScreenMatrix=ph(),h._projectMatrix,h._viewMatrix),c.syncEnv(),O.useProgram(F),c.setGLState(!1,!0),c.setUniforms(!1),c.renderState.attribs.disable(),a.clear(a.DEPTH_BUFFER_BIT),wj(a,[0,0,0,0]),q.blend.enabled=!1,q.depth.enabled=!1,q.depth.mask=!1,h.drawSky(a,F),q.depth.mask=!0,q.depth.enabled=!0,wg(a,Q),Ll(a,Q)},addRenderLayerListener:function(H,a,D){var N=this;N._renderLayerNotifier||(N._renderLayerNotifier=new $p),N._renderLayerNotifier.add(H,a,D)},removeRenderLayerListener:function(f,N){this._renderLayerNotifier&&this._renderLayerNotifier.remove(f,N)},fireRenderLayerEvent:function(g,v){var L=this._renderLayerNotifier;L&&L.fire({layer:g,phase:v})},renderLayer:function(d){var c=this,w=c._picking,S=c._40Q.get(d);if(S){c.fireRenderLayerEvent(d,"prepare");var f=c.getGL(),O=xd[d],u=c._frameState,h=u.renderState,i=h.glState,U=h.directUniforms();!w&&c.isSortable()&&S.sort(c._sortFunc,c._projScreenMatrix);var $,A,z,P=S.opaque,k=S.transparent,R=S.batchModelMap,s=S.polylineModelMap,I=S.wireframeModelMap,f=c.getGL(),L=c._prg;w||(i.blend.enabled=!1,i.depth.enabled=!0,i.depth.mask=!0),U.uTransparent=!1,O.clearDepth!==!1&&f.clear(f.DEPTH_BUFFER_BIT);var K=this.drawFilter;if(K)for(z=P,$=0,A=z.length;A>$;$++)K(z[$].data)!==!0&&z[$].ui._42(f,L,Y);else{for(z=P,$=0,A=z.length;A>$;$++)z[$].ui._42(f,L,Y);if(w)for(z=k,$=0,A=z.length;A>$;$++)z[$].ui._46Q(f);Er(c,R),Fn(c,s),Fn(c,I)}if(w||(i.blend.enabled=!0,i.depth.mask=!1),c._45Q=U.uTransparent=!0,K)for(z=k,$=0,A=z.length;A>$;$++)K(z[$].data)!==!0&&z[$].ui._42(f,L,a);else{for(z=k,$=0,A=z.length;A>$;$++)z[$].ui._42(f,L,a);Er(c,R,null,!0),Fn(c,s,null,!0),Fn(c,I,null,!0)}c._45Q=null,c.fireRenderLayerEvent(d,"post")}},_42:function(v,O){var Q=this;if(!Q._35O&&(!Tq||Wf(Tq))){var $=Q.getWidth(),X=Q.getHeight();if($&&X){var g=Q.getGL();if(g){var a,o=Q._canvas;if(v?a=!0:v=Q.getDevicePixelRatio(),!Q._picking&&(a||$!==o.clientWidth||X!==o.clientHeight)){$f(o,$,X,v);var e=v;$&&Math.abs(g.drawingBufferWidth-$*v)>1&&(e=Math.min(e,g.drawingBufferWidth/$)),X&&Math.abs(g.drawingBufferHeight-X*v)>1&&(e=Math.min(e,g.drawingBufferHeight/X)),e!==v&&(Q.setDevicePixelRatio(v=e),$f(o,$,X,v)),Q._18Q=null}g.clear(g.COLOR_BUFFER_BIT);var R=g._renderInfo;R.calls=0,R.vertices=0,R.faces=0,R.lines=0,R.points=0,R.textureCache={time:0,count:0,pixels:0},R.frame=++Q._frameId,R.cacheTimeCost=0,R.reflectDepth=0,$*=v,X*=v,this.syncRenderState();do{if(Q.isVREnabled()&&Q.vr.render(g,$,X,O))break;if(Q.updateScene(),Q._postProcessing.render(g,$,X,O))break;Q.setViewport(g,0,0,$,X),Q.renderScene(O)}while(!1);Q._33Q=!1,Q.countFrame(),Q._doBufferGC(g)}}}},syncRenderState:function(){var F,d;(F=this._frameState)&&(d=F.renderState)&&d.syncLoss()},drawReflectors:function(Y){Y._renderInfo.reflectDepth++;var g,J,T,d=this,n=d._dataModel.getReflectors(),e=!1;for(g in n)J=n[g],d.isVisible(J)&&(T=d.getData3dUI(J),T&&T.drawReflector(Y)&&(e=!0));return Y._renderInfo.reflectDepth--,e},isReflecting:function(g){return g._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(w,E){return this._postProcessing.enableModule(w,E)},getPostProcessingModule:function(m){return this._postProcessing.getModule(m)},getPostProcessingValue:function(i,r){var T=this._postProcessing.getModule(i);return T?T[r]:_},setPostProcessingValue:function(w,d,k){var a=this.getPostProcessingValue(w,d),c=this._postProcessing.getModule(w);c&&a!==k&&("enable"===d?this.enablePostProcessing(w,k):c[d]=k,this.firePropertyChange("postProcessing."+w+"."+d,a,k))},setViewport:function(s,S,r,U,N){this._viewport=[S,r,U,N],Of.for(s).directState().viewport=this._viewport},getRenderState:function(){return Of.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(i){this._bufferGCInterval=i},_doBufferGC:function(P,L){var d,u,U=P._bufPool,t=0,O=0,M=P._renderInfo.frame,f=this._bufferGCInterval||10;for(d in U)t++,u=U[d],u&&(L||M-u._fid>f?(P.deleteBuffer(u._buf),u._buf=null,U[d]=null):O++);if(t/2>O&&t>128){var X={};for(d in U)U[d]&&(X[d]=U[d]);P._bufPool=X}P._validBufCount=O},_swapLineMap:function(){var z=this;Jg=z._polylineModelMap,z._polylineModelMap=z._polylineModelMapSwap,z._polylineModelMapSwap=Jg,Jg=z._wireframeModelMap,z._wireframeModelMap=z._wireframeModelMapSwap,z._wireframeModelMapSwap=Jg,Jg=z._polylineIndexMap,z._polylineIndexMap=z._polylineIndexMapSwap,z._polylineIndexMapSwap=Jg,Jg=z._wireframeIndexMap,z._wireframeIndexMap=z._wireframeIndexMapSwap,z._wireframeIndexMapSwap=Jg},_updateSkybox:function(Q){if(this._skybox&&Q){var k=Q.property,U=!1,Y=this._skybox;if("eye"===k||"forceUpdate"===k){var $=this._eye;Y.p3($[0],$[1],$[2]),U=!0}if("near"===k||"far"===k||"forceUpdate"===k||"asceptChanged"===k){var T=Y.__cachedS3__;T||(T=Y.__cachedS3__=Y.getFinalScale3d());var t=Math.sqrt(3),X=1/0,H=-1/0;T.forEach(function(h){h/=2,X=F(h,X),H=f(h,H)}),H*=t;var Z=this._near,W=this._far,C=Math.tan(this.getFovy()/2)*Z,m=this.getAspect()*C,r=1.1*Math.sqrt(m*m+C*C+Z*Z),K=1;if(r>X)K=r/X;else if(H>=W){var A=W*W/(Z+W);K=A/H}if(1!==K){Y.__updatingSkybox__=!0;var q=T.map(function(u){return K*u});Y.s3(q),Y.setScale3d(1,1,1),U=!0,delete Y.__updatingSkybox__
}}U&&this.invalidateData(Y)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(P){return this.setSkybox(P)},getSkybox:function(){return this._skybox},setSkybox:function(V){var p=this._skybox;if(p===V)return V&&this._updateSkybox({property:"forceUpdate"}),void 0;if(p&&(this._skyboxStyleMap&&p.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&p.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&p.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:vi,data:p})),this._skybox=V,this.ump(this._updateSkybox,this),V){V.dm()&&V.dm().remove(V),this._skyboxStyleMap=b.Default.clone(V.getStyleMap()),this._skyboxAnchor3d=V.getAnchor3d(),V.setAnchor3d(.5,.5,.5),this._skyboxP3=V.p3().slice(0),V.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var z=V.onPropertyChanged;V.onPropertyChanged=function(e){z.call(V,e),!V.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(e.property)>=0&&(V.__cachedS3__=_)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",p,V)},drawSky:function($,s){var I=this,a=I._skybox;if(a){var p=Of.for($).directUniforms(),t=I._headlightIntensity,m=bc(I._headlightColor),s=I._prg;1!==t&&(m=[m[0]*t,m[1]*t,m[2]*t]),p.uHeadlightColor=[m[0],m[1],m[2],1];var E=I.getData3dUI(a);if(E){var k=I.isOrtho(),f=k||this._computedProjectMatrix;if(f){var B=I._projectMatrix;k&&(I._ortho=!1),p.uPMatrix=I._projectMatrix=qg(I,!0)}var K=a.p3(),J=this.getEye();(K[0]!==J[0]||K[1]!==J[1]||K[2]!==J[2])&&(a._position.x=J[0],a._54O=J[1],a._position.y=J[2]),E.validate(),E._42($,s,r),f&&(k&&(I._ortho=!0),p.uPMatrix=I._projectMatrix=B)}$.clear($.DEPTH_BUFFER_BIT),p.uHeadlightColor=[m[0],m[1],m[2],I._headlightDisabled?1:0]}},getLogicalPoint:function(m){return ag(m,this._canvas)},isRectOverlapping:function(b){var L=this.getData3dUI(b);return L._rectOverlapping},getHitFaceInfo:function(U){U.target&&(U=this.lp(U));var Z=this.getDataInfoAt(U);if(Z){var d=this.intersectObject(U,Z.data);if(d)return{data:Z.data,face:d.part}}return Q},unproject:function(r,c){var v=this,q=v.getWidth(),h=v.getHeight(),A=r.target?v.lp(r):r,_=A.x-q/2,G=A.y-h/2,x=2*(_/q),p=2*(-1*G/h);c=c||0;var B=ph(),f=qg(v),t=xq(v);We(B,f,t),Sg(B);var y=lo([x,p,c,1],B);return[y[0]/y[3],y[1]/y[3],y[2]/y[3]]},getDataAt:function(c){var z=this.getDataInfoAt(c);return z?z.data:Q},getDataInfoAt:function(J,Z,y){return J.target&&(J=this.lp(J)),this._1o.get(Hq(J.x,J.y,Z),!0,y)},getDatasInRect:function(g,G){return this._1o.get(g,!1,G)},setEditable:function(w){var h=this,Q=h._editable;h._editable=w,this.fp(Wk,Q,w)},isEditable:function(L){var N=this;return L?N._editable?Je(L)?L.s("3d.editable")?N._editableFunc?N._editableFunc(L):!0:!1:!1:!1:N._editable},isSelectable:function(O){return O.s("3d.selectable")&&this.sm().isSelectable(O)},isMovable:function($){var l=this;return hn($)&&$.getStyle(jo)!==Hl?!1:$.s("3d.movable")?l._movableFunc?l._movableFunc($):!0:!1},isSizeEditable:function(o){return Je(o)?this._sizeEditableFunc?this._sizeEditableFunc(o):!0:!1},isRotationEditable:function(C){return Je(C)&&C.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(C):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(A){this.setZoom(af,A)},zoomOut:function(X){this.setZoom(1/af,X)},setZoom:function(){var M=new id,k=new id,v=new id,g=new id;return function(_,K){if(1!==_){var Z=this;Z._14o&&Z._14o.stop(!0);var f,R=1/_;M.copy(Z.getCenter()),k.copy(Z.getEye());var m=Z._ortho;if(m){if(f=Z._orthoWidth,f<Z._moveStep&&_>1)return}else if(M.distanceTo(k)<Z._moveStep&&1>R)return;var Y=!1;return Z._zoomToCenter===!1&&Z._lastZoomLP&&(v.copy(k).sub(M).normalize(),Z._81O=null,g.copy(Z.getHitPosition(Z._lastZoomLP,M.toArray(),v.toArray())),Y=!0,Z._lastZoomHit=g),(K=Fl(K))?(K.action=function(x){Z.fi({kind:Z._zooming?"betweenZoom":"beginZoom"}),Z._zooming=1;var j=(R-1)*x+1;m&&Z.setOrthoWidth(f*j),Y?(Z.setEye(v.lerpVectors(g,k,j).toArray()),Z.setCenter(v.lerpVectors(g,M,j).toArray())):m||Z.setEye(v.lerpVectors(M,k,j).toArray())},K._37o=function(){delete Z._14o,delete Z._zooming,Z.fi({kind:"endZoom"}),Z.onZoomEnded()},Z._14o=Po(K)):(m&&Z.setOrthoWidth(f*R),Y?(Z.setEye(v.lerpVectors(g,k,R).toArray()),Z.setCenter(v.lerpVectors(g,M,R).toArray())):m||Z.setEye(v.lerpVectors(M,k,R).toArray()),void 0)}}}(),setOrthoZoom:function(g,J){return this.setZoom(g,J)},getPositionInfo:function(R){var L=this,e=L._eye,i=L._center,k=L.getAspect(),I=R?kd(Yb(i,e,!0),Yb(R,e)):Ki(e,i);if(L._ortho){var h=L._orthoWidth;return{length:I,height:h/k,width:h}}var p=2*is(L._fovy/2)*I;return{length:I,height:p,width:p*k}},getCenterInfo:function(){var E=this;return E._81O||(E._81O=E.getPositionInfo()),be(E._81O)},rotate:function(J,A,u,c){var i=this;if(J||A){c==Q&&(c=i._firstPersonMode),i._88O&&i._88O.stop(!0);var D=i._center,I=i._eye,E=i.getCenterInfo().length,U=c?D:I,w=c?I:D,q=Yb(U,w),g=mf(q[0],q[2]),x=mf(z(q[0]*q[0]+q[2]*q[2]),q[1]),a=c?Nc:fr;return c&&(A=-A),(u=Fl(u))?(u.action=function(L){i.fi({kind:i._rotating?"betweenRotate":"beginRotate"}),i._rotating=1;var p=g+J*L,s=x+A*L;s=c?e-Fm(i,e-s):Fm(i,s),q[0]=E*h(s)*h(p),q[1]=E*j(s),q[2]=E*h(s)*j(p),U[0]=w[0]+q[0],U[1]=w[1]+q[1],U[2]=w[2]+q[2],i.fp(a,Q,U)},u._37o=function(){delete i._88O,delete i._rotating,i.fi({kind:"endRotate"}),i.onRotateEnded()},i._88O=Po(u)):(g+=J,x+=A,x=c?e-Fm(i,e-x):Fm(i,x),q[0]=E*h(x)*h(g),q[1]=E*j(x),q[2]=E*h(x)*j(g),U[0]=w[0]+q[0],U[1]=w[1]+q[1],U[2]=w[2]+q[2],i.fp(a,Q,U),void 0)}},pan:function(O,E,w,J){if(O||E){var F=this;J==Q&&(J=F._firstPersonMode),F._89O&&F._89O.stop(!0);var y=xq(F),m=[y[0]*O,y[4]*O,y[8]*O],P=[y[1]*E,y[5]*E,y[9]*E],d=m[0]+P[0],q=m[1]+P[1],v=m[2]+P[2],i=F._center,Y=F._eye;if(J){var u=uc(F.getBoundaries(),Y[0],Y[2],Y[0]+d,Y[2]+v,z(d*d+v*v));d=u[0],v=u[1]}if(w=Fl(w)){var C=be(Y),t=be(i);return w.action=function(S){F.fi({kind:F._panning?"betweenPan":"beginPan"}),F._panning=1,i[0]=t[0]+d*S,i[1]=t[1]+q*S,i[2]=t[2]+v*S,Y[0]=C[0]+d*S,Y[1]=C[1]+q*S,Y[2]=C[2]+v*S,F.fp(fr,Q,Y),F.fp(Nc,Q,i)},w._37o=function(){delete F._89O,delete F._panning,F.fi({kind:"endPan"}),F.onPanEnded()},F._89O=Po(w)}i[0]+=d,i[1]+=q,i[2]+=v,Y[0]+=d,Y[1]+=q,Y[2]+=v,F.fp(fr,Q,Y),F.fp(Nc,Q,i)}},walk:function($,S,M){if($){var _=this;M==Q&&(M=_._firstPersonMode),_._90O&&_._90O.stop(!0);var d=_._center,v=_._eye,Z=Yb(d,v,!0);if(M){var V=uc(_.getBoundaries(),v[0],v[2],v[0]+Z[0]*$,v[2]+Z[2]*$,D($));if($=Ki(V),!$)return;Z=[V[0]/$,0,V[1]/$]}if(S=Fl(S)){var g=be(v),i=be(d);return S.action=function(u){_.fi({kind:_._walking?"betweenWalk":"beginWalk"}),_._walking=1;var A=$*u;v[0]=g[0]+Z[0]*A,v[1]=g[1]+Z[1]*A,v[2]=g[2]+Z[2]*A,d[0]=i[0]+Z[0]*A,d[1]=i[1]+Z[1]*A,d[2]=i[2]+Z[2]*A,_.fp(fr,Q,v),_.fp(Nc,Q,d)},S._37o=function(){delete _._90O,delete _._walking,_.fi({kind:"endWalk"}),_.onWalkEnded()},_._90O=Po(S)}v[0]+=Z[0]*$,v[1]+=Z[1]*$,v[2]+=Z[2]*$,d[0]+=Z[0]*$,d[1]+=Z[1]*$,d[2]+=Z[2]*$,_.fp(fr,Q,v),_.fp(Nc,Q,d)}},handleScroll:function(M,z){zq(M);var T=this,u=T._moveStep,g=T.getDataInfoAt(M);if(g){var i=g.data;if(i&&T.isInteractive(i)){var H=T.intersectObject(M,i);if(H){var c=H.part,L=Bj(i.s(c+".image")||i.s("shape3d."+c+".image")||i.s("all.image")||i.s("shape3d.image"));if(L&&yk(L.scrollable,i,T))return}}}return T.isFirstPersonMode()?(T.isPannable()&&T.pan(0,z>0?u:-u),void 0):(T.isZoomable()&&(T._lastZoomLP=T.lp(M),T.setZoom(0>z?1/Xg:Xg),T._lastZoomLP=T._lastZoomHit=null),void 0)},handlePinch:function(i,s){if(this.isZoomable()){if(Math.abs(i-s)<C.pinchZoomThreshold)return;this.setZoom(s>i?1/Mn:Mn)}},reset:function(x){this.setUp(C.graph3dViewUp),this.moveCamera(C.graph3dViewEye,C.graph3dViewCenter,x)},moveSelection:function(X,B,Q){var r=this;r.dm().beginTransaction(),Jp(this.sm().toSelection(this.isMovable,this),X,B,Q),r.dm().endTransaction()},getMoveMode:function(v,_){var $=_.s("3d.move.mode");if($)return $;var B="88",q="89",Z="90";return Xf(v)||Fr[B]&&Fr[q]&&Fr[Z]?"xyz":Fr[B]&&Fr[q]?"xy":Fr[B]&&Fr[Z]?"xz":Fr[q]&&Fr[Z]?"yz":Fr[B]?"x":Fr[q]?"y":Fr[Z]?"z":"xz"},handleTick:function(){var v=this,w=!1,Z=v._moveStep,B=Z,u=!1,y=!0,E=v._rotateStep*(y?-1:1);if(v.isWalkable()||(B=0),v.isPannable()||(Z=0),v.isRotatable()||(E=0),v._32Q){var e=(wq()-v._32Q)/50;B*=e,Z*=e,E*=e}v._31Q&&(Xr(v._31Q),delete v._31Q,delete v._32Q),Xk()&&(w=!0,v.pan(-Z,0,u,y)),tm()&&(w=!0,v.pan(Z,0,u,y)),bm()&&(w=!0,Xf()?v.pan(0,Z,u,y):v.walk(B,u,y)),En()&&(w=!0,Xf()?v.pan(0,-Z,u,y):v.walk(-B,u,y)),re()&&(w=!0,v.rotate(-E,0,u,y)),ze()&&(w=!0,v.rotate(E,0,u,y)),zc()&&(w=!0,v.rotate(0,-E/2,u,y)),uh()&&(w=!0,v.rotate(0,E/2,u,y)),w&&(v._32Q=wq(),v._31Q=Pq(v.handleTick,v))},handleKeyDown:function(Y){var H=this;!Kp(Y)&&Ar[Y.keyCode]?H.handleTick():ue(Y)?H.selectAll():Qi(Y)?H.handleDelete(Y):Uq(Y)&&this.isResettable()&&H.reset()},checkDoubleClickOnNote:function(V,c,x){var q=this;if(x===Hd){if(c.s("note.toggleable"))return c.s(lj,!c.s(lj)),q.fi({kind:"toggleNote",event:V,data:c,part:x}),!0}else if(x===el&&c.s("note2.toggleable"))return c.s(bg,!c.s(bg)),q.fi({kind:"toggleNote2",event:V,data:c,part:x}),!0;return!1},checkDoubleClickOnRotation:function(z,v,M){return M===Os?(v.setRotationX(0),!0):M===Ps?(v.setRotationY(0),!0):M===Qs?(v.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(S){var D=this;if(D.isOrtho())return D.getWidth()/D.getOrthoWidth();var g=D.getCenter(),k=D.getHeight(),L=D.getEye(),q=[g[0]-L[0],g[1]-L[1],g[2]-L[2]],F=[S[0]-L[0],S[1]-L[1],S[2]-L[2]],l=Math.sqrt(q[0]*q[0]+q[1]*q[1]+q[2]*q[2]),o=1/Math.tan(D.getFovy()/2);return k*l*o/(F[0]*q[0]+F[1]*q[1]+F[2]*q[2])},inViewSpace:function(f){var v,Z=this,j=Z._transformPointToViewSpace(f),E=Z.getAspect(),V=Z.getNear(),Y=Z.getFar();return-j[2]<V||-j[2]>Y?!1:Z.isOrtho()?(v=Z.getOrthoWidth()/2,Math.abs(j[0])<=v&&Math.abs(j[1]*E)<=v):(v=Math.sqrt(j[0]*j[0]+j[1]*j[1]+j[2]*j[2])*Math.tan(Z.getFovy()/2),Math.abs(j[1]<=v)&&Math.abs(j[0])<=v*E)},getPVMatrix:function(){var r,D=this;return(r=D._18Q)||(r=qg(D),D._18Q=We(r,r,xq(D)),D._18Q._wh=D.getWidth()/2/D.getHeight()),r},getFrustum:function(){var l=new El,C=new rk,i=new Array(16);return function(){for(var K=this.getPVMatrix(),w=!1,B=0;16>B;B++)K[B]!==i[B]&&(w=!0,i[B]=K[B]);return w&&C.setFromMatrix(l.fromArray(K)),C}}(),toViewPosition:function(d){var P=this,R=P.getWidth()/2,A=P.getHeight()/2,J=P.getPVMatrix();return d=lo([d[0],d[1],d[2],1],J),{x:R+R*d[0]/d[3],y:A-A*d[1]/d[3],z:d[2]/d[3]}},getHitPosition:function(w,R,a){var k=this,L=k.getWidth(),b=k.getHeight(),e=w.target?k.lp(w):w,Q=e.x-L/2,C=e.y-b/2,U=k.getCenterInfo(),o=xq(k);R=R?R:[0,0,0],a=a?a:[0,1,0],Q=Q/L*U.width,C=-1*C/b*U.height;var p=[o[0]*Q,o[4]*Q,o[8]*Q],z=[o[1]*C,o[5]*C,o[9]*C],J=[p[0]+z[0],p[1]+z[1],p[2]+z[2]],n=k.getCenter(),t=$o(k,R,a,[J[0]+n[0],J[1]+n[1],J[2]+n[2]]);return t?t:[0,0,0]},intersectObject:function(W,L){return this._raycaster.intersectObject(W,L)},intersectObjects:function(L,Z,a){return this._raycaster.intersectObjects(L,Z,a)},getLineLength:function(L){this.validate();var o=this.getData3dUI(L);if(o&&o.getCache){var A=o.getCache();if(A)return A[A.length-1].length}return 0},getLineOffset:function(t,F){var A=this.getData3dUI(t);if(A&&A.getCache){var r=A.getCache();if(r){var l=Dp(r,F);if(!t.r3)return l;var Z=t.r3();if(0===Z[0]&&0===Z[1]&&0===Z[2])return l;var i=new id(t.p3()),I=new id(l.point).sub(i),c=new id(l.tangent).add(I),K=(new ql).setFromEuler(new Vp(Z,t.getRotationMode(),!0));return I.applyQuaternion(K),c.applyQuaternion(K),{point:I.add(i),tangent:c.sub(I).normalize()}}}return Q},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(A,P,_){var m=this,L=m.getEye();L=[L[0],L[1],L[2]];var K=m.getCenter();if(K=[K[0],K[1],K[2]],A||(A=L),P||(P=K),m._flyAnim&&m._flyAnim.stop(!0),_=Fl(_),!_)return m.setEye(A[0],A[1],A[2]),m.setCenter(P[0],P[1],P[2]),delete m._flyAnim,!0;var s=[A[0]-L[0],A[1]-L[1],A[2]-L[2]],f=[P[0]-K[0],P[1]-K[1],P[2]-K[2]];return _.action=function(G){m.setCenter(K[0]+f[0]*G,K[1]+f[1]*G,K[2]+f[2]*G),m.setEye(L[0]+s[0]*G,L[1]+s[1]*G,L[2]+s[2]*G)},_._37o=function(){delete m._flyAnim},m._flyAnim=Po(_)},flyTo:function(){function X(R,i,F){if(F instanceof b.Node){Z.fromArray(pc(F,i.getMat(F)));var o=F.getAnchor3d();R.push((new id).set(0-o.x,0-o.y,0-o.z).applyMatrix4(Z)),R.push((new id).set(0-o.x,0-o.y,1-o.z).applyMatrix4(Z)),R.push((new id).set(0-o.x,1-o.y,0-o.z).applyMatrix4(Z)),R.push((new id).set(0-o.x,1-o.y,1-o.z).applyMatrix4(Z)),R.push((new id).set(1-o.x,0-o.y,0-o.z).applyMatrix4(Z)),R.push((new id).set(1-o.x,0-o.y,1-o.z).applyMatrix4(Z)),R.push((new id).set(1-o.x,1-o.y,0-o.z).applyMatrix4(Z)),R.push((new id).set(1-o.x,1-o.y,1-o.z).applyMatrix4(Z))}}var E=new id,D=new id,r=new id,d=new id,s=new id,Z=new El,z=new b.Math.Quaternion,I=new Vp,n=new pk;return function(T,W,P){var A=this;"boolean"==typeof W&&(W={animation:W}),W=W||{};var e=W.center,N=W.distance,p=W.direction,V=W.worldDirection,S=P||W.ratio||.8,g=W.xRatio||S,B=W.yRatio||S;(P!==_||W.duration||W.frames)&&(W={animation:W});var M,o,H=[],x=N===_;if(e&&r.fromArray(e),T||(T=A.dm().getDatas()),1===T.length&&(T=Wh(T)?T.get(0):T[0]),T instanceof b.Node)e||r.fromArray(T.p3()),x&&(X(H,A,T),M=H.length);else{if(!T.length)return;if((x||!e)&&(H=[],T.forEach(function(C){X(H,A,C)}),M=H.length,!M))return;e||(n.setFromPoints(H),r.copy(n.min).add(n.max).multiplyScalar(.5))}if(A._flyAnim&&A._flyAnim.stop(!0),E.fromArray(A.getEye()),D.fromArray(A.getCenter()),A.setCenter(r.x,r.y,r.z),d.subVectors(E,D),p||V){!V&&T instanceof b.Node?z.setFromEuler(I.set(T.r3(),T.getRotationMode(),!0)):z.set(0,0,0,1);var K=d.length();d.fromArray(V||p).applyQuaternion(z).setLength(K)}var U=new id(A.getUp()),R=$m.fequal(U.x,0,1e-5)&&$m.fequal(U.z,0,1e-5);if(R&&0===d.x&&0===d.z){var $=.001,J=d.y;d.y=J*(1-$),d.z=Math.sign(J)*$}var c=0;if(x){var Z,F,f,t=g,a=B;if(s.copy(d),A.isOrtho()){var j=-1/0;for(A._eye[0]=d.x+r.x,A._eye[1]=d.y+r.y,A._eye[2]=d.z+r.z,Z=qg(A),We(Z,Z,xq(A)),o=0;M>o;o++)f=H[o],F=lo([f.x,f.y,f.z,1],Z),j=Math.max(j,Math.max(Math.abs(F[0])/t,Math.abs(F[1])/a));c=A.getOrthoWidth()*j}else{for(var k,w,v=A.getNear(),u=10;u--;){for(A._eye[0]=d.x+r.x,A._eye[1]=d.y+r.y,A._eye[2]=d.z+r.z,Z=qg(A),We(Z,Z,xq(A)),k=!0,w=-1/0,o=0;M>o;o++){if(f=H[o],F=lo([f.x,f.y,f.z,1],Z),F[3]<v&&u){d.multiplyScalar(2),k=!1;break}w=Math.max(w,Math.max(Math.abs(F[0])/t,Math.abs(F[1])/a)-F[3])}if(k)break}d.setLength(w+d.length())}d.manhattanLength()<1e-6&&d.copy(s)}else d.setLength(N);var Y=d.add(r),O=Fl(W.animation);if(O){A.setEye(E.x,E.y,E.z),A.setCenter(D.x,D.y,D.z);var Q=Y.clone().sub(r),m=Q.length();m&&Q.multiplyScalar(1/m);var L=E.clone().sub(D),l=L.length();l&&L.multiplyScalar(1/l);var i=(new El).lookAtDirection(L,U),h=(new El).lookAtDirection(Q,U),y=(new ql).setFromRotationMatrix(i),q=(new ql).setFromRotationMatrix(h),G=(new id).subVectors(r,D);if(c)var bn=A.getOrthoWidth();var fn=new id,Ak=new id,Hp=new id,gc=O.action,Vd=O._37o,hj=D.clone();return O.action=function(s,o){Ak.copy(hj).addScaledVector(G,s);var K=y.clone().slerp(q,s);fn.set(0,0,1).applyQuaternion(K).setLength(l+(m-l)*s).add(Ak),Hp.set(0,1,0).applyQuaternion(K),A.setCenter(Ak.x,Ak.y,Ak.z),A.setEye(fn.x,fn.y,fn.z),A.setUp(Hp.x,Hp.y,Hp.z),c&&A.setOrthoWidth((c-bn)*s+bn),gc&&gc(s,o)},O._37o=function(){delete A._flyAnim;var L=A.getUp(),F=R?C.graph3dViewUp:U.toArray();(L[0]!==F[0]||L[1]!==F[1]||L[2]!==F[2])&&A.setUp(F),Vd&&Vd()},{lastEye:E,lastCenter:D,eye:Y,center:r,orthoWidth:c,animation:A._flyAnim=Po(O)}}return A.setEye(Y.x,Y.y,Y.z),A.setCenter(r.x,r.y,r.z),c&&A.setOrthoWidth(c),delete A._flyAnim,{lastEye:E,lastCenter:D,eye:Y,center:r,orthoWidth:c}}}(),getBoundingBox:function(){function A(g,h,t){R.fromArray(pc(t,h.getMat(t)));var O=t.getAnchor3d();g.push((new id).set(0-O.x,0-O.y,0-O.z).applyMatrix4(R)),g.push((new id).set(0-O.x,0-O.y,1-O.z).applyMatrix4(R)),g.push((new id).set(0-O.x,1-O.y,0-O.z).applyMatrix4(R)),g.push((new id).set(0-O.x,1-O.y,1-O.z).applyMatrix4(R)),g.push((new id).set(1-O.x,0-O.y,0-O.z).applyMatrix4(R)),g.push((new id).set(1-O.x,0-O.y,1-O.z).applyMatrix4(R)),g.push((new id).set(1-O.x,1-O.y,0-O.z).applyMatrix4(R)),g.push((new id).set(1-O.x,1-O.y,1-O.z).applyMatrix4(R))}var R=new El;return function(O){if(O=O||this.sm().getSelection(),O instanceof b.Node&&(O=[O]),0===O.length)return Q;var d=[];O.forEach(function(r){Je(r)&&A(d,this,r)},this);var r=[1/0,1/0,1/0],q=[-1/0,-1/0,-1/0];return d.forEach(function(N){r[0]=Math.min(N.x,r[0]),r[1]=Math.min(N.y,r[1]),r[2]=Math.min(N.z,r[2]),q[0]=Math.max(N.x,q[0]),q[1]=Math.max(N.y,q[1]),q[2]=Math.max(N.z,q[2])}),{min:r,max:q}}}(),setBatchInfo:function(O,A){var z=this._batchInfoMap[O];this._batchInfoMap[O]=A,this.fp("batchInfo",z,A)},getBatchInfo:function(J){return this._batchInfoMap[J]||Tn[J]},setOrthoWidth:function(u){var e=this._orthoWidth;if(this._orthoWidth=u,this._syncEyeWithOrthoWidth){var d=u/this.getAspect(),J=d/2/is(this.getFovy()/2),p=(new id).fromArray(this.getEye()),n=(new id).fromArray(this.getCenter());p.sub(n).setLength(J).add(n),this.setEye(p.toArray())}this.fp("orthoWidth",e,u)},getCamera:function(f){var h=this;f||(f=h._mainCamera,f||(f=h._mainCamera=new b.Camera)),f.s({"camera.type":h.isOrtho()?"ortho":"perspective","camera.aspect":h.getAspect(),"camera.fovy":h.getFovy(),"camera.ortho.width":h.getOrthoWidth(),"camera.near":h.getNear(),"camera.far":h.getFar()});var V=h.getEye();return f.p3(V.slice()),f.lookAt(h.getCenter(),h.getUp()),f}}),function(){function A(c,_,n){var R=c[_];R&&R.releaseTexture(),c[_]=n}function h(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function Z(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function n(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function X(){return{vs:n(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",Z(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function e(){return{vs:n(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",Z(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function I(b){return{vs:n(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+b+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",Z(),"\n #define ENVMAP_TYPE_CUBE_UV \n",h(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var Y=cl.EnvmapRenderer=function(c){this.gv=c,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0};Y.prototype={},Y.prototype.constructor=Y,Y.prototype.changeEnvmapType=function(T){"legacy"===T?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},Y.prototype.invalidateEnvmap=function(G){var h=this.gv;if("legacy"!==h.getEnvmapType()){var C=h.getGL();C&&(G?(delete this._envmapHash[G],delete this._probeCaptureTime[G]):(this._envmapHash={},this._probeCaptureTime={}),h.iv())}},Y.prototype.onBeforeRenderLegacy=function(x){this.assureTextureLegacy(x)},Y.prototype.assureTextureLegacy=function(X){var b=this,w=b.gv,f=w.getEnvmap();if(f!==b._lastLegacyImage){if(b._envmapLegacy&&(X.deleteTexture(b._envmapLegacy),b._envmapLegacy=null),!f)return b._lastLegacyImage=f,void 0;var m=C.getImage(f);if(m&&m.tagName){m=C.resizeImagePOT(m,!0);var d=b._envmapLegacy=X.createTexture();X.activeTexture(X.TEXTURE0),X.bindTexture(X.TEXTURE_CUBE_MAP,d),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MAG_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,X.RGBA,X.RGBA,X.UNSIGNED_BYTE,m),X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,X.RGBA,X.RGBA,X.UNSIGNED_BYTE,m),X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,X.RGBA,X.RGBA,X.UNSIGNED_BYTE,m),X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,X.RGBA,X.RGBA,X.UNSIGNED_BYTE,m),X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,X.RGBA,X.RGBA,X.UNSIGNED_BYTE,m),X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,X.RGBA,X.RGBA,X.UNSIGNED_BYTE,m),X.bindTexture(X.TEXTURE_CUBE_MAP,X._emptyCubeTexture),b._lastLegacyImage=f}}},Y.prototype.setEnvmapLegacy=function(v){v.uEnvMap=this._envmapLegacy},Y.prototype.onBeforeRenderNew=function(K){this.assureTextureNew(K),this.resetUniformCache()},Y.prototype.assureTextureNew=function(c){var T=this,O=T.gv,e=O.getEnvmap(),V=T._envmapHash,Q=T._envmaps,x=c._renderInfo.frame;if(!(this._lastCaptureFrame>=x||O._picking))for(var o in e){var h,S=e[o],P=S.type;switch(P){case"sphere":h=S.image,h!==V[o]&&(kn=C.getImage(h),kn&&(V[o]=h,A(Q,o,T.fromEquirectangular(h))));break;case"cube":var G=S.images;if(G&&6===G.length&&(h=G.join(","),h!==V[o])){for(var $=!0,w=0;6>w;w++)if(!C.getImage(G[w])){$=!1;break}$&&(V[o]=h,A(Q,o,T.fromCubemap(G)))}break;case"skybox":var i=O.getSkybox();if(i){var s=i.s("shape3d");if(h="sphere"===s?i._id+"_"+i.s("shape3d.image"):i._id+"_"+i.s("front.image"),h!==V[o]){var $;if("sphere"===s)$=C.getImage(i.s("shape3d.image"));else{$=!0;for(var M=["front","back","left","right","top","bottom"],w=0;6>w;w++)if(!C.getImage(i.s(M[w]+".image"))){$=!1;break}}$&&(V[o]=h,A(Q,o,T.fromSkybox()))}}break;case"probe":var n=S.pos,W=S.size;if(h=n[0]+"_"+n[1]+"_"+n[2]+"_"+W,h!==V[o]){var J=this._probeCaptureTime[h],E=Date.now();J||(this._probeCaptureTime[h]=J=E),E-J>C.envmapProbeMinWaitTime&&!Ol&&!kb||E-J>C.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[h],V[o]=h,A(Q,o,T.fromSceneProbe(n,W,S.filter))):O.iv()}}}},Y.prototype.resetUniformCache=function(){this._frameUniformCache={}},Y.prototype.setEnvmap=function(z,q){var x=z.uuid,l=this._frameUniformCache,D=this._envmaps[q];D&&(D=D.texture),l[x]!==D&&(l[x]=D,z.uEnvMap=D)},Y.prototype.fromEquirectangular=function(v){var B=b.Default.getImage(v);return this.rectSize=[1/B.width,1/B.height],v=this.gv.getTexture(v),this.fromTexture(v)},Y.prototype.fromCubemap=function(V){var t=this.gv.getGL(),g=t.createTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_CUBE_MAP,g),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var B=[],d=P/3,E=0;6>E;E++)B[E]=C.resizeImage(b.Default.getImage(V[E]),d);return t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,B[0]),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,B[1]),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,B[2]),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,B[3]),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,B[4]),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,B[5]),t.bindTexture(t.TEXTURE_CUBE_MAP,t._emptyCubeTexture),this.fromTexture(g,!0)},Y.prototype.fromTexture=function(O,x){var u=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var m=this.gv,r=m.getGL(),V=Of.for(r).directState(),w=V.depth.enabled;V.scissor.enabled=!0,V.depth.enabled=!1;var L=m.getViewport(r);return this._textureToCubeUV(O,u,x),this._applyPMREM(u),u.unbind(r),m.setViewport(r,L[0],L[1],L[2],L[3]),V.depth.enabled=w,V.scissor.enabled=!1,u},Y.prototype.fromSkybox=function(){return this._fromCamera(function(v){v.s({"camera.onlySky":!0})})},Y.prototype.fromScene=function(C){return this._fromCamera(function(V){V.s({"camera.onlySky":!1}),C&&C(V)})},Y.prototype.fromNode=function(w){var Y=this.gv.getData3dUI(w),D=Y._42;Y._42=ss;var k=this.gv.getSkybox(),h=w.p3();if(k){var b=k.p3();k.p3(h)}var o=this.fromScene(function(A){A.p3(h)});return Y._42=D,k&&k.p3(b),o},Y.prototype.fromSceneProbe=function(r,R,W){var l=this.gv,L=l.getSkybox();if(L){var U=L.p3();L.p3(r)}if(W){var Q=l.isVisible;l.isVisible=function(D){var A=W(D);return A!==_?A:Q.call(l,D)}}var G=this.fromScene(function(q){q.p3(r),q.s("camera.near",R)});return W&&(l.isVisible=Q),L&&L.p3(U),G},Y.prototype._fromCamera=function(r){var _=this.gv,t=_.getCamera();r&&r(t);var b=new sk(_,P,P,{cube:!0}),F=_.getGL(),Z=_.getViewport(F),R=this.setEnvmapByProbeId,z=this.onBeforeRender;this.setEnvmapByProbeId=function(K){K.envMap=F._emptyTexture},this.onBeforeRender=ss,t.attachRenderTarget(b),t.render(_),t.detachRenderTarget(),this.setEnvmapByProbeId=R,this.onBeforeRender=z,_.setViewport(F,Z[0],Z[1],Z[2],Z[3]);var Q=this.fromTexture(b.texture,!0);return b.releaseTexture(),Q},Y.prototype._allocateTargets=function(){return new sk(this.gv,3*q,3*q,{magFilter:Di.NEAREST,minFilter:Di.NEAREST})
},Y.prototype._textureToCubeUV=function(M,_,H){var I,Y=this.gv;H?null==(I=this._cubemapShader)&&(this._cubemapShader=I=this.createShader(X())):null==(I=this._equirectShader)&&(this._equirectShader=I=this.createShader(e()));var G=Y.getGL();_.bind(G),this._setViewport(_,0,0,3*q,2*q);var u=Y.getRenderState();u.useProgram(I);var z=u.directUniforms(),T=u.directAttribs();z.envMap=M,H||(z.texelSize=this.rectSize);var D=o[0];T.position=Bg(G,null,D.vs,Q,3),T.uv=Bg(G,null,D.uv,Q,2),T.faceIndex=Bg(G,null,D.faceIs,Q,1),Lj(G,0,D.vs.length/3)},Y.prototype._applyPMREM=function(I){for(var c,F,G,c=1;d>c;c++)F=Math.sqrt(m[c]*m[c]-m[c-1]*m[c-1]),G=l[(c-1)%l.length],this._blur(I,c-1,c,F,G)},Y.prototype._setViewport=function(s,W,D,$,I){var K=this.gv;K.setViewport(K.getGL(),W,D,$,I),K.getRenderState().directState().scissor.box=[W,D,$,I]},Y.prototype._blur=function(l,p,O,i,k){var r=this._pingPongRenderTarget;this._halfBlur(l,r,p,O,i,"latitudinal",k),this._halfBlur(r,l,O,O,i,"longitudinal",k)},Y.prototype.createShader=function(H){var V=this.gv;return V.getPostProcessing().createShader(V.getGL(),H).program},Y.prototype._halfBlur=function(O,u,E,J,g,M,m){var Y=this.gv,s=this._blurMaterial;if("latitudinal"===M||"longitudinal"===M){s||(this._blurMaterial=s=this.createShader(I(p)));var r=Y.getGL();u.bind(r);var W=3,Z=Y.getRenderState();Z.useProgram(s);var T,i,z,H=Z.directUniforms(),N=Z.directAttribs(),G=S[E]-1,X=isFinite(g)?Math.PI/(2*G):2*Math.PI/(2*p-1),l=g/X,A=isFinite(g)?1+Math.floor(W*l):p,n=[],w=0;for(T=0;p>T;++T)i=T/l,z=Math.exp(-i*i/2),n.push(z),0==T?w+=z:A>T&&(w+=2*z);for(T=0;T<n.length;T++)n[T]=n[T]/w;H.envMap=O.texture,H.samples=A,H.weights=n,H.latitudinal="latitudinal"===M,m&&(H.poleAxis=m),H.dTheta=X,H.mipInt=a-E;var K=S[J],i=3*Math.max(0,q-2*K),U=(0===J?0:2*q)+2*K*(J>a-R?J-a+R:0);this._setViewport(u,i,U,3*K,2*K);var _=o[J];N.position=Bg(r,null,_.vs,Q,3),N.uv=Bg(r,null,_.uv,Q,2),N.faceIndex=Bg(r,null,_.faceIs,Q,1),Lj(r,0,_.vs.length/3),u.unbind(r)}};var R=4,a=8,q=Math.pow(2,a),M=[.125,.215,.35,.446,.526,.582],d=a-R+1+M.length,p=20,G=(1+Math.sqrt(5))/2,x=1/G,l=[new id(1,1,1),new id(-1,1,1),new id(1,1,-1),new id(-1,1,-1),new id(0,G,x),new id(0,G,-x),new id(x,0,G),new id(-x,0,G),new id(G,x,0),new id(-G,x,0)],k=function(){for(var q=[],i=[],L=[],u=a,B=0;d>B;B++){var f=Math.pow(2,u);i.push(f);var l=1/f;B>a-R?l=M[B-a+R-1]:0==B&&(l=0),L.push(l);for(var Q=1/(f-1),g=-Q/2,e=1+Q/2,b=6,C=[],O=[],n=[],o=0;b>o;o++){var X=2*(o%3)/3-1,r=o>2?0:-1;C.push(X,r,0,X+2/3,r,0,X+2/3,r+1,0,X,r,0,X+2/3,r+1,0,X,r+1,0),O.push(g,g,e,g,e,e,g,g,e,e,g,e),n.push(o,o,o,o,o,o)}q.push({vs:new Ac(C),uv:new Ac(O),faceIs:new Ac(n)}),u>R&&u--}return{_lodPlanes:q,_sizeLods:i,_sigmas:L}}(),o=k._lodPlanes,S=k._sizeLods,m=k._sigmas,P=C.EnvmapTextureSize}();var uk=["left","front","right","back","top","bottom"],Qq=cl._RenderList=function(){function k(){z.length=0,p.length=0,L={}}function x(X){var b,P,F,o,A=X.gv,y=X.data,g=X.shapeModel;if(g){var M,f,q,i=y.s("shape3d.transparent")||y.s("points.transparent");for(oi(g)||(M=yk(g.transparent,y,A),g=[g]),F=0,o=g.length;o>F;F++)q=g[F],f=yk(q.transparent,y,A),f===_&&(f=M),f===_&&(f=i),f?P=!0:b=!0}for(F=0,o=uk.length;o>F;F++){var O=X[uk[F]];O&&(O.transparent?P=!0:b=!0)}A.isLabelVisible(y)&&(X.labelInfo&&(y.s(lf+".transparent")?P=!0:b=!0),X.label2Info&&(y.s($n+".transparent")?P=!0:b=!0)),A.isNoteVisible(y)&&(X.noteInfo&&(y.s(Hd+".transparent")?P=!0:b=!0),X.note2Info&&(y.s(el+".transparent")?P=!0:b=!0)),X._38o&&(P=b=!0),P||(b=!0),X._renderParams={opaque:b,transparent:P}}function Z(n,m){m&&x(n);var O=n.data,H=O._id;if(!L[H]){L[H]=!0;var V=n._renderParams;V&&V.visible!==!1&&(n={ui:n,data:O,z:0,id:H},V.opaque&&z.push(n),V.transparent&&p.push(n))}}function K(G,$){if(p.length>1){for(var J,t,A=[0,0,0,0],o=0,Q=p.length;Q>o;o++)J=p[o].data,(t=J._position)?(A[0]=t.x,A[1]=J._54O,A[2]=t.y,A[3]=1,lo(A,$),p[o].z=A[2]/A[3]):p[o].z=0;p.sort(G||V)}}function v(T){T?(Iq(s,b,T),Iq(B,m,T),Iq(A,g,T)):(s=this.batchModelMap={},b=this.batchIndexMap={},B=this.polylineModelMap={},m=this.polylineIndexMap={},A=this.wireframeModelMap={},g=this.wireframeIndexMap={}),this.markBatchInvalid()}function y(T){T?Iq(s,b,T):(s=this.batchModelMap={},b=this.batchIndexMap={}),this.markBatchInvalid()}function j(t){t?Iq(B,m,t):(B=this.polylineModelMap={},m=this.polylineIndexMap={}),this.markBatchInvalid()}function l(V){V?Iq(A,g,V):(A=this.wireframeModelMap={},g=this.wireframeIndexMap={}),this.markBatchInvalid()}function r(){return this._batchInvalid}function F(){this._batchInvalid=!0}function o(){this._batchInvalid=null}var z=[],p=[],s={},b={},B={},m={},A={},g={},L={};return{opaque:z,transparent:p,init:k,push:Z,batchModelMap:s,batchIndexMap:b,polylineModelMap:B,polylineIndexMap:m,wireframeModelMap:A,wireframeIndexMap:g,ivBatch:v,ivModelBatch:y,ivPolylineBatch:j,ivWireframeBatch:l,markBatchInvalid:F,isBatchInvalid:r,onUpdated:o,sort:K}},Kf=cl._RenderLists=function(){function N(){for(var T in H)H[T].init()}function w(){for(var d in H)H[d].onUpdated()}function q(z,R){z=z||"main";var D=H[z];return!D&&R&&(D=H[z]=new Qq),D}function h(t,o){var E=t.data.getRenderLayer(),I=q(E,!0);I.push(t,o)}function g(B){for(var j in H)B(H[j])}var H={};return{init:N,onUpdated:w,get:q,push:h,each:g,lists:H}},sk=cl.RenderTarget=function(f,l,S,q){var v,s=this;null!=l&&l.canvas?(v=l,l=S,S=q,q=arguments[4]):v=f.getGL(),q=q||{},q.cube===!!q.cube,q.samples=q.cube?0:Math.min(f._glCapabilities.maxSamples,q.samples&&q.samples>1&&2===f._webGLVersion?q.samples:0),s.options=q,s.uuid=b.Math.generateUUID(),s.gv=f,s.init(f,v,q),s.format=q.format||Di.RGBA,s.generateMipmaps=!!q.generateMipmaps,q.samples&&!f._glCapabilities._maxSamplesChecked?s.setSize(v,l||1,S||1):s.setSize(v,l,S)};x.assign(cl.RenderTarget.prototype,{bind:function(F,M){var L=this.options;if(L.autoSize){var S=this.gv,$=S.getDevicePixelRatio(),f=S.getWidth()*$,l=S.getHeight()*$;this.setSize(F,f,l)}L.cube?Kl(F,this.frame[M]):Kl(F,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(r){ml(r),this.options.samples&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,this._MSAAFbo),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.frame),r.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,r.COLOR_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(N,h,U){var T=this,j=U.samples,X=U.cube,A=T.texture=h.createTexture(),L=X?Di.TEXTURE_CUBE_MAP:Di.TEXTURE_2D;h.activeTexture(h.TEXTURE0),h.bindTexture(L,A),h.texParameteri(L,h.TEXTURE_WRAP_S,U.wrapS||h.CLAMP_TO_EDGE),h.texParameteri(L,h.TEXTURE_WRAP_T,U.wrapT||h.CLAMP_TO_EDGE);var o=j?h.NEAREST:h.LINEAR;if(h.texParameteri(L,h.TEXTURE_MIN_FILTER,U.minFilter||o),h.texParameteri(L,h.TEXTURE_MAG_FILTER,U.magFilter||o),h.bindTexture(L,null),X){T.depth=[],T.frame=[];for(var e=0;6>e;e++)T.depth[e]=h.createRenderbuffer(),T.frame[e]=h.createFramebuffer()}else T.depth=h.createRenderbuffer(),T.frame=h.createFramebuffer();T.assureTexture()},assureTexture:function(){var C=this;C.gv._2Oi(C.uuid,C.texture,"default")},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(y,J,Z){var i=this;if(J=Math.round(J),Z=Math.round(Z),J&&Z&&(i.width!==J||i.height!==Z)){i.width=J,i.height=Z;var L=y.RENDERBUFFER,B=y.FRAMEBUFFER,V=i.options.samples,l=i.options.cube,$=l?Di.TEXTURE_CUBE_MAP:Di.TEXTURE_2D;if(V){var a=i.gv._glCapabilities;if(!a._maxSamplesChecked){for(y.bindRenderbuffer(L,i.depth),y.getError();V>1&&(y.renderbufferStorageMultisample(L,V,y.DEPTH_COMPONENT16,J,Z),y.getError());)V=Math.floor(V>>1);1>=V&&(V=0,y.texParameteri($,y.TEXTURE_MIN_FILTER,i.options.minFilter||y.LINEAR),y.texParameteri($,y.TEXTURE_MAG_FILTER,i.options.magFilter||y.LINEAR),y.renderbufferStorage(L,y.DEPTH_COMPONENT16,J,Z)),a._maxSamplesChecked=!0,a.maxSamples=i.options.samples=V,y.bindRenderbuffer(L,Q)}}if(V&&(i._MSAAFbo||(i._MSAAFbo=y.createFramebuffer(),i._MSAARbO=y.createRenderbuffer()),y.bindRenderbuffer(L,i._MSAARbO),y.renderbufferStorageMultisample(y.RENDERBUFFER,V,y.RGBA8,J,Z),y.bindFramebuffer(B,i._MSAAFbo),y.framebufferRenderbuffer(B,y.COLOR_ATTACHMENT0,L,i._MSAARbO),y.framebufferRenderbuffer(B,y.DEPTH_ATTACHMENT,L,i.depth),y.bindFramebuffer(B,null),y.bindRenderbuffer(L,null)),y.activeTexture(y.TEXTURE0),y.bindTexture($,i.texture),l)for(var e=y.TEXTURE_CUBE_MAP_POSITIVE_X,k=0;6>k;k++)i.setupFrameBufferTextureAndDepth(y,i.frame[k],i.depth[k],e+k);else i.setupFrameBufferTextureAndDepth(y,i.frame,i.depth,y.TEXTURE_2D);if(i.generateMipmaps&&(2===gv._webGLVersion||$m.isPOT(J)&&$m.isPOT(Z))){y.generateMipmap($);var p=i.options.minFilter||(V?y.NEAREST:y.LINEAR);y.texParameteri($,y.TEXTURE_MIN_FILTER,p===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_LINEAR)}y.bindTexture($,null)}},setupFrameBufferTextureAndDepth:function(T,t,Y,c){var O=this,$=O.format;T.texImage2D(c,0,$,this.width,this.height,0,$,T.UNSIGNED_BYTE,null),T.bindFramebuffer(T.FRAMEBUFFER,t),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,c,O.texture,0),this.setupRenderBufferStorage(T,Y),T.bindFramebuffer(T.FRAMEBUFFER,null)},setupRenderBufferStorage:function(h,I){var g=this,l=h.RENDERBUFFER;h.bindRenderbuffer(l,I);var C=g.options.samples;C?h.renderbufferStorageMultisample(l,C,h.DEPTH_COMPONENT16,g.width,g.height):(h.renderbufferStorage(l,h.DEPTH_COMPONENT16,g.width,g.height),h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,l,I)),h.bindRenderbuffer(h.RENDERBUFFER,null)},toCanvas:function(){var X=this,C=X.gv.getGL();Kl(C,X.frame);var a=X.width,M=X.height,I=new Uint8Array(4*a*M);C.readPixels(0,0,a,M,X.format,C.UNSIGNED_BYTE,I),ml(C);var T=L.createElement("canvas");T.width=a,T.height=M;var $=T.getContext("2d"),n=$.createImageData(a,M);return n.data.set(I),$.putImageData(n,0,0),T}});var bo=cl.Interactor=function(m){this.gv=this.g3d=m};Ok("Interactor",x,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(c){this.gv.fi(c)},startDragging:function(s){Td(this,s)}});var mp=cl.DefaultInteractor=function(F){rd(mp,this,[F])};Ok("DefaultInteractor",bo,{getState:function(){return this._62O},setState:function(W){this._62O=W},getDataInfoAt:function(n,j){var H=this.gv,F=H.getDataInfoAt(n);if(!H.isBlockSelectable()||!F||!F.data)return F;if(!j&&H.isSelected(F.data))return F;for(var G=F.data;(G=G.getParent())&&G instanceof b.Block&&H.isSelectable(G);){var T=H.isSelected(G);if(T&&j)break;if(F={data:G,part:F.part},T&&!j)break}return F},handle_contextmenu:function(v){zq(v)},handle_mousewheel:function(u){this.gv.handleScroll(u,u.wheelDelta/40)},handle_DOMMouseScroll:function(L){2===L.axis&&this.gv.handleScroll(L,-L.detail)},handle_keydown:function(P){this.gv.handleKeyDown(P)},handle_mousedown:function(d){this.handle_touchstart(d)},handle_touchstart:function(J){zq(J);var i=this,y=i.gv,S=Do(J),D=i.getDataInfoAt(J),m=D?D.data:Q,L=D?D.part:Q,Y=y.sm(),n=tc(J),T=xm(J);y.setFocus(J)&&(i._62O=Q,i._57I=Q,i.pendingClickThrough=Q,i.__lastClientPoint__=Hf(J),m?Kp(J)?Y.co(m)?Y.rs(m):Y.as(m):Y.co(m)?m instanceof Ri&&m.isClickThroughEnabled()&&Do(J)&&(i.pendingClickThrough=Hf(J)):Y.ss(m):S&&(Kp(J)?y.isRectSelectable()&&(i._62O=zd):i._57I=Hf(J)),i._31Q&&(Xr(i._31Q),delete i._31Q,delete i._32Q),i._62O||(y.isFirstPersonMode()&&(Xf(J)||iq(J)||T>2?i._62O="pan":y.isMouseRoamable()||rq(J)?(i._62O="roaming",i.foward=n&&Do(J),i._32Q=wq(),i._31Q=Pq(i.tick,i)):S||(i._62O="roaming")),i._62O||(S&&n&&Us[L]?(i._62O=L,i.p3=m.p3()):S&&n&&Je(m)&&y.isSelected(m)?y.isMovable(m)?(i._62O="move",i.p3=m.p3(),i.movedata=m):y._39Q(m)&&(i._62O="none"):rq(J)&&(T>2?i._62O="pan":2===T&&(i.dist=Ti(J),i._62O="pinch")))),i.point=y.lp(J),Td(i,J),Mq(J)?y.handleDoubleClick(J,m,L):y.handleClick(J,m,L))},tick:function(){var p=this,w=p.gv,L=w._moveStep;p.point&&w.isWalkable()&&(p._32Q&&(L*=(wq()-p._32Q)/50),w.walk(p.foward?L:-L),p._32Q=wq(),p._31Q=Pq(p.tick,p))},handle_mouseup:function(K){this.handle_touchend(K)},handle_touchend:function(m){var Y=this._57I;if(Y&&(Ki(Y,Hf(m))<=1&&this.gv.sm().cs(),this._57I=Q),Y=this.pendingClickThrough){if(Ki(Y,Hf(m))<=1){var q=this.getDataInfoAt(m);q&&q.data instanceof Ri&&q.data.isClickThroughEnabled()&&(q=this.getDataInfoAt(m,!0),q&&(m.clickThrough=!0,this.gv.sm().ss(q.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(S){var o,v,B=this,r=B.gv,u=B._62O,I=B.point,P=r.dm(),J=r.lp(S),Y=J.x-I.x,A=J.y-I.y,H=r.getWidth(),M=r.getHeight();if(H&&M){var m=Hf(S),W=cp(r,m,B.__lastClientPoint__),K=Ki({x:0,y:0},W),R=-Z*Y/H,j=-Z*A/M;if("roaming"===u)B.rotate(S,R/2,j/2);else if(u===Os||u===Ps||u===Qs)r._86O||P.beginTransaction(),r.fi({kind:r._86O?"betweenEditRotation":"beginEditRotation",event:S}),r._86O=1,r.sm().each(function(C){if(Je(C)&&r.isRotationEditable(C)){var z=D(R)>D(j)?R:j;u===Os?C.setRotationX(C.getRotationX()+z):u===Ps?C.setRotationY(C.getRotationY()+z):u===Qs&&C.setRotationZ(C.getRotationZ()+z)}});else if("move"===u||Us[u]){if(u===Rs||u===Ss||u===Ts)r._87O||P.beginTransaction(),r.fi({kind:r._87O?"betweenEditScale":"beginEditScale",event:S}),r._87O=1;else{if(!r._moving){if(K<C.touchMoveThreshold)return;P.beginTransaction()}r.fi({kind:r._moving?"betweenMove":"beginMove",event:S}),r._moving=1}var L,N=B.p3,g=r.getPositionInfo(N),d=xq(r);L=u===Ls?"x":u===Ms?"y":u===Ns?"z":u===Rs?"sx":u===Ss?"sy":u===Ts?"sz":r.getMoveMode(S,B.movedata),Y=Y/H*g.width,A=-1*A/M*g.height;var y,f,_=[d[0]*Y,d[4]*Y,d[8]*Y],e=[d[1]*A,d[5]*A,d[9]*A],X=_[0]+e[0],z=_[1]+e[1],s=_[2]+e[2],U=[N[0]+X,N[1]+z,N[2]+s],F=Yb(r.getEye(),U,!0);if("xyz"===L?(y=U,r.moveSelection(X,z,s)):"xz"===L?(y=$o(r,N,[0,1,0],U),y&&r.moveSelection(y[0]-N[0],0,y[2]-N[2])):"xy"===L?(y=$o(r,N,[0,0,1],U),y&&r.moveSelection(y[0]-N[0],y[1]-N[1],0)):"yz"===L?(y=$o(r,N,[1,0,0],U),y&&r.moveSelection(0,y[1]-N[1],y[2]-N[2])):"x"===L||"sx"===L?(F[0]=0,y=$o(r,N,F,U),y&&(f=y[0]-N[0],"x"===L?r.moveSelection(f,0,0):r.sm().each(function(C){Je(C)&&r.isSizeEditable(C)&&(o=C.getScaleX()+f/100,v=o/C.getScaleX(),C.setScaleX(o),Xf(S)&&(C.setScaleY(C.getScaleY()*v),C.setScaleTall(C.getScaleTall()*v)))}))):"y"===L||"sy"===L?(F[1]=0,y=$o(r,N,F,U),y&&(f=y[1]-N[1],"y"===L?r.moveSelection(0,f,0):r.sm().each(function($){Je($)&&r.isSizeEditable($)&&(o=$.getScaleTall()+f/100,v=o/$.getScaleTall(),$.setScaleTall(o),Xf(S)&&($.setScaleY($.getScaleY()*v),$.setScaleX($.getScaleX()*v)))}))):("z"===L||"sz"===L)&&(F[2]=0,y=$o(r,N,F,U),y&&(f=y[2]-N[2],"z"===L?r.moveSelection(0,0,f):r.sm().each(function(k){Je(k)&&r.isSizeEditable(k)&&(o=k.getScaleY()+f/100,v=o/k.getScaleY(),k.setScaleY(o),Xf(S)&&(k.setScaleX(k.getScaleX()*v),k.setScaleTall(k.getScaleTall()*v)))}))),!y)return;B.p3=y}else if(u===zd){var a=B.div;a||(a=B.div=jc(),zk(B.getView(),a),a.op=I,a.style.background=r.getRectSelectBackground()),r.fi({kind:r._rectSelecting?"betweenRectSelect":"beginRectSelect",event:S}),r._rectSelecting=1,a.rect=Tl(a.op,J),xg(a,a.rect)}else if("pinch"===u&&2===xm(S)){r.fi({kind:r._pinching?"betweenPinch":"beginPinch",event:S}),r._pinching=1;var f=Ti(S);r._lastZoomLP||(r._lastZoomLP=Bc(S)),r.handlePinch(f,B.dist),B.dist=f}else"pan"===u||Xf(S)||iq(S)?B.pan(S,Y,A):"none"===u||r.isFirstPersonMode()||B.rotate(S,R,j);B.point=J}},pan:function(K,n,g){var B=this.gv;if(B.isPannable()){var p=B.getWidth(),T=B.getHeight();if(!p||!T)return;var I=B.getCenterInfo(),D=n/p*I.width,L=-1*g/T*I.height;B.fi({kind:B._panning?"betweenPan":"beginPan",event:K}),B._panning=1,B.pan(-D,-L)}},rotate:function(B,I,O){var t=this.gv;t.isRotatable()&&(t.fi({kind:t._rotating?"betweenRotate":"beginRotate",event:B}),t._rotating=1,t.rotate(I,O))},handleWindowMouseUp:function(I){this.handleWindowTouchEnd(I)},handleWindowTouchEnd:function(o){var K=this,M=K.gv,m=M.dm(),E=K.div;if(E){var d=M.getDatasInRect(E.rect);if(!d.isEmpty()){var e=M.sm(),Y=e.toSelection(),x=Xf(o),U=o.altKey;d.each(function(g){e.co(g)?(!x||x&&U)&&Y.remove(g):(!U||x&&U)&&Y.add(g)}),e.ss(Y)}hg(E)}M._moving&&(delete M._moving,M.fi({kind:"endMove",event:o}),M.onMoveEnded(),m.endTransaction()),M._panning&&(delete M._panning,M.fi({kind:"endPan",event:o}),M.onPanEnded()),M._rotating&&(delete M._rotating,M.fi({kind:"endRotate",event:o}),M.onRotateEnded()),M._86O&&(delete M._86O,M.fi({kind:"endEditRotation",event:o}),m.endTransaction()),M._87O&&(delete M._87O,M.fi({kind:"endEditScale",event:o}),m.endTransaction()),M._pinching&&(delete M._pinching,M.fi({kind:"endPinch",event:o}),M.onPinchEnded()),M._rectSelecting&&(delete M._rectSelecting,M.fi({kind:"endRectSelect",event:o}),M.onRectSelectEnded()),M._walking&&(delete M._walking,M.fi({kind:"endWalk",event:o}),M.onWalkEnded()),M._lastZoomLP=M._lastZoomHit=null,K.dist=K.point=K._62O=K.p3=K.movedata=K.div=K._57I=K.pendingClickThrough=K._32Q=K._31Q=K.foward=Q,K.__lastClientPoint__=Q}});var bs=cl.MapInteractor=function(N){rd(bs,this,[N]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};Ok("MapInteractor",bo,{setUp:function(){bs.superClass.setUp.call(this);var g=this.gv;this.__oldMinPhi__=g.getRotateMinPhi(),this.__oldMaxPhi__=g.getRotateMaxPhi(),g.setRotateMinPhi(this._minPhi),g.setRotateMaxPhi(this._maxPhi)},tearDown:function(){bs.superClass.tearDown.call(this);var B=this.gv;B.setRotateMinPhi(this.__oldMinPhi__),B.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(A){zq(A)},handle_mousewheel:function(s){this.gv.handleScroll(s,s.wheelDelta/40)},handle_DOMMouseScroll:function(J){2===J.axis&&this.gv.handleScroll(J,-J.detail)},handle_keydown:function(w){this.gv.handleKeyDown(w)},handle_mousedown:function(c){this.handle_touchstart(c)},handle_touchstart:function(d){zq(d);var W=this,x=W.gv;if(x.setFocus(d)){var K=x.getDataInfoAt(d),b=K?K.data:Q,A=K?K.part:Q,R=W.editing={point:x.lp(d)};rq(d)?R.touch=!0:(R.touch=!1,R.clickLeft=Do(d),R.pan=iq(d)?!0:"left"===this.panButton===R.clickLeft),b&&x._39Q(b)&&(R.preventDefault=!0),Td(W,d),Mq(d)?x.handleDoubleClick(d,b,A):x.handleClick(d,b,A)}},handle_mouseup:function(x){this.handle_touchend(x)},handle_touchend:function(){},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(I){var v=this,y=v.gv,m=v.editing;if(m){var p=y.lp(I),k=m.point,S=p.x-k.x,C=p.y-k.y;if(!m.moved){if(Math.abs(S)<v.threshold&&Math.abs(C)<v.threshold&&!(I.touches&&I.touches.length>1))return;m.moved=!0}if(!m.preventDefault)if(m.point=p,m.touch){var O=I.touches.length;if(2!==O)v.pan(I,S,C);else{if(1>=O)return;var L=I.touches,h={x:L[0].clientX,y:L[0].clientY},q={x:L[1].clientX,y:L[1].clientY},x={x:q.x-h.x,y:q.y-h.y},r=m.lastCenter,s=Math.atan2(x.y,x.x),t=m.theta,B=0;t==Q?t=m.theta=s:(B=s-t,m.thetaStarted||Math.abs(B)>v.touchRotateThreshold?(m.thetaStarted=!0,m.theta=s):B=0);var j=e*(h.y+q.y)/2/y.getHeight(),$=m.phi,K=0;$==Q?$=m.phi=j:(K=j-$,m.phiStarted||Math.abs(K)>v.touchRotateThreshold?(m.phiStarted=!0,m.phi=j):K=0);var W,P=Math.sqrt(x.x*x.x+x.y*x.y),E=m.vlen;if(E){var u=h.x-r.x,V=h.y-r.y,w=q.x-r.x,z=q.y-r.y,b=Math.sqrt(u*u+V*V),Y=Math.sqrt(w*w+z*z),D=E/2,l=v._sign2(b-D),d=v._sign2(Y-D);0>l*d||0===l&&0===d?(W=1,m.vlen=P):(W||(W=P/E),m.scaleStarted||Math.abs(W-1)>v.touchScaleThreshold?(m.vlen=P,m.scaleStarted=!0):W=1)}else E=m.vlen=P,W=1;1!==W&&y.setZoom(W),(K||B)&&v.rotate(I,B,-K),m.lastCenter={x:(q.x+h.x)/2,y:(q.y+h.y)/2}}}else if(m.pan)v.pan(I,S,C);else{var R=y.getWidth(),i=y.getHeight();if(!R||!i)return;var N=-Z*S/R,M=-Z*C/i;v.rotate(I,N,M)}}},_sign2:function(u){return Math.abs(u)<this._touchScaleCheckAccuracy?0:u>0?1:-1},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},getDataInfoAt:function(h,D){var j=this.gv,r=j.getDataInfoAt(h);if(!j.isBlockSelectable()||!r||!r.data)return r;if(!D&&j.isSelected(r.data))return r;for(var u=r.data,X=r.part;(u=u.getParent())&&u instanceof b.Block&&j.isSelectable(u);){var G=j.isSelected(u);if(G&&D)break;if(r={data:u,part:X},G&&!D)break}return r},handleWindowTouchEnd:function(d){var q=this,W=q.editing;if(q.editing=null,W){var D=q.gv;if(W.moved||!W.clickLeft&&!W.touch)D._panning=null,D._rotating=null,D.fi({kind:W.pan?"endPan":"endRotate",event:d});else{var E=q.getDataInfoAt(d),l=E&&E.data;l instanceof Ri&&l.isClickThroughEnabled()&&(E=q.getDataInfoAt(d,!0),E&&(l=E.data)),l?D.sm().setSelection([l]):D.sm().clearSelection()}}},pan:function(S,v,x){var q=this,g=q.gv;if(g.isPannable()){var h=g.getWidth(),u=g.getHeight();if(h&&u){var f=g.getCenterInfo(),y=-v/h*f.width,D=1*x/u*f.height;g.fi({kind:g._panning?"betweenPan":"beginPan",event:S}),g._panning=1;var i=q.keepHorizon,G=q.editing.touch;if((G&&S.touches&&S.touches.length>1||!G&&Xf(S))&&(i=!i),!i)return g.pan(y,D);if(y||D){var A=xq(g),K=[A[0]*y,A[4]*y,A[8]*y],H=[A[1],0,A[9]],j=Math.sqrt(H[0]*H[0]+H[2]*H[2]);j&&(H=[H[0]/j*D,0,H[2]/j*D]);var P=K[0]+H[0],E=K[1]+H[1],m=K[2]+H[2],X=g._center,W=g._eye;X[0]+=P,X[1]+=E,X[2]+=m,W[0]+=P,W[1]+=E,W[2]+=m,g.fp(fr,Q,W),g.fp(Nc,Q,X)}}}},rotate:function(V,q,i){var h=this,L=h.gv;if(L.isRotatable()){var s=L._center,k=L._eye,W=Yb(k,s),P=mf(z(W[0]*W[0]+W[2]*W[2]),W[1]),_=Fm(L,P+i);i=_-P,L.fi({kind:L._rotating?"betweenRotate":"beginRotate",event:V}),L._rotating=1,L.rotate(q,i)}}}),x.defineProperties(bs.prototype,{panButton:{get:function(){return this._panButton},set:function(M){this._panButton=M}},minPhi:{get:function(){return this._minPhi},set:function(X){this.gv.setRotateMinPhi(this._minPhi=X)}},maxPhi:{get:function(){return this._maxPhi},set:function(c){this.gv.setRotateMaxPhi(this._maxPhi=c)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(m){this._keepHorizon=m}},threshold:{get:function(){return this._threshold},set:function(M){this._threshold=M}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(r){this._touchScaleThreshold=r}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(n){this._touchRotateThreshold=n}}});var gh,Ds="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Es=32,Fs=cl.GlobeInteractor=function(q,s){rd(Fs,this,[q]);var C,y=s.radius||6378137,a=this,c=null;gh||(gh=jc(),gh.style.border="",gh.style.backgroundImage="url("+Ds+")");var D=new ql,x=new id,$=new id,l=new id,r=new _f,F="number"==typeof y?{x:y,y:y,z:y}:y,T={center:new id(0,0,0),radius:F},S=function(Z){q._81O=null;var i=q.getHitPosition(Z,q.getCenter(),x.copy(q.getEye()).sub($.copy(q.getCenter())).toArray());return r.origin.copy(q.getEye()),r.direction.copy(i).sub(r.origin).normalize(),r.intersectEllipsoid(T)},N=function(i,I){q._81O=null,r.origin.copy(q.getEye());for(var X,j,O=q.getCenter(),B=x.copy(q.getEye()).sub($.copy(q.getCenter())).toArray(),P=1,D=16,F=0,A=1,d={x:0,y:0};D--;){if(d.x=I.x+(i.x-I.x)*P,d.y=I.y+(i.y-I.y)*P,X=q.getHitPosition(d,O,B),r.direction.copy(X).sub(r.origin).normalize(),j=r.intersectEllipsoid(T),j&&1===P)return{hit:j};j?F=P:A=P,P=(F+A)/2}return{hit:j,out:1>P}},E=function(r,C){if(c){var f=Date.now();c.deltaTime=c.lastTime?f-c.lastTime:1e3,c.lastTime=f,c.lastAxis=r,c.lastAngle=C}C&&(D.setFromAxisAngle(r,C),q.setEye(x.copy(q.getEye()).applyQuaternion(D).toArray()),q.setCenter(x.copy(q.getCenter()).applyQuaternion(D).toArray()),q.setUp(x.copy(q.getUp()).applyQuaternion(D).toArray()))};a._showCrossIcon=function(Q){zk(a.getView(),gh),xg(gh,{x:Q.clientX-Es/2,y:Q.clientY-Es/2,width:Es,height:Es})},a._hideCrossIcon=function(){hg(gh)},a._scrollImpl=function(h,z){c={point:q.lp(h),screen:Hf(h),hit:S(h),type:"right"},c.hitNormalize=c.hit?c.hit.clone().normalize():new id;var I={clientX:c.screen.x,clientY:c.screen.y+10*z};a._handleMoveImpl(I),a._endMoveImpl(I)},a._startMoveImpl=function(i){C&&(C.stop(!0),C=null),c={point:q.lp(i),screen:Hf(i),hit:S(i)},c.hitNormalize=c.hit?c.hit.clone().normalize():new id,rq(i)?1===i.touches.length?c.hit&&(c.type="left"):2===i.touches.length&&(c.type="touch2"):(Do(i)?c.hit&&(c.type="left"):kr(i)?c.type="right":iq(i)&&c.hit&&(c.type="middle"),!c.hit||"right"!==c.type&&"middle"!==c.type||a._showCrossIcon(i)),c.type&&Td(a,i)},a._handleMoveImpl=function(i){if(c)switch(c.type){case"left":return a._handleLeft(i);case"right":return a._handleRight(i);case"middle":return a._handleMiddle(i);case"touch2":return a._handleTouch2(i)}},a._endMoveImpl=function(){if(c){if(this._hideCrossIcon(),"left"===c.type||"middle"===c.type){var W=1e3*(c.lastAngle/(c.deltaTime||30)),h=c.lastAxis,Q=c.lastTime,N=function(){var T=Date.now(),D=(T-Q)/1e3;return Q=T,W*=Math.pow(Math.abs(a.decelerationRate),3*D),Math.abs(W)<.01?(W=0,C&&C.stop(),void 0):(E(h,W*D),void 0)};C=Po({action:function(){N(arguments)},duration:5e3})}c=null}},a._handleLeft=function(h){if(!c.finished){var U=Hf(h),x=N(U,c.lastScreen||c.screen);if(c.lastScreen=U,!x.hit)return c.finished=!0,a._endMoveImpl(h),void 0;var Z=x.hit;Z.normalize();var g=c.hitNormalize,n=Math.acos(Z.dot(g)),W=Z.cross(g).normalize();E(W,n),x.out&&(c.finished=!0,a._endMoveImpl(h))}},a._handleRight=function(k){var N=c.lastScreen||c.screen,w=N.y;N=c.lastScreen=Hf(k);var o=N.y,T=o-w;if(T){var U=Math.min(.5,T*a.scaleSpeed);x.copy(q.getEye());var C=c.hit;C||(C=x.clone().divide(F).normalize().multiply(F)),$.copy(x).lerp(C,U),q.setEye($.toArray()),x.copy(q.getUp()),$.normalize();var K=x.clone().cross($).normalize();if(l.copy(q.getCenter()),l.sub(K.multiplyScalar(l.dot(K))),q.setCenter(l.toArray()),c.hit){var b=S(c.screen),Y=c.hitNormalize;if(b){b.normalize();var u=Math.acos(b.dot(Y)),G=b.cross(Y).normalize();u&&E(G,u)}}}};var R=function(L){return Math.abs(L)<.01?0:L>0?1:-1};a._handleTouch2=function(j){var X=j.touches.length;if(2===X){var M=j.touches,b={x:M[0].clientX,y:M[0].clientY},D={x:M[1].clientX,y:M[1].clientY},s={x:D.x-b.x,y:D.y-b.y},h=c.lastCenter,t=Math.atan2(s.y,s.x),P=c.theta,n=0;P==Q?P=c.theta=t:(n=t-P,c.thetaStarted||Math.abs(n)>.03?(c.thetaStarted=!0,c.theta=t):n=0);var I,g=Math.sqrt(s.x*s.x+s.y*s.y),K=c.vlen;if(K){var V=b.x-h.x,a=b.y-h.y,S=D.x-h.x,W=D.y-h.y,z=Math.sqrt(V*V+a*a),l=Math.sqrt(S*S+W*W),U=K/2,L=R(z-U),i=R(l-U);0>L*i||0===L&&0===i?(I=1,c.vlen=g):(I||(I=g/K),c.scaleStarted||Math.abs(I-1)>.05?(c.vlen=g,c.scaleStarted=!0):I=1)}else K=c.vlen=g,I=1;var s=$.copy(q.getEye()).clone();1!==I&&q.setEye(s.setLength((s.length()-y)/I+y).toArray()),n&&E(s.normalize(),n),c.lastCenter={x:(D.x+b.x)/2,y:(D.y+b.y)/2}}},a._handleMiddle=function(z){var v=Hf(z),y=c.screen;c.screen=v;var w=(v.y-y.y)/180*Math.PI*a.rollSpeed;$.copy(q.getCenter()).sub(x.copy(q.getEye())).normalize(),x.copy(q.getUp()).cross($).normalize(),$.copy(q.getEye()).sub(c.hit).applyAxisAngle(x,w).add(c.hit);var V=$.clone();$.copy(q.getCenter()).sub(c.hit).applyAxisAngle(x,w).add(c.hit);var N=$.clone(),G=$.copy(q.getUp()).applyAxisAngle(x,w).clone(),C=!1;w>0&&(l.copy(G),$.copy(N).sub(V).normalize(),x.copy(V).multiplyScalar(-1).normalize(),x.dot(l)-$.dot(l)>0&&(C=!0)),C||l.copy(c.hit).sub(V).dot(c.hitNormalize)>=0&&(C=!0),C||(q.setEye(V.toArray()),q.setCenter(N.toArray()),q.setUp(G.toArray()));var J=-(v.x-y.x)/180*Math.PI*a.rotateSpeed;E(c.hitNormalize,J)}};Ok("GlobeInteractor",bo,{handle_contextmenu:function(w){zq(w)},handle_mousewheel:function(Y){this._scrollImpl(Y,Y.wheelDelta/40)},handle_DOMMouseScroll:function(p){2===p.axis&&this._scrollImpl(p,-p.detail)},handle_keydown:function(i){this.gv.handleKeyDown(i)},handle_mousedown:function(k){this.handle_touchstart(k)},handle_touchstart:function(w){zq(w);var A=this.gv;if(A.setFocus(w)){var z=A.getDataInfoAt(w),p=z?z.data:Q;p&&A.isInteractive(p)||this._startMoveImpl(w);var y=z?z.part:Q;Mq(w)?A.handleDoubleClick(w,p,y):A.handleClick(w,p,y)}},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(){},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(h){this._handleMoveImpl(h)},handleWindowMouseUp:function(Q){this.handleWindowTouchEnd(Q)},handleWindowTouchEnd:function(h){this._endMoveImpl(h)}}),x.defineProperties(Fs.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(s){this._rotateSpeed=s}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(s){this._rollSpeed=s}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(k){this._scaleSpeed=k}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(A){this._decelerationRate=A}}});var Gs=function(b){var j=2147483648|b;return[(255&j>>16)/255,(255&j>>8)/255,(255&j)/255,(255&j>>24)/255]},Hs=function(Z){this.gv=Z,this.gv.pickColorMap={_pickIdUsed:2e3}};eq(Hs,x,{_iv:!0,iv:function(){this._iv=!0},get:function(l,o,O){this.validate();var s=this,_=s.gv.getGL();if(!_)return Q;var j,K,T=s._resolution,h=Math.round(l.x*T),k=Math.ceil(l.width*T),v=Math.ceil(l.height*T),J=s.height-Math.round(l.y*T)-v,Y=E(k/2),$=new Uint8Array(4*k*v),a=0,P=$.length,B=o?Q:new Qd,x=o?Q:{};if(Kl(_,s.frame),_.readPixels(h,J,k,v,_.RGBA,_.UNSIGNED_BYTE,$),ml(_),o){for(;Y>=a;a++)for(var I=Y-a,y=Y+a,N=I;y>=N;N++)for(var i=I;y>=i;i++)if((N===I||N===y||i===I||i===y)&&(j=s.info($,4*(N*k+i)))){if(O&&O(j)===!1)continue;return j}}else for(;P>a;a+=4)if(j=s.info($,a)){if(O&&O(j)===!1)continue;K=j.data,x[K._id]||(B.add(K),x[K._id]=K)}return B},info:function(z,u){return this.gv.pickColorMap[(z[u]<<16)+(z[u+1]<<8)+z[u+2]+((127&z[u+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var Z=this,z=Z.gv,T=z.getGL();if(T){var R=Z._resolution=z._pickerResolution*z.getDevicePixelRatio(),H=Math.round(R*z.getWidth()),t=Math.round(R*z.getHeight()),g=T.RGBA,U=T.TEXTURE_2D,n=T.RENDERBUFFER,P=T.FRAMEBUFFER;if(Z.texture||(Z.texture=Gp(T),Z.render=T.createRenderbuffer(),Z.frame=T.createFramebuffer()),(Z.width!==H||Z.height!==t)&&(T.activeTexture(T.TEXTURE0),$r(T,Z.texture),T.texImage2D(U,0,g,H,t,0,g,T.UNSIGNED_BYTE,Q),Zr(T,T.TEXTURE_MIN_FILTER,T.LINEAR),T.bindRenderbuffer(n,Z.render),T.renderbufferStorage(n,T.DEPTH_COMPONENT16,H,t),Kl(T,Z.frame),T.framebufferTexture2D(P,T.COLOR_ATTACHMENT0,U,Z.texture,0),T.framebufferRenderbuffer(P,T.DEPTH_ATTACHMENT,n,Z.render),$r(T,Q),T.bindRenderbuffer(n,Q),ml(T),Z.width=H,Z.height=t),Z._iv){Z._iv=!1;var k=!1;z._40Q.each(function(g){!k&&g.isBatchInvalid()&&(k=!0)}),k&&z.updateScene(),Kl(T,Z.frame),T.clear(T.COLOR_BUFFER_BIT),z.overlappingBox.clear(),z.setViewport(T,0,0,H,t),z.renderPickScene(),ml(T)}}}});var Is=function(x){this.gv=x
};eq(Is,x,{gap:0,size:0,_42:function(D,I){var f=this,e=f.gv,K=e._gridGap,R=e._gridSize;if(e._gridVisible){if(f.gap!==K||f.size!==R){for(var h=[],u=e._gridSize/2,q=K*u,G=0;2*u+1>G;G++){var x=6*G,t=6*(2*u+1)+x;h[x]=-q,h[x+1]=0,h[x+2]=-q+G*K,h[x+3]=q,h[x+4]=0,h[x+5]=-q+G*K,h[t]=-q+G*K,h[t+1]=0,h[t+2]=-q,h[t+3]=-q+G*K,h[t+4]=0,h[t+5]=q}f.vs=new Ac(h),f.gap=K,f.size=R}Sk(e),pl(D,I),wh(D),Ob(D,I,1,e._gridColor,e._buffer.vs,f.vs),Lj(D,0,f.vs.length/3,D.LINES),wn(D),kq(D,I)}else f.vs=f.gap=f.size=Q}});var Js=function(c){this.gv=c};eq(Js,x,{_42:function(I,l){var C=this.gv,y=C._buffer.vs,A=C._axisXColor,x=C._axisYColor,M=C._axisZColor,Y=C._originAxisVisible,h=C._centerAxisVisible;if(Y||h){var g=nm?I.TRIANGLES:I.TRIANGLE_FAN,u=I.LINES;if(Sk(C),pl(I,l),wh(I),Y){var Z=C.getCenterInfo(),k=F(Z.width,Z.height)/5,s=.8*k,v=.05*k;Ob(I,l,1.5,A,y,new Ac([0,0,0,k,0,0,s,v,0,s,0,v,s,-v,0,s,0,-v,s,v,0,0,0,0,0,k,0,v,s,0,0,s,v,-v,s,0,0,s,-v,v,s,0,0,0,0,0,0,k,v,0,s,0,v,s,-v,0,s,0,-v,s,v,0,s])),Lj(I,0,2,u),Lj(I,1,6,g),Ob(I,l,Q,x),Lj(I,7,2,u),Lj(I,8,6,g),Ob(I,l,Q,M),Lj(I,14,2,u),Lj(I,15,6,g)}if(h){var n=C._center,K=n[0],p=n[1],D=n[2],Z=C.getPositionInfo(n);k=F(Z.width,Z.height)/20,Ob(I,l,1.5,A,y,new Ac([K,p,D,K+k,p,D,K,p,D,K,p+k,D,K,p,D,K,p,D+k])),Lj(I,0,2,u),Ob(I,l,Q,x),Lj(I,2,2,u),Ob(I,l,Q,M),Lj(I,4,2,u)}wn(I),kq(I,l)}}});var Ks=function(g){this.gv=g},Ls="edit_tx",Ms="edit_ty",Ns="edit_tz",Os="edit_rx",Ps="edit_ry",Qs="edit_rz",Rs="edit_sx",Ss="edit_sy",Ts="edit_sz",Us={};Us[Ls]=101,Us[Ms]=102,Us[Ns]=103,Us[Os]=104,Us[Ps]=105,Us[Qs]=106,Us[Rs]=107,Us[Ss]=108,Us[Ts]=109,eq(Ks,x,{_42:function(E,e,Y){var U=this,k=U.gv,o=k.sm().ld();if(o&&k.isEditable(o)&&!k.isEditHelperDisabled()&&Je(o)&&(!k.isFirstPersonMode()||!k.isMouseRoamable()&&!Ap)){Sk(k);var T,j=k.isMovable(o),X=k.isRotationEditable(o),x=k.isSizeEditable(o),h=k._axisXColor,c=k._axisYColor,J=k._axisZColor,t=k._editSizeColor,i=o.p3();if(k.isOrtho()){var s=k.getCenterInfo();T=F(s.width,s.height)/8}else T=Ki(k.getEye(),i)/10;var f,B,W=T/(Y?5:10),l=.7*T,Q=.4*l,r=i[0],n=i[1],M=i[2];f=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],j&&U._17O(E,e,o,Y,Ls,h,f,[r,n-W,M,r+l,n-W,M,r+l,n,M,r+l,n,M,r,n,M,r,n-W,M,r,n-W,M+W,r+l,n-W,M+W,r+l,n-W,M,r+l,n-W,M,r,n-W,M,r,n-W,M+W]),B=r+l,x&&U._17O(E,e,o,Y,Rs,t,f,[B,n-W,M,B+Q,n-W,M,B+Q,n,M,B+Q,n,M,B,n,M,B,n-W,M,B,n-W,M+W,B+Q,n-W,M+W,B+Q,n-W,M,B+Q,n-W,M,B,n-W,M,B,n-W,M+W]),B+=Q,X&&U._17O(E,e,o,Y,Os,h,f,[B,n-W,M,B+Q,n-W,M,B+Q,n,M,B+Q,n,M,B,n,M,B,n-W,M,B,n-W,M+W,B+Q,n-W,M+W,B+Q,n-W,M,B+Q,n-W,M,B,n-W,M,B,n-W,M+W]),f=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],j&&U._17O(E,e,o,Y,Ms,c,f,[r,n,M,r,n+l,M,r-W,n+l,M,r-W,n+l,M,r-W,n,M,r,n,M,r,n,M,r,n,M-W,r,n+l,M-W,r,n+l,M-W,r,n+l,M,r,n,M]),B=n+l,x&&U._17O(E,e,o,Y,Ss,t,f,[r,B,M,r,B+Q,M,r-W,B+Q,M,r-W,B+Q,M,r-W,B,M,r,B,M,r,B,M,r,B,M-W,r,B+Q,M-W,r,B+Q,M-W,r,B+Q,M,r,B,M]),B+=Q,X&&U._17O(E,e,o,Y,Ps,c,f,[r,B,M,r,B+Q,M,r-W,B+Q,M,r-W,B+Q,M,r-W,B,M,r,B,M,r,B,M,r,B,M-W,r,B+Q,M-W,r,B+Q,M-W,r,B+Q,M,r,B,M]),f=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],j&&U._17O(E,e,o,Y,Ns,J,f,[r,n,M,r,n,M+l,r,n-W,M+l,r,n-W,M+l,r,n-W,M,r,n,M,r,n-W,M,r-W,n-W,M,r-W,n-W,M+l,r-W,n-W,M+l,r,n-W,M+l,r,n-W,M]),B=M+l,x&&U._17O(E,e,o,Y,Ts,t,f,[r,n,B,r,n,B+Q,r,n-W,B+Q,r,n-W,B+Q,r,n-W,B,r,n,B,r,n-W,B,r-W,n-W,B,r-W,n-W,B+Q,r-W,n-W,B+Q,r,n-W,B+Q,r,n-W,B]),B+=Q,X&&U._17O(E,e,o,Y,Qs,J,f,[r,n,B,r,n,B+Q,r,n-W,B+Q,r,n-W,B+Q,r,n-W,B,r,n,B,r,n-W,B,r-W,n-W,B,r-W,n-W,B+Q,r-W,n-W,B+Q,r,n-W,B+Q,r,n-W,B])}},_17O:function(q,o,Y,p,R,U,h,k){var $=this.gv,V=$._buffer,b=Of.for(q),j=b.directUniforms(),F=b.directAttribs();if($._picking){p=$.pickColorMap;var O=Us[R];p[O]={data:Y,part:R},j.uFixPickReverseColor=Gs(O)}Rg(q,o,Q,!0,Q,!0,Q,!1),j.uDiffuse=U,F.aPosition=wg(q,V.vs,new Ac(k),Q),F.aNormal=wg(q,V.ns,new Ac(h),Q),wh(q),Lj(q,0,12),wn(q),Wl(q,o)}});var Vs=b.Raycaster=function(d){this.gv=d,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Xq("Raycaster",x,{intersect:function(p){var k=this,Y=k.gv,R=Y.getDataAt(p);return R?k.intersectObject(p,R):null},intersectObjects:function(I,Q,q){var v,S,g,T,o=this,B=1/0,W=I.origin||(new id).fromArray(o.gv.getEye()),h=o.maxTriangleTest,K=[];Q.forEach(function(N){q&&q(N)===!1||N.s("intersect")!==!1&&K.push(N)});var L=W.distanceToSquared2([0,0,0]);return K.sort(function(Q,R){return(Q.p3?W.distanceToSquared2(Q.p3()):L)-(R.p3?W.distanceToSquared2(R.p3()):L)}),o.countTriangles=0,K.forEach(function(_){o.countTriangles>h||(v=o.intersectObject(I,_),v&&(S=W.distanceToSquared(v.world),B>S&&(g=_,T=v,B=S)))}),o.countTriangles=0,{data:g,intersect:T}},intersectObjectAndRecordTriangle:function(h,S){this._4GQ=!0;var F=this.intersectObject(h,S);return this._4GQ=!1,F},intersectLastTriangle:function(a,Z){var P=this.getRay(a);P.applyMatrix4(Z.inverseMatrix);var m=P.intersectPlane(Z.plane);if(!m)return null;var Y=Wr.uvIntersection(m,Z.p1,Z.p2,Z.p3,Z.uv1.clone(),Z.uv2.clone(),Z.uv3.clone());return{world:m.clone().applyMatrix4(Z.matrixWorld),local:m.clone(),uv:Y}},getRay:function(y){if(y instanceof _f)return y;var X=this,C=X.gv,a=C.unproject(y),s=new id,A=C.getEye(),H=new id;if(C.isOrtho()){var t=new id(A);H.copy(C.getCenter()).sub(t).normalize();var O=s.copy(a).sub(t).dot(H);s.copy(H).setLength(-O).add(t.copy(a))}else s.copy(A),H.copy(a).sub(s).normalize();return new b.Math.Ray(s,H)},intersectObject:function(D,s){return this._intersectObjectImpl(this.getRay(D),s)},_intersectObjectImpl:function(){function w(){var f=new id;return f.subVectors(X,V),S.subVectors(B,V),f.cross(S).normalize(),f}var _=new El,e=new El,W=new _f,y=new id,v=new id,E=new id,M=new id,O=new id,B=new id,V=new id,X=new id,I=new jj,h=new jj,T=new jj,S=new id,q={vs:tq,is:hi,uv:Gm},i=sf.slice(0);return i.push("csg"),function(f,p){var u=this.gv.getData3dUI(p),a=p.mat||u.mat;a?_.fromArray(a):_.identity(),e.getInverse(_),W.copy(f).applyMatrix4(e);var x,k,L,D="body",P=u.shapeModel;if(!P&&(p instanceof b.Polyline||p instanceof b.Edge)&&u.lineShapeModel&&(P=u.lineShapeModel),P||(P=sh(u)),P||(b.CSGNode&&p instanceof b.CSGNode||b.CSGShape&&p instanceof b.CSGShape?(L=!0,P=[u.left,u.front,u.right,u.back,u.top,u.bottom,u.csg]):p instanceof b.Node&&!(p instanceof b.Shape)?(x=!0,P=q):(k=!0,P=[u.left,u.front,u.right,u.back,u.top,u.bottom])),!P)return console.log("Can not find shape model."),null;oi(P)||(P=[P]);var d,c,o,t,l,Q,J,N,s,G,R,z,j,K,S,H,m=1/0,U=["","top_","bottom_"],r=!1,F=this.backfaceCulling,n=[];for(pg(P,u,n),d=0,c=n.length;c>d;d++)if(j=n[d])for(o=0,t=U.length;t>o;o++)if(K=U[o],J=j[K+"vs"],N=j[K+"is"],s=j[K+"uv"]||j[K+"tuv"],J){if(S=j[K+"boundingBox"]){var R=W.intersectBox(S);if(!R)continue;if(W.origin.distanceTo(R)>m)continue;H=!1}else j[K+"boundingBox"]=S=new b.Math.Box3,H=!0;for(l=0,Q=N?N.length:J.length/3;Q>l;l+=3)this.countTriangles++,N?(v.fromArray(J,3*N[l]),E.fromArray(J,3*N[l+1]),M.fromArray(J,3*N[l+2])):(v.fromArray(J,3*l),E.fromArray(J,3*(l+1)),M.fromArray(J,3*(l+2))),H&&(S.expandByPoint(v),S.expandByPoint(E),S.expandByPoint(M)),G=W.intersectTriangle(v,E,M,F,y),G&&(z=W.origin.distanceTo(G),m>z&&(m=z,O.copy(G),B.copy(v),V.copy(E),X.copy(M),""!==K?D=K.slice(0,-1):x?D=sf[Math.floor(l/6)]:k?D=sf[d]:L&&(D=i[d]),s&&(r=!0,N?(I.fromArray(s,2*N[l]),h.fromArray(s,2*N[l+1]),T.fromArray(s,2*N[l+2])):(I.fromArray(s,2*l),h.fromArray(s,2*(l+1)),T.fromArray(s,2*(l+2))))))}if(!isFinite(m))return null;var $,C,g=O.clone().applyMatrix4(_),Z=this._4GQ;r&&(Z&&(C={inverseMatrix:e.clone(),matrixWorld:_.clone(),p1:B.clone(),p2:V.clone(),p3:X.clone(),uv1:I.clone(),uv2:h.clone(),uv3:T.clone(),plane:(new b.Math.Plane).setFromCoplanarPoints(B,V,X)}),$=Wr.uvIntersection(O,B,V,X,I,h,T));var A=w(B,V,X),Y=w(B.applyMatrix4(_),V.applyMatrix4(_),X.applyMatrix4(_)),Qc=W.direction.dot(A);Qc>0&&(A.multiplyScalar(-1),Y.multiplyScalar(-1));var er={world:g,local:O.clone(),worldNormal:Y,normal:A,uv:$,part:D};return C&&(er.triangleInfo=C),er}}()});var Ws=function(w,B){this.gv=w,this.s=function(L,I,E){return I==Q&&(I=E),I==Q?B.getStyle(L):yk(I,B,w)},this.data=B};eq(Ws,x,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:_,iv:function(){this._iv=!0},update:function(D,c,B){var S=this,C=S.data;if(D||(D=S.gv,c=D.getGL(),B=D._40Q),!S.needValidate(c)||!D.isVisible(C))return B.push(this,!1),void 0;var I,p,m,l,w,X=C._id,x=C._47Q?null:S.s("batch"),n=C.getRenderLayer(),i=B.get(n,!0),L=i.batchIndexMap,M=i.batchModelMap,y=D.getBrightness(C),f=y!=Q&&1!==y;I=Wc(L,M,C,x,D);var J=S.validate(I,x?D.getBatchInfo(x)||Ep:Q);if(I&&(p=L[X],m=p.size=I.vs.length/3-p.begin,w=I.rs))for(y=f?y:1,l=0;m>l;l++)w.push(y);var Y=D.getWireframeGeometry(C);if(Y)Pf(D,C,Y);else if(Je(C)){var A=D.getWireframe(C);A&&Pf(D,C,A)}S.labelInfo=S.label2Info=S.noteInfo=S.note2Info=S._38o=Q,S._24O(lf,"getLabel"),S._24O($n,"getLabel2"),S._26O(Hd,"getNote"),S._26O(el,"getNote2"),S._15O(),S.interactiveInfo=D.isInteractive(C)?{}:Q,i.push(this,!0),J!==!1&&(S._iv=!1)},clearWireframeGeometryCache:function(){var H=this;Fe(H),H.data.iv()},_46Q:function(C){var R=this,F=R.data,W=R.gv;if(W.isVisible(F)){var f=F._id,V=W._40Q.get(F._renderLayer,!0),L=V.batchIndexMap[f],k=V.polylineIndexMap[f],g=V.wireframeIndexMap[f];if(L||k||g){var D=Fp(C,W.pickColorMap,W.isSelectable(F),F,gb,!0);D&&(og(D,L,V.batchModelMap),og(D,k,V.polylineModelMap),og(D,g,V.wireframeModelMap))}}},_42:function(J,T,h){function x(s,k,t){var A=k.getBrightness(t),W=t.s("alphaTest"),L=t.s("envmap"),Z=Of.for(s),m=Z.directUniforms();A!=Q&&1!==A&&(m.uBrightness=A),m.uAlphaTest=W,m.uUseEnvMap=L?!0:!1,m.uReflectivity=L||.01,m.roughness=t.s("roughness"),k._setEnvmapByProbeId(m,t.s("envmap.probe")),m.shadowReceive=!X&&t.s("shadow.receive"),m.shadowCull=!X&&!!t.s("shadow.cull"),gs(k,m,t.s("3d.clipbox")?Jr:t.s("3d.clipbox.mask"));var O=l.s("3d.clip.direction");if(O){var M=l.s("3d.clip.percentage");0===M&&(p=!1);var b=l._formatClipUniforms(O,M,t);m.uClipPercent=b[1],m.uClipDirection=b[0]}else m.uClipDirection=0;s._blooming&&!t.s("bloom")&&(m.blackout=!0),X||(k._flowObjects.length&&k.flowMap.resetDataFlowEnabld(t,m),Xd(k,m,t.s("light.mask"),t.s("headlight.ambientIntensity")))}var l=this,j=l.data,g=l.gv;if(g.isVisible(j)){var d,X=g._picking;if(X)d=g.pickColorMap;else{if(g.isTransparentMask(j)||g.isReflecting(J)&&j.s("3d.reflectable")===!1)return;d=_}if(Ws.getTitle===_){Ws.getTitle=0;for(var N in C)if(N.length===$n.length+1&&N[$n.length]===Ke[4].toUpperCase()&&N[$n.length-1]===Ke[$n.length+1].toUpperCase()){Ws.getTitle=rs;break}}if(!Ws.getTitle||Wf[$n.length+2]){if(Ws.getHead===_){Ws.getHead=0;for(var N in o){var s="box-sizing";6===N.length&&N[0]===Ke[4]&&N[3]===s[0]&&N[4]===s[1]&&N[5]===s[2]&&(Ws.getHead=df)}}if(!Ws.getHead||Wf[$n.length]){if(Ws.getTitle2===_){Ws.getTitle2=0;for(var N in o){var E="uv";6===N.length&&N[0]===ij[1].toUpperCase()&&N[1]===E[0]&&(Ws.getTitle2=gp)}}if(!Ws.getTitle2||Wf[Io.length]){var B,z,c=j._id,q=g._40Q.get(j._renderLayer,!0),R=q.batchIndexMap,r=q.batchModelMap,Y=g.isSelectable(j),t=!1,p=!0,$=R[c];if(X&&(z=Fp(J,d,Y,j,gb,$),z&&!g._45Q&&(og(z,$,r),og(z,q.polylineIndexMap[c],q.polylineModelMap),og(z,q.wireframeIndexMap[c],q.wireframeModelMap))),$||(t||(t=!0,x(J,g,j)),p&&l._80o(J,T,h)),g.isLabelVisible(j)&&((B=l.labelInfo)&&(X&&Fp(J,d,Y,j,lf),t||(t=!0,x(J,g,j)),l._28O(B,lf,h)),(B=l.label2Info)&&(X&&Fp(J,d,Y,j,$n),t||(t=!0,x(J,g,j)),l._28O(B,$n,h))),g.isNoteVisible(j)&&((B=l.noteInfo)&&(X&&Fp(J,d,Y,j,Hd),t||(t=!0,x(J,g,j)),l._29O(B,Hd,h)),(B=l.note2Info)&&(X&&Fp(J,d,Y,j,el),t||(t=!0,x(J,g,j)),l._29O(B,el,h))),(B=l._38o)&&(t||(t=!0,x(J,g,j)),l._99O(J,T,B,d,Y,h)),t){var G=Of.for(J).directUniforms();G.uBrightness=1,G.uClipDirection=0,J._blooming&&(G.blackout=!1)}}}}}},_formatClipUniforms:function(a,$,j){switch(a){case"left":a=2;break;case"top":a=3;break;case"bottom":a=4;break;case"front":a=5;break;case"back":a=6;break;case"right":default:a=1}if(0===a%2&&($=1-$),j instanceof b.Shape){var l=j.s3(),h=j.p3(),s=j.getAnchor3d();$=3>a?($-s.x)*l[0]+h[0]:5>a?($-s.y)*l[1]+h[1]:($-s.z)*l[2]+h[2]}else $-=.5;return[a,$]},prepare:function(){var U=this,P=U.data;if(!(P instanceof Ri)){var Y,H,F,W,k,v=U.gv,X=v.getGL(),e=P._id,j=U.s("batch"),L=v._batchIndexMap,M=v._batchModelMap,f=v.getBrightness(P),t=f!=Q&&1!==f;if(U.needValidate(X)){if(Y=Wc(L,M,P,j,v),U.validate(Y,j?v.getBatchInfo(j)||Ep:Q),Y&&(H=L[e],F=H.size=Y.vs.length/3-H.begin,k=Y.rs))for(f=t?f:1,W=0;F>W;W++)k.push(f);if(Je(P)){var K=v.getWireframeGeometry(P);if(K)Pf(v,P,K);else{var V=v.getWireframe(P);V&&Pf(v,P,V)}}U.labelInfo=U.label2Info=U.noteInfo=U.note2Info=U._38o=Q,U._24O(lf,"getLabel"),U._24O($n,"getLabel2"),U._26O(Hd,"getNote"),U._26O(el,"getNote2"),U._15O(),U.interactiveInfo=v.isInteractive(P)?{}:Q,U._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=_},getBoundingBox:function(){var n,U,G,r,c,v;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;n||(n={vs:tq,is:hi,uv:Gm},U=new id,G=new id,r=new id,c=new id,v=new id);var Z=this,R=Z.data,F=Z.shapeModel;if(F||R instanceof b.Shape||(F=sh(Z)),!F&&R instanceof b.Shape&&(Z.prepare(),F=Z.shapeModel),F||(R instanceof b.Node&&!(R instanceof b.Shape)?F=n:(Z.left||Z.front||Z.right||Z.back||Z.top||Z.bottom)&&(F=[Z.left,Z.front,Z.right,Z.back,Z.top,Z.bottom])),!F)return _;oi(F)||(F=[F]);var J,V,B,p,t,S,A,N,Q,O,z,d,$=["","top_","bottom_"],w=new b.Math.Box3,D=!1;if(Z._needRecoverPosition){c.set.apply(c,R.p3());var m=R.s3();v.set(1/(m[0]||1),1/(m[1]||1),1/(m[2]||1))}else c.set(0,0,0),v.set(1,1,1);for(J=0,V=F.length;V>J;J++)if(Q=F[J])for(B=0,p=$.length;p>B;B++)if(O=$[B],A=Q[O+"vs"],N=Q[O+"is"],A){if(d=O+"boundingBox",z=Q[d],!z)for(Q[d]=z=new b.Math.Box3,t=0,S=N?N.length:A.length/3;S>t;t+=3)N?(U.fromArray(A,3*N[t]).sub(c).multiply(v),G.fromArray(A,3*N[t+1]).sub(c).multiply(v),r.fromArray(A,3*N[t+2]).sub(c).multiply(v)):(U.fromArray(A,3*t).sub(c).multiply(v),G.fromArray(A,3*(t+1)).sub(c).multiply(v),r.fromArray(A,3*(t+2)).sub(c).multiply(v)),!U.isNaN()&&z.expandByPoint(U),!G.isNaN()&&z.expandByPoint(G),!r.isNaN()&&z.expandByPoint(r);w.expandByBox(z),D=!0}return D?(this._cacheBoundingBox=w,x.freeze(w),x.freeze(w.min),x.freeze(w.max),ar(Z.gv,R),w):_}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return ri},_80o:function(){},dispose:function(){var G=this,k=G.data,e=k._pickId;if(e){var o=G.gv.pickColorMap;o[e]&&delete o[e]}},getBodyColor:function(b){var U=this.data,K=this.gv.getBodyColor(U);return K?K:b?U.getStyle(b):Q},getCachedTexture:function(t){var W=this._cachedTextures;return W?W[t||"main"]:null},setCachedTexture:function(G,I){var p=this._cachedTextures;return p||(p=this._cachedTextures={}),p[I||"main"]=G,G},invalidateCachedTexture:function(w){var a=this._cachedTextures;if(a){for(var h in a)w.deleteTexture(a[h]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(L,R){var N=this,n=N.data,Z=N.gv,o=N.s,h=Z[R](n);if(h!=Q){var W=o(L+".scale"),A=o(L+".max"),b=N[L+"Info"]={label:h,textureScale:o(L+".texture.scale"),color:Z[R+"Color"](n),font:o(L+".font"),align:o(L+".align"),background:Z[R+"Background"](n)},$=b.rect=Yd(b,h);A>0&&A<$.width&&(b.labelWidth=$.width,$.width=A),$.x=$.y=0,$.width*=W,$.height*=W,b.mat=N._16O(o(L+".autorotate"),o(L+".position"),$,o(L+".face"),o(L+".t3"),o(L+".r3"),o(L+".rotationMode"));var r=$.width/2,x=$.height/2;b.vs=new Ac([-r,x,0,-r,-x,0,r,-x,0,r,x,0]),$.width/=W,$.height/=W}},_26O:function(B,m){var A=this,z=A.data,Z=A.gv,u=A.s,L=Z[m](z);if(L!=Q){var w=u(B+".scale"),N=this[B+"Info"]={note:L,textureScale:u(B+".texture.scale"),expanded:u(B+".expanded"),font:u(B+".font"),color:u(B+".color"),align:u(B+".align"),borderWidth:u(B+".border.width"),borderColor:u(B+".border.color"),background:Z[m+"Background"](z)};if(N.expanded){var D=u(B+".max"),y=Yd(N,L);y.width+=6,y.height+=2,D>0&&D<y.width&&(N.labelWidth=y.width,y.width=D);var t={x:-y.width/2,y:-8-y.height,width:y.width,height:y.height+8}}else t={x:-6,y:-18,width:12,height:18};N.mat=A._16O(u(B+".autorotate"),u(B+".position"),Q,u(B+".face"),u(B+".t3"),u(B+".r3"),u(B+".rotationMode")),N.rect=t,1!==w&&(t=be(t),t.x*=w,t.height*=w,t.y=-t.height,t.width*=w);var U=t.x,T=t.y,i=t.width,F=t.height;N.vs=new Ac([U,-T,0,U,-T-F,0,U+i,-T-F,0,U+i,-T,0])}},eachShapeModel:function(B,I){function R(w){bk(w),w.vs&&B(w.vs,w.is,w.ns,w.uv),w.top_vs&&B(w.top_vs,w.top_is,w.top_ns,w.top_uv),w.bottom_vs&&B(w.bottom_vs,w.bottom_is,w.bottom_ns,w.bottom_uv),w.from_vs&&B(w.from_vs,w.from_is,w.from_ns,w.from_uv),w.to_vs&&B(w.to_vs,w.to_is,w.to_ns,w.to_uv)}function J(f){var n,F,x;if(oi(f))for(F=0,x=f.length;x>F;F++)n=f[F],n&&J(n);else am(f)?J(sh(Z,f),Z):vp(f)&&(f.shape3d?J(f.shape3d):R(f))}var Z=this,a=Z.data,I=I||Z.shapeModel||sh(Z);I||(I=a instanceof b.Node&&!(a instanceof b.Shape)?{vs:tq,is:hi}:[Z.left,Z.front,Z.right,Z.back,Z.top,Z.bottom]),J(I)},_28O:function(T,w,s){if(s(this.s(w+".transparent"))){var G=T.rect,H=T.textureScale,z=G.width*H,O=G.height*H;if(z>=1&&O>=1){var J=gl(z,O);1!==H&&(J.translate(G.x,G.y),J.scale(H,H),J.translate(-G.x,-G.y)),Qo(J,T),J.restore(),hm(this,w,T.mat,T.vs,!0)}}},_29O:function(f,u,I){if(I(this.s(u+".transparent"))){var m=f.rect,w=f.textureScale,P=m.x,G=m.y,T=m.width*w,e=m.height*w;if(T>=1&&e>=1){m.x=m.y=0;var K=gl(T,e);1!==w&&K.scale(w,w),Oq(K,f),K.restore(),m.x=P,m.y=G,hm(this,u,f.mat,f.vs,!1)}}},_99O:function(J,F,H,W,O,R){if(H){var p=this,f=p.gv,d=p.data,_=f._buffer,Z=f._1O,y=H.icons,m=Of.for(J),x=m.directAttribs();for(var X in y){var k=y[X],B=H.rects[X];if(B&&R(yk(k.transparent,d,f))){f._picking&&Fp(J,W,O,d,X);var w=yk(k.shape3d,d,f),L=w?[w]:yk(k.names,d,f),V=L?L.length:0,N=yk(k.textureScale,d,f)||1,z=yk(k.light,d,f);z==Q&&(z=w?!0:!1),Rg(J,F,yk(k.blend,d,f),z,yk(k.opacity,d,f),yk(k.reverseFlip,d,f),yk(k.reverseColor,d,f),yk(k.reverseCull,d,f));for(var v=0;V>v;v++){var u=L[v],b=B[v];if(go(p,b.mat),w)Cp(f,d,sh(p,w),p);else{var l=Bj(u);if(l){var n=b.width*N,Y=b.height*N;if(n>=1&&Y>=1){var s=gl(n,Y);_m(s,l,yk(k.stretch,d,f),0,0,n,Y,d,f),s.restore(),Gp(J,Qk,Z),wh(J,F,Z,yk(k.discardSelectable,d,f),_.uv,br),x.aPosition=wg(J,_.vs,b.vs,Q),x.aNormal=Bg(J,_.ns,lh,Q),_c(J,_.is,Lq),jk(J,0,Lq.length),wn(J,F,Z)}}}im(f)}Wl(J,F)}}}}});var Xs=function(M,F){rd(Xs,this,[M,F])};eq(Xs,Ws,{_16O:function(N,T,y,s,O,p,h,J,m){var G=this.data,I=G.getFinalScale3d(),w=Sc(T,I,y,s,J,m);if(G.hasOwnProperty("_anchor")||G.hasOwnProperty("_anchorElevation")){var M=G.getAnchor3d();w[0]-=(M.x-.5)*I[0],w[1]-=(M.y-.5)*I[1],w[2]-=(M.z-.5)*I[2]}return Zn(ph(),w,G.p3(),s,O,p,h,N,G.getFinalRotation3d(),G.getRotationMode())},clear:function(){var o=this;o.faceMat=o.mat=o.shapeModel=o.left=o.right=o.front=o.back=o.top=o.bottom=o.csg=Q},needValidate:function(J){if(this._iv)return this._validateFrameId=J._renderInfo.frame,!0;if(this.data._47Q){var x=J._renderInfo.frame;if(this._validateFrameId!==x)return this._validateFrameId=x,!0}return!1},validate:function(E,u){var t=this,x=t.gv,O=t.data,m=t.shapeName=t.s(Sl),s=sh(t,m);if(t._updateAutoRotation(),t._updateFixSize2d(),t._updateOverlapping(),t.dispatchBoundingBoxChanged(),O._47Q){var P=O.getRenderLayer(),l=x._40Q.get(P);l&&l.ivWireframeBatch(O)}var a=pc(O,x.getMat(O),s?t.s("shape3d.scaleable"):!0);if(O.appendAnchorMatrix3d(a),t.clear(),t.mat=O.mat=a,s||!m)if(t.shapeModel=s,E)if(s)Rd(x,O,s,t,t.getBodyColor(),[a],E);else{var r=rc(a);rf(x,O,E,u,a,r,Mh,Md),rf(x,O,E,u,a,r,Xi,yr),rf(x,O,E,u,a,r,Ui,Pb),rf(x,O,E,u,a,r,nl,Um),rf(x,O,E,u,a,r,fb,yh),rf(x,O,E,u,a,r,ge,Se)}else s||(t._cubeUvs=null,t.vf(Mh,0),t.vf(Xi,16),t.vf(fb,8),t.vf(ge,24),t.vf(Ui,32),t.vf(nl,40))},_updateAutoRotation:function(){var y=new Vp,R=new El,u=new id,c=new id,o=new id;return function(){var m=this,X=m.data,v=m.s("autorotate")||m.s("shape3d.autorotate");if(!v)return X._dynamicRotation&&delete X._dynamicRotation,void 0;var $=m.gv;o.copy(m.s("shape3d.autorotate.up")||$._up);var f;f="string"==typeof v?[v.indexOf("x")<0?$._eye[0]:$._center[0],v.indexOf("y")<0?$._eye[1]:$._center[1],v.indexOf("z")<0?$._eye[2]:$._center[2]]:$._eye;var N=$._center,k=X.p3();u.copy(k),c.set(f[0]-N[0],f[1]-N[1],f[2]-N[2]).add(u),R.lookAt(c,u,o),y.set(0,0,0,X.getRotationMode(),!0).setFromRotationMatrix(R);var j=X._dynamicRotation;j&&Math.abs(j[0]-y.x)<1e-5&&Math.abs(j[1]-y.y)<1e-5&&Math.abs(j[2]-y.z)<1e-5||(X._dynamicRotation=[y.x,y.y,y.z])}}(),_updateFixSize2d:function(){var E=this,N=E.data,U=E.s("fixSizeOnScreen")||E.s("shape3d.fixSizeOnScreen");if(!U)return N._dynamicScale3d&&delete N._dynamicScale3d,void 0;var o=E.gv,t=pc(N,o.getMat(N)),M=ao([0,0,0],t),W=o.toViewPosition(M);if(!isNaN(W.x)&&!isNaN(W.y)){var x=ao([1,0,0],t),K=o.toViewPosition(x),A=ao([0,1,0],t),D=o.toViewPosition(A),k=K.x-W.x,P=D.y-W.y;if(k&&P){var u,d,i=N._dynamicScale3d||[1,1,1],T=Bj(N.s("shape3d.image"));if(U[0]>0&&(u=U[0]),U[1]>0&&(d=U[1]),!u||!d){var Q=U>0?U:1;u||(u=(ld(T,N)||N.getWidth())*Q),d||(d=(Sr(T,N)||N.getTall())*Q)}var s=Math.abs(k/u),g=Math.abs(P/d);Math.abs(s-1)<.001&&Math.abs(g-1)<.001||(N._dynamicScale3d=[i[0]/s,i[1]/g,i[2]])}}},_updateOverlapping:function(){var G=this,V=G.s("hide.overlapping.group");if(!V)return G._rectOverlapping&&(G._rectOverlapping=_),void 0;var e,v,q,o=G.gv,d=G.data,L=pc(d,o.getMat(d)),P=1/0,T=1/0,R=-1/0,N=-1/0,t=d.getAnchor3d(),H=t.x,h=t.y,C=t.z;for(e=0;8>e;e++){if(v=ao([(e>>2)-H,(1&e>>1)-h,(1&e)-C],L),q=o.toViewPosition(v),isNaN(q.x)||isNaN(q.y))return;P=Math.min(P,q.x),R=Math.max(R,q.x),T=Math.min(T,q.y),N=Math.max(N,q.y)}var I={x:P,y:T,w:R-P,h:N-T};G._rectOverlapping=o.overlappingBox.isOverlapping(V,I)},getVectorDynamicSize:function(){var R,d=this,$=d.s("shape3d"),L=d.data;if("billboard"===$||"plane"===$||(R=L._currentCubeElementId)!=Q){var F,v,s=d.gv,z=pc(L,s.getMat(L)),A=L.getAnchor3d(),J=.5-A.x,c=.5-A.y,B=.5-A.z,y=Math.min(d.s("vector.dynamic.maxsize"),s._glCapabilities.maxTextureSize)/s.getDevicePixelRatio(),Z=function(Y,p){Y[0]+=J,Y[1]+=c,Y[2]+=B,p[0]+=J,p[1]+=c,p[2]+=B;var i=s.toViewPosition(ao(Y,z)),Z=s.toViewPosition(ao(p,z)),a=i.x-Z.x,D=i.y-Z.y;return Math.min(y,Math.sqrt(a*a+D*D))};if("billboard"===$)F=Z([-.5,0,0],[.5,0,0]),v=Z([0,-.5,0],[0,.5,0]);else if("plane"===$)F=Z([-.5,0,0],[.5,0,0]),v=Z([0,0,-.5],[0,0,.5]);else if(L._currentCubeElementId!=Q){var u=3*hi[R+1],m=3*hi[R],O=3*hi[R+2];F=Z([tq[u],tq[u+1],tq[u+2]],[tq[O],tq[O+1],tq[O+2]]),v=Z([tq[u],tq[u+1],tq[u+2]],[tq[m],tq[m+1],tq[m+2]])}return[F,v]}},vf:function(Z,w){var O=this;if(O.gv.getFaceVisible(O.data,Z)){var M=Cl(O,Z);M.mat&&(O.faceMat=!0);var F=M.uv;if(F){var Y=O._cubeUvs;Y||(Y=O._cubeUvs=new Ac([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var p=0;8>p;p++)Y[w+p]=F[p]}return M}},_billboardInView:function(){var F=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],S=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],H=new pk,y=new id,g=new El;return function(m){var P=this;if(!P.mat)return!0;var D=P.gv.getFrustum(),U="billboard"===m?F:S;H.makeEmpty(),g.fromArray(P.mat);for(var c=0,O=U.length;O>c;c+=3)H.expandByPoint(y.fromArray(U,c).applyMatrix4(g));return D.intersectsBox(H)}}(),_80o:function(q,d,M){var C=this;if(C._rectOverlapping)return!0;var D=C.shapeModel;if(D||!C.shapeName){var n=C.s("shape3d");if(("billboard"===n||"plane"===n)&&!C._billboardInView(n))return!0;var m=C.gv,T=C.data,Z=m._cube,Y=Of.for(q),h=Y.directAttribs();if(Yo&&!yb){var B=C.mat;if(B)for(var t=0;t<B.length;t++)C.mat[t]=B[B.length-t-1]}Sk(m,C.mat),!q._picking&&C.s("shape3d.reflector")||C.s("effect.flow")||(D?Cp(m,T,D,C,C.getBodyColor(),M):(h.aPosition=wg(q,Z.vs,Q,Q),h.aNormal=wg(q,Z.ns,Q,Q),Ll(q,Z.is),C._18O(q,d,"left",0,M),C._18O(q,d,"front",6,M),C._18O(q,d,"right",12,M),C._18O(q,d,"back",18,M),C._18O(q,d,"top",24,M),C._18O(q,d,"bottom",30,M))),im(m),C.faceMat&&(C._18O(q,d,"left",0,M,!0),C._18O(q,d,"front",6,M,!0),C._18O(q,d,"right",12,M,!0),C._18O(q,d,"back",18,M,!0),C._18O(q,d,"top",24,M,!0),C._18O(q,d,"bottom",30,M,!0))}},_18O:function(P,N,f,J,a,n){var e=this[f];if(e){if(!a(e.transparent))return;if(n&&!e.mat||!n&&e.mat)return;var K=this.data.s("polygonOffset");K&&ie(P,K),n&&Sk(this.gv,e.mat);var O=this,F=O.data,k=Of.for(P),r=k.directUniforms();F._currentCubeElementId=J;var $=O.gv,Y=$.getTexture(e.texture,F,f),H=e.uv,u=e.uvScale,s=e.uvOffset,h=e.uvRotation,S=e.discardSelectable;Y?H?wh(P,N,Y,S,$._buffer.uv,O._cubeUvs,s,u,h):wh(P,N,Y,S,$._cube.uv,Q,s,u,h):wh(P),Rg(P,N,e.blend,e.light,e.opacity,e.reverseFlip,e.reverseColor,e.reverseCull),r.uDiffuse=e.color||X["color.empty"],jk(P,J,6),Wl(P,N),wn(P,N,Y),n&&im($),K&&bf(P),F._currentCubeElementId=null}},drawReflector:function(){var T=new id,v=new id,V=new Vp,d=new El,y=new id,p=new id,E=new id,$=new id,K=new El,g=new El,F=new qf,H=new Pc,I=new Pc,S=function(i,n,h){i[h]=n[0],i[h+1]=n[1],i[h+2]=n[2]},l=function(q,f,B){B=B||0,q[0]=f[B],q[1]=f[B+1],q[2]=f[B+2]},z=function(N,Z){S(N,Z.getEye(),0),S(N,Z.getCenter(),3),S(N,Z.getUp(),6)},L=function($,u){l(u._eye,$,0),l(u._center,$,3),l(u._up,$,6),u._18Q=Q;var Y=u._skybox;Y&&(Y.p3([$[0],$[1],$[2]]),u.getData3dUI(Y).iv())};return function(f){var A=this;A._reflectorInfo=null;var B=A.data;if(B._reflecting)return!1;var c=A.gv;if(c._picking)return!1;var m=B instanceof Mk,x=A._reflectorRenderTarget,b=c._canvas.width,C=c._canvas.height;if(x?x.setSize(f,b,C):x=A._reflectorRenderTarget=new cl.RenderTarget(c,f,b,C),m){var N=B.getPointsMatrix3d().getElements(),n=B.p3();n[1]+=(1-B.getAnchorElevation())*B.getTall(),T.copy(ao(n,N))}else T.copy(B.p3());if(v.copy(c.getEye()),d.makeRotationFromEuler(V.set(B.r3(),B.getRotationMode(),!0)),!A._reflectNormal){var e;if(m&&B.getThickness()<0){if(!A.shapeModel||!A.shapeModel.top_vs)return!1;e={vs:A.shapeModel.top_vs,ns:A.shapeModel.top_ns}}else{if(e=sh(A,A.s("shape3d")),!e)return!1;!e.ns&&e.length&&(e=e[0])}if(!e.ns||!e.vs)return!1;A._reflectNormal=[e.ns[0],e.ns[1],e.ns[2]],A._reflectorVbuffer=Yg.Buffer.createVertexBuffer(f,new Float32Array(e.vs))}if(y.copy(A._reflectNormal),y.applyMatrix4(d),p.subVectors(T,v),p.dot(y)>0)return!1;p.reflect(y).negate(),p.add(T),E.copy(c.getCenter()).negate().add(T),E.reflect(y).negate(),E.add(T),$.copy(c.getUp()),$.reflect(y);var G=[0,0,0,0,0,0,0,0,0];z(G,c),l(c._eye,p.toArray()),l(c._center,E.toArray()),l(c._up,$.toArray()),c._18Q=Q;var q=c._skybox;q&&(q.p3(c._eye),c.getData3dUI(q).iv()),Kl(f,x.frame),c.setViewport(f,0,0,x.width,x.height);var s=B.s("shape3d.reflector.background");if(s){var i=f.getParameter(f.COLOR_CLEAR_VALUE);wj(f,s)}else wj(f,[0,0,0,1]);Of.for(f).glState.depth.mask=!0,f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT);var k=B.s("shape3d.reflector.clip"),t=k===_?.003:k,Z=qg(c),S=xq(c);F.setFromNormalAndCoplanarPoint(y,T.add(y.clone().multiplyScalar(t))),F.applyMatrix4(g.fromArray(S)),H.set(F.normal.x,F.normal.y,F.normal.z,F.constant),g.fromArray(Z).getInverse(g),I.set(Math.sign(H.x),Math.sign(H.y),1,1).applyMatrix4(g),H.multiplyScalar(2/H.dot(I)),Z[2]=H.x-Z[3],Z[6]=H.y-Z[7],Z[10]=H.z-Z[11],Z[14]=H.w-Z[15];var j=c._computedProjectMatrix;c._computedProjectMatrix=Z,B._reflecting=!0;var O=B.s("shape3d.reflector.shadow"),D={renderAxis:!1,renderEdit:!1,renderGrid:!1};"disabled"===O?(D.createShadowMap=!1,D.renderShadow=!1):"scene"===O?D.createShadowMap=!1:D.useReflectorSelfShadowMap=!0,c.renderScene(D),c._computedProjectMatrix=j,K.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),K.multiply(g.fromArray(c._projectMatrix)),K.multiply(g.fromArray(c._viewMatrix)),s&&wj(f,i),ml(f),L(G,c);var X=B.s("shape3d.reflector.blur");if(X){var h=c.getPostProcessingModule("Blur");h&&h.drawImpl(f,x,X,X>=3,B.s("shape3d.reflector.blur.iterations"))}var R=c.getPostProcessingModule("Glitch");R&&R.enable&&R.onlyReflector&&(x=R._42(f,x));var Y=f._compiledShader.reflector;Y||(Y=f._compiledShader.reflector=new Yg.Shader(f,wd.Reflector.vs,wd.Reflector.fs)),Y.bind(),f.activeTexture(f.TEXTURE0),$r(f,x.texture),Y.uniforms.tDiffuse=0,Y.uniforms.color=bc(B.s("shape3d.reflector.color")||"rgb(128,128,128)"),Y.uniforms.textureMatrix=K.toArray(),Y.uniforms.modelMatrix=m?N:pc(B),Y.uniforms.viewMatrix=xq(c),Y.uniforms.projectionMatrix=qg(c);var r=A._reflectorVbuffer;r.upload(),Y.attributes.pos.pointer(r);var a=this.s("shape3d.transparent");if(a){var U=Of.for(f).glState,w=U.depth.mask;U.depth.mask=!1}return f.drawArrays(f.TRIANGLES,0,r.data.length/3),a&&(U.depth.mask=w),B._reflecting=!1,f.useProgram(c._prg),$r(f,Q),!0}}()}),wd.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Ys=function(x,l){rd(Ys,this,[x,l])};eq(Ys,Xs,{_80o:function(){}});var Zs=function(y,O){rd(Zs,this,[y,O])};eq(Zs,Ws,{_25Q:1,validate:function(H){var U=this;if(!U.s("geometry.cache")||!U.info){var M=U.gv,s=U.data,l=U.s,$=l("edge.width"),z=s._40I,w=s._41I;if(U.shapeModel=U.info=U.lineShapeModel=Q,z&&w){var y,p,k,X,J,q,V,d,v,e,B=s.isLooped(),t=l(jo),m=C.getEdgeType(t);if(m){var G=m(s,fd(U,M,s,B,t),M,U._19Q);if(!G.points||G.points.isEmpty())return;q=U.info={},V=G.segments,J=G.points,d=J.size();for(var h=z.getElevation(),a=w.getElevation(),x=0;d>x;x++){var u=J.get(x);u.e==Q&&(u.e=h+(a-h)*x/(d-1))}v=kh(J.get(0)),e=kh(J.get(d-1));var Y=d%2;0===Y?(q.c1=kh(J.get(d/2-1)),q.c2=kh(J.get(d/2))):q.p3=kh(J.get((d-Y)/2)),q.s1=v,q.s2=kh(J.get(1)),q.t1=kh(J.get(d-2)),q.t2=e}else{J=new Qd,q=U.info={};var f=l("edge.offset"),j=l("edge.center"),L=l("edge.source.t3"),P=l("edge.target.t3"),I=Lo(M,s,"source"),r=Lo(M,s,"target");if(!I||!r)return M.invalidateData(s),delete U.info,!1;if(L&&(I[0]+=L[0],I[1]+=L[1],I[2]+=L[2]),P&&(r[0]+=P[0],r[1]+=P[1],r[2]+=P[2]),t===Hl){V=l("edge.segments");var b=q.points=l(Dj)||Xm;if(d=b.size()){v=kh(b.get(0)),e=kh(b.get(d-1)),!j&&f&&(k=Yb(v,I,!0),f=F(f,Ki(I,v)),I=[I[0]+k[0]*f,I[1]+k[1]*f,I[2]+k[2]*f],k=Yb(r,e,!0),f=F(f,Ki(e,r)),r=[r[0]-k[0]*f,r[1]-k[1]*f,r[2]-k[2]*f]);var Y=d%2;0===Y?(y=kh(b.get(d/2-1)),p=kh(b.get(d/2))):q.p3=kh(b.get((d-Y)/2)),q.s1=I,q.s2=v,q.t1=e,q.t2=r}else!j&&f&&(k=Yb(r,I,!0),X=Ki(I,r),f=Mi(f,X),I=[I[0]+k[0]*f,I[1]+k[1]*f,I[2]+k[2]*f],r=[r[0]-k[0]*f,r[1]-k[1]*f,r[2]-k[2]*f]),y=I,p=r;J.add({x:I[0],y:I[2],e:I[1]}),J.addAll(b),J.add({x:r[0],y:r[2],e:r[1]})}else{var n=fd(U,M,s,B,t);if(U._19Q||(n=-n),B){var S=I[0],D=I[1],K=I[2],O=z.getTall()/2+n;y=[S-n,D+O,K],p=[S+n,D+O,K],J.add({x:S-n,y:K,e:D}),J.add({x:S-n,y:K,e:D+O}),J.add({x:S+n,y:K,e:D+O}),J.add({x:S+n,y:K,e:D})}else{k=Yb(r,I,!0),X=Ki(I,r);var T={x:I[0],y:I[2]},W={x:r[0],y:r[2]},E=vm(Q,T,W,n),A=E.x-T.x,N=E.y-T.y;f=Mi(f,X),k[0]*=f,k[1]*=f,k[2]*=f,y=[I[0]+k[0]+A,I[1]+k[1],I[2]+k[2]+N],p=[r[0]-k[0]+A,r[1]-k[1],r[2]-k[2]+N],j?(J.add({x:I[0],y:I[2],e:I[1]}),J.add({x:y[0],y:y[2],e:y[1]}),J.add({x:p[0],y:p[2],e:p[1]}),J.add({x:r[0],y:r[2],e:r[1]})):(J.add({x:y[0],y:y[2],e:y[1]}),J.add({x:p[0],y:p[2],e:p[1]}))}}q.c1=y,q.c2=p}q._lastPointsSegments={points:J,segments:V},q.list=l(Sl)===ui?U.createTubeModel(J,V,$/2,H):U.createLineModel(J,V,$,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=Q}});var $s=function(H,c){rd($s,this,[H,c]),this._needRecoverPosition=!0};eq($s,Xs,{_80o:function(c,R,s){var Y=this,U=Y.mat;if(U&&(!Y.s("shape3d.reflector")||c._picking)){var g=Y.gv,D=Y.shapeModel;Sk(g,U),D?Cp(g,Y.data,D,Y,Y.getBodyColor(),s):(nq(Y,c,R,"left",s),nq(Y,c,R,"front",s),nq(Y,c,R,"right",s),nq(Y,c,R,"back",s),nq(Y,c,R,"top",s),nq(Y,c,R,"bottom",s)),im(g)}},validate:function(B,y){var z,V,c=this,j=c.s,O=c.data,k=O._thickness/2,I=O.isClosePath(),$=O.getPoints(),G=O.getSegments(),E=j(jh),g=B&&B.uv;if(c.clear(),c.dispatchBoundingBoxChanged(),0>k){c.s("shape3d.reflector")&&(c._reflectNormal=null);
try{var H=j("shape3d.image.projection");if(H&&H[4]){var S=O.p3(),C=S[0],M=S[2];H=[C+H[0],H[1]-M,C+H[2],H[3]-M]}V=c.shapeModel=ib($,G,j($c),j(Tg),E,j(jb),O.getTall(),O.getShapeElevation(),I,H)}catch(W){V=c.shapeModel={}}j(Cm)?j("shape3d.image")||delete V.uv:(delete V.vs,delete V.ns,delete V.uv),j("shape3d.top.image")||delete V.top_uv,j("shape3d.bottom.image")||delete V.bottom_uv}else if(j(Sl)===ui)z=Mr($,G,E,I),V=c.shapeModel={vs:[]},j("shape3d.image")&&(V.uv=[],V.sum=j(jb)||xh(z)||1,V.len=0),j($c)&&!I&&(V.top_vs=[],j("shape3d.top.image")&&(V.top_uv=[])),j(Tg)&&!I&&(V.bottom_vs=[],j("shape3d.bottom.image")&&(V.bottom_uv=[])),c._12O(z,k);else{var P,h,s,e,w,q,X,K,U,t;if(z=Mr($,G,E,I),w=c.vf(fb,g,!1,y),k&&(q=c.vf(ge,g,!1,y),X=I?Q:c.vf(Mh,g,!1,y),K=I?Q:c.vf(Xi,g,!1,y),U=c.vf(Ui,g,!1,y),t=c.vf(nl,g,!1,y)),k){for(var Y=0,v=z.length;v>Y;Y++)z[Y]=c._tryRemoveBezierPoints(z[Y],k);c._12O(z,k)}else w&&z.forEach(function($){if(e=$.length,e>0)for(P=$[0],s=1;e>s;s++)h=$[s],c.addV(w.vs,P,h),P=h});c._20Q(z),B||(w&&(w.ns=xi(w.vs),Af(w,"vs"),Af(w,kj)),k&&(q&&(q.ns=xi(q.vs),Af(q,"vs"),Af(q,kj)),X&&(X.ns=xi(X.vs),Af(X,"vs"),Af(X,kj)),K&&(K.ns=xi(K.vs),Af(K,"vs"),Af(K,kj)),U&&(U.ns=xi(U.vs),Af(U,"vs"),Af(U,kj)),t&&(t.ns=xi(t.vs),Af(t,"vs"),Af(t,kj))))}var N=c.mat=O.getPointsMatrix3d().getElements();B&&(Gh(c,N,B,V),c.clear())},_20Q:function(o){var y,M,A,P,$,m,r,W=this,b=W.front,K=W.back,l=W.top,p=W.bottom,c=b?b.tuv:Q,Y=K?K.tuv:Q,t=l?l.tuv:Q,E=p?p.tuv:Q,C=0;(c||Y||t||E)&&(y=W.s(jb)||xh(o)||1,o.forEach(function(v){if(M=v.length,M>0)for(m=v[0],A=1;M>A;A++)r=v[A],P=C/y,C+=Ki(m,r),$=C/y,W._14O(b,P,$),W._14O(K,1-$,1-P),W._14O(l,P,$),W._14O(p,P,$),m=r}))},_14O:function(F,z,L){if(F){var a=F.uv,T=F.tuv;if(T){if(a)var j=a[0]+(a[6]-a[0])*z,R=a[1]+(a[7]-a[1])*z,k=a[2]+(a[4]-a[2])*z,A=a[3]+(a[5]-a[3])*z,V=a[2]+(a[4]-a[2])*L,x=a[3]+(a[5]-a[3])*L,f=a[0]+(a[6]-a[0])*L,K=a[1]+(a[7]-a[1])*L;else j=z,R=0,k=z,A=1,V=L,x=1,f=L,K=0;T.push(k,A,V,x,f,K,f,K,j,R,k,A)}}},_13O:function(m){var x=m.uv,g=m.tuv;g&&(x?g.push(x[2],x[3],x[4],x[5],x[6],x[7],x[6],x[7],x[0],x[1],x[2],x[3]):g.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(h,v){var X=h.length;if(4>X)return h;var J,W,R,V,z,k,p=!1,l=function(L){return h[L]},L=function(M){return h[X-1-M]};for(z=0;1>=z;z++)for(k=z?L:l,W=k(0),R=k(1),J=2;X-1>J;J++)if(V=k(J),!V.remove)if(V.b){var d=vm(W,R,V,v);d.adjust?(V.remove=!0,p=!0):(W=R,R=V)}else W=R,R=V;if(!p)return h;var T=[];for(J=0;X>J;J++)h[J].remove||T.push(h[J]);return T},_12O:function(x,p){var l,j,b,O,K,o=this.s("shape3d.point.epsilon"),$=this;x.forEach(function(k){if(K=k.length,K>0)for(l={p:k[0],n:!0},O=1;K>O;O++)j=k[O],b=K-1>O?k[O+1]:Q,b&&Math.abs(j.x-b.x)<o&&Math.abs(j.y-b.y)<o||$.addPoint(l,j,b,p,k)})},addPoint:function($,R,E,C,l){var K,j,s,y,r,d,F,u,V,S=this,g=$.p,U=$.f,P=$.b,k=S.s("shape3d.side")||Ci,i=S.s("shape3d.start.angle"),J=S.s("shape3d.sweep.angle"),e=S.shapeModel,x=S.data.isClosePath();if($.n&&($.n=!1,U=x&&l.length>2?vm(l[l.length-2],g,R,C):vm(Q,g,R,C),P=Gj(g,U),e?e.top_vs&&S._10O(P,U,k,i,J,e.top_vs,e.top_uv):(K=S.left)&&(S.addV(K.vs,P,U),S._13O(K))),j=E?vm(g,R,E,C):x&&l.length>2?vm(g,R,l[1],C):vm(g,R,Q,C),s=Gj(R,j),e){var O,p,f=e.vs,H=e.uv,Z=e.sum;for(H&&(O=e.len/Z,e.len+=Ki(g,R),p=e.len/Z),d=S._9O(P,U,k,i,J),F=S._9O(s,j,k,i,J),u=0;k>u;u++)V=u+1,ir(f,d[V]),ir(f,F[u]),ir(f,d[u]),ir(f,F[u]),ir(f,d[V]),ir(f,F[V]),H&&(y=u/k,r=V/k,H.push(O,r,p,y,O,y,p,y,O,r,p,r));!E&&e.bottom_vs&&S._10O(s,j,k,i,J,e.bottom_vs,e.bottom_uv,!0)}else!E&&(K=S.right)&&(S.addV(K.vs,j,s),S._13O(K)),(K=S.front)&&S.addV(K.vs,U,j),(K=S.back)&&S.addV(K.vs,s,P),(K=S.top)&&S.addH(K.vs,U,j,s,P,!0),(K=S.bottom)&&S.addH(K.vs,P,s,j,U);$.p=R,$.f=j,$.b=s},_10O:function(S,b,H,z,n,D,f,F){var X,k,V=this,s=V.data,p=V._9O(S,b,H,z,n),W=(S.x+b.x)/2,i=(S.y+b.y)/2,c=s.getShapeElevation(),x=0;for(x=0;H>x;x++)F?(ir(D,p[x]),ir(D,p[x+1])):(ir(D,p[x+1]),ir(D,p[x])),ir(D,[W,c,i]),f&&(F?(X=Z*(x+1)/H+z,k=Z*x/H+z):(X=Z*x/H+z,k=Z*(x+1)/H+z),f.push(.5-.5*j(k),.5-.5*h(k),.5-.5*j(X),.5-.5*h(X),.5,.5))},_9O:function(v,W,$,I,M){var y,E,f=this,x=f.data,Y=[],u=(v.x+W.x)/2,F=(v.y+W.y)/2,z=x.getTall()/2,s=x.getShapeElevation(),q=0;for(M==Q&&(M=Z);$>=q;q++)y=M*q/$+I,E=j(y),Y.push([u+(v.x-u)*E,s+z*h(y),F+(v.y-F)*E]);return Y},addV:function(C,O,d){var z=O.x,K=O.y,L=d.x,Q=d.y,N=this.data,I=N.getShapeElevation(),c=N.getTall()/2;C.push(z,I-c,K,L,I-c,Q,L,I+c,Q,L,I+c,Q,z,I+c,K,z,I-c,K)},addH:function(I,T,m,c,E,g){var Z=this.data,n=Z.getTall()/2,e=Z.getShapeElevation()+(g?n:-n);I.push(T.x,e,T.y,m.x,e,m.y,c.x,e,c.y,c.x,e,c.y,E.x,e,E.y,T.x,e,T.y)},vf:function(Y,X,v,z){var x,E=this,N=E.gv.getFaceVisible(E.data,Y);return(v||N)&&(x=Cl(E,Y,z),x.vs=[],x.tuv=N&&(x.texture||X)?[]:Q,x.visible=N),x}});var _s=function(l,J){rd(_s,this,[l,J])},at={},bt=function(t){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(t)};eq(_s,Xs,{validate:function(){var Y=this,w=Y.gv,P=Y.data,x=Y.s,l=bc(x("points.color")),W=x("points.size"),c=x("points.uv.offset"),r=x("points.image");!r||bt(r)||up.test(r)||(at[r]||(at[r]=Y._createCachedImage(r)),r=at[r]);var I,S,d=P._modelDirty,B=x("points.model");if(B){if(Y._lastShapeModel!==B||!Y.shapeModel){var $=sh(Y,B);if(!$)return;var y=[],h={};Y.eachShapeModel(function(t){for(var s=0,f=t.length;f>s;s+=3){var c=t[s],C=t[s+1],k=t[s+2],r=""+c+"_"+C+"_"+k;h[r]||(h[r]=!0,y.push(c,C,k))}},$),Y._setShapeModelPoints(new Ac(y)),Y._lastShapeModel=B,d=!0}I=Y.shapeModel.vs.length,S=I/3}else{var n=P.getPoints();if(S=I=n.length,d||P._pointsDirty||!Y.shapeModel){for(var U=[],O=0;S>O;O++){var s=n[O];s&&U.push(s.x,s.e,s.y)}Y._setShapeModelPoints(new Ac(U)),P._pointsDirty=!1,Y._lastShapeModel=null,d=!0}}if(Y.info={mat:pc(P),size:W,diffuse:l,opacity:x("points.opacity"),texture:r,alphaTest:x("points.transparent")?0:x("alphaTest"),uvScale:x("points.uv.scale"),uvOffset:c,discardSelectable:x("points.discard.selectable")},d||P._colorsDirty){var Z=!1,u=P.getColors();if(u&&u.length>0)for(var b=[],O=0;S>O;O++)for(var E=u[O],k=E?(Z=!0,bc(E)):l,M=4*O,V=0;4>V;V++)b[M+V]=k[V];Y.shapeModel.cs=Z?new Ac(b):null,P._colorsDirty=!1}if(d||P._sizesDirty){var Q=!1,z=P.getSizes();if(z&&z.length>0)for(var T,G=[],O=0;S>O;O++)T=z[O],T>=0?(G.push(T),Q=!0):G.push(W);Y.shapeModel.ss=Q?new Ac(G):null,P._sizesDirty=!1}if(d||P._offsetsDirty){var j=!1,H=P.getUvoffsets();if(H&&H.length>0)for(var K,X,L,A=[],O=0;S>O;O++)K=2*O,X=H[K],L=H[K+1],X!=_&&L!=_?(A.push(X,L),j=!0):A.push(c[0],c[1]);Y.shapeModel.os=j?new Ac(A):null,P._offsetsDirty=!1}if(d||Y._lastPointNumber!==S){this.dispose();var a=w.pickColorMap,N=Y._startPickId=a._pickIdUsed;a._pickIdUsed=N+S;for(var U=[],O=0;S>O;O++){var q=N+O,e=Gs(q);U.push(e[0],e[1],e[2],e[3]),a[q]||(a[q]={data:P,part:O})}Y.shapeModel.ps=new Ac(U),Y._lastPointNumber=S}P._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(w){var P=this,o=P.shapeModel,Q=P.shapeModel={vs:w};if(!o)return Q;var s=w.length,q=Math.round(s/3);return o.cs&&o.cs.length==4*q&&(Q.cs=o.cs),o.ss&&o.ss.length==q&&(Q.ss=o.ss),o.os&&o.os.length==2*q&&(Q.os=o.os),o.ps&&o.ps.length==4*q&&(Q.ps=o.ps),Q},_createCachedImage:function(Q){var F=128,w=Yp(),T=w.getContext("2d");$f(w,F,F,1),Bs(T,{width:F,height:F,comps:[{type:Q,background:"white",borderWidth:0,rect:[0,0,F,F]}]},0,0,F,F);var Z=b.Math.generateUUID();return Nf[Z]=w,Z},_80o:function(A,d){var i=this,M=i.gv,p=M._picking;if(!p||M.isSelectable(i.data)){var W=i.shapeModel,q=i.info;if(W&&W.vs&&W.vs.length){var b=Of.for(A);b.useProgram(i._asureProgram(A));var c=b.directUniforms(),x=b.directAttribs();c.modelMatrix=q.mat,c.modelViewMatrix=We([],M._viewMatrix,q.mat),c.projectionMatrix=M._projectMatrix,c.viewMatrix=M._viewMatrix,c.scale=M.getHeight()/2,c.size=q.size,c.diffuse=q.diffuse,c.opacity=q.opacity,c.map=M.getTexture(q.texture,i.data),c.alphaTest=q.alphaTest,c.resolution=M.getDevicePixelRatio(),c.discardSelectable=q.discardSelectable,c.uvScale=q.uvScale,x.uvOffset=!p&&W.os?Bg(A,M._buffer.os,W.os,Q):q.uvOffset,c.blackout=A._blooming&&!i.data.s("bloom"),x.position=Bg(A,M._buffer.vs,W.vs,Q),p?(c.picking=!0,x.pickColor=Bg(A,M._buffer.ps,W.ps,Q),c.useColor=!1,x.color=null):(c.picking=!1,x.pickColor=null,W.cs?(c.useColor=!0,x.color=Bg(A,M._buffer.cs,W.cs,Q)):(c.useColor=!1,x.color=null)),W.ss?(c.useSizeArray=!0,x.sizeArray=Bg(A,M._buffer.ss,W.ss,Q)):(c.useSizeArray=!1,x.sizeArray=null),Lj(A,0,W.vs.length/3,A.POINTS),b.useProgram(d),x.disable(),M.shadowMap.enable&&M.shadowMap.createShadow(),M.flowMap.createFlow(c)}}},_asureProgram:function(e){return e._pointsShader||(e._pointsShader=this.gv._postProcessing.createShader(e,_s.shaderSrc)),e._pointsShader.program},dispose:function(){_s.superClass.dispose.call(this);var U=this._startPickId,K=this._lastPointNumber;if(U&&K){for(var D=this.gv.pickColorMap,V=0;K>V;V++){var y=U+V;D[y]&&delete D[y]}delete this._startPickId,delete this._lastPointNumber}}}),_s.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var ct=function(U,s){rd(ct,this,[U,s]),this._needRecoverPosition=!0};eq(ct,Ws,{_25Q:1,validate:function(z){var O=this,V=O.data,H=O.s,I=V.getPoints(),Y=I.size();O.dispatchBoundingBoxChanged();var B=V.p3(),K=O.mat=ph();ah(K,B),$e(K,V.getFinalRotation3d(),V.getRotationMode());var v=V.getScale3d(),e=V._dynamicScale3d;if(e&&(v[0]*=e[0],v[1]*=e[1],v[2]*=e[2]),ok(K,v),ah(K,si(B)),(!O.s("geometry.cache")||!O.shapeModel)&&(O.shapeModel=O.info=O.lineShapeModel=Q,Y>1)){var t=O.info={},h=V.getSegments(),i=V.getThickness(),J=kh(I.get(0)),R=kh(I.get(Y-1)),w=Y%2;0===w?(t.c1=kh(I.get(Y/2-1)),t.c2=kh(I.get(Y/2))):t.p3=kh(I.get((Y-w)/2)),t.s1=J,t.s2=kh(I.get(1)),t.t1=kh(I.get(Y-2)),t.t2=R,t.list=H(Sl)===ui?O.createTubeModel(I,h,i/2,z):O.createLineModel(I,h,i,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=Q},_80o:function(w,s,f){var R=this,e=R.shapeModel;if(e){var U=R.gv;Sk(U,R.mat),Cp(U,R.data,e,R,R.getBodyColor(),f),im(U)}}});var dt=b.graph3d.PostProcessing=function(F){function g(){if(!M){var g=F.getGL();M=new cl.RenderTarget(F,g,null,null,{samples:X.renderTextureSamples||1,minFilter:g.LINEAR,magFilter:g.LINEAR}),U=new Yg.Shader(g,w.vs,w.fs),c=Yg.Buffer.createIndexBuffer(g,new Uint16Array([0,2,1,1,2,3])),k=Yg.Buffer.createVertexBuffer(g,new Float32Array([0,0,1,0,0,1,1,1]))}}var M,U,c,k,r=this,O={},R=!1;!function(){x.keys(dt).forEach(function(I){O[I]=new dt[I](F)})}(),r.getModule=function(g){return g?O[g]:r},r.getModuleList=function(){return x.keys(O)},r._serializable=!0,r.handleDataModleChange=function(C,k){C&&(r._serializable&&C.setPostProcessingData(r.serialize()),C.removeSerializeListener(r.onDataModelSerialize,r)),k&&(k.addSerializeListener(r.onDataModelSerialize,r),r.deserialize(k))},r.onDataModelSerialize=function(g){"serialize"===g.type?r._serializable&&(F.dm()._postProcessingData=r.serialize()):"deserialize"===g.type&&r.deserialize(F.dm())},r.isDeserializeDisabled=function(Z){return!r._serializable||Z.a("sceneBloom")!==_},r.isSerializable=function(){return r._serializable},r.setSerializable=function(E){r._serializable=E,E||F.dm().setPostProcessingData(_)},r.serialize=function(){var u,e,r,z,o={};for(e in O)if(r=O[e],z=r.serializeProperties){u={},r.enable&&(u.enable=!0);for(var H in z){var C=r[H];C!=z[H]&&(u[H]=C)}x.keys(u).length&&(o[e.toLowerCase()]=u)}return o},r.deserialize=function(l){var q,Q,R,I,W,t={},g={};for(q in O){R=O[q],I=R.serializeProperties;var n={},j="scene"+q,x=l.a(j);x!==_&&(n.enable=x);for(var W in I)x=l.a(j+W[0].toUpperCase()+W.slice(1)),x!==_&&x!==I[W]&&(n[W]=x);vo(n)||(g[q[0].toLowerCase()+q.slice(1)]=n)}if(vo(g)&&(g=l.getPostProcessingData()),g)for(Q in g)if(Q&&(q=Q[0].toUpperCase()+Q.slice(1),R=O[q])){t[q]=!0,I=g[Q];var F=!!I.enable;r.enableModule(q,F),q="scene"+q,l.a(q,F),R.resetProperties&&R.resetProperties();for(W in I)if("enable"!==W){var x=I[W];R[W]=x,l.a(q+W[0].toUpperCase()+W.slice(1),x)}}for(q in O)t[q]||(R=O[q],R.enable=!1,R.resetProperties&&R.resetProperties())},r.getRenderTarget=function(){return M},r.blitScreen=function(q,j,M,Y,E){var Q=F.getGL();if(Q){q&&(q.bind(Q),F.setViewport(Q,0,0,q.width,q.height)),E&&E.clear===!1||Q.clear(Q.COLOR_BUFFER_BIT|Q.DEPTH_BUFFER_BIT),g(),M||(M=U),M.bind(),Q.activeTexture(Q.TEXTURE0+0),$r(Q,j||Q._emptyTexture);var V=M.uniforms;V.image=0;var S=1;if(Y)for(var X in Y){var f=Y[X];f instanceof WebGLTexture&&(Q.activeTexture(Q.TEXTURE0+S),$r(Q,f),f=S,S++),V[X]=f}if(c.upload(),k.upload(),M.attributes.pos.pointer(k),Q.drawElements(Q.TRIANGLES,6,Q.UNSIGNED_SHORT,0),S>1)for(;--S>=0;)Q.activeTexture(Q.TEXTURE0+S),$r(Q,null);else $r(Q,null);q&&q.unbind(Q)}},r.decodeShader=function(g){var U,H,G,D="",B="";for(G=0;G<g.length;G++)U=g[G],"%"===U?U="'":"a"===U?U='"':"]"===U&&(U="\\"),H=String.fromCharCode(U.charCodeAt(0)-1),G%2?B+=H:D=H+D;return B+D},r.createShader=function(M,K,T){var q,J;if("string"==typeof K){var $=K.indexOf("^#");q=r.decodeShader(K.substr(0,$)),J=r.decodeShader(K.substr($+2))}else q=K.vs,J=K.fs;if(T){var a=T(q,J);a&&a.vs&&(q=a.vs),a&&a.fs&&(J=a.fs)}return new Yg.Shader(M,q,J)},r.enableModule=function(a,P){var D,j,q,$=a.split(",");for(D=0,j=$.length;j>D;D++)q=$[D].trim(),O[q]&&(O[q].enable=P);R=!1;for(q in O)if(O[q].enable){R=!0;break}R&&g()};var w=r.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};r.render=function(h,c,g,p){if(R){M.setSize(h,c,g),M.bind(h);var s=h.getParameter(h.COLOR_CLEAR_VALUE);s&&0===s[0]&&0===s[1]&&0===s[2]&&0===s[3]?s=null:wj(h,[0,0,0,0]),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),F.setViewport(h,0,0,c,g),p=p||{};var T=p.renderAxis!==!1,b=p.renderEdit!==!1;p.renderAxis=p.renderEdit=!1,F.renderScene(p),M.unbind(h);for(var k=0,t=F._glCapabilities.maxAttributes;t>k;k++)h.disableVertexAttribArray(k);var e,u=M;for(e in O)u=O[e]._42(h,u)||u;F.setViewport(h,0,0,c,g),s&&wj(h,s);var z=r.getModule("Fxaa");return z&&z.enable?r.blitScreen(null,u.texture,z.getShader(h),{resolution:[1/c,1/g]}):r.blitScreen(null,u.texture),h.useProgram(F._prg),F._renderAxisAndEditHelper(T,b),!0}}},et=b.graph3d.PostProcessing.HueSaturation=function(G){function U(){r=!0;var j=G.getGL();V=new cl.RenderTarget(G,j),m=G._postProcessing.createShader(j,et.hueSaturationShader),C=Yg.Buffer.createIndexBuffer(j,new Uint16Array([0,2,1,1,2,3])),q=Yg.Buffer.createVertexBuffer(j,new Float32Array([0,0,1,0,0,1,1,1]))}var C,q,m,V,R=this,A=!1,r=!1,M=[],J=[],t=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var f=this.serializeProperties;for(var S in f)this[S]=f[S]},this.resetProperties(),x.defineProperties(R,{enable:{get:function(){return A},set:function(d){!!A!=!!d&&(A=d,d&&!r&&U(),G.iv())}},hue:{get:function(){return M.map(function(s){return E(180*s)})},set:function(U){if(M!==U&&7===U.length){for(var E=0;7>E;E++)M[E]=U[E]/180;G.iv()}}},saturation:{get:function(){return J.map(function(h){return E(100*h)})},set:function(U){if(J!==U&&7===U.length){for(var b=0;7>b;b++)J[b]=U[b]/100;G.iv()}}},lightness:{get:function(){return t.map(function(d){return E(100*d)})},set:function(w){if(t!==w&&7===w.length){for(var F=0;7>F;F++)t[F]=w[F]/100;G.iv()}}}}),R._42=function(y,_){if(A){r||U();var R=_.width,k=_.height;if(R&&k){V.setSize(y,R,k),Kl(y,V.frame),G.setViewport(y,0,0,V.width,V.height),y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT),m.bind(),y.activeTexture(y.TEXTURE0+0),$r(y,_.texture);var v=m.uniforms;return v.image=0,v.hue=M,v.saturation=J,v.lightness=t,C.upload(),q.upload(),m.attributes.pos.pointer(q),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0),$r(y,null),ml(y),V}}}};et.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var ft=b.graph3d.PostProcessing.Bloom=function(j){function C(){var Q=j.getGL();if(Q)for(var O=j._postProcessing,y=0;P>y;y++)v[y]=O.createShader(Q,ft._35Q,function(G,J){return{fs:J.replace(/DEFINE_VALUE/g,I[y]).replace("%OVERRIDE_ALPHA_DEFINE%",e?"#define OVERRIDE_ALPHA":"")}})}function o(){var p=j.getWidth(),d=j.getHeight();if(p&&d){z=[p,d],Z=!0;var W,o=j.getGL(),c=Math.round(z[0]/2),Q=Math.round(z[1]/2);for(V=new cl.RenderTarget(j,o,c,Q),W=0;P>W;W++)w.push(new cl.RenderTarget(j,o,c,Q)),K.push(new cl.RenderTarget(j,o,c,Q)),c=Math.round(c/2),Q=Math.round(Q/2);var A=j._postProcessing;L=A.createShader(o,ft._34Q),C(),s=A.createShader(o,ft._36Q,function(f,W){return{fs:W.replace(/NUM_MIPS/g,P)}}),u=A.createShader(o,ft.finalShader),T=Yg.Buffer.createIndexBuffer(o,new Uint16Array([0,2,1,1,2,3])),N=Yg.Buffer.createVertexBuffer(o,new Float32Array([0,0,1,0,0,1,1,1]))}}var H,A,W,e,g,T,N,_,E=this,r=!1,Z=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var g=this.serializeProperties;for(var C in g)this[C]=g[C]},x.defineProperties(E,{enable:{get:function(){return r},set:function(W){!!r!=!!W&&(r=W,W&&!Z&&o(),j.iv())}},strength:{get:function(){return H},set:function(B){H!==B&&(H=B,j.iv())}},threshold:{get:function(){return A},set:function(e){A!==e&&(A=e,j.iv())}},radius:{get:function(){return W},set:function(N){W!==N&&(W=N,j.iv())}},overrideAlpha:{get:function(){return e},set:function(Y){!!e!=!!Y&&(e=Y,Z&&C(),j.iv())}},selective:{get:function(){return g},set:function(m){!!g!=!!m&&(g=!!m,j.iv())}}}),this.resetProperties();var V,L,s,u,z=[256,256],w=[],K=[],P=5,I=[3,5,7,9,11],v=[];E._42=function($,X){function G(H,i,L,n){Kl($,i.frame),j.setViewport($,0,0,i.width,i.height),n?n($):$.clear($.COLOR_BUFFER_BIT|$.DEPTH_BUFFER_BIT),J!==H&&H.bind();var I=0;for(var S in L){var V=L[S];V instanceof WebGLTexture&&($.activeTexture($.TEXTURE0+I),$r($,V),V=I,I++),H.uniforms[S]=V}for(J!==H&&(T.upload(),N.upload(),H.attributes.pos.pointer(N),J=H),$.drawElements($.TRIANGLES,6,$.UNSIGNED_SHORT,0);I--;)$.activeTexture($.TEXTURE0+I),$r($,null);ml($)}if(r&&(Z||(o(),Z))){var J;if(g){_||(_=new cl.RenderTarget(j,$)),_.setSize($,X.width,X.height),_.bind($);var Q=$.getParameter($.COLOR_CLEAR_VALUE);Q&&0===Q[0]&&0===Q[1]&&0===Q[2]&&1===Q[3]?Q=null:wj($,[0,0,0,1]),$.clear($.COLOR_BUFFER_BIT|$.DEPTH_BUFFER_BIT),j.setViewport($,0,0,X.width,X.height),$._blooming=!0,j.syncRenderState(),j.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),$._blooming=!1,Q&&wj($,Q),_.unbind($)}G(L,V,{smoothWidth:.01,luminosityThreshold:A,tDiffuse:g?_.texture:X.texture});var B,p=V,S=Math.round(z[0]/2),m=Math.round(z[1]/2);for(B=0;P>B;B++)G(v[B],w[B],{colorTexture:p.texture,direction:[1,0],texSize:[S,m]}),G(v[B],K[B],{colorTexture:w[B].texture,direction:[0,1],texSize:[S,m]}),S=Math.round(S/2),m=Math.round(m/2),p=K[B];return G(s,w[0],{blurTexture1:K[0].texture,blurTexture2:K[1].texture,blurTexture3:K[2].texture,blurTexture4:K[3].texture,blurTexture5:K[4].texture,bloomStrength:H,bloomRadius:W,bloomTintColor:[1,1,1]}),G(u,X,{image:w[0].texture},function(A){Of.for(A).glState.blend.apply({enabled:!0,equation:A.FUNC_ADD,func:[A.SRC_ALPHA,A.ONE]})}),Of.for($).glState.blend.apply({equation:$.FUNC_ADD,func:[$.SRC_ALPHA,$.ONE_MINUS_SRC_ALPHA,$.ONE,$.ONE_MINUS_SRC_ALPHA]}),X}}};ft._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",ft._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",ft._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",ft.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var gt=b.graph3d.PostProcessing.Dof=function(B){function l(){m=!0;var a=B.getGL();q=new cl.RenderTarget(B,a),D=B._postProcessing.createShader(a,gt._38Q),y=Yg.Buffer.createIndexBuffer(a,new Uint16Array([0,2,1,1,2,3])),Z=Yg.Buffer.createVertexBuffer(a,new Float32Array([0,0,1,0,0,1,1,1]))}var q,D,y,Z,T,K,E,v,o=this,I=!1,m=!1,h=$m.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var z=this.serializeProperties;for(var c in z)this[c]=z[c]},x.defineProperties(o,{enable:{get:function(){return I},set:function(i){!!I!=!!i&&(I=i,i&&!m&&l(),B.iv())}},image:{get:function(){return K},set:function(o){K!==o&&(K=o,T&&(B.deleteTexture(h),T=null),B.iv())}},maxblur:{get:function(){return E},set:function(R){E!==R&&(E=R,B.iv())}},aperture:{get:function(){return v},set:function(n){v!==n&&(v=n,B.iv())}}}),this.resetProperties(),o._42=function(F,t){function k(E,O,U,e){Kl(F,O.frame),B.setViewport(F,0,0,O.width,O.height),e?e(F):F.clear(F.COLOR_BUFFER_BIT|F.DEPTH_BUFFER_BIT),Q!==E&&E.bind();var W=0;for(var R in U){var C=U[R];C instanceof WebGLTexture&&(F.activeTexture(F.TEXTURE0+W),$r(F,C),C=W,W++),E.uniforms[R]=C}for(Q!==E&&(y.upload(),Z.upload(),E.attributes.pos.pointer(Z),Q=E),F.drawElements(F.TRIANGLES,6,F.UNSIGNED_SHORT,0);W--;)F.activeTexture(F.TEXTURE0+W),$r(F,null);ml(F)}if(I){m||l();var Q;if(!T){var i=Bj(this.image);if(!i||!i.comps&&!i.tagName)return t;b.Default.setImage(h,i),T=B.getTexture(h)}var e=t.width,p=t.height;if(e&&p)return q.setSize(F,e,p),k(D,q,{tColor:t.texture,tDepth:T,aspect:e/p,aperture:this.aperture,maxblur:this.maxblur}),q}}};gt._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";
var ht=b.graph3d.PostProcessing.Blur=function(l){function K(){m=!0;var B=l.getGL();H=new cl.RenderTarget(l,B),$=l._postProcessing.createShader(B,ht.hBlurShader),j=l._postProcessing.createShader(B,ht.vBlurShader)}var $,j,H,F,t,e,c,B,X,a=this,s=!1,m=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var q=this.serializeProperties;for(var P in q)this[P]=q[P]},x.defineProperties(a,{enable:{get:function(){return s},set:function(D){!!s!=!!D&&(s=D,D?l.addRenderLayerListener(V,this):l.removeRenderLayerListener(V,this),D&&!m&&K(),l.iv())}},downSample:{get:function(){return c},set:function(Y){c!==Y&&(c=Y,l.iv)}},value:{get:function(){return e},set:function(M){e!==M&&(e=M,l.iv())}},iterations:{get:function(){return B},set:function(s){B!==s&&(B=s,l.iv())}},layer:{get:function(){return X},set:function(k){X!==k&&(X=k,l.iv())}}}),this.resetProperties();var V=function(M){if(s&&M.layer===X&&"post"===M.phase){var h=l.getGL();if(!l._picking&&!l.isReflecting(h)){var z=l._postProcessing.getRenderTarget();z.unbind(h);for(var G=0,A=l._glCapabilities.maxAttributes;A>G;G++)h.disableVertexAttribArray(G);a.drawImpl(h,z),z.bind(h),h.useProgram(l._prg)}}};a._42=function(){},a.drawImpl=function(M,z,k,T,o){m||K();var Y,P;if(z?(Y=z.width,P=z.height):(Y=l._viewport[2],P=l._viewport[3]),Y&&P){var b=l._postProcessing;"boolean"!=typeof T&&(T=c),k==Q&&(k=e),o==Q&&(o=B),o=Math.max(1,Math.round(o));var y=Of.for(M).glState.depth,E=y.enabled;if(y.enabled=!1,T){k/=2;var n=[Y,P];Y/=2,P/=2,F||(F=new cl.RenderTarget(l,M),t=b.createShader(M,ht.downSampleShader)),F.setSize(M,Y,P),b.blitScreen(F,z.texture,t,{texelSize:[1/n[0],1/n[1]]}),z.setSize(M,Y,P)}else F&&F.setSize(0,0);H.setSize(M,Y,P);for(var p=[],W=0;o>W;W++)p.push(k),k=Math.max(1,Math.floor(k/2));for(var W=0;o>W;W++){var J=p[o-W-1],x=T&&0===W?F.texture:z.texture;b.blitScreen(H,x,$,{value:J/Y}),T&&W===o-1&&z.setSize(M,n[0],n[1]),b.blitScreen(z,H.texture,j,{value:J/P})}return y.enabled=E,z}}};ht.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",ht.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",ht.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var it=b.graph3d.PostProcessing.Glitch=function(P){function j(){if(L&&f){C=Date.now(),p=0,r=1e3*e(f[0],f[1]),J=[];for(var V=1,d=L.length;d>V;V+=2)J.push((V>1?J[J.length-1]:0)+r*L[V]/l)}}function R(){P.redraw()}function c(){_=!0;var d=P.getGL();z=new cl.RenderTarget(P,d),s=P._postProcessing.createShader(d,it.Shader);for(var M=N*N,u=gl(N,N),t=u.getImageData(0,0,N,N),y=t.data,W=0;M>W;W++)y[3*W+0]=U(256),y[3*W+1]=U(256),y[3*W+2]=U(256),y[3*W+3]=U(256);u.putImageData(t,0,0),o=Gp(d,Qk)}var z,s,r,C,p,J,o,D,f,L,S=this,Y=!1,_=!1,e=$m.randomFloat,U=$m.randomInt,l=0,N=64;this.serializeProperties={onlyReflector:!1,period:[2,3],intensity:[3,.3,1,.1,0,.4]},this.resetProperties=function(){var R=this.serializeProperties;for(var t in R)this[t]=R[t]},x.defineProperties(S,{enable:{get:function(){return Y},set:function(w){!!Y!=!!w&&(Y=w,w&&(j(),_||c()),P.iv())}},onlyReflector:{get:function(){return D},set:function(t){!!D!=!!t&&(D=t,P.iv())}},period:{get:function(){return f},set:function(c){f=c,j(),P.iv()}},intensity:{get:function(){return L},set:function(U){U||(U=[1,1]),L=U,l=0;for(var H=1,u=U.length;u>H;H+=2)l+=U[H];j(),P.iv()}}}),this.resetProperties(),S._42=function(E,q){if(Y){_||c();var V=!!P.isReflecting(E);if(V===!!D){var l=q.width,T=q.height;if(l&&T){var f=P._postProcessing,t=Of.for(E).glState.depth,n=t.enabled;t.enabled=!1,z.setSize(E,l,T);var I,W=Date.now();W-C>J[p]&&(p++,p>=J.length&&j()),I=L[2*p];var g={seed:Math.random(),byp:I?0:1,tDisp:o};return I&&(g.angle=e(-Math.PI,Math.PI),g.distortion_x=e(0,1),g.distortion_y=e(0,1),g.amount=Math.random()/30*I,g.seed_x=e(-1,1)*I,g.seed_y=e(-1,1)*I),f.blitScreen(z,q.texture,s,g),t.enabled=n,requestAnimationFrame(R),z}}}}};it.Shader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd~j!tj<p*ow!Viwj!h-ifqh!bgnmjp)b!uE<3f!svvoujygfpus>ns!pjmopuD!hcbzsqG<`m!hv!oj|g!pfstnm!ft!bn~q!mf<sx3pEo!tj!n,bshpfm<pD!hvbosjGg`pmshn!!>t!bsnpqmmpfDsh3bEs!Gu`Emjht!q<<*3!/v1o+j*g*p/s1n6!+gemfpfbtu!!+b!ntpzv-oeuf<ft!!v+o!jtgyp)s3nd!fgwm)peboub!sb)o5hdmffw<+u!ovvopjngbp+s/n1!1g3m!p>b!ux!ptoftf!e5<df!wv!ojfgtpjspno!!gemepbb0u0!!tf<f*eb`/yb<hd!!v-ocj/gcpds!n-!hg/mbphbdu!!-tsf/fsed`)z5<df!wv!o>j!gsppsmnp!DghmbpsbGu`!mehj!tu<p*suufjtpgog`py!<.!!qv!o-jfghpbsnnj!)gEm3pfbsuv!ueyjftuu!p>s!ucjdp!o5`dzf<w!!v<o*jqg!p-sfnh!bgnmjp)bEu3!fdspvmu`ytf<u!>!!wbbhsdz!j5odhf!ww!fd<3*!uwfVtwg<gp!!,d!pqo!t-uf!hgbmnpjb)uE!3VfosqvbudylfEup!x>o!tsddb!m5fd!f>w!!36<6*/*!f0m!h3o6b7)/o<jt!!d-p*oftmuh!owbf)dt4p!dQ)b3ddlfGwb!d+u!pusotv!p>n!bw!f>d!4u)f!t3g6g7p/!!3+d!f3w6!7/s!f+e!b3i6t7!/u-g!j3i6t7!/C!H+S!!3n6p7s/g-!!f3t6b7c/0!0*!<<!*d/p6o0teuf!fwtf)d+5z!`Veofqfbtd+lmGbbndsuppos>t,!z>/!qV!oq<b*d/l6E0pexfofttd)b+myf`!e0f!fwtf+dm5b)n!sQpbod>l,Gyb/dqu!ps~t!-!~2!/!<**<y`!ogpmjpubsup!uvtojqeb!d,l!SyH/CqB)U!p.E!f/q2u!i>)!!yd/pqo!tu|!!jfot!mwff!d5~!!w!<*y!`|op!jsufsupvustoj!ee>pyu/)q!!w-|!*V/o1q?bzd`leGfbfdtu)pgsjt!!*|<!*!e~fft!+gtm`pmbpud!.szb`ooep)jwufsdp3u!tdjpe*?|y/!qs!f%u%v!sto`!mgpsdb,dzu`)otpjjou)seppuut)jdep=/yy/zq!)-gwjf!d3~)!23~/!:9<:z9`-o8p9j/u3s4p4u*t*j*e!!+>!!5z4/8q6!9/|6!5f6t4m*f<!!~~!<!*wzp`joep!jnubsjpou)t*j!e|!,!!jzg/)qc)z!q.=!2/*2!!|>!!zw/fqd!3!|q*!/>1!?wyV`we<ff!tg)mgpjb!u!|y!t*!e>f!fgtm+ptp`sm)phdm.`yG`sobphjDupsppsuet/jye!?0z!/1q/!6%*%<!t!`gmmppdb,uy!`zotp!j>u!sgpmuptpjse)=hzm/`qG)sgbjh!Dp<p*s*ee/fzf!t0+!e1f/f6t*+<q!!-gqmtpjbEuu!)o!pEs3nfbsmv!u>y!fvuo)qibudqlfSEHpCUB";var jt=b.graph3d.PostProcessing.Fxaa=function(w){var B,z=this,f=!1;x.defineProperties(z,{enable:{get:function(){return f},set:function(A){!!f!=!!A&&(f=A,w.iv())}}}),z.getShader=function(r){if(B)return B;var A=w.getPostProcessingModule();return B=A.createShader(r,{vs:A.blitScreenShaderSrc.vs,fs:A.decodeShader(jt.ShaderSourceFs)})},z._42=function(){}};jt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",nd(C,{accordionViewExpandIcon:df(Sb),accordionViewCollapseIcon:df(Sb,!0),accordionViewLabelColor:yd,accordionViewLabelFont:rr,accordionViewTitleBackground:rm,accordionViewSelectBackground:Hc,accordionViewSelectWidth:3,accordionViewSeparatorColor:_,splitViewDividerSize:1,splitViewDividerBackground:rm,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:$g,rect:[2,2,12,12],background:Sb}]},propertyViewLabelColor:tj,propertyViewLabelSelectColor:yd,propertyViewLabelFont:rr,propertyViewExpandIcon:df(dj),propertyViewCollapseIcon:df(dj,!0),propertyViewBackground:_b,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Bq,propertyViewColumnLineColor:Bq,propertyViewSelectBackground:Hc,listViewLabelColor:tj,listViewLabelSelectColor:yd,listViewLabelFont:rr,listViewRowLineVisible:!1,listViewRowLineColor:Bq,listViewSelectBackground:Hc,treeViewLabelColor:tj,treeViewLabelSelectColor:yd,treeViewLabelFont:rr,treeViewExpandIcon:df(ur),treeViewCollapseIcon:df(ur,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Bq,treeViewSelectBackground:Hc,treeViewDoubleClickToToggle:!0,tableViewLabelColor:tj,tableViewLabelSelectColor:yd,tableViewLabelFont:rr,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Bq,tableViewColumnLineColor:Bq,tableViewSelectBackground:Hc,treeTableViewLabelColor:tj,treeTableViewLabelSelectColor:yd,treeTableViewLabelFont:rr,treeTableViewExpandIcon:df(ur),treeTableViewCollapseIcon:df(ur,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Bq,treeTableViewColumnLineColor:Bq,treeTableViewSelectBackground:Hc,tableHeaderLabelColor:tj,tableHeaderLabelFont:rr,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:jl,tableHeaderBackground:_b,tableHeaderMoveBackground:Dd,tableHeaderInsertColor:Hc,tableHeaderSortDescIcon:dn(dj,!0),tableHeaderSortAscIcon:dn(dj),tabViewTabGap:1,tabViewLabelColor:yd,tabViewLabelFont:rr,tabViewTabBackground:rm,tabViewSelectWidth:3,tabViewSelectBackground:Hc,tabViewMoveBackground:Dd,tabViewInsertColor:Hc,toolbarLabelColor:tj,toolbarLabelSelectColor:yd,toolbarLabelFont:rr,toolbarBackground:_b,toolbarSelectBackground:Hc,toolbarItemGap:8,toolbarSeparatorColor:Uk},!0);var kt={translateX:1,sortColumn:1},lt={sortable:1,sortOrder:1,sortFunc:1},mt={focusData:1},nt={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},ot={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},pt=function(u,C){C.add(u),u.hasChildren()&&u.eachChild(function(G){pt(G,C)})},qt=function(p,w,F,_,q,Z,k,s,r,l,O){var Y,j=F.getValueType(l),c=F.getAlign(l);if(F.getEnumValues(l)){var P=F.toEnumLabel(w,l),I=Vm||0,K=0,b=Z,i=C.getTextSize(_,P).width;return Y=Bj(F.toEnumIcon(w,l)),Y&&(K=Z+Vm/2,"center"===c?K+=(s-(I+i))/2:"right"===c&&(K=K+s-(I+i)),Fb(p,Y,K,k+r/2,l,O),b=K+Vm/2),P!=Q&&(Y?Br(p,P,_,q,b,k,s-(b-Z),r):Br(p,P,_,q,Z,k,s,r,c)),void 0}return w=F.formatValue(w),w!=Q?j===se?(uj(p,Z,k,s,r,w),void 0):j===Xp||!j&&wb(w)?(Y=Bj(w?Uf:ls),Fb(p,Y,Z+s/2,k+r/2,l,O),void 0):(Br(p,w,_,q,Z,k,s,r,c),void 0):void 0},rt=function(D,U){var g=U.view,C=nb(D),y=U.column||U.property;g.getDataModel().beginTransaction(),U.editor=D,D.info=U,g.setCurrentEditor(D),g.getView().insertBefore(C,g._79O),xg(D,U.editorRect),D.setFocus?D.setFocus():hp(D),D.commitValue=function(l,v){D._17Q&&(D=D._17Q),v||g.setValue(U.data,y,D.getValue?D.getValue():D.value),D.close&&D.close(),hg(C)},y.onEditorCreated&&y.onEditorCreated(U)},st=function(p,x,w,D,H){var t=ho(p,w),h=x.value,Y=x.view,q=H.getValueType(x.data);return t.onblur=t.onchange=function(){Y.endEditing()},"input"===p?(h=H.formatValue(h),h!=Q&&(t.value=h),t.onkeydown=function(m){Ud(m)?Y.endEditing():ol(m)&&Y.endEditing(!0)},(q===Gr||q===_o)&&W(t,Qh,C.numberListener)):p===zd&&D.forEach(function(p){var _=L.createElement("option");_.innerHTML=H.toEnumLabel(p),_.value=p,H.isEnumEqual(h,p)&&(_.selected=!0),zk(t,_)}),rt(t,x),t},tt=b.widget={},ut=function($,m,y){eq(v+".widget."+$,m,y)};nd(Im,{ms_value:function(M){M.getValue=function($){var s=this.getItemById($),k=s.element;return am(k)?k:k?k.getValue?k.getValue():k.value:s.selected},M.setValue=function(I,_){var D=this.getItemById(I);if(D){var h=D.element;h&&!am(h)?h.setValue?h.setValue(_):h.value=_:wb(_)?(D.selected=_,this.iv()):(D.element=_,this.iv())}},M.v=function(x,g){var o=this;if(2===arguments.length)o.setValue(x,g);else{if(!vp(x))return o.getValue(x);for(var L in x)o.setValue(L,x[L])}return o}},_46o:function(P){P._icon=Q,P._accessType=Q,P._valueType=Q,P._editable=!1,P._batchEditable=!0,P._align=Mh,P._nullable=!0,P._emptiable=!1,P.setParent=Cf,P.formatValue=function(V){var z=this,P=z._valueType;return z.getEnumValues()?z.toEnumLabel(V):P===Xp?!!V:V!=Q&&P===Gr?u(V):V},P.setEnum=function(W,G,y,T,s,n,$){var m=this;W&&!oi(W)&&W.values&&(T=W.editable,y=W.icons,G=W.labels,s=W.strict,n=W.maxHeight,$=W.dropDownWidth,W=W.values),Wh(W)&&(W=W._as),Wh(G)&&(G=G._as),Wh(y)&&(y=y._as),m._enumValues=W,m._enumLabels=G,m._enumIcons=y,m._enumEditable=T,m._enumStrict=s==Q?!0:s,m._enumMaxHeight=n,m._enumDropDownWidth=$,W&&W.length&&Ho(W[0])&&(m._valueType=_o),m.fp("enum",!1,!0)},P.getEnumDropDownWidth=function(){return this._enumDropDownWidth},P.getEnumMaxHeight=function(){return this._enumMaxHeight},P.isEnumEditable=function(){return this._enumEditable},P.getEnumValues=function(){return this._enumValues},P.getEnumLabels=function(){return this._enumLabels},P.getEnumIcons=function(){return this._enumIcons},P.isEnumStrict=function(){return this._enumStrict},P.isEnumEqual=function(Y,N){return this._enumStrict?Y===N:Y==N},P.toEnumLabel=function(p,j){var N=this,S=N.getEnumValues(j),b=N.getEnumLabels(j);if(S&&b)for(var H=0;H<S.length;H++)if(N.isEnumEqual(p,S[H]))return b[H];return p},P.toEnumIcon=function($,x){var y=this,u=y.getEnumValues(x),M=y.getEnumIcons(x);if(u&&M)for(var s=0;s<u.length;s++)if(y.isEnumEqual($,u[s]))return M[s];return _}},_45o:function(G){G._87o=function(z,g,H,f,y,e){if(z){var $=this,t=$._90I,W=jc(1);$._columnLineVisible&&(y-=1),$._rowLineVisible&&(e-=1),0>=y||0>=e||($._90I||(t=$._90I={}),t[g]||(t[g]=new Qd),xg(W,$.tx()+H,$.ty()+f,y,e),zk(W,z),$._view.insertBefore(W,$._79O),z.onParentAdded&&z.onParentAdded(W),t[g].add(W))}},G._76o=function(){var A=this,j=A._90I;if(j){for(var a in j)j[a].each(function(O){hg(O)});delete A._90I}},G._77o=function(o){var P=this;if(P._90I){var l=P._90I[o];l&&(l.each(function(Z){hg(Z)}),delete P._90I[o])}}},_47o:function(i){i.getValue=function(q,E){return E.getValue?E.getValue(q,E,this):rs(q,E.getAccessType(),E.getName())},i.setValue=function(U,H,k){if(H.isEmptiable(U)||""!==k||(k=_),H.isNullable(U)||k!=Q){var W=this,t=H.getName(U),x=H.getAccessType(U),g=H.getValueType(U);g===Gr&&am(k)?k=pm(k):g===_o&&am(k)?k=parseFloat(k):g===Xp&&am(k)&&(k="true"===k),W._batchEditable&&H._batchEditable&&W.isSelected(U)?W.sm().each(function(O){H.setValue?H.setValue(O,H,k,W):ad(O,x,t,k)}):H.setValue?H.setValue(U,H,k,W):ad(U,x,t,k)}},i.setCurrentEditor=function(A){this.endEditing(),this._currentEditor=A,this.redraw()},i.isEditing=function(O,w){var c=this,t=c._currentEditor;if(!t)return!1;if(w){var p=t.info;return p?(p.column||p.property)===w&&p.data===O:!1}return!0},i.endEditing=function(f){var Z=this,I=Z._currentEditor;I&&(delete Z._currentEditor,I.commitValue&&I.commitValue(I.info,f),Z.redraw(),Z.getDataModel().endTransaction())},i.beginEditing=function(v){this.endEditing();var Y=this,R=v.column||v.property;if(R.beginEditing)R.beginEditing(v);else{var s=v.data,j=v.value,p=Y.getSelectBackground(s),i=R.getEnumValues(s),I=R.getSlider(s),q=R.getColorPicker(s);if(I){var X=Df(tt.Slider,I);return X.setValue(j),X.getView().onblur=function(){Y.endEditing()},X.isInstant()&&(X.onValueChanged=function(){Y.setValue(s,R,X.getValue())}),rt(X,v),void 0}if(q||R.getValueType(s)===se){var c=Df(tt.ColorPicker,q);return c.setValue(j),c.onClosed=function(){Y.endEditing()},c.isInstant()&&(c.onValueChanged=function(y,T){Y.setValue(s,R,T)}),rt(c,v),c.open(),void 0}if(i){if(tt.ComboBox){var E=new tt.ComboBox;E.setValue(j),E.setValues(i),E.setLabels(R.getEnumLabels(s)),E.setIcons(R.getEnumIcons(s)),E.setEditable(R.isEnumEditable(s)),E.setStrict(R.isEnumStrict(s)),E.setMaxHeight(R.getEnumMaxHeight(s)),E.setDropDownWidth(R.getEnumDropDownWidth(s)),E.onClosed=function(){Y.endEditing()},rt(E,v),E.open()}else st(zd,v,p,i,R);return}var z=R.getValueType(s);if(z===Xp||wb(j))return Y.setValue(s,R,!j),void 0;if(R.getItemEditor(s)){var g=ec(R.getItemEditor(s)),Z=new g(s,R,Y,v),t=Z.getView();return t._17Q=Z,Z.setValue(j),Pd(t),rt(t,v),Z.editBeginning&&Z.editBeginning(),void 0}st("input",v,p,Q,R)}}},_44o:function(Z){Z.init=function(P){var j=this,c=j.th=new Jt(P),x=j._view=Si(1,j);j.tv=j._tableView=P,zk(x,c.getView()),zk(x,P.getView()),c.mp(function(h){h.property===pe&&j.iv()}),j.iv()},Z.getTableView=function(){return this.tv},Z.getTableHeader=function(){return this.th},Z.getDataModel=function(){return this.tv.dm()},Z.getColumnModel=function(){return this.tv.getColumnModel()},Z.setColumns=function(H){this.tv.setColumns(H)},Z.addColumns=function(B){this.tv.addColumns(B)},Z.endEditing=function(){this.tv.endEditing()},Z.validateImpl=function(){var j=this,b=j.th,y=Ro(b),_={x:0,y:0,width:j.getWidth(),height:y};xg(b,_),_.y=y,_.height=f(0,j.getHeight()-y),xg(j.tv,_)}},ms_vs:function(F){F._41o=function(){return this._29I.height<this._59I},F._43o=function(){var p=this;p._41o()&&(p._58I||(Eg(function(){p._94O()},gm),p.iv()),p._58I=new Date)},F._94O=function(){var q=this;if(q._58I){var e=new Date;e.getTime()-q._58I.getTime()>=gm?(delete q._58I,q.iv()):Eg(function(){q._94O()},gm)}},F._93I=function(){var q=this,F=q._27I;if(q._58I||!q._autoHideScrollBar){F||zk(q._79O,F=q._27I=jc());var w=q._29I,r=w.height,p=q._59I,s=q.getScrollBarSize(),t=w.width-s-2,x=r*(-q.ty()/p),D=r*(r/p),j=F.style;p>r?(Tf>D&&(x=x+D/2-Tf/2,0>x&&(x=0),x+Tf>r&&(x=r-Tf),D=Tf),j.visibility=qj,j.background=q.getScrollBarColor(),j.borderRadius=s/2+jf,xg(F,t,x,s,D)):j.visibility=qr}else F&&(F.style.visibility=qr)}},ms_hs:function(b){b._40o=function(){return this._29I.width<this._91I},b._42o=function(){var D=this;D._40o()&&(D._95O||(Eg(function(){D._94I()},gm),D.iv()),D._95O=new Date)},b._94I=function(){var M=this;if(M._95O){var A=new Date;A.getTime()-M._95O.getTime()>=gm?(delete M._95O,M.iv()):Eg(function(){M._94I()},gm)}},b._92I=function(){var D=this,T=D._28I;if(D._95O||!D._autoHideScrollBar){T||zk(D._79O,T=D._28I=jc());var j=D._29I,G=j.width,K=D._91I,F=D.getScrollBarSize(),E=j.height-F-2,c=G*(-D.tx()/K),A=G*(G/K),X=T.style;K>G?(Tf>A&&(c=c+A/2-Tf/2,0>c&&(c=0),c+Tf>G&&(c=G-Tf),A=Tf),X.visibility=qj,X.background=D.getScrollBarColor(),X.borderRadius=F/2+jf,xg(T,c,E,A,F)):X.visibility=qr}else T&&(T.style.visibility=qr)}}}),Gn(Uf,oo(16,16,[{type:Lm,rect:[1,1,14,14],background:Hc},{type:hd,rect:[1,1,14,14],width:1,color:po},{type:qo,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Gn(ls,oo(16,16,{type:hd,rect:[1,1,14,14],width:1,color:po})),Gn(tb,oo(16,16,[{type:To,rect:[2,2,12,12],borderWidth:1,borderColor:po,background:"#FFF"},{type:To,rect:[4,4,8,8],background:Hc}])),Gn(zb,oo(16,16,{type:To,rect:[2,2,12,12],borderWidth:1,borderColor:po})),Im._15Q=function(c){c._29I=Tm,c._59I=0,c._91I=0,c._5o=function(G){var Z=this;Z._30I=new Qd,Z._rows=new Qd,Z._rowMap={},Z._31I=0,Z._14I=0,Z._view=Si(1,Z),Z._canvas=Yp(Z._view),zk(Z._view,Z._79O=jc()),Z.dm(G?G:new Zi)},c.getCheckIcon=function(E){var a=this.sm(),z=a.co(E);return a.sg()?Bj(z?tb:zb):Bj(z?Uf:ls)},c.checkData=function(D){var y=this.sm(),U=y.co(D);y.sg()&&U||(this._32o=1,U?y.rs(D):y.as(D),delete this._32o)},c.getDataAt=function(q){q.target&&(q=this.lp(q));var L=E(q.y/this._rowHeight),D=this._rows;return 0>L||L>=D.size()?Q:D.get(L)},c.onDataDoubleClicked=function(){},c.onDataClicked=function(){},c.adjustTranslateX=function(){return 0},c.adjustTranslateY=function(O){var $=this.getHeight()-this._59I;return $>O&&(O=$),O>0?0:u(O)},c.onPropertyChanged=function(Z){var L=this,O=Z.property;nt[O]?L.ivm():mt[O]||L.redraw(),O===Kn?L._42o():O===Dr&&L._43o()},c.getLabel=function(z){return z.toLabel()},c.getLabelFont=function(){return this._labelFont},c.getLabelColor=function(E){var S=this;if(S.isCheckMode()){if(S._focusData===E)return S._labelSelectColor}else if(S.isSelected(E))return S._labelSelectColor;return S._labelColor},c.getStartRowIndex=function(){return this._31I},c.getEndRowIndex=function(){return this._14I},c.getRowDatas=function(){return this._rows},c.getRowIndex=function(I){return this._rowMap[I._id]},c.getRowSize=function(){return this._rows.size()},c.getViewRect=function(){return be(this._29I)},c.isVisible=function(w){return this._visibleFunc?this._visibleFunc(w):!0},c.getCurrentSortFunc=function(){return this._sortFunc},c.setDataModel=function(A){var e=this,o=e._dataModel,F=e._selectionModel;o!==A&&(o&&(o.umm(e.handleDataModelChange,e),o.umd(e.handleDataPropertyChange,e),o.umh(e.handleHierarchyChange,e),F||o.sm().ums(e.handleSelectionChange,e)),e._dataModel=A,A.mm(e.handleDataModelChange,e),A.md(e.handleDataPropertyChange,e),A.mh(e.handleHierarchyChange,e),F?F._21I(A):A.sm().ms(e.handleSelectionChange,e),e.fp("dataModel",o,A))},c.validateModel=function(){var d=this;d._rows.clear(),d._rowMap={},d.buildChildren(d._dataModel._roots);var X=d._rows=d._rows.toList(d.isVisible,d),v=0,n=d.getCurrentSortFunc(),P=X.size();for(n&&X.sort(n);P>v;v++)d._rowMap[X.get(v)._id]=v},c.buildChildren=function(O){var d=this;O.each(function(_){d._rows.add(_),d.buildChildren(_._children)})},c.handleDataModelChange=function(){this.ivm()},c.handleDataPropertyChange=function(M){"parent"===M.property?this.ivm():this.invalidateData(M.data)},c.handleHierarchyChange=function(){this.ivm()},c.handleSelectionChange=function(D){D.datas.each(this.invalidateData,this),this.onSelectionChanged(D)},c.onSelectionChanged=function(p){var f=this,A=f.sm();!f.isAutoMakeVisible()||1!==A.size()||"set"!==p.kind&&"append"!==p.kind||f._32o||f.makeVisible(A.ld())},c.handleBackgroundClick=function(X){Do(X)&&!this.isCheckMode()&&this.sm().cs()},c.makeVisible=function(k){k&&(this._23I=k,this.iv())},c.scrollToIndex=function(v){var y=this,h=y._29I,U=h.height,$=y._rowHeight,b=$*v;v>=0&&v<y._rows.size()&&U>0&&(b+$>h.y+U?y.ty(-b+U-$):b<h.y&&y.ty(-b))},c.autoScroll=function(c,a){var l=this,t=l._rowHeight,f=t,J=t/4,X=l._29I,K=l.lp(c),T={x:l.tx(),y:l.ty()};return t>0&&X&&(K.x-X.x<f?l.translate(J,0):X.x+X.width-K.x<f&&l.translate(-J,0),K.y-X.y<f?l.translate(0,J):X.y+X.height-K.y<f&&l.translate(0,-J)),T.x=l.tx()-T.x,T.y=l.ty()-T.y,a&&(a.x+=T.x,a.y+=T.y),T},c.getTopRowOrderSelection=function(){var B=this.sm().getTopSelection(),W={},z=new Qd;return B.each(function(Z){W[Z._id]=Z}),this._rows.each(function(d){W[d._id]&&z.add(d)}),z},c.getRowOrderSelection=function(){var X=new Qd;return this._rows.each(function(T){this.isSelected(T)&&X.add(T)},this),X},c.ivm=function(){this.invalidateModel()},c.invalidateModel=function(){var u=this;u._96I||(u._96I=1,u._32I=1,delete u._24I),u.iv()},c.redraw=function(){var $=this;$._32I||($._32I=1,delete $._24I,$.iv())},c.invalidateData=function(t){var j=this;Ah?j.redraw():j._32I||(j._24I||(j._24I={}),j._24I[t._id]=t,j.iv())},c.getFocusData=function(){return this._focusData},c.setFocusDataById=function(t){this.setFocusData(this.dm().getDataById(t))},c.setFocusData=function(M){var S=this,b=S._focusData;b!==M&&(S._focusData=M,S.fp("focusData",b,M),b&&S.invalidateData(b),M&&(S.invalidateData(M),S.isAutoMakeVisible()&&S.makeVisible(M)))},c.drawRowBackground=function(a,y,E,b,z,T,D){var M=this,r=M.isCheckMode();(y===M._focusData&&r||E&&!r)&&uj(a,b,z,T,D,M.getSelectBackground(y))},c.drawData=function(u,c,R){var H=this,b=H._rowHeight,W=b*R,E=H._29I,$=E.x,r=E.width;u.save(),u.beginPath(),u.rect($,W,r,b),u.clip(),H._87o(H.drawRow(u,c,H.isSelected(c),$,W,r,b),R,$,W,r,b),u.restore(),H._rowLineVisible&&uj(u,$,W+b-1,r,1,H._rowLineColor)
},c._12I=function(k){var Z=this,D=Z._31I,Y=Z._29I,i=Y.x,w=Y.y,h=Y.width,R=Y.height;for(k.beginPath(),k.rect(i,w,h,R),k.clip(),k.clearRect(i,w,h,R),Z._76o(),Z._93db(k);D<Z._14I;D++)Z.drawData(k,Z._rows.get(D),D);Z._92db(k)},c._13I=function(S){for(var z,c=this,a=c._rowHeight,C=c._29I,X=C.x,E=C.width,h=c._31I,W=c._30I;h<c._14I;h++)z=c._rows.get(h),c._24I[z._id]&&W.add({data:z,index:h});W.isEmpty()||(S.beginPath(),W.each(function(R){S.rect(X,R.index*a,E,a)}),S.clip(),W.each(function(k){S.clearRect(X,k.index*a,E,a)}),W.each(function(q){c._77o(q.index)}),c._93db(S),W.each(function(T){c.drawData(S,T.data,T.index)}),c._92db(S),W.clear())},c.preValidateModel=function(){this.endEditing&&this.endEditing()},c.validateImpl=function(){var M=this,T=M._canvas,h=M.getWidth(),y=M.getHeight(),z=M._rowHeight,i=M._32I;(h!==T.clientWidth||y!==T.clientHeight)&&($f(T,h,y),i=1),M._96I&&(M.preValidateModel(),M.validateModel());var r=M._29I,P={x:-M.tx(),y:-M.ty(),width:h,height:y},X=M._rows.size(),I=ob(T),Z=M._23I;i||dl(P,r)||(i=1),M._29I=P,M._59I=X*z,M._31I=E(P.y/z),M._14I=J((P.y+P.height)/z),M._31I<0&&(M._31I=0),M._14I>X&&(M._14I=X),M._99I&&i&&M._99I();var x=M.tx(),o=M.ty();(M._40o()||M._41o())&&(M._59I+=M.getScrollBarSize(),M._99I&&i&&(M._91I+=M.getScrollBarSize())),Yo&&!yb&&(I.save(),Wi(I,h/ui.length,y/ui.length,1)),Wi(I,x,o,1),i?M._12I(I):M._24I&&M._13I(I),M._93I(),M._92I(),I.restore(),M._32I=M._24I=M._96I=Q,Z&&(M.scrollToIndex(M.getRowIndex(Z)),delete M._23I),M.tx(M.tx()),M.ty(M.ty())},c.canHandleSelectMode=function(){return!0}},Im._48o=function(F){F._rootVisible=!0,F._rootData=Q,F._35o=function(){this._expandMap={},this._levelMap={}},F.validateModel=function(){var w=this,a=w._rootData;w._rows.clear(),w._levelMap={},w._rowMap={},w._currentLevel=0,a?w._rootVisible?w.isVisible(a)&&w.buildData(a):w.buildChildren(a):w.buildChildren(),delete w._currentLevel},F.buildData=function(l){var F=this,o=l._id,R=F._rows;F._rowMap[o]=R.size(),R.add(l),F._levelMap[o]=F._currentLevel,F.isExpanded(l)&&(F._currentLevel++,F.buildChildren(l),F._currentLevel--)},F.buildChildren=function(p){var F=this,w=p?p._children:F._dataModel._roots,h=F.getCurrentSortFunc();h&&F.isChildrenSortable(p)?w.toList(F.isVisible,F).sort(h).each(F.buildData,F):w.each(function(h){F.isVisible(h)&&F.buildData(h)})},F.getLevel=function(k){return this._levelMap[k._id]},F.getToggleIcon=function(c){var S=this,x=S._loader,q=S._collapseIcon;return x&&!x.isLoaded(c)?q:c.hasChildren()?S.isExpanded(c)?S._expandIcon:q:Q},F.isCheckMode=function(){return this._checkMode!=Q},F.isChildrenSortable=function(){return!0},F.handleDataModelChange=function(o){var V=this;o.kind===vi?delete V._expandMap[o.data._id]:o.kind===gg&&(V._expandMap={}),V.ivm()},F.toggle=function(M){var J=this;J.isExpanded(M)?J.collapse(M):J.expand(M)},F.isExpanded=function(j){return 1===this._expandMap[j._id]},F.expand=function(T){var p=this,X=p._loader;p.isExpanded(T)||(X&&!X.isLoaded(T)&&X.load(T),p._expandMap[T._id]=1,p.ivm(),p.onExpanded(T))},F.onExpanded=function(){},F.collapse=function(m){var t=this;t.isExpanded(m)&&(delete t._expandMap[m._id],t.ivm(),t.onCollapsed(m))},F.onCollapsed=function(){},F.expandAll=function(a){if(a)this.expand(a),a.eachChild(function(H){this.expandAll(H)},this);else{var N=this;N._dataModel.each(function(Q){Q.hasChildren()&&(N._expandMap[Q._id]=1)}),N.ivm()}},F.collapseAll=function(){this._expandMap={},this.ivm()},F.makeVisible=function(i){if(i){var P=this;if(!P._rootData||i.isDescendantOf(P._rootData)){for(var h=i._parent;h;)P.expand(h),h=h._parent;P._23I=i,P.iv()}}},F.checkData=function(t){var Z,V=this,s=V._checkMode,I=V.sm(),d=I.co(t);if(!I.sg()||!d){if(V._32o=1,s===Dh)d?I.rs(t):I.as(t);else if(s===Jl)Z=new Qd(t),Z.addAll(t._children);else if("descendant"===s)Z=new Qd,pt(t,Z);else if("all"===s&&(Z=new Qd,pt(t,Z),!d))for(var X=t._parent;X;)Z.add(X),X=X._parent;Z&&(d?I.rs(Z):I.as(Z)),delete V._32o}},F.drawTree=function(e,V,i,p,m,c,a){var U=this,R=U._indent,t=U._levelMap[V._id],K=U.getIconWidth(V),l=Bj(U.getToggleIcon(V));l?(p+=R*t,Fb(e,l,p+R/2,m+a/2,V,U),p+=R):p+=R*(t+1),U._checkMode&&(Fb(e,U.getCheckIcon(V),p+R/2,m+a/2,V,U),p+=R),U.drawIcon(e,V,p,m,K,a),U.drawLabel(e,V,p+K,m,a)}},Im._14Q=function(z){z.getIcon=function(_){return _.getIcon()},z.getIconWidth=function(m){return this.getIcon(m)?this._indent:0},z.drawIcon=function(U,G,z,h,Y,P){if(Y){var Q=this,c=Q.getBodyColor(G),y=Bj(Q.getIcon(G),c);y&&(P-=Q.isRowLineVisible()?1:0,_m(U,y,vh,z,h,Y,P,G,Q,c),Xn(U,Q.getBorderColor(G),z,h,Y,P))}},z.drawLabel=function(m,y,x,V,F){var s=this;Br(m,s.getLabel(y),s.getLabelFont(y),s.getLabelColor(y),x,V,0,F)}},Im._50o=function(t){t._98I=function(){var K=this,H=K._39o=new Zi;K._60I=new Qd,H.mm(K._17o,K),H.md(K._18o,K),H.mh(K._19o,K)},t.setColumns=function(o){this._39o.clear(),this.addColumns(o)},t.addColumns=function(N){var w=this._39o;N.forEach(function(j){if(!(j instanceof wt)){var F=ec(j.className);j=Df(F?F:wt,j)}w.add(j)})},t.onColumnClicked=function(){},t.onCheckColumnClicked=function(){},t._3Q=function(G){for(var K,g=0,F=this._60I,T=F.size();T>g;g++)if(K=F.get(g),K.column===G)return K;return Q},t.getColumnAt=function(c){var E=this._4Q(c);return E?E.column:Q},t._4Q=function(s){for(var K=this,T=s.target?K.lp(s).x:s.x,i=K._60I,g=0;g<i.size();g++){var v=i.get(g),E=v.startX;if(T>=E&&T<E+v.column.getWidth())return v}return Q},t.getToolTip=function(f){var N=this,P=N.getDataAt(f),d=N.getColumnAt(f);return P&&d?d.getToolTip(P,N):Q},t.adjustTranslateX=function(p){var w=this.getWidth()-this._91I;return w>p&&(p=w),p>0?0:u(p)},t._99I=function(){var f=this,n=f._29I,y=f._60I;y.clear(),f._91I=0,f._39o._roots.each(function(O){if(O.isVisible()){var T=f._91I+O.getWidth();f._91I<=n.x+n.width&&T>=n.x&&y.add({column:O,startX:f._91I}),f._91I=T}})},t.drawData=function(X,d,f){var F=this,c=F._rowHeight,N=c*f,H=F.isSelected(d),Z=F._29I,P=Z.x,b=Z.width;F.drawRowBackground(X,d,H,P,N,b,c),F._60I.each(function(U){var x=U.column,W=U.startX,j=x.getWidth();j>0&&!F.isEditing(d,x)&&(X.save(),X.beginPath(),X.rect(W,N,j,c),X.clip(),F._87o(F.drawCell(X,d,H,x,W,N,j,c),f,W,N,j,c),F._columnLineVisible&&uj(X,W+j-1,N,1,c,F._columnLineColor),X.restore())}),F._rowLineVisible&&uj(X,P,N+c-1,b,1,F._rowLineColor)},t.drawCell=function(z,w,q,x,m,R,t,d){var i=this;if(x.drawCell)return x.drawCell(z,w,q,x,m,R,t,d,i);var K=i.getValue(w,x);qt(z,K,x,i.getLabelFont(w,x,K),i.getLabelColor(w,x,K),m,R,t,d,w,i)},t.getColumnModel=function(){return this._39o},t._17o=function(){this.redraw()},t._18o=function(t){var X=this;t.data===X._sortColumn&&lt[t.property]?X.ivm():(X._42o(),X.redraw())},t._19o=function(){this.redraw()},t.getCurrentSortFunc=function(){var z=this,x=z._sortColumn;if(x&&x.isSortable()){var r=x.getSortFunc(),q=Al===x.getSortOrder()?1:-1;return r||(r=ik),function(U,M){return r.call(z,z.getValue(U,x),z.getValue(M,x),U,M)*q}}return z._sortFunc},t.isCellEditable=function(Z,u,h){return u.isEditable()&&this.isEditable()?u.isCellEditable?u.isCellEditable(Z,u,h,this):!0:!1},t._37O=function(N,G){if(Do(G))for(var J=this,f=J.lp(G),o=J._60I,$=J._rowHeight,D=J._29I,e=D.x,V=D.y,O=D.width,L=D.height,W=0;W<o.size();W++){var k=o.get(W),q=k.startX,t=k.column,E=t.getWidth();if(t!==J._31o&&t!==J._4o&&f.x>=q&&f.x<q+E&&J.isCellEditable(N,t,G)){var U={x:q,y:J.getRowIndex(N)*$,width:E,height:$},p={x:U.x+J.tx(),y:U.y+J.ty(),width:U.width,height:U.height},Q=0,X=0;return U.x<e?Q=U.x-e:U.x+U.width>e+O&&(Q=U.x+U.width-e-O),Q&&(J.tx(J.tx()-Q),p.x-=Q),U.y<V?X=U.y-V:U.y+$>V+L&&(X=U.y+$-V-L),X&&(J.ty(J.ty()-X),p.y-=X),J.beginEditing({data:N,column:t,value:J.getValue(N,t),event:G,rect:U,editorRect:p,view:J}),void 0}}}},tt.BaseItemEditor=function(W,D,O,Q){this._data=W,this._column=D,this._master=O,this._editInfo=Q},ut("BaseItemEditor",x,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var vt=b.Tab=function(){rd(vt,this)};Xq("Tab",mi,{ms_ac:["view","closable","disabled","visible"],_icon:Q,_closable:!1,_disabled:!1,_visible:!0,setParent:Cf});var wt=b.Column=function(){rd(wt,this)};Xq("Column",mi,{_46o:1,ms_ac:["accessType","valueType",qj,Wk,qm,Od,"align",se,"sortOrder",me,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Al,_sortFunc:Q,_sortable:!0,_clickable:!0,setWidth:function(b){16>b&&(b=16);var x=this._width;this._width=b,this.fp(Od,x,b)},getToolTip:function(Z,C){return this.formatValue(C.getValue(Z,this))}});var xt=b.Property=function(){rd(xt,this)};Xq("Property",mi,{_46o:1,ms_ac:["accessType","valueType",Wk,qm,"categoryName",se,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:Q,getToolTip:function(O,H,b){var z=this;return H?z.formatValue(b.getValue(O,z)):b.getPropertyName(z)}}),tt.AccordionView=function(){var C=this;C._20o={},C._21o=new Qd,C._10o=Q,C._9o=Q,C._11o=Q,C._view=Si(0,C),C.iv()},ut("AccordionView",x,{ms_v:1,ms_fire:1,ms_ac:[Gd,Cs,"titleHeight",us,Gg,"titleBackground","selectWidth",fo,"orientation","separatorColor"],_expandIcon:C.accordionViewExpandIcon,_collapseIcon:C.accordionViewCollapseIcon,_titleHeight:As,_labelColor:C.accordionViewLabelColor,_labelFont:C.accordionViewLabelFont,_titleBackground:C.accordionViewTitleBackground,_selectBackground:C.accordionViewSelectBackground,_selectWidth:C.accordionViewSelectWidth,_orientation:"v",_separatorColor:C.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(B,t,D,C){var n=this,E=jc(),k={content:t,div:E,canvas:Yp(E),icon:C};if(n._20o[B])throw B+" already exists";var $=k.downEventFunc=function(v){zq(v)},m=k.upEventFunc=function(x){zq(x),Do(x)&&(n._10o===B?n.collapse():n.expand(B))};[mh,Rl].forEach(function(p){W(E,p,$)}),[Rr,Tk].forEach(function(u){W(E,u,m)}),E.style.cursor=Yi,zk(n._view,E),n._20o[B]=k,n._21o.add(B),D&&n.expand(B),n.iv()},remove:function(n){var l=this,A=l._20o[n];if(A){var t=A.div;hg(t),[mh,Rl].forEach(function(l){R(t,l,A.downEventFunc)}),[Rr,Tk].forEach(function(F){R(t,F,A.upEventFunc)}),delete l._20o[n],l._21o.remove(n),l.iv()}},clear:function(){var H=this;H._21o.toArray().forEach(H.remove,H),H._20o={},H._21o.clear(),H.iv()},isExpanded:function(r){return this._10o===r},expand:function(S){var O=this;O._20o[S]&&O._10o!==S&&(O._10o=S,O.onExpanded(S),O.iv())},onExpanded:function(){},collapse:function(){var k=this;k._10o&&(k.onCollapsed(k._10o),delete k._10o,k.iv())},onCollapsed:function(){},initCanvas:function(T,s,M){$f(T,s,M);var o=ob(T);return Wi(o,0,0,1),o.clearRect(0,0,s,M),o},drawTitle:function(A,j,d,L,N){var F=this,U=Bj(N.icon),s=F.isExpanded(j),Q=F._titleHeight,D=F._titleBackground,e=F._selectWidth,w=F._separatorColor,b=Bj(s?F._expandIcon:F._collapseIcon),C=e+4;uj(A,0,0,d,L,D),s&&e&&uj(A,0,0,e,L,F._selectBackground),(s||F._21o.get(F._21o.size()-1)!==j)&&uj(A,0,L-1,d,1,w?w:Oi(D)),U&&(Fb(A,U,C+ld(U)/2,Q/2),C+=ld(U)+2),Br(A,j,F.getLabelFont(j),F.getLabelColor(j),C,0,0,Q),b&&Fb(A,b,d-ld(b)/2-4,Q/2)},validateImpl:function(){var T=this,n=T._view,p=0,Q=0,O=T.getWidth(),E=T.getHeight(),y=T._titleHeight,s=T._21o.size()*y,M=T._11o,R=T._9o;delete T._11o,delete T._9o,T._21o.each(function(a){var t,J,r=T._20o[a],k=r.content,d=T._10o===a;Zh(T)?(xg(r.div,p,0,y,E),t=T.initCanvas(r.canvas,y,E),Hk(t,0,E),wm(t,-Ej),T.drawTitle(t,a,E,y,r),t.restore(),d?(J=f(0,O-s),k&&(T._11o=k,T._9o=nb(k),xg(k,p+y,0,J,E)),p+=y+J):p+=y):(xg(r.div,0,Q,O,y),t=T.initCanvas(r.canvas,O,y),T.drawTitle(t,a,O,y,r),t.restore(),d?(J=f(0,E-s),k&&(T._11o=k,T._9o=nb(k),xg(k,0,Q+y,O,J)),Q+=y+J):Q+=y)});var q=T._9o;M&&M!==T._11o&&M.endEditing&&M.endEditing(),q&&q!==R&&zk(n,q),R&&R!==q&&hg(R)}}),tt.SplitView=function(U,z,x,v){var E=this,d=E._dividerDiv=jc(),y=E._60O=Yp(),k=E._61O=Yp(),H=y.style,T=k.style;E._view=Si(1,E),zk(E._view,d),H.msTouchAction=Jq,H.pointerEvents=Jq,H.cursor=Yi,T.msTouchAction=Jq,T.pointerEvents=Jq,T.cursor=Yi,U&&E.setLeftView(U),z&&E.setRightView(z),x&&E.setOrientation(x),v!=Q&&E.setPosition(v),E.setStatus(bn),new yt(E)},ut("SplitView",x,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:C.splitViewDividerSize,_dividerBackground:C.splitViewDividerBackground,_dragOpacity:C.splitViewDragOpacity,_toggleIcon:C.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(i,n){var Y=this,s=Y._position;isNaN(i)||(n||(Y._82O=0>i?-1:i>1?1:0),Y._position=i,Y.fp(_g,s,i))},getLeftView:function(){return this._leftView},setLeftView:function(E){var Y=this,F=Y._leftView,V=Y._view;if(Y._leftView!==E){if(F&&F!==Y._rightView){var S=nb(F);S.parentNode===V&&hg(S)}if(Y._leftView=E,E){var b=nb(E);b.parentNode!==V&&V.insertBefore(b,Y._dividerDiv)}Y.fp("leftView",F,E)}},getRightView:function(){return this._rightView},setRightView:function(n){var F=this,$=F._rightView,C=F._view;if(F._rightView!==n){if($&&$!==F._leftView){var f=nb($);f.parentNode===C&&hg(f)}if(F._rightView=n,n){var U=nb(n);U.parentNode!==C&&C.insertBefore(U,F._dividerDiv)}F.fp("rightView",$,n)}},validateImpl:function(){var x=this,C=x._draggable,Q=x._position,H=x.getWidth(),y=x.getHeight(),l=x._dividerSize,j=x._dividerBackground,g=Ap?18:8,n=x._dividerDiv,L=x._82O,r=x._60O,S=x._61O,_=x._toggleIcon,p=x._status,O=n.style,Z=null,R=Ap?20:4,T=_.comps[0];l>=g||0===l?x._coverDiv&&(hg(x._coverDiv),delete x._coverDiv):x._coverDiv||(x._coverDiv=jc(),nm&&(x._coverDiv.style.background=eo),zk(n,x._coverDiv)),x._togglable?r.parentNode||(zk(n,r),zk(n,S)):(hg(r),hg(S));var U=x._coverDiv,M=x._leftView,b=x._rightView;if(Zh(x)){if(l>H&&(l=H),p===bn)if(1===L)var t=F(Q,H),I=f(0,H-l-t);else-1===L?(I=F(-Q,H),t=f(0,H-l-I)):(t=u((H-l)*Q),I=f(0,H-l-t));else"cl"===p?(t=0,I=f(0,H-l)):"cr"===p&&(I=0,t=f(0,H-l));M&&xg(M,0,0,t,y),b&&xg(b,t+l,0,I,y),xg(n,t,0,l,y),x._22o=t,U&&(xg(U,l/2-g/2,0,g,y),U.style.cursor=C?cr:""),n.style.cursor=C?cr:"";var k=n.clientHeight/2,G=n.clientWidth;$f(r,G,G),xg(r,0,k-G-R,G,G),Z=ob(r),Wi(Z,0,0,1),T.rotation=-Ej,Bs(Z,_,0,0,G,G),Z.restore(),$f(S,G,G),xg(S,0,k+R,G,G),Z=ob(S),Wi(Z,0,0,1),T.rotation=Ej,Bs(Z,_,0,0,G,G),Z.restore()}else{if(l>y&&(l=y),p===bn)if(1===L)var B=F(Q,y),s=f(0,y-l-B);else-1===L?(s=F(-Q,y),B=f(0,y-l-s)):(B=u((y-l)*Q),s=f(0,y-l-B));else"cl"===p?(B=0,s=f(0,y-l)):"cr"===p&&(s=0,B=f(0,y-l));M&&xg(M,0,0,H,B),b&&xg(b,0,B+l,H,s),xg(n,0,B,H,l),x._22o=B,U&&(xg(U,0,l/2-g/2,H,g),U.style.cursor=C?Wm:""),O.cursor=C?Wm:"";var m=n.clientWidth/2,G=n.clientHeight;$f(r,G,G),xg(r,m-G-R,0,G,G),Z=ob(r),Wi(Z,0,0,1),T.rotation=0,Bs(Z,_,0,0,G,G),Z.restore(),$f(S,G,G),xg(S,m+R,0,G,G),Z=ob(S),Wi(Z,0,0,1),T.rotation=e,Bs(Z,_,0,0,G,G),Z.restore()}O.background=j}});var yt=function(N){this.sv=N,this.addListeners()};eq(yt,x,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(K){var y=this,O=y.sv,C=O._dividerDiv,L=O._60O,R=O._61O,G=O._status,j=K.target;if(j===L)G===bn?O.setStatus("cl"):"cr"===G&&O.setStatus(bn);else if(j===R)G===bn?O.setStatus("cr"):"cl"===G&&O.setStatus(bn);else if(tc(K)&&(j===C||j===O._coverDiv)&&(zq(K),O.isDraggable())){O.getLeftView(),O.getRightView();var b=y.maskDiv=jc();if(b.style.left=0,b.style.top=0,b.style.width=O.getWidth()+"px",b.style.height=O.getHeight()+"px",O.getView().appendChild(b),!O.isContinuousLayout()){var S=y.resizeDiv=jc();S.style.left=C.style.left,S.style.top=C.style.top,S.style.width=C.style.width,S.style.height=C.style.height,S.style.opacity=O.getDragOpacity(),S.style.background=O.getDividerBackground(),zk(y.getView(),S)}y._lastAbsPosition=O._22o,y._86o=Zh(O)?Hf(K).x:Hf(K).y,Td(y,K)}},handleWindowTouchMove:function(a){tc(a)&&this.update(a,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(I){var y=this;y.update(I,!0),y.sv.setStatus(bn),y.maskDiv&&hg(y.maskDiv),y.resizeDiv&&hg(y.resizeDiv),y.maskDiv=y.resizeDiv=Q},handle_mousedown:function(u){Do(u)&&this.handle_touchstart(u)},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowMouseUp:function(T){this.handleWindowTouchEnd(T)},update:function(H,m){var n=this,M=n.sv,P=Zh(M)?M.getWidth():M.getHeight(),s=M._dividerSize,y=n._lastAbsPosition-n._86o;Zh(M)?(y+=Hf(H).x,y>P-s&&(y=P-s),0>y&&(y=0),n.resizeDiv&&(n.resizeDiv.style.left=y+jf)):(y+=Hf(H).y,y>P-s&&(y=P-s),0>y&&(y=0),n.resizeDiv&&(n.resizeDiv.style.top=y+jf)),m&&P!==s&&(1===M._82O?M.setPosition(y,1):-1===M._82O?M.setPosition(y-P+s,1):M.setPosition(y/(P-s),1))}}),tt.TabView=function(){var j=this,G=j._view=Si(1,j),F=j._91O=jc(1),K=j._tabModel=new Zi,U=K.sm(),Y=j.invalidate;j._7o=new Qd,j._canvas=Yp(F),zk(G,F),zk(G,j._92O=jc(1)),U.setSelectionMode(jg),U.ms(j.handleSelectionChange,j),K.mm(Y,j),K.mh(Y,j),K.md(Y,j),j._interactor=new zt(j),j.iv()},ut("TabView",x,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",us,Gg,"tabHPadding","tabBackground","selectWidth",fo,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Ui,_tabHeight:As,_tabGap:C.tabViewTabGap,_labelColor:C.tabViewLabelColor,_labelFont:C.tabViewLabelFont,_tabBackground:C.tabViewTabBackground,_selectWidth:C.tabViewSelectWidth,_selectBackground:C.tabViewSelectBackground,_moveBackground:C.tabViewMoveBackground,_insertColor:C.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(d,x,s){var u,r=this._tabModel;return d instanceof vt?(u=d,x&&u.setView(x)):(u=new vt,u.setName(d),u.setView(x)),r.add(u),s&&r.sm().ss(u),u},getLabel:function(X){return X.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(F){this._23o=F,this.iv()},get:function(i){var X=this,h=X._tabModel;if(Ho(i))return h._roots.get(i);if(am(i)){var n;return h.each(function(O){i===X.getLabel(O)&&(n=O)}),n}return i instanceof vt?i:Q},select:function(O){this._tabModel.sm().ss(this.get(O))},remove:function(W){var r=this;if(W=r.get(W)){var c=r._tabModel,l=c._roots.indexOf(W);r._tabModel.remove(W),r.selectByIndex(--l)}},getCurrentTab:function(){return this._8o},hideTabView:function(x,l){l.parentNode===this._92O&&(gf(l)?(l.style.display=Vl,l._tab_=x):hg(l),zn())},showTabView:function(S,X){gf(X)&&(X.style.display="block",X._tab_=S),X.parentNode!==this._92O&&(zk(this._92O,X),zn())},_24o:function(){var I,P=this,o=P._8o,y=P._9o,B=P._tabModel.sm().ld();B&&(I=nb(B.getView())),I!==y&&(y&&(o.getView()&&o.getView().endEditing&&o.getView().endEditing(),P.hideTabView(o,y)),I&&P.showTabView(B,I)),P._8o=B,P._9o=I,o!==B&&P.onTabChanged(o,B)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(T,C){this.selectByIndex(--C)},selectByIndex:function($){var M=this,F=M._tabModel,q=F.size();if(q&&!F.sm().ld()){$==Q&&($=0),$>=q&&($=q-1),0>$&&($=0);for(var c=$;c>=0;c--){var B=M.get(c);if(!B.isDisabled())return M.select(B),B}for(c=$+1;q>c;c++)if(B=M.get(c),!B.isDisabled())return M.select(B),B}},getTabWidth:function(K){var X=this.getTabHPadding(),G=4+2*X,d=Bj(K.getIcon());d&&(G+=ld(d,K)+4);var y=this.getLabel(K);return y&&(G+=lr(this.getLabelFont(K),y).width+4),K.isClosable()&&(G+=10),G},drawTab:function(r,n,v,T,H,W,$){var c,N=this,t=N._tabPosition,g=this.getTabHPadding(),L=v+4+g,y=N._selectWidth,P=Bj(n.getIcon()),K=n.isDisabled(),S=N.getLabelColor(n),U=N.getLabelFont(n),k=N.getLabel(n),E=N._selectBackground,h=t===Mh+"-vertical",d=t===Xi+"-vertical";(h||d)&&(L=T+4+g),K&&(r.globalAlpha=Op),uj(r,v,T,H,W,$),n===N._8o&&y&&(t===Ui?uj(r,v,T+W-y,H,y,E):t===Mh?uj(r,v+H-y,T,y,W,E):t===Xi?uj(r,v,T,y,W,E):h?uj(r,v+H-y,T,y,W,E):d?uj(r,v,T,y,W,E):uj(r,v,T,H,y,E));var Y=H/2;if(h&&(Hk(r,Y,T+W/2),wm(r,e),Hk(r,-Y,-T-W/2)),P){var j=Sr(P,n),l=ld(P,n);if(h||d){var u=v+H/2,A=L+j/2;Hk(r,u,A),wm(r,Ej),Hk(r,-u,-A),Fb(r,P,v+H/2,L+j/2,n,N),Hk(r,u,A),wm(r,-Ej),Hk(r,-u,-A),L+=j+4}else Fb(r,P,L+l/2,T+W/2,n,N),L+=l+4}return h||d?(Hk(r,H/2,L+H/2),wm(r,Ej),Hk(r,-H/2,-L-H/2),Br(r,k,U,S,v,L,W,H),Hk(r,H/2,L+H/2),wm(r,-Ej),Hk(r,-H/2,-L-H/2)):Br(r,k,U,S,L,T,H,W),h&&(Hk(r,Y,T+W/2),wm(r,-e),Hk(r,-Y,-T-W/2)),n.isClosable()&&(c=d?{x:v+H-12,y:T+W-12,width:12,height:12}:{x:v+H-12,y:T+2,width:12,height:12},this.drawCloseIcon(n,r,S,c)),K&&(r.globalAlpha=1),c},drawCloseIcon:function(T,w,H,A){var N=A.x,E=A.y;w.strokeStyle=H,w.lineWidth=1,w.beginPath(),w.moveTo(N+2,E+8),w.lineTo(N+8,E+2),w.moveTo(N+8,E+8),w.lineTo(N+2,E+2),w.stroke()},getTabAt:function(k){var S=this._interactor._8Q(k);return S?S.tab:null},validateImpl:function(){var w=this;w._24o();var N,r=w._canvas,c=w._tabPosition,b=w._91O,C=w._92O,p=w._tabModel,s=w.getWidth(),B=w.getHeight(),g=w._tabHeight,A=w._7o,$=w._tabGap,I=c===Ui,R=c===Mh,e=c===Xi,i=c===Mh+"-vertical",T=c===Xi+"-vertical",x=w._23o,L=0;if((R||e)&&p._roots.each(function(X){L=f(w.getTabWidth(X),L)}),I?(xg(b,0,0,s,g),N={x:0,y:g,width:s,height:f(0,B-g)}):R?(xg(b,0,0,L,B),N={x:L,y:0,width:f(0,s-L),height:B}):e?(xg(b,s-L,0,L,B),N={x:0,y:0,width:f(0,s-L),height:B}):i?(xg(b,0,0,g,B),N={x:g,y:0,width:f(0,s-g),height:B}):T?(xg(b,s-g,0,g,B),N={x:0,y:0,width:f(0,s-g),height:B}):(xg(b,0,B-g,s,g),N={x:0,y:0,width:s,height:f(0,B-g)}),xg(C,N),i||T){w._9o&&(N.x=0,xg(w._8o.getView(),N)),$f(r,g,B);var u=ob(r),Z=0;if(Wi(u,0,w.ty(),1),u.clearRect(0,0,g,B),A.clear(),p._roots.each(function(t){if(t.isVisible()){var H,f=w.getTabWidth(t);if(!x||x.tab!==t){var V=w.getTabBackground(t);H=w.drawTab(u,t,0,Z,g,f,V)}A.add({_75o:H,tab:t,startY:Z,endY:Z+f,height:f}),Z+=f+$}}),w._23Q=f(0,Z-$),x){var Q=x.position;w.drawTab(u,x.tab,0,x.startY,g,x.height,w._moveBackground),uj(u,0,Q,g,1,w._insertColor)}if(u.restore(),w._selectionChanged){w._selectionChanged=!1;for(var D=w.ty(),K=0;K<A.size();K++){var n=A.get(K);if(n.tab===w._8o){if(n.endY+D<0){w.ty(-n.startY);break}if(n.startY+D>B){w.ty(B-n.endY);break}}}}w.ty(w.ty())}else if(R||e){w._9o&&(N.x=0,xg(w._8o.getView(),N)),$f(r,L,B);var u=ob(r),Z=0;if(Wi(u,0,w.ty(),1),u.clearRect(0,0,L,B),A.clear(),p._roots.each(function(y){if(y.isVisible()){var F;if(!x||x.tab!==y){var h=w.getTabBackground(y);F=w.drawTab(u,y,0,Z,L,g,h)}A.add({_75o:F,tab:y,startY:Z,endY:Z+g,height:g}),Z+=g+$}}),w._23Q=f(0,Z-$),x){var Q=x.position;w.drawTab(u,x.tab,0,x.startY,L,x.height,w._moveBackground),uj(u,0,Q,L,1,w._insertColor)}if(u.restore(),w._selectionChanged){w._selectionChanged=!1;for(var D=w.ty(),K=0;K<A.size();K++){var n=A.get(K);if(n.tab===w._8o){if(n.endY+D<0){w.ty(-n.startY);break}if(n.startY+D>B){w.ty(B-n.endY);break}}}}w.ty(w.ty())}else{w._9o&&(N.y=0,xg(w._8o.getView(),N)),$f(r,s,g);var u=ob(r),h=0;if(Wi(u,w.tx(),0,1),u.clearRect(0,0,s,g),A.clear(),p._roots.each(function(Z){if(Z.isVisible()){var f,a=w.getTabWidth(Z);if(!x||x.tab!==Z){var r=w.getTabBackground(Z);f=w.drawTab(u,Z,h,0,a,g,r)}A.add({_75o:f,tab:Z,startX:h,endX:h+a,width:a}),h+=a+$}}),w._64I=f(0,h-$),x){var Q=x.position;w.drawTab(u,x.tab,x.startX,0,x.width,g,w._moveBackground),ef(u,w._insertColor,Q,0,g)}if(u.restore(),w._selectionChanged){w._selectionChanged=!1;for(var Y=w.tx(),K=0;K<A.size();K++){var n=A.get(K);if(n.tab===w._8o){if(n.endX+Y<0){w.tx(-n.startX);break}if(n.startX+Y>s){w.tx(s-n.endX);break}}}}w.tx(w.tx())}for(var z=[],G=C.children,K=0;K<G.length;K++){var m=G[K],M=m._tab_;M&&!p.contains(M)&&z.push(m)}z.forEach(function(n){C.removeChild(n)})}});var zt=function(G){this.tv=G,this.addListeners()};eq(zt,x,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(i){this.handleScroll(i,10*(i.wheelDelta/40))},handle_DOMMouseScroll:function(e){this.handleScroll(e,10*-e.detail)},handleScroll:function(i,J){zq(i);var z=this.tv,F=z._tabPosition;!z._40o()||F!==Ui&&F!==nl||z.tx(this.tv.tx()+J),!z._41o()||F!==Mh&&F!==Xi&&F!==Mh+"-vertical"&&F!==Xi+"-vertical"||z.ty(this.tv.ty()+J)},_8Q:function(H){var O,q,k=this.tv,X=k._tabPosition,R=k._7o;if(X===Ui||X===nl){var _=k.lp(H).x;for(O=0;O<R.size();O++)if(q=R.get(O),q.startX<=_&&_<=q.endX)return q}else if(X===Mh||X===Xi||X===Mh+"-vertical"||X===Xi+"-vertical"){var A=k.lp(H).y;for(O=0;O<R.size();O++)if(q=R.get(O),q.startY<=A&&A<=q.endY)return q}return Q},isClickable:function(d){var E=this.tv,$=E._tabPosition,e=this._73o=this._8Q(d);return!E._40o()||$!==Ui&&$!==nl?!E._41o()||$!==Mh&&$!==Xi&&$!==Mh+"-vertical"&&$!==Xi+"-vertical"?e&&(!e.tab.isDisabled()||E.isMovable()):!0:!0},handle_mousemove:function(D){var z=this;xf?z._74o=z._8Q(D):z.getView().style.cursor=z.isClickable(D)?Yi:""},handle_mousedown:function(y){this.handle_mousemove(y),this.handle_touchstart(y)},handle_touchstart:function(K){var n=this,J=n.tv,m=J._tabPosition;zq(K),Do(K)&&n.isClickable(K)&&(m===Ui||m===nl?(n.x=Hf(K).x,n.lp=J.lp(K),n.tx=J.tx()):(n.y=Hf(K).y,n.lp=J.lp(K),n.ty=J.ty()),Td(n,K))},handle_mouseup:function(m){this.handle_touchend(m)},handle_touchend:function(q){if(iq(q)){var c=this._73o;if(!c)return;var v=this.tv,B=v.getTabModel(),d=c.tab;if(!d.isDisabled()&&d.isClosable()){var _=function(){var D=B._roots.indexOf(d);B.remove(d),v.onTabClosed(d,D)};v.onTabClosing(d,_)&&_()}}},handleWindowMouseMove:function(z){this.handleWindowTouchMove(z)},handleWindowTouchMove:function(H){var q,i=this,x=i.tv,k=x._tabPosition,m=i._73o;if(k===Ui||k===nl){if(q=Hf(H).x-i.x,!i._25o&&!i.moving&&D(q)>2&&(x._40o()&&!Kp(H)?i._25o=1:m&&x.isMovable()&&(i.moving=1)),i._25o)x.tx(i.tx+q);else if(i.moving){var $=i.lp.x+q,o=x._tabGap/2;x._7o.each(function(A){var e=A.endX,U=$-A.startX<e-$;$>=A.startX&&e>=$&&x._7Q({tab:m.tab,startX:m.startX+q,width:m.width,front:U,insertTab:A.tab,position:U?f(0,A.startX-o):F(x._64I,e+o)})})}}else if(q=Hf(H).y-i.y,!i._25o&&!i.moving&&D(q)>2&&(x._41o()&&!Kp(H)?i._25o=1:m&&x.isMovable()&&(i.moving=1)),i._25o)x.ty(i.ty+q);else if(i.moving){var R=i.lp.y+q,o=x._tabGap/2;x._7o.each(function(D){var g=D.endY,H=R-D.startY<g-R;R>=D.startY&&g>=R&&x._7Q({tab:m.tab,startY:m.startY+q,height:m.height,front:H,insertTab:D.tab,position:H?f(0,D.startY-o):F(x._23Q,g+o)})})}},handleWindowMouseUp:function(S){this.handleWindowTouchEnd(S)},handleWindowTouchEnd:function(){var y=this,r=y.tv,n=r._tabPosition,f=r.getTabModel(),W=f._roots,G=y._73o;if(y.moving){var m=r._23o;if(m&&m.insertTab!==m.tab){var j=m.tab,A=W.remove(j),z=W.indexOf(m.insertTab);z>=0&&(m.front||z++,z<=W.size()&&(W.add(j,z),f._38I(j,A,z)))}r._7Q(Q),delete y.moving}else if(!y._25o&&G){j=G.tab;var O=y._74o;if(!O||O.tab===j)if(!j.isDisabled()&&Om(G._75o,y.lp)){var P=function(){var D=W.indexOf(j);f.remove(j),r.onTabClosed(j,D)};r.onTabClosing(j,P)&&P()}else j.isDisabled()||r._8o===j||f.sm().ss(j)}y._25o=y._73o=y._74o=n===Ui||n===nl?y.x=y.lp=y.tx=Q:y.y=y.lp=y.ty=Q}}),tt.PropertyView=function(Y){var k=this;k._view=Si(1,k),k._canvas=Yp(k._view),zk(k._view,k._79O=jc()),k._rows=new Qd,k._28o=new Qd,k._26o={},k._26Q={};var $=k._propertyModel=new Zi,Z=k.ivm;$.mm(Z,k),$.md(Z,k),$.mh(Z,k),k.dm(Y?Y:new Zi),new At(k)},ut("PropertyView",x,{ms_ac:[us,qk,Gg,Wk,qm,"categorizable",er,me,Re,Gd,Cs,Kh,jr,hh,"selectRowIndex",fo,"background",Rk,so,Rm,Ef,Ke],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Tm,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Vm,_background:C.propertyViewBackground,_expandIcon:C.propertyViewExpandIcon,_collapseIcon:C.propertyViewCollapseIcon,_scrollBarColor:Tr,_scrollBarSize:Qp,_autoHideScrollBar:Fk,_selectBackground:C.propertyViewSelectBackground,_rowHeight:Ii,_rowLineVisible:C.propertyViewRowLineVisible,_rowLineColor:C.propertyViewRowLineColor,_10I:.5,_columnLineVisible:C.propertyViewColumnLineVisible,_columnLineColor:C.propertyViewColumnLineColor,_labelColor:C.propertyViewLabelColor,_labelSelectColor:C.propertyViewLabelSelectColor,_labelFont:C.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(i){0>i&&(i=0),i>1&&(i=1);var f=this,p=f._10I;f._10I=i,f.fp("columnPosition",p,i)},getPropertyName:function(e){return e.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(T,V,_){return _===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(Z,B){return B===this._selectRowIndex?this._labelSelectColor:Z.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(Z){var P=this.getHeight()-this._59I;return P>Z&&(Z=P),Z>0?0:u(Z)},isExpanded:function(D){if(!D)return!0;var t=this._26o[D];return t?t.isExpanded:!(this._26Q[D]===!1)},toggle:function(v){var h=this;h.isExpanded(v)?h.collapse(v):h.expand(v)},expandAll:function(){this.validate();for(var A in this._26o)this.expand(A)},expand:function(Q){if(Q&&Q!==Vl){var n=this,D=n._26o[Q];D&&!D.isExpanded&&(D.isExpanded=!0,n.onExpanded(Q),n.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var j in this._26o)this.collapse(j)},collapse:function(Y){if(Y&&Y!==Vl){var U=this,v=U._26o[Y];v&&v.isExpanded&&(v.isExpanded=!1,U.onCollapsed(Y),U.ivm())}},onCollapsed:function(){},getCategoryName:function(D){if(!this.isCategorizable())return Vl;var $=D.getCategoryName();return $?$:Vl},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(O){var U=this,Y=U._dataModel;Y!==O&&(Y&&(Y.umd(U.handlePropertyChange,U),U._selectionModel||Y.sm().ums(U.handleSelectionChange,U)),U._dataModel=O,O.md(U.handlePropertyChange,U),U._selectionModel?U._selectionModel._21I(O):O.sm().ms(U.handleSelectionChange,U),U.fp(Ei,Y,O))},isVisible:function(r){return this._visibleFunc?this._visibleFunc(r):!0},onPropertyChanged:function(e){var V=this,S=e.property;ot[S]?V.ivm():V.iv(),S===Dr&&V._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Xm},handlePropertyChange:function(f){this._27o===f.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var k=this;k._96I||(k.setSelectRowIndex(-1),k._96I=1,k.iv())},redraw:function(){this.iv()},validateModel:function(){var B=this,U=B._rows,n=B._28o,b={},i=new Qd,R=B._27o;B.updateCurrentData(),R!==B._27o&&B.endEditing(),U.clear(),n.clear(),B.getRawProperties().each(function(t){if(B.isVisible(t)){i.add(t);var M=B.getCategoryName(t);b[M]||(n.add(M,M===Vl?0:_),b[M]={isExpanded:B.isExpanded(M),properties:new Qd})}}),B._sortFunc&&i.sort(B._sortFunc);for(var z in B._26o)B._26Q[z]=B.isExpanded(z);B._26o=b,n.each(function(X){X!==Vl&&U.add(X);var N=b[X];N.isExpanded&&i.each(function(Z){B.getCategoryName(Z)===X&&(N.properties.add(Z),U.add({property:Z,data:B._27o}))},B)})},validateImpl:function(){var v=this;v._76o(),v._96I&&(v.validateModel(),delete v._96I);var k=v._canvas,I=v.getWidth(),f=v.getHeight(),O=-v.ty(),w=v._rowHeight,g=v._indent,U=I-g,W=v._rows,x=W.size(),i=v._9I=g+U*v._10I,A=v._59I=x*w;$f(k,I,f),v._29I={x:0,y:O,width:I,height:f},v._31I=E(O/w),v._14I=J((O+f)/w),v._31I<0&&(v._31I=0),v._14I>x&&(v._14I=x);var o,y=ob(k),M=v._background;Wi(y,0,-O,1),y.beginPath(),y.rect(0,O,I,f),y.clip(),y.clearRect(0,O,I,f),v._93db(y),M&&uj(y,0,0,g,A,M);for(var m=v._31I;m<v._14I;m++){var z=W.get(m),O=w*m;if(am(z))M&&uj(y,g,O,U,w,M),o=Bj(v.isExpanded(z)?v._expandIcon:v._collapseIcon),o&&_m(y,o,vh,0,O,g,w),y.save(),y.beginPath(),y.rect(g,O,U,w),y.clip(),v.drawCategoryName(y,z,m,g,O,U,w),y.restore();else{var H=z.property,N=z.data,o=Bj(H.getIcon()),V=v._selectRowIndex===m?v.getSelectBackground():Q;if(o&&_m(y,o,vh,0,O,g,w),V&&uj(y,g,O,U,w,V),y.save(),y.beginPath(),y.rect(g,O,i-g,w),y.clip(),v.drawPropertyName(y,H,m,g,O,i-g,w),y.restore(),!v.isEditing(N,H)){var D=i+1,Z=I-i-1;y.save(),y.beginPath(),y.rect(D,O,Z,w),y.clip(),v._87o(v.drawPropertyValue(y,H,v.getValue(N,H),m,D,O,Z,w,N),m,D,O,Z,w),y.restore()}}v._rowLineVisible&&uj(y,g,O+w-1,U,1,v._rowLineColor)
}v._columnLineVisible&&(uj(y,i,0,1,A,v._columnLineColor),uj(y,I-1,0,1,A)),v._92db(y),v._93I(),y.restore(),v.ty(v.ty())},drawCategoryName:function(m,J,f,X,G,U,O){Br(m,J,this.getCategoryFont(J),this.getCategoryColor(J),X,G,U,O)},drawPropertyName:function(x,y,z,F,G,u,$){return y.drawPropertyName?(y.drawPropertyName(x,y,z,F,G,u,$,this),void 0):(Br(x,this.getPropertyName(y),this.getPropertyFont(y,z),this.getPropertyColor(y,z),F,G,u,$),void 0)},drawPropertyValue:function(j,W,J,i,v,T,S,K,$){return W.drawPropertyValue?W.drawPropertyValue(j,W,J,i,v,T,S,K,$,this):(qt(j,J,W,this.getLabelFont(W,J,i),this.getLabelColor(W,J,i),v,T,S,K,$,this),void 0)},isPropertyEditable:function(J){return J.isEditable()&&this.isEditable()},setProperties:function(Z){this._propertyModel.clear(),this.addProperties(Z)},addProperties:function(J){if(J){var f=this._propertyModel;J.forEach(function(d){if(!(d instanceof xt)){var o=ec(d.className);d=Df(o?o:xt,d)}f.add(d)})}},getRowIndexAt:function(J){var R=this,b=E(R.lp(J).y/R._rowHeight);return b>=0&&b<R._rows.size()?b:-1},getPropertyAt:function(t){var y=this,H=y.getRowIndexAt(t);return H>=0?y._rows.get(H).property:Q},getToolTip:function(L){var I=this,g=I.getPropertyAt(L),z=I._27o;return g&&z?g.getToolTip(z,I._9I<I.lp(L).x,I):Q}});var At=function(I){this.pv=I,this.addListeners()};eq(At,x,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(q){this.getView().style.cursor=q},clear:function(){var V=this;V._62O=V.cp=V.ty=V.p=Q,V.setCursor(Dh)},handle_mousedown:function(A){this.handle_touchstart(A)},handle_touchstart:function(o){var J=this,j=J.pv;zq(o),j.setFocus(o)&&(Do(o)?(J.cp=Hf(o),J.ty=j.ty(),J.p=j.getColumnPosition(),J.handle_touchmove(o)):j.setSelectRowIndex(j.getRowIndexAt(o)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(x){this.handle_touchend(x)},handle_touchend:function(R){var q=this;if(q.cp&&!q._62O){var U=q.pv,p=U.lp(R),S=p.x,x=p.y,k=U._indent,P=U.getRowIndexAt(R),u=U._9I;if(P>=0){var C=U._rowHeight,j=C*P,h=U._rows.get(P),z=h.property;if(am(h))Bj(U.isExpanded(h)?U._expandIcon:U._collapseIcon)&&S>=0&&k>=S&&x>=j&&j+C>=x?U.toggle(h):Mq(R)&&U.toggle(h);else if(S>u&&U.isPropertyEditable(z,R)){var v={x:u+1,y:j,width:U.getWidth()-u-1,height:C},f={x:v.x+U.tx(),y:v.y+U.ty(),width:v.width,height:v.height},g=0,T=U._29I;v.y<T.y?g=v.y-T.y:v.y+C>T.y+T.height&&(g=v.y+C-T.y-T.height),g&&(U.ty(U.ty()-g),f.y-=g),U.beginEditing({data:h.data,property:z,value:U.getValue(h.data,z),event:R,rect:v,editorRect:f,view:U})}}U.setSelectRowIndex(P)}q.clear()},handleWindowMouseMove:function(x){this.handleWindowTouchMove(x)},handleWindowTouchMove:function(i){var b=this,B=b.pv,r=b.ty,R=b.cp,p=Hf(i),U=b._62O;if("p"===U)B.setTranslateY(r+p.y-R.y);else if("c"===U){var k=B.getWidth()-B._indent;if(k>16){var C=b.p-(R.x-p.x)/k,a=16/k;a>C&&(C=a),C>1-a&&(C=1-a),B.setColumnPosition(C)}}else"s"===U&&B.setTranslateY(r+(R.y-p.y)*B._59I/B._29I.height)},handle_mousemove:function(x){this.handle_touchmove(x)},handle_touchmove:function(Y){if(!xf&&Do(Y)){var Q=this,W=Q.pv,o=D(W.lp(Y).x-W._9I)<=(Ap?8:3);Q.cp?Q._62O||(o?(Q._62O="c",Td(Q,Y)):D(Hf(Y).y-Q.cp.y)>=2&&(Q._62O=Q.isV(Y)?"s":"p",Td(Q,Y))):(o?Q.setCursor(cr):Q.setCursor(Dh),Q.isV(Y)&&W._43o())}},isV:function(Z){var C=this.pv,N=C._29I;return C._41o()&&N.x+N.width-C.lp(Z).x<oc},handle_mousewheel:function(b){this.handleScroll(b,b.wheelDelta/40)},handle_DOMMouseScroll:function(s){2===s.axis&&this.handleScroll(s,-s.detail)},handleScroll:function(t,m){var F=this.pv;zq(t),F.endEditing(),F.translate(0,m*F.getRowHeight())},handle_keydown:function(v){var e=this.pv,I=e._rows.size(),T=e._selectRowIndex+(zc(v)?-1:1);(zc(v)||uh(v))&&(0>T&&(T=0),T>=I&&(T=I-1),e.setSelectRowIndex(T))}}),tt.ListView=function(k){this._5o(k),new Bt(this)},ut("ListView",x,{ms_ac:[us,qk,Gg,Rk,er,so,Rm,me,Re,Kh,jr,hh,yc,fo],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Vm,_rowHeight:Ii,_rowLineVisible:C.listViewRowLineVisible,_rowLineColor:C.listViewRowLineColor,_scrollBarColor:Tr,_scrollBarSize:Qp,_autoMakeVisible:Cj,_autoHideScrollBar:Fk,_selectBackground:C.listViewSelectBackground,_labelColor:C.listViewLabelColor,_labelSelectColor:C.listViewLabelSelectColor,_labelFont:C.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(t){var b=this,s=b._checkMode;b._checkMode=t,b.fp(Io,s,t)},drawRow:function(n,f,l,G,_,A,i){var q=this,I=0,E=q._indent,O=q.getIconWidth(f);q.drawRowBackground(n,f,l,G,_,A,i),q._checkMode&&(Fb(n,Bj(q.getCheckIcon(f)),I+E/2,_+i/2,f,q),I+=E),q.drawIcon(n,f,I,_,O,i),q.drawLabel(n,f,I+O,_,i)}});var Bt=function(O){this.list=O,this.addListeners()};eq(Bt,x,{ms_listener:1,getView:function(){return this.list._view},clear:function(R){var Z=this,I=Z.list;R&&"d"===Z._62O&&!Z.dragCancel&&I.handleDragAndDrop(R,"end"),I.draggingData&&(I.draggingData=null,I.redraw()),Z.dragCancel=Z._62O=Z._isV=Z._isH=Z.cp=Z.tx=Z.ty=Q},handle_mousedown:function(e){this.handle_touchstart(e)},handle_touchstart:function(W){var e=this,i=e.list;if(zq(W),i.setFocus(W)){var C=i.getDataAt(W);e.cp=Hf(W),e.tx=i.tx(),e.ty=i.ty(),Do(W)?C&&i.handleDragAndDrop&&!e.isV(W)&&!e.isH(W)&&(i.draggingData=C,i.redraw(),i.handleDragAndDrop(W,"prepare")):(C?e._33o(W,C):this._cancelDataDoubleSelect(),e.clear(W))}},handleWindowMouseUp:function(K){this.clear(K)},handleWindowTouchEnd:function(u){this.clear(u)},handle_mouseup:function(L){this.handle_touchend(L)},handle_touchend:function(X){var r=this,t=r.list;if(!r._isV&&!r._isH&&r.cp&&!r._62O){var b=t.getDataAt(X);b?(t.isCheckMode()?r._34o(X,b):r._33o(X,b),Mq(X)?t.onDataDoubleClicked(b,X):t.onDataClicked(b,X)):(r._cancelDataDoubleSelect(),t.handleBackgroundClick(X))}r.clear(X)},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(j){var O=this,R=O.list,p=O._62O,y=O.tx,n=O.ty,K=O.cp,r=Hf(j),w=R._29I;"p"===p?R.setTranslate(y+r.x-K.x,n+r.y-K.y):"v"===p?R.ty(n+(K.y-r.y)*R._59I/w.height):"h"===p?R.tx(y+(K.x-r.x)*R._91I/w.width):"d"===p&&(O.dragCancel||R.handleDragAndDrop(j,"between"))},handle_mousemove:function(N){this.handle_touchmove(N)},handle_touchmove:function(n){if(!xf&&Do(n)){var N=this,i=N.list;if(N._isV=N.isV(n),N._isH=N.isH(n),N.cp){if(!N._62O){if(Ki(Hf(n),N.cp)<2)return;N._isV?N._62O="v":N._isH?N._62O="h":i.draggingData&&!this.dragCancel?(N._62O="d",i.handleDragAndDrop(n,"begin")):N._62O="p",N._62O&&"d"!==N._62O&&i.draggingData&&(i.draggingData=null,i.redraw()),Td(N,n)}}else N._isV&&i._43o(),N._isH&&i._42o()}},isV:function(P){var K=this.list,s=K._29I;return K._41o()&&s.x+s.width-K.lp(P).x<oc},isH:function(_){var X=this.list,a=X._29I;return X._40o()&&a.y+a.height-X.lp(_).y<oc},handle_mousewheel:function(T){this.handleScroll(T,T.wheelDelta/40,T.wheelDelta!==T.wheelDeltaX)},handle_DOMMouseScroll:function(d){this.handleScroll(d,-d.detail,1)},handleScroll:function(j,_,W){var F=this.list;zq(j),F.endEditing&&F.endEditing(),W&&F._41o()?F.translate(0,_*F.getRowHeight()):F._40o()&&F.translate(10*_,0)},handle_keydown:function(N){if(!C.isInput(N.target)){var x,E=this.list,m=E.sm(),t=E._rows,p=t.size();if(ue(N))E.selectAll();else if(Qi(N))E.handleDelete&&E.handleDelete(N);else if(ol(N))"d"!==this._62O||this.dragCancel||(E.handleDragAndDrop(N,"cancel"),this.dragCancel=!0);else if(Uq(N))E.isCheckMode()&&(x=E.getFocusData(),x&&E.checkData(x));else if(zc(N)||uh(N)){var k=E.isCheckMode();if(x=k?E.getFocusData():m.ld()){var K=E.getRowIndex(x);K>=0&&(zc(N)?0!==K&&(x=t.get(K-1),k?E.setFocusData(x):m.ss(x)):K!==p-1&&(x=t.get(K+1),k?E.setFocusData(x):m.ss(x)))}else p>0&&(x=t.get(0),k?E.setFocusData(x):m.ss(x))}}},_34o:function(x,A){var X=this.list,P=X.lp(x).x;return P>=0&&P<=X._indent?(X.checkData(A),void 0):(X.setFocusData(A),void 0)},_33o:function(D,W){var z=this.list,u=z.sm(),V=u.ld();if(!z.canHandleSelectMode(D,W))return this._cancelDataDoubleSelect(),void 0;if(Kp(D))z.isSelected(W)?u.rs(W):u.as(W);else if(Xf(D))if(V)for(var i=z.getRowIndex(V),c=z.getRowIndex(W);i!==c;)i+=c>i?1:-1,u.as(z._rows.get(i));else u.ss(W);else Do(D)?(u.contains(W)?z.handleDataDoubleSelect&&(this._handleDataDoubleSelect(D,W),Mq(D)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),u.ss(W)):u.contains(W)||u.ss(W)},_handleDataDoubleSelect:function(q,h){this._cancelDataDoubleSelect(),this._doubleSelectTimer=Eg(function(){this.list.handleDataDoubleSelect(q,h),this._doubleSelectTimer=_}.bind(this),C.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(qs(this._doubleSelectTimer),this._doubleSelectTimer=_)}}),tt.TreeView=function(Z){var E=this;E._35o(),E._5o(Z),new Ct(E)},ut("TreeView",x,{ms_ac:[us,qk,Gg,"rootVisible",Io,"rootData",me,Re,Kh,jr,hh,er,Rk,so,Rm,Gd,Cs,yc,fo,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:Q,_indent:Vm,_rowHeight:Ii,_rowLineVisible:C.treeViewRowLineVisible,_rowLineColor:C.treeViewRowLineColor,_scrollBarColor:Tr,_scrollBarSize:Qp,_autoHideScrollBar:Fk,_expandIcon:C.treeViewExpandIcon,_collapseIcon:C.treeViewCollapseIcon,_autoMakeVisible:Cj,_selectBackground:C.treeViewSelectBackground,_labelColor:C.treeViewLabelColor,_labelSelectColor:C.treeViewLabelSelectColor,_labelFont:C.treeViewLabelFont,_doubleClickToToggle:C.treeViewDoubleClickToToggle,drawRow:function(v,J,w,W,i,j,s){var C=this;C.drawRowBackground(v,J,w,W,i,j,s),C.drawTree(v,J,w,0,i,j,s)},isOnToggleIcon:function(j){var I=this.getDataAt(j);if(I){var l=this.getIndent(),R=this.lp(j).x;if(Bj(this.getToggleIcon(I))){var F=l*this.getLevel(I);if(R>=F&&F+l>=R)return!0}}return!1}});var Ct=function(c){rd(Ct,this,[c])};eq(Ct,Bt,{toggle:function(C,O,A,j){var F=this.list,R=F.lp(C).x;if(Bj(F.getToggleIcon(O))){var q=A*j;if(R>=q&&q+A>=R)return F.toggle(O),!0}return F.isDoubleClickToToggle()&&Mq(C)?(F.toggle(O),!0):!1},_34o:function(g,t){var B=this.list,j=B.lp(g).x,M=B._levelMap[t._id],s=B._indent,a=s*(M+1);return j>=a&&a+s>=j?(B.checkData(t),void 0):(this.toggle(g,t,s,M)||B.setFocusData(t),void 0)},_33o:function(H,K){var w=this,z=w.list;if(!w.toggle(H,K,z._indent,z.getLevel(K)))if(Xf(H)){var x=z.sm();if(x.size()>0){for(var n=z._rows,f=null,l=0,p=n.size();p>l;l++)if(z.isSelected(n.get(l))){f=l;break}for(var I=null,l=n.size()-1;l>=0;l--)if(z.isSelected(n.get(l))){I=l;break}var s,c,V=z.getRowIndex(K);for(f>V?(s=V-1,c=f):V>I?(s=I,c=V):(s=f,c=I);s!==c;)s++,x.as(z._rows.get(s))}else x.ss(K)}else Ct.superClass._33o.call(w,H,K)},handle_keydown:function(T){if(re(T)||ze(T)){var p=this.list,x=p._rows,H=p.isCheckMode(),w=p.sm(),M=H?p.getFocusData():w.ld();M?M.hasChildren()&&(re(T)?p.collapse(M):p.expand(M)):x.size()>0&&(M=x.get(0),H?p.setFocusData(M):w.ss(M))}else Ct.superClass.handle_keydown.call(this,T)}});var Dt=tt.TableView=function(G){this._98I(),this._5o(G),new Et(this)};ut("TableView",x,{ms_ac:[us,qk,Gg,"sortMode",Wk,qm,Rk,so,Rm,Ef,Ke,"sortColumn",me,Re,Kh,jr,hh,yc,fo],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:he,_editable:!0,_batchEditable:!1,_rowHeight:Ii,_rowLineVisible:C.tableViewRowLineVisible,_rowLineColor:C.tableViewRowLineColor,_columnLineVisible:C.tableViewColumnLineVisible,_columnLineColor:C.tableViewColumnLineColor,_scrollBarColor:Tr,_scrollBarSize:Qp,_autoHideScrollBar:Fk,_autoMakeVisible:Cj,_selectBackground:C.tableViewSelectBackground,_labelColor:C.tableViewLabelColor,_labelSelectColor:C.tableViewLabelSelectColor,_labelFont:C.tableViewLabelFont,getCheckColumn:function(){var P=this;if(!P._31o){var u=P._31o=new wt;u.setEditable(!0),u.setWidth(40),u.getValue=P.getCheckColumValue,u.drawCell=P.drawCheckColumnCell}return P._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(o){var g=this,H=g._39o,f=g.getCheckColumn();o!==g.isCheckMode()&&(o?H.add(f,0):H.remove(f),g.fp(Io,!o,o))},getCheckColumValue:function(k,D,Z){return Z.isSelected(k)},drawCheckColumnCell:function(p,c,R,D,k,G,E,O,J){Fb(p,J.getCheckIcon(c),k+E/2,G+O/2,c,J)}});var Et=function(S){rd(Et,this,[S])};eq(Et,Bt,{_34o:function(p,B){var q=this.list,x=q._31o;if(q.isCellEditable(B,x,p)){var D=q._3Q(x),$=q.lp(p).x;if(D&&$>=D.startX&&$<D.startX+x.getWidth())return q.checkData(B),void 0}q._37O(B,p),q.setFocusData(B)},_33o:function(q,D){this.list._37O(D,q),Et.superClass._33o.apply(this,arguments)}});var Ft=tt.TreeTableView=function(O){var P=this,o=P._4o=new wt;P._35o(),P._98I(),P._5o(O),o.setDisplayName("Name"),o.setEditable(!0),o.setWidth(180),o.drawCell=Gt,o.getValue=Ht,P._39o.add(o),new It(P)},Gt=function(s,x,G,k,g,B,l,Z,T){T.drawTree(s,x,G,g,B,l,Z)},Ht=function(h,I,T){return T.getLabel(h)};ut("TreeTableView",x,{ms_ac:[us,qk,Gg,"sortMode",Wk,qm,er,Io,"rootData","rootVisible",me,Re,"sortColumn",Gd,Cs,Kh,jr,hh,yc,Rm,Rk,so,Ef,Ke,fo,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:he,_checkMode:Q,_editable:!0,_batchEditable:!1,_indent:Vm,_rowHeight:Ii,_rowLineVisible:C.treeTableViewRowLineVisible,_rowLineColor:C.treeTableViewRowLineColor,_columnLineVisible:C.treeTableViewColumnLineVisible,_columnLineColor:C.treeTableViewColumnLineColor,_expandIcon:C.treeTableViewExpandIcon,_collapseIcon:C.treeTableViewCollapseIcon,_scrollBarColor:Tr,_scrollBarSize:Qp,_autoHideScrollBar:Fk,_autoMakeVisible:Cj,_selectBackground:C.treeTableViewSelectBackground,_labelColor:C.treeTableViewLabelColor,_labelSelectColor:C.treeTableViewLabelSelectColor,_labelFont:C.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var It=function(q){rd(It,this,[q])};eq(It,Bt,{_34o:function(l,G){var i=this.list,Y=i._4o,k=i._3Q(Y),E=i.lp(l).x;if(k){var I=i._indent,b=k.startX+I*i.getLevel(G);if(Bj(i.getToggleIcon(G))&&E>=b&&b+I>=E)return i.toggle(G),void 0;if(i.isCellEditable(G,Y)&&(b+=I,E>=b&&b+I>=E))return i.checkData(G),void 0}i._37O(G,l),i.setFocusData(G)},_33o:function(U,w){var l=this.list,K=l.lp(U).x;if(Bj(l.getToggleIcon(w))){var e=l._3Q(l._4o);if(e){var b=l._indent,q=e.startX+b*l.getLevel(w);if(K>=q&&q+b>=K)return l.toggle(w),void 0}}l._37O(w,U),It.superClass._33o.apply(this,arguments)}});var Jt=tt.TableHeader=function(v){var r=this,T=r._view=Si(1,r),O=r._39o=v.getColumnModel(),s=r.iv;r.tv=r._tableView=v,r._60I=new Qd,r._canvas=Yp(T),T.style.background=C.tableHeaderBackground||"",T.style.height=In+jf,O.mm(s,r),O.md(s,r),O.mh(s,r),v.mp(function(N){kt[N.property]&&r.iv()},r),new Kt(r),r.iv()};ut("TableHeader",x,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",us,Gg,er,"moveBackground","insertColor",Ef,Ke,"resizable","movable"],_checkIcon:ls,_movable:!0,_resizable:!0,_labelColor:C.tableHeaderLabelColor,_labelFont:C.tableHeaderLabelFont,_columnLineColor:C.tableHeaderColumnLineColor,_columnLineVisible:C.tableHeaderColumnLineVisible,_sortDescIcon:C.tableHeaderSortDescIcon,_sortAscIcon:C.tableHeaderSortAscIcon,_moveBackground:C.tableHeaderMoveBackground,_insertColor:C.tableHeaderInsertColor,_indent:Vm,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(r){return r.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(A){return A.getColor()||this._labelColor},getLabelAlign:function(D){return D._align},onPropertyChanged:function(){this.iv()},_5Q:function(c){this._61I=c,this.iv()},getLogicalPoint:function(m){return ag(m,this._canvas,this.tv.tx())},validateImpl:function(){var s=this,c=s._canvas,l=s.getWidth(),t=s.getHeight(),H=s.tv,J=s._60I,h=s._61I,V=-H.tx(),Z=0;(l!==c.clientWidth||t!==c.clientHeight)&&$f(c,l,t),J.clear(),s._39o._roots.each(function(k){if(k.isVisible()){var U=Z+k.getWidth();V+l>=Z&&U>=V&&J.add({column:k,startX:Z}),Z=U}});var v=ob(c);if(Wi(v,-V,0,1),v.beginPath(),v.rect(V,0,l,t),v.clip(),v.clearRect(V,0,l,t),J.each(function(G){var _=G.column,D=G.startX,V=_.getWidth();V>0&&(v.save(),v.beginPath(),v.rect(D,0,V,t),v.clip(),h&&h.column===_||s.drawColumn(v,_,D,0,V,t),s._columnLineVisible&&uj(v,D+V-1,0,1,t,s._columnLineColor),v.restore())}),h){var I=h.column,Z=h.startX,U=h.position,b=I.getWidth();v.save(),v.beginPath(),v.rect(Z,0,b,t),v.clip(),v.fillStyle=s._moveBackground,v.fill(),s.drawColumn(v,I,Z,0,b,t),v.restore(),ef(v,s._insertColor,U,0,t)}v.restore()},_6Q:function(M){var L=this.tv;return L._31o===M&&L.sm().getSelectionMode()===fe},drawColumn:function(c,g,o,B,v,q){var T=this,f=T.tv,D=Bj(g.getIcon()),J=T.getLabelAlign(g);if(T._6Q(g)){var a=Bj(T._checkIcon);Fb(c,a,o+v/2,B+q/2,g,T)}else{var i=T.getLabel(g),r=T.getLabelFont(g),_=T.getLabelColor(g),P=lr(r,i).width,t=D?T._indent:0;J===Mh?(D&&_m(c,D,vh,o,B,t,q),Br(c,i,r,_,o+t,B,v,q,Mh)):J===Xi?(D&&_m(c,D,vh,o+v-P-t,B,t,q),Br(c,i,r,_,o,B,v,q,Xi)):(D&&_m(c,D,vh,o+(v-P-t)/2,B,t,q),Br(c,i,r,_,o+(v-P+t)/2,B,0,q,Mh))}if(g.isSortable()&&f.getSortColumn()===g&&(D=Bj(g.getSortOrder()===Al?T._sortAscIcon:T._sortDescIcon))){var x=ld(D,g)/2+2;Fb(c,D,J===Xi?o+x:o+v-x,B+q/2,g,f)}}});var Kt=function(k){var J=this;J.th=k,J.tv=k._tableView,J.addListeners()};eq(Kt,x,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(c){this.getView().style.cursor=c},handle_mousemove:function(N){if(!xf){var C=this;delete C._29o,C.setCursor(Dh);for(var B=C.th,J=B._60I,r=B.lp(N).x,x=J.size()-1;x>=0;x--){var z=J.get(x),m=z.column,F=z.startX+m.getWidth();if(B.isResizable()&&D(F-r)<=(Ap?10:3))return C._29o=z,C.setCursor(cr),void 0;r>z.startX&&F>r&&(C._29o=z),(m.isClickable()||m.isSortable()||B.isMovable()||C.tv.getCheckColumn&&m===C.tv.getCheckColumn())&&r>z.startX&&F>r&&C.setCursor(Yi)}}},handle_mousedown:function(N){this.handle_touchstart(N)},handle_touchstart:function(f){var A=this;zq(f),A.tv.endEditing(),A.handle_mousemove(f),A._29o&&(A.x=Hf(f).x,A.lx=A.th.lp(f).x,A.w=A._29o.column.getWidth(),Td(A,f))},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(j){var z=this,A=z.th,C=z.getView().style.cursor,U=z._29o,B=Hf(j).x-z.x;if(z.resizing||z.moving||(C===cr?z.resizing=1:A.isMovable()&&C===Yi&&D(B)>2&&(z.moving=1)),z.resizing)U.column.setWidth(z.w+B);else if(z.moving){var J=z.lx+B;A._60I.each(function(V){var R=V.startX,G=R+V.column.getWidth();if(J>=R&&G>=J){var r={column:U.column,startX:U.startX+B,front:G-J>J-R,insertColumn:V.column};r.position=r.front?R:G,A._5Q(r)}})}},_16Q:function(f,v){var Z=this,u=Z.tv,d=Z.th,N=d._checkIcon;if(d._6Q(f)){var R=Bj(N),h=Z.lx,Y=f.getWidth(),x=ld(R,f);if(h>=v+Y/2-x&&v+Y/2+x>=h){d.setCheckIcon(N===Uf?ls:Uf);var t=u.sm(),D=u._rows;return N===Uf?t.rs(D):t.ss(D),u.onCheckColumnClicked(f),!0}}return!1},handleWindowMouseUp:function(o){this.handleWindowTouchEnd(o)},handleWindowTouchEnd:function(P){var L=this,f=L.tv,D=L.th,t=L._29o;if(L.moving){var N=D._61I;if(N&&N.insertColumn!==N.column){var w=N.column,i=f.getColumnModel()._roots,c=i.remove(w),R=i.indexOf(N.insertColumn);R>=0&&(N.front||R++,R<=i.size()&&(i.add(w,R),f.getColumnModel()._38I(w,c,R)))}D._5Q(Q),delete L.moving}else if(!L.resizing&&t){w=t.column;var Z=D.lp(P).x,u=t.startX,J=!0;if(D.onColumnClicked){var g=D.onColumnClicked(w,P,u);g===!1&&(J=!1)}if(J&&Z>=u&&Z<=u+w.getWidth()&&!L._16Q(w,u)){if(w.isSortable()){var a=f.getSortMode(),d=w.getSortOrder();a===he?f.getSortColumn()===w?(d===ff&&f.setSortColumn(Q),w.setSortOrder(d===Al?ff:Al)):f.setSortColumn(w):"bistate"===a&&(f.getSortColumn()===w?w.setSortOrder(d===Al?ff:Al):f.setSortColumn(w))}f.onColumnClicked(w,P,u)}}L._29o=L.resizing=L.x=L.lx=L.w=Q}}),tt.TablePane=function(c){this.init(new Dt(c))},ut("TablePane",x,{ms_v:1,_44o:1}),tt.TreeTablePane=function(a){this.init(new Ft(a))},ut("TreeTablePane",x,{ms_v:1,_44o:1}),tt.Toolbar=function(B){var M=this,y=M._view=Si(1,M),Z=y.style;Z.background=C.toolbarBackground||"",Z.height=As+jf,M._canvas=Yp(y),M._30o=new Qd,M._90I=new Qd,M.setItems(B||[]),y.handleGroupSelectedChanged=function(J){if(J.isSelected()){var P=J.getGroupId();null!=P&&M._items.forEach(function(w){var i=w.element;i&&i!==J&&i.setSelected&&i.getGroupId&&i.getGroupId()===P&&i.setSelected(!1)})}},new Lt(M)},ut("Toolbar",x,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[wk,us,Gg,qk,fo,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:C.toolbarLabelColor,_labelSelectColor:C.toolbarLabelSelectColor,_labelFont:C.toolbarLabelFont,_selectBackground:C.toolbarSelectBackground,_itemGap:C.toolbarItemGap,_separatorColor:C.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(o){var H=this.getItemInfoAt(o);return H?H.item.toolTip:Q},getLabelColor:function(n){return n&&n.selected&&n.type!==Uf&&n.type!==Yr?this._labelSelectColor:this._labelColor},onPropertyChanged:function(K){this.iv(),K.property===wk&&this._items.forEach(function(k){bi(k)})},redraw:function(){this.iv()},addItem:function(C,v){var N=this._items;v==Q?N.push(C):N.splice(v,0,C),this.fp(wk,Q,N)},removeItem:function(_){if(_)for(var u=this._items,A=0;A<u.length;A++)_===u[A]&&(u.splice(A,1),this.fp(wk,Q,u))},removeItemById:function(L){if(L!=Q)for(var o=this._items,I=0;I<o.length;I++)if(L===o[I].id){var Z=o.splice(I,1)[0];return this.fp(wk,Q,o),Z}},getItemById:function(z){if(z!=Q)for(var I=this._items,C=0;C<I.length;C++){var B=I[C];if(z===B.id)return B}},setItemVisible:function(Z,m){var M=this.getItemById(Z);M&&(M.visible=m)},getItemInfos:function(){return this._30o},getItemInfoAt:function(k){var A=this,b=0,P=A._30o,S=A.lp(k),L=S.x,D=S.y;if(D>=0&&D<=A.getHeight())for(;b<P.size();b++){var F=P.get(b);if(F.startX<=L&&L<=F.endX)return F}return Q},drawItem:function(D,T,N,Y,E){if(T.visible===!1)return 0;if(np(T.visible)&&!T.visible())return 0;var k=this,H=T.disabled;H&&(D.globalAlpha=Op);var j=k.drawItemImpl(D,T,N,Y,E),y=k._itemGap;return H&&(D.globalAlpha=1),this._currentItem!==T||"separator"===T||T.separator===!0||T.unfocusable||Xn(D,k._separatorColor,N-y/2,0,j+y,Y),j},drawItemImpl:function(v,K,e,g,b){var O=this,X=O._view,M=O._itemGap,k=g/2,$=K.type,Y=K.element,V=K.label;am(Y)&&(V=Y,Y=Q);var S,y=O.getLabelFont(K),x=O.getLabelColor(K),i=K.selected,L=Bj(K.icon),G=ld(L,K),F=0,W=G+(V?lr(y,V).width:0);if("separator"===K||K.separator===!0)return ef(v,O._separatorColor,e,g/4,k),1;if(Y){L&&Fb(v,L,e+G/2,k,K,O),Br(v,V,y,x,e+G,0,0,g);var P=nb(Y);b||O._90I.add(P),P.parentNode!==X&&zk(X,P),Y.iv&&Y.iv(),Y.validate&&Y.validate();var w=P.getBoundingClientRect(),C=w.width,a=P.style;return Pd(P),a.left=O.tx()+e+W+jf,a.top=(g-w.height)/2+jf,W+C}return $===Yr?S=Bj(i?tb:zb):$===Uf&&(S=Bj(i?Uf:ls)),S?(F=ld(S,K),Fb(v,S,e+F/2,k,K,O),e+=F,W+=F):i&&uj(v,e-M/2,0,W+M,g,O.getSelectBackground(K)),L&&Fb(v,L,e+G/2,k,K,O),Br(v,V,y,x,e+G,0,0,g),W},validateImpl:function(){var g=this,C=g._canvas,v=g.getWidth(),G=g.getHeight(),$=g._30o,y=g._items;$f(C,v,G);var b=ob(C),z=g._itemGap,V=z/2;Wi(b,g.tx(),0,1),b.clearRect(0,0,v,G);var t=g._90I;g._90I=new Qd,$.clear(),y.forEach(function(A){var B=g.drawItem(b,A,V,G);$.add({item:A,startX:V,endX:V+B,width:B}),B&&(V+=B+z)}),t.each(function(k){g._90I.contains(k)||hg(k)});var w=g._64I;g._64I=f(0,V-z/2),b.restore(),g._stickToRight?(g._65O=0,b=ob(C),V=v-g._64I+z/2,Wi(b,0,0,1),b.clearRect(0,0,v,G),$.clear(),y.forEach(function(I){var U=g.drawItem(b,I,V,G,!0);$.add({item:I,startX:V,endX:V+U,width:U}),U&&(V+=U+z)}),b.restore()):g.tx(g.tx()),w!==g._64I&&g.onSumWidthChanged(w,g._64I)},onSumWidthChanged:function(){},handleClick:function(H,X){var T=this,k=H.type,W=H.action,t=H.groupId,K=H.selected;H.disabled||(t!=Q?K||(H.selected=!0,this._items.forEach(function(w){w.groupId===t&&H!==w&&(w.selected=!1)}),W&&H.action(H,T,X)):k===Uf||"toggle"===k?(H.selected=!K,W&&H.action(H,T,X)):W&&H.action(H,T,X)),zn(),T.iv()}});var Lt=function(s){this.tb=s,this.addListeners()};eq(Lt,x,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(R){this.handleScroll(R,10*(R.wheelDelta/40))},handle_DOMMouseScroll:function(t){this.handleScroll(t,10*-t.detail)},handleScroll:function(o,I){zq(o);var $=this.tb;$.isScrollable()&&!$._stickToRight&&($.tx($.tx()+I),$j())},handle_mousemove:function(V){var t=this;xf||t.setItem(V)},handle_mouseout:function(J){var y=this;J.target===y.getView()?y.tb.setCurrentItem(Q):y.handle_mousemove(J)},handle_mousedown:function(V){this.handle_mousemove(V),this.handle_touchstart(V)},handle_touchstart:function(k){var _=this,o=_.tb,m=k.target;Do(k)&&(m===_.getView()||m===o._canvas)&&(zq(k),o.setFocus(k)&&(this.setItem(k,!0),(o.isScrollable()||_.info&&!_.info.item.disabled)&&(_.x=Hf(k).x,_.tx=o.tx(),Td(_,k))))},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(V){var A=this,f=A.tb;if(!f._stickToRight){var I=Hf(V).x-A.x;!A._25o&&D(I)>2&&f.isScrollable()&&(A._25o=1),A._25o&&f.tx(A.tx+I)}},handleWindowMouseUp:function(j){this.handleWindowTouchEnd(j)},handleWindowTouchEnd:function(Z){var b=this,p=b.tb,P=b.info,D=b.tb.getItemInfoAt(Z);if(!b._25o&&P){var R=P.item;D&&D.item===R&&p.handleClick(R,Z)}b._25o=b.x=b.tx=Q,b.setItem()},setItem:function(y,k){var H=this,P=H.tb,D=H.info=y?P.getItemInfoAt(y):Q,g=D?D.item:Q;P.setCurrentItem(g),k&&g&&np(g.onDown)&&g.onDown(y)}}),tt.BorderPane=function(){this._view=Si(1,this),this.iv()},ut("BorderPane",x,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(R,B){this._12o("leftView",R),B!=Q&&this.setLeftWidth(B)},getRightView:function(){return this._rightView},setRightView:function(B,r){this._12o("rightView",B),r!=Q&&this.setRightWidth(r)},getTopView:function(){return this._topView},setTopView:function(S,C){this._12o("topView",S),C!=Q&&this.setTopHeight(C)},getBottomView:function(){return this._bottomView},setBottomView:function(I,$){this._12o("bottomView",I),$!=Q&&this.setBottomHeight($)},getCenterView:function(){return this._centerView},setCenterView:function(j){this._12o("centerView",j)},_12o:function(y,O){var m=this,w="_"+y,W=m._view,V=m[w];V!==O&&(V&&(V.getView?hg(V.getView()):hg(V)),m[w]=O,O&&(O.getView?zk(W,O.getView(),1):zk(W,O,1)),m.fp(y,V,O))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var u=this,A=u._topView,g=u._bottomView,p=u._leftView,c=u._rightView,G=u._centerView,X=u.getWidth(),y=u.getHeight(),E=0,i=0,s=X,m=y,R=0,T=0,K=0,t=0;A&&(R=u._topHeight==Q?Ro(A):u._topHeight,i=R),g&&(T=u._bottomHeight==Q?Ro(g):u._bottomHeight,m=y-T),p&&(K=u._leftWidth==Q?Kg(p):u._leftWidth,E=K),c&&(t=u._rightWidth==Q?Kg(c):u._rightWidth,s=X-t);var J=f(0,s-E),w=f(0,m-i);A&&xg(A,0,0,X,R),g&&xg(g,0,m,X,T),p&&xg(p,0,i,K,w),c&&xg(c,s,i,t,w),G&&xg(G,E,i,J,w)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);